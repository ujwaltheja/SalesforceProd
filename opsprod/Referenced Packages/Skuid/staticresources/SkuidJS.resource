"use strict";if(Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var f=[];for(var g in e)a.call(e,g)&&f.push(g);if(b)for(var h=0;h<d;h++)a.call(e,c[h])&&f.push(c[h]);return f}}()),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&d!=Infinity&&d!=-Infinity&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);e<c;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=c;arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&d!=1/0&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d))));for(var e=d>=0?Math.min(d,c-1):c-Math.abs(d);e>=0;e--)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.filter||(Array.prototype.filter=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments[1],f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;if(null==this)throw new TypeError(" this is null or not defined");var e=Object(this),f=e.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(c=b),d=0;f>d;){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}}),Array.prototype.reduce||(Array.prototype.reduce=function(a){if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var b,c=Object(this),d=c.length>>>0,e=0;if(2==arguments.length)b=arguments[1];else{for(;d>e&&!(e in c);)e++;if(e>=d)throw new TypeError("Reduce of empty array with no initial value");b=c[e++]}for(;d>e;e++)e in c&&(b=a(b,c[e],e,c));return b}),Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e;if(null==this)throw new TypeError(" this is null or not defined");var f=Object(this),g=f.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(c=b),d=new Array(g),e=0;e<g;){var h,i;e in f&&(h=f[e],i=a.call(c,h,e,f),d[e]=i),e++}return d}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(a){if(null==this)throw new TypeError('"this" is null or not defined');var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError("predicate must be a function");for(var d=arguments[1],e=0;e<c;){var f=b[e];if(a.call(d,f,e,b))return f;e++}return undefined}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(a){if(null==this)throw new TypeError('"this" is null or not defined');var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError("predicate must be a function");for(var d=arguments[1],e=0;e<c;){var f=b[e];if(a.call(d,f,e,b))return e;e++}return-1}}),Date.now||(Date.now=function(){return(new Date).getTime()}),String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.substr(b,a.length)===a}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(a,b){if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),d=c.length>>>0;if(0===d)return!1;for(var e=0|b,f=Math.max(e>=0?e:d-Math.abs(e),0);f<d;){if(function(a,b){return a===b||"number"==typeof a&&"number"==typeof b&&isNaN(a)&&isNaN(b)}(c[f],a))return!0;f++}return!1}}),function(a){a&&a.prototype&&null==a.prototype.firstElementChild&&Object.defineProperty(a.prototype,"firstElementChild",{get:function(){for(var a,b=this.childNodes,c=0;a=b[c++];)if(1===a.nodeType)return a;return null}})}(window.Node||window.Element),window.skuid||(window.skuid={}),function(a){if(!a.console){var b=a.console={};b.warn=b.info=b.error=b.trace=b.log=b.time=b.timeEnd=function(){}}if("object"!=typeof JSON)throw a.alert("Skuid cannot run in this Web Browser. Please make sure you are using Internet Explorer 8 or higher and are not in Compatibility Mode."),"Unsupported browser."}(window),!skuid.$){!function(a,b){var c;c=c||function(a){var b,c=String.prototype.split,d=/()??/.exec("")[1]===a;return b=function(b,e,f){if("[object RegExp]"!==Object.prototype.toString.call(e))return c.call(b,e,f);var g,h,i,j,k=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),m=0,e=new RegExp(e.source,l+"g");for(b+="",d||(g=new RegExp("^"+e.source+"$(?!\\s)",l)),f=f===a?-1>>>0:f>>>0;(h=e.exec(b))&&!((i=h.index+h[0].length)>m&&(k.push(b.slice(m,h.index)),!d&&h.length>1&&h[0].replace(g,function(){for(var b=1;b<arguments.length-2;b++)arguments[b]===a&&(h[b]=a)}),h.length>1&&h.index<b.length&&Array.prototype.push.apply(k,h.slice(1)),j=h[0].length,m=i,k.length>=f));)e.lastIndex===h.index&&e.lastIndex++;return m===b.length?(j||!e.test(""))&&k.push(""):k.push(b.slice(m)),k.length>f?k.slice(0,f):k},String.prototype.split=function(a,c){return b(this,a,c)},b}(),function(a,b){if("object"==typeof d&&d)b(d);else{var c={};b(c),"function"==typeof define&&define.amd?define(c):a.Mustache=c}}(window,function(a){function b(a,b){return t.call(a,b)}function c(a){return!b(p,a)}function d(a){return"function"==typeof a}function e(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function f(a){return String(a).replace(/[&<>"'\/]/g,function(a){return w[a]})}function g(a){if(!v(a)||2!==a.length)throw new Error("Invalid tags: "+a);return[new RegExp(e(a[0])+"\\s*"),new RegExp("\\s*"+e(a[1]))]}function h(b,d){d=d||a.tags,b=b||"","string"==typeof d&&(d=d.split(o));for(var f,h,l,m,p,t,u=g(d),v=new k(b),w=[],x=[],y=[],z=!1,A=!1;!v.eos();){if(f=v.pos,l=v.scanUntil(u[0]))for(var B=0,C=l.length;C>B;++B)m=l.charAt(B),c(m)?y.push(x.length):A=!0,x.push(["text",m,f,f+1]),f+=1,"\n"===m&&function(){if(z&&!A)for(;y.length;)delete x[y.pop()];else y=[];z=!1,A=!1}();if(!v.scan(u[0]))break;if(z=!0,h=v.scan(s)||"name",v.scan(n),"="===h?(l=v.scanUntil(q),v.scan(q),v.scanUntil(u[1])):"{"===h?(l=v.scanUntil(new RegExp("\\s*"+e("}"+d[1]))),v.scan(r),v.scanUntil(u[1]),h="&"):l=v.scanUntil(u[1]),!v.scan(u[1]))throw new Error("Unclosed tag at "+v.pos);if(p=[h,l,f,v.pos],x.push(p),"#"===h||"^"===h)w.push(p);else if("/"===h){if(!(t=w.pop()))throw new Error('Unopened section "'+l+'" at '+f);if(t[1]!==l)throw new Error('Unclosed section "'+t[1]+'" at '+f)}else"name"===h||"{"===h||"&"===h?A=!0:"="===h&&(u=g(d=l.split(o)))}if(t=w.pop())throw new Error('Unclosed section "'+t[1]+'" at '+v.pos);return j(i(x))}function i(a){for(var b,c,d=[],e=0,f=a.length;f>e;++e)(b=a[e])&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(d.push(b),c=b));return d}function j(a){for(var b,c,d=[],e=d,f=[],g=0,h=a.length;h>g;++g)switch(b=a[g],b[0]){case"#":case"^":e.push(b),f.push(b),e=b[4]=[];break;case"/":c=f.pop(),c[5]=b[2],e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}return d}function k(a){this.string=a,this.tail=a,this.pos=0}function l(a,b){this.view=null==a?{}:a,this.cache={".":this.view},this.parent=b}function m(){this.cache={}}var n=/\s*/,o=/\s+/,p=/\S/,q=/\s*=/,r=/\s*\}/,s=/#|\^|\/|>|\{|&|=|!/,t=RegExp.prototype.test,u=Object.prototype.toString,v=Array.isArray||function(a){return"[object Array]"===u.call(a)},w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};k.prototype.eos=function(){return""===this.tail},k.prototype.scan=function(a){var b=this.tail.match(a);if(b&&0===b.index){var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c}return""},k.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},l.prototype.push=function(a){return new l(a,this)},l.prototype.lookup=function(a){var b;if(a in this.cache)b=this.cache[a];else{for(var c=this;c;){if(a.indexOf(".")>0){b=c.view;for(var e=a.split("."),f=0;null!=b&&f<e.length;)b=b[e[f++]]}else b=c.view[a];if(null!=b)break;c=c.parent}this.cache[a]=b}return d(b)&&(b=b.call(this.view)),b},m.prototype.clearCache=function(){this.cache={}},m.prototype.parse=function(a,b){var c=this.cache,d=c[a];return null==d&&(d=c[a]=h(a,b)),d},m.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof l?b:new l(b);return this.renderTokens(d,e,c,a)},m.prototype.renderTokens=function(b,c,e,f){function g(a){return k.render(a,c,e)}for(var h,i,j="",k=this,l=0,m=b.length;m>l;++l)switch(h=b[l],h[0]){case"#":if(!(i=c.lookup(h[1])))continue;if(v(i))for(var n=0,o=i.length;o>n;++n)j+=this.renderTokens(h[4],c.push(i[n]),e,f);else if("object"==typeof i||"string"==typeof i)j+=this.renderTokens(h[4],c.push(i),e,f);else if(d(i)){if("string"!=typeof f)throw new Error("Cannot use higher-order sections without the original template");null!=(i=i.call(c.view,f.slice(h[3],h[5]),g))&&(j+=i)}else j+=this.renderTokens(h[4],c,e,f);break;case"^":(!(i=c.lookup(h[1]))||v(i)&&0===i.length)&&(j+=this.renderTokens(h[4],c,e,f));break;case">":if(!e)continue;null!=(i=this.parse(d(e)?e(h[1]):e[h[1]]))&&(j+=this.renderTokens(i,c,e,f));break;case"&":null!=(i=c.lookup(h[1]))&&(j+=i);break;case"name":null!=(i=c.lookup(h[1]))&&(j+=a.escape(i));break;case"text":j+=h[1]}return j},a.name="mustache.js",a.version="0.8.0",a.tags=["{{","}}"];var x=new m;a.clearCache=function(){return x.clearCache()},a.parse=function(a,b){return x.parse(a,b)},a.render=function(a,b,c){return x.render(a,b,c)},a.to_html=function(b,c,e,f){var g=a.render(b,c,e);return d(f)?void f(g):g},a.escape=f,a.Scanner=k,a.Context=l,a.Writer=m});!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof d?module.exports=b():a.NProgress=b()}(window,function(){function a(a,b,c){return b>a?b:a>c?c:a}function b(a){return 100*(-1+a)}function c(a,c,d){var e;return e="translate3d"===j.positionUsing?{transform:"translate3d("+b(a)+"%,0,0)"}:"translate"===j.positionUsing?{transform:"translate("+b(a)+"%,0)"}:{"margin-left":b(a)+"%"},e.transition="all "+c+"ms "+d,e}function d(a,b){return("string"==typeof a?a:g(a)).indexOf(" "+b+" ")>=0}function e(a,b){var c=g(a),e=c+b;d(c,b)||(a.className=e.substring(1))}function f(a,b){var c,e=g(a);d(a,b)&&(c=e.replace(" "+b+" "," "),a.className=c.substring(1,c.length-1))}function g(a){return(" "+(a&&a.className||"")+" ").replace(/\s+/gi," ")}function h(a){a&&a.parentNode&&a.parentNode.removeChild(a)}var i={};i.version="0.2.0";var j=i.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};i.configure=function(a){var b,c;for(b in a)void 0!==(c=a[b])&&a.hasOwnProperty(b)&&(j[b]=c);return this},i.status=null,i.set=function(b){var d=i.isStarted();b=a(b,j.minimum,1),i.status=1===b?null:b;var e=i.render(!d),f=e.querySelector(j.barSelector),g=j.speed,h=j.easing;return e.offsetWidth,k(function(a){""===j.positionUsing&&(j.positionUsing=i.getPositioningCSS()),l(f,c(b,g,h)),1===b?(l(e,{transition:"none",opacity:1}),e.offsetWidth,setTimeout(function(){l(e,{transition:"all "+g+"ms linear",opacity:0}),setTimeout(function(){i.remove(),a()},g)},g)):setTimeout(a,g)}),this},i.isStarted=function(){return"number"==typeof i.status},i.start=function(){i.status||i.set(0);var a=function(){setTimeout(function(){i.status&&(i.trickle(),a())},j.trickleSpeed)};return j.trickle&&a(),this},i.done=function(a){return a||i.status?i.inc(.3+.5*Math.random()).set(1):this},i.inc=function(b){var c=i.status;return c?c>1?void 0:("number"!=typeof b&&(b=c>=0&&.2>c?.1:c>=.2&&.5>c?.04:c>=.5&&.8>c?.02:c>=.8&&.99>c?.005:0),c=a(c+b,0,.994),i.set(c)):i.start()},i.trickle=function(){return i.inc()},function(){var a=0,b=0;i.promise=function(c){return c&&"resolved"!==c.state()?(0===b&&i.start(),a++,b++,c.always(function(){b--,0===b?(a=0,i.done()):i.set((a-b)/a)}),this):this}}(),i.render=function(a){if(i.isRendered())return document.getElementById("sk-nprogress");e(document.documentElement,"sk-nprogress-busy");var c=document.createElement("div");c.id="sk-nprogress",c.innerHTML=j.template;var d,f=c.querySelector(j.barSelector),g=a?"-100":b(i.status||0),k=document.querySelector(j.parent);return l(f,{transition:"all 0 linear",transform:"translate3d("+g+"%,0,0)"}),j.showSpinner||(d=c.querySelector(j.spinnerSelector))&&h(d),k!=document.body&&e(k,"sk-nprogress-custom-parent"),k.appendChild(c),c},i.remove=function(){f(document.documentElement,"sk-nprogress-busy"),f(document.querySelector(j.parent),"sk-nprogress-custom-parent");var a=document.getElementById("sk-nprogress");a&&h(a)},i.isRendered=function(){return!!document.getElementById("sk-nprogress")},i.getPositioningCSS=function(){var a=document.body.style,b="WebkitTransform"in a?"Webkit":"MozTransform"in a?"Moz":"msTransform"in a?"ms":"OTransform"in a?"O":"";return b+"Perspective"in a?"translate3d":b+"Transform"in a?"translate":"margin"};var k=function(){function a(){var c=b.shift();c&&c(a)}var b=[];return function(c){b.push(c),1==b.length&&a()}}(),l=function(){function a(a){return a.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(a,b){return b.toUpperCase()})}function b(a){var b=document.body.style;if(a in b)return a;for(var c,d=e.length,f=a.charAt(0).toUpperCase()+a.slice(1);d--;)if((c=e[d]+f)in b)return c;return a}function c(c){return c=a(c),f[c]||(f[c]=b(c))}function d(a,b,d){b=c(b),a.style[b]=d}var e=["Webkit","O","Moz","ms"],f={};return function(a,b){var c,e,f=arguments;if(2==f.length)for(c in b)void 0!==(e=b[c])&&b.hasOwnProperty(c)&&d(a,c,e);else d(a,f[1],f[2])}}();return i});var d=a,e=window.Mustache;window.$j=d.$=d.jQuery=b.noConflict(),d.Mustache=window.Mustache,d.NProgress=window.NProgress,e?(window.Mustache=e,e=null):(delete window.Mustache,delete window.NProgress),function(a){function b(b){if("string"==typeof b.data&&(b.data={keys:b.data}),b.data&&b.data.keys&&"string"==typeof b.data.keys){var c=b.handler,d=b.data.keys.toLowerCase().split(" ");b.handler=function(e){if(this===e.target||!b.data.filterTextInputs||!(a.inArray(e.target.type,a.hotkeys.textAcceptingInputTypes)>-1||/textarea|select/i.test(e.target.nodeName))){var f=a.hotkeys.specialKeys[e.keyCode],g=String.fromCharCode(e.which).toLowerCase(),h="",i={};a.each(["alt","ctrl","meta","shift"],function(a,b){e[b+"Key"]&&f!==b&&(h+=b+"+")}),h=h.replace("alt+ctrl+meta+shift","hyper"),f&&(i[h+f]=!0),g&&(i[h+g]=!0,i[h+a.hotkeys.shiftNums[g]]=!0,"shift+"===h&&(i[a.hotkeys.shiftNums[g]]=!0));for(var j=0,k=d.length;j<k;j++)if(i[d[j]])return c.apply(this,arguments)}}}}a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},textAcceptingInputTypes:["text","password","number","email","url","range","date","month","week","time","datetime","datetime-local","search","color","tel"]},a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:b}})}(b),function(a){a.datepicker.parseDate=function(b,c,d){if(null==b||null==c)throw"Invalid arguments";if(""===(c="object"==typeof c?c.toString():c+""))return null;var e,f,g,h,i=0,j=(d?d.shortYearCutoff:null)||this._defaults.shortYearCutoff,k="string"!=typeof j?j:(new Date).getFullYear()%100+parseInt(j,10),l=(d?d.dayNamesShort:null)||this._defaults.dayNamesShort,m=(d?d.dayNames:null)||this._defaults.dayNames,n=(d?d.monthNamesShort:null)||this._defaults.monthNamesShort,o=(d?d.monthNames:null)||this._defaults.monthNames,p=-1,q=-1,r=-1,s=-1,t=!1,u=function(a){var c=e+1<b.length&&b.charAt(e+1)===a;return c&&e++,c},v=function(a){var b=u(a),d="@"===a?14:"!"===a?20:"y"===a&&b?4:"o"===a?3:2,e=new RegExp("^\\d{1,"+d+"}"),f=c.substring(i).match(e);if(!f)throw"Missing number at position "+i;return i+=f[0].length,parseInt(f[0],10)},w=function(b,d,e){var f=-1,g=a.map(u(b)?e:d,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if(a.each(g,function(a,b){var d=b[1];if(c.substr(i,d.length).toLowerCase()===d.toLowerCase())return f=b[0],i+=d.length,!1}),-1!==f)return f+1;throw"Unknown name at position "+i},x=function(){if(c.charAt(i)!==b.charAt(e))throw"Unexpected literal at position "+i;i++};for(e=0;e<b.length;e++)if(t)"'"!==b.charAt(e)||u("'")?x():t=!1;else switch(b.charAt(e)){case"d":r=v("d");break;case"D":w("D",l,m);break;case"o":s=v("o");break;case"m":q=v("m");break;case"M":q=w("M",n,o);break;case"y":p=v("y");break;case"@":h=new Date(v("@")),p=h.getFullYear(),q=h.getMonth()+1,r=h.getDate();break;case"!":h=new Date((v("!")-this._ticksTo1970)/1e4),p=h.getFullYear(),q=h.getMonth()+1,r=h.getDate();break;case"'":u("'")?x():t=!0;break;default:x()}if(i<c.length&&(g=c.substr(i),!/^\s+/.test(g)))throw"Extra/unparsed characters found in date: "+g;if(-1===p?p=(new Date).getFullYear():p<100&&(p+=(new Date).getFullYear()-(new Date).getFullYear()%100+(p<=k?0:-100)),s>-1)for(q=1,r=s;;){if(f=this._getDaysInMonth(p,q-1),r<=f)break;q++,r-=f}if(h=this._daylightSavingAdjust(new Date(p,q-1,r)),h.getFullYear()!==p||h.getMonth()+1!==q||h.getDate()!==r)throw"Invalid date";return h}}(b),function(a){"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],a):a(b)}(function(a){function b(a){return a}function c(a){return decodeURIComponent(a.replace(e," "))}function d(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return f.json?JSON.parse(a):a}catch(e){}}var e=/\+/g,f=a.cookie=function(e,g,h){if(void 0!==g){if(h=a.extend({},f.defaults,h),"number"==typeof h.expires){var i=h.expires,j=h.expires=new Date;j.setDate(j.getDate()+i)}return g=f.json?JSON.stringify(g):g+"",document.cookie=[encodeURIComponent(e),"=",f.raw?g:encodeURIComponent(g),h.expires?"; expires="+h.expires.toUTCString():"",h.path?"; path="+h.path:"",h.domain?"; domain="+h.domain:"",h.secure?"; secure":""].join("")}for(var k=f.raw?b:c,l=document.cookie.split("; "),m=e?void 0:{},n=0,o=l.length;o>n;n++){var p=l[n].split("="),q=k(p.shift()),r=k(p.join("="));if(e&&e===q){m=d(r);break}e||(m[q]=d(r))}return m};f.defaults={},a.removeCookie=function(b,c){return void 0!==a.cookie(b)&&(a.cookie(b,"",a.extend(c,{expires:-1})),!0)}}),function(){function a(a){function b(b,d){var f,p,q=b==window,r=d&&void 0!==d.message?d.message:void 0;if(d=a.extend({},a.blockUI.defaults,d||{}),!d.ignoreIfBlocked||!a(b).data("blockUI.isBlocked")){if(d.overlayCSS=a.extend({},a.blockUI.defaults.overlayCSS,d.overlayCSS||{}),f=a.extend({},a.blockUI.defaults.css,d.css||{}),d.onOverlayClick&&(d.overlayCSS.cursor="pointer"),p=a.extend({},a.blockUI.defaults.themedCSS,d.themedCSS||{}),r=void 0===r?d.message:r,q&&n&&c(window,{fadeOut:0}),r&&"string"!=typeof r&&(r.parentNode||r.jquery)){var s=r.jquery?r[0]:r,t={};a(b).data("blockUI.history",t),t.el=s,t.parent=s.parentNode,t.display=s.style.display,t.position=s.style.position,t.parent&&t.parent.removeChild(s)}a(b).data("blockUI.onUnblock",d.onUnblock);var u,v,w,x,y=d.baseZ;u=a(k||d.forceIframe?'<iframe class="blockUI" style="z-index:'+y+++';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+d.iframeSrc+'"></iframe>':'<div class="blockUI" style="display:none"></div>'),v=a(d.theme?'<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+y+++';display:none"></div>':'<div class="blockUI blockOverlay" style="z-index:'+y+++';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),d.theme&&q?(x='<div class="blockUI '+d.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(y+10)+';display:none;position:fixed">',d.title&&(x+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(d.title||"&nbsp;")+"</div>"),x+='<div class="ui-widget-content ui-dialog-content"></div>',x+="</div>"):d.theme?(x='<div class="blockUI '+d.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(y+10)+';display:none;position:absolute">',d.title&&(x+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(d.title||"&nbsp;")+"</div>"),x+='<div class="ui-widget-content ui-dialog-content"></div>',x+="</div>"):x=q?'<div class="blockUI '+d.blockMsgClass+' blockPage" style="z-index:'+(y+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+d.blockMsgClass+' blockElement" style="z-index:'+(y+10)+';display:none;position:absolute"></div>',w=a(x),r&&(d.theme?(w.css(p),w.addClass("ui-widget-content")):w.css(f)),d.theme||v.css(d.overlayCSS),v.css("position",q?"fixed":"absolute"),(k||d.forceIframe)&&u.css("opacity",0);var z=[u,v,w],A=a(q?"body":b);a.each(z,function(){this.appendTo(A)}),d.theme&&d.draggable&&a.fn.draggable&&w.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var B=m&&(!a.support.boxModel||a("object,embed",q?null:b).length>0);if(l||B){if(q&&d.allowBodyStretch&&a.support.boxModel&&a("html,body").css("height","100%"),(l||!a.support.boxModel)&&!q)var C=i(b,"borderTopWidth"),D=i(b,"borderLeftWidth"),E=C?"(0 - "+C+")":0,F=D?"(0 - "+D+")":0;a.each(z,function(a,b){var c=b[0].style;if(c.position="absolute",2>a)q?c.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+d.quirksmodeOffsetHack+') + "px"'):c.setExpression("height",'this.parentNode.offsetHeight + "px"'),q?c.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):c.setExpression("width",'this.parentNode.offsetWidth + "px"'),F&&c.setExpression("left",F),E&&c.setExpression("top",E);else if(d.centerY)q&&c.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),c.marginTop=0;else if(!d.centerY&&q){var e=d.css&&d.css.top?parseInt(d.css.top,10):0,f="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+e+') + "px"';c.setExpression("top",f)}})}if(r&&(d.theme?w.find(".ui-widget-content").append(r):w.append(r),(r.jquery||r.nodeType)&&a(r).show()),(k||d.forceIframe)&&d.showOverlay&&u.show(),d.fadeIn){var G=d.onBlock?d.onBlock:j,H=d.showOverlay&&!r?G:j,I=r?G:j;d.showOverlay&&v._fadeIn(d.fadeIn,H),r&&w._fadeIn(d.fadeIn,I)}else d.showOverlay&&v.show(),r&&w.show(),d.onBlock&&d.onBlock();if(e(1,b,d),q?(n=w[0],o=a(d.focusableElements,n),d.focusInput&&setTimeout(g,20)):h(w[0],d.centerX,d.centerY),d.timeout){var J=setTimeout(function(){q?a.unblockUI(d):a(b).unblock(d)},d.timeout);a(b).data("blockUI.timeout",J)}}}function c(b,c){var f,g=b==window,h=a(b),i=h.data("blockUI.history"),j=h.data("blockUI.timeout");j&&(clearTimeout(j),h.removeData("blockUI.timeout")),c=a.extend({},a.blockUI.defaults,c||{}),e(0,b,c),null===c.onUnblock&&(c.onUnblock=h.data("blockUI.onUnblock"),h.removeData("blockUI.onUnblock"));var k;k=g?a("body").children().filter(".blockUI").add("body > .blockUI"):h.find(">.blockUI"),c.cursorReset&&(k.length>1&&(k[1].style.cursor=c.cursorReset),k.length>2&&(k[2].style.cursor=c.cursorReset)),g&&(n=o=null),c.fadeOut?(f=k.length,k.stop().fadeOut(c.fadeOut,function(){0==--f&&d(k,i,c,b)})):d(k,i,c,b)}function d(b,c,d,e){var f=a(e);if(!f.data("blockUI.isBlocked")){b.each(function(){this.parentNode&&this.parentNode.removeChild(this)}),c&&c.el&&(c.el.style.display=c.display,c.el.style.position=c.position,c.parent&&c.parent.appendChild(c.el),f.removeData("blockUI.history")),f.data("blockUI.static")&&f.css("position","static"),"function"==typeof d.onUnblock&&d.onUnblock(e,d);var g=a(document.body),h=g.width(),i=g[0].style.width;g.width(h-1).width(h),g[0].style.width=i}}function e(b,c,d){var e=c==window,g=a(c);if((b||(!e||n)&&(e||g.data("blockUI.isBlocked")))&&(g.data("blockUI.isBlocked",b),e&&d.bindEvents&&(!b||d.showOverlay))){var h="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";b?a(document).bind(h,d,f):a(document).unbind(h,f)}}function f(b){if("keydown"===b.type&&b.keyCode&&9==b.keyCode&&n&&b.data.constrainTabKey){var c=o,d=!b.shiftKey&&b.target===c[c.length-1],e=b.shiftKey&&b.target===c[0];if(d||e)return setTimeout(function(){g(e)},10),!1}var f=b.data,h=a(b.target);return h.hasClass("blockOverlay")&&f.onOverlayClick&&f.onOverlayClick(),h.parents("div."+f.blockMsgClass).length>0||0===h.parents().children().filter("div.blockUI").length}function g(a){if(o){var b=o[!0===a?o.length-1:0];b&&b.focus()}}function h(a,b,c){var d=a.parentNode,e=a.style,f=(d.offsetWidth-a.offsetWidth)/2-i(d,"borderLeftWidth"),g=(d.offsetHeight-a.offsetHeight)/2-i(d,"borderTopWidth");b&&(e.left=f>0?f+"px":"0"),c&&(e.top=g>0?g+"px":"0")}function i(b,c){return parseInt(a.css(b,c),10)||0}a.fn._fadeIn=a.fn.fadeIn;var j=a.noop||function(){},k=/MSIE/.test(navigator.userAgent),l=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);document.documentMode;var m=a.isFunction(document.createElement("div").style.setExpression);a.blockUI=function(a){b(window,a)},a.unblockUI=function(a){c(window,a)},a.growlUI=function(b,c,d,e){var f=a('<div class="growlUI"></div>');b&&f.append("<h1>"+b+"</h1>"),c&&f.append("<h2>"+c+"</h2>"),void 0===d&&(d=3e3);var g=function(b){b=b||{},a.blockUI({message:f,fadeIn:"undefined"!=typeof b.fadeIn?b.fadeIn:700,fadeOut:"undefined"!=typeof b.fadeOut?b.fadeOut:1e3,timeout:"undefined"!=typeof b.timeout?b.timeout:d,centerY:!1,showOverlay:!1,onUnblock:e,css:a.blockUI.defaults.growlCSS})};g(),f.css("opacity"),f.mouseover(function(){g({fadeIn:0,timeout:3e4});var b=a(".blockMsg");b.stop(),b.fadeTo(300,1)}).mouseout(function(){a(".blockMsg").fadeOut(1e3)})},a.fn.block=function(c){if(this[0]===window)return a.blockUI(c),this;var d=a.extend({},a.blockUI.defaults,c||{});return this.each(function(){var b=a(this);d.ignoreIfBlocked&&b.data("blockUI.isBlocked")||b.unblock({fadeOut:0})}),this.each(function(){"static"==a.css(this,"position")&&(this.style.position="relative",a(this).data("blockUI.static",!0)),this.style.zoom=1,b(this,c)})},a.fn.unblock=function(b){return this[0]===window?(a.unblockUI(b),this):this.each(function(){c(this,b)})},a.blockUI.version=2.65,a.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var n=null,o=[]}"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],a):a(b)}(),function(a){var b=a.blockUI.defaults;a.extend(b.css,{border:"none",padding:"15px",backgroundColor:"#888","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.75,color:"#EEE","font-weight":"bold",top:"200px"}),b.centerY=!1,a.extend(b.overlayCSS,{backgroundColor:"#FFF",opacity:.7}),a.extend(b.growlCSS,{opacity:1,backgroundColor:"#000"})}(b),function(a){var b=0;a.widget("ech.multiselect",{options:{header:!0,height:175,minWidth:225,classes:"",checkAllText:"Check all",uncheckAllText:"Uncheck all",noneSelectedText:"Select options",selectedText:"# selected",selectedList:0,show:null,hide:null,autoOpen:!1,multiple:!0,position:{}},_create:function(){var b=this.element.hide(),c=this.options;this.speed=a.fx.speeds._default,this._isOpen=!1,b=(this.button=a('<div type="button"><span class="ui-icon ui-icon-triangle-2-n-s"></span></div>')).addClass("ui-multiselect ui-widget ui-state-default ui-corner-all").addClass(c.classes).attr({title:b.attr("title"),"aria-haspopup":!0,tabIndex:b.attr("tabIndex")}).insertAfter(b),(this.buttonlabel=a("<span />")).html(c.noneSelectedText).appendTo(b);var b=(this.menu=a("<div />")).addClass("ui-multiselect-menu ui-widget ui-widget-content ui-corner-all").addClass(c.classes).appendTo(document.body),d=(this.header=a("<div />")).addClass("ui-widget-header ui-corner-all ui-multiselect-header ui-helper-clearfix").appendTo(b);(this.headerLinkContainer=a("<ul />")).addClass("ui-helper-reset").html(function(){return!0===c.header?'<li><a class="ui-multiselect-all" href="#"><span class="ui-icon ui-icon-check"></span><span>'+c.checkAllText+'</span></a></li><li><a class="ui-multiselect-none" href="#"><span class="ui-icon ui-icon-closethick"></span><span>'+c.uncheckAllText+"</span></a></li>":"string"==typeof c.header?"<li>"+c.header+"</li>":""}).append('<li class="ui-multiselect-close"><a href="#" class="ui-multiselect-close"><span class="ui-icon ui-icon-circle-close"></span></a></li>').appendTo(d),(this.checkboxContainer=a("<ul />")).addClass("ui-multiselect-checkboxes ui-helper-reset").appendTo(b),this._bindEvents(),this.refresh(!0),c.multiple||b.addClass("ui-multiselect-single")},_init:function(){!1===this.options.header&&this.header.hide(),this.options.multiple||this.headerLinkContainer.find(".ui-multiselect-all, .ui-multiselect-none").hide(),this.options.autoOpen&&this.open(),this.element.is(":disabled")&&this.disable()},refresh:function(c){var d=this.element,e=this.options,f=this.menu,g=this.checkboxContainer,h=[],i="",j=d.attr("id")||b++;d.find("option").each(function(b){a(this);var c,d=this.parentNode,f=this.innerHTML,g=this.title,k=this.value,b="ui-multiselect-"+(this.id||j+"-option-"+b),l=this.disabled,m=this.selected,n=["ui-corner-all"],o=(l?"ui-multiselect-disabled ":" ")+this.className;"OPTGROUP"===d.tagName&&(c=d.getAttribute("label"),-1===a.inArray(c,h)&&(i+='<li class="ui-multiselect-optgroup-label '+d.className+'"><a href="#">'+c+"</a></li>",h.push(c))),l&&n.push("ui-state-disabled"),m&&!e.multiple&&n.push("ui-state-active"),i+='<li class="'+o+'">',i+='<label for="'+b+'" title="'+g+'" class="'+n.join(" ")+'">',i+='<input id="'+b+'" name="multiselect_'+j+'" type="'+(e.multiple?"checkbox":"radio")+'" value="'+k+'" title="'+f+'"',m&&(i+=' checked="checked"',i+=' aria-selected="true"'),l&&(i+=' disabled="disabled"',i+=' aria-disabled="true"'),i+=" /><span>"+f+"</span></label></li>"}),g.html(i),this.labels=f.find("label"),this.inputs=this.labels.children("input"),this._setButtonWidth(),this._setMenuWidth(),this.button[0].defaultValue=this.update(),
c||this._trigger("refresh")},update:function(){var b=this.options,c=this.inputs,d=c.filter(":checked"),e=d.length,b=0===e?b.noneSelectedText:a.isFunction(b.selectedText)?b.selectedText.call(this,e,c.length,d.get()):/\d/.test(b.selectedList)&&0<b.selectedList&&e<=b.selectedList?d.map(function(){return a(this).next().html()}).get().join(", "):b.selectedText.replace("#",e).replace("#",c.length);return this.buttonlabel.html(b),b},_bindEvents:function(){function b(){return c[c._isOpen?"close":"open"](),!1}var c=this,d=this.button;d.find("span").bind("click.multiselect",b),d.bind({click:b,keypress:function(a){switch(a.which){case 27:case 38:case 37:c.close();break;case 39:case 40:c.open()}},mouseenter:function(){d.hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover-")},mouseleave:function(){a(this).removeClass("ui-state-hover-")},focus:function(){d.hasClass("ui-state-disabled")||a(this).addClass("ui-state-focus")},blur:function(){a(this).removeClass("ui-state-focus")}}),this.header.delegate("a","click.multiselect",function(b){a(this).hasClass("ui-multiselect-close")?c.close():c[a(this).hasClass("ui-multiselect-all")?"checkAll":"uncheckAll"](),b.preventDefault()}),this.menu.delegate("li.ui-multiselect-optgroup-label a","click.multiselect",function(b){b.preventDefault();var d=a(this),e=d.parent().nextUntil("li.ui-multiselect-optgroup-label").find("input:visible:not(:disabled)"),f=e.get(),d=d.parent().text();!1!==c._trigger("beforeoptgrouptoggle",b,{inputs:f,label:d})&&(c._toggleChecked(e.filter(":checked").length!==e.length,e),c._trigger("optgrouptoggle",b,{inputs:f,label:d,checked:f[0].checked}))}).delegate("label","mouseenter.multiselect",function(){a(this).hasClass("ui-state-disabled")||(c.labels.removeClass("ui-state-hover-"),a(this).addClass("ui-state-hover-").find("input").focus())}).delegate("label","keydown.multiselect",function(b){switch(b.preventDefault(),b.which){case 9:case 27:c.close();break;case 38:case 40:case 37:case 39:c._traverse(b.which,this);break;case 13:a(this).find("input")[0].click()}}).delegate('input[type="checkbox"], input[type="radio"]',"click.multiselect",function(b){var d=a(this),e=this.value,f=this.checked,g=c.element.find("option");this.disabled||!1===c._trigger("click",b,{value:e,text:this.title,checked:f})?b.preventDefault():(d.focus(),d.attr("aria-selected",f),g.each(function(){this.value===e?this.selected=f:c.options.multiple||(this.selected=!1)}),c.options.multiple||(c.labels.removeClass("ui-state-active"),d.closest("label").toggleClass("ui-state-active",f),c.close()),c.element.trigger("change"),setTimeout(a.proxy(c.update,c),10))}),a(document).bind("mousedown.multiselect",function(b){c._isOpen&&!a.contains(c.menu[0],b.target)&&!a.contains(c.button[0],b.target)&&b.target!==c.button[0]&&c.close()}),a(this.element[0].form).bind("reset.multiselect",function(){setTimeout(a.proxy(c.refresh,c),10)})},_setButtonWidth:function(){var a=this.element.outerWidth(),b=this.options;/\d/.test(b.minWidth)&&a<b.minWidth&&(a=b.minWidth),this.button.css("width","100%")},_setMenuWidth:function(){var a=this.menu;this.button.outerWidth(),parseInt(a.css("padding-left"),10),parseInt(a.css("padding-right"),10),parseInt(a.css("border-right-width"),10),parseInt(a.css("border-left-width"),10)},_traverse:function(b,c){var d=a(c),e=38===b||37===b,d=d.parent()[e?"prevAll":"nextAll"]("li:not(.ui-multiselect-disabled, .ui-multiselect-optgroup-label)")[e?"last":"first"]();d.length?d.find("label").trigger("mouseover"):(d=this.menu.find("ul").last(),this.menu.find("label")[e?"last":"first"]().trigger("mouseover"),d.scrollTop(e?d.height():0))},_toggleState:function(a,b){return function(){this.disabled||(this[a]=b),b?this.setAttribute("aria-selected",!0):this.removeAttribute("aria-selected")}},_toggleChecked:function(b,c){var d=c&&c.length?c:this.inputs,e=this;d.each(this._toggleState("checked",b)),d.eq(0).focus(),this.update();var f=d.map(function(){return this.value}).get();this.element.find("option").each(function(){!this.disabled&&-1<a.inArray(this.value,f)&&e._toggleState("selected",b).call(this)}),d.length&&this.element.trigger("change")},_toggleDisabled:function(b){this.button.attr({disabled:b,"aria-disabled":b})[b?"addClass":"removeClass"]("ui-state-disabled");var c=this.menu.find("input"),c=b?c.filter(":enabled").data("ech-multiselect-disabled",!0):c.filter(function(){return!0===a.data(this,"ech-multiselect-disabled")}).removeData("ech-multiselect-disabled");c.attr({disabled:b,"arial-disabled":b}).parent()[b?"addClass":"removeClass"]("ui-state-disabled"),this.element.attr({disabled:b,"aria-disabled":b})},open:function(){var b=this.button,c=this.menu,d=this.speed,e=this.options,f=[];if(!1!==this._trigger("beforeopen")&&!b.hasClass("ui-state-disabled")&&!this._isOpen){var g=c.find("ul").last(),h=e.show,i=b.offset();a.isArray(e.show)&&(h=e.show[0],d=e.show[1]||this.speed),h&&(f=[h,d]),g.scrollTop(0).height(e.height),a.ui.position&&!a.isEmptyObject(e.position)?(e.position.of=e.position.of||b,c.show().position(e.position).hide()):c.css({top:i.top+b.outerHeight(),left:i.left}),a.fn.show.apply(c,f),this.labels.eq(0).trigger("mouseover").trigger("mouseenter").find("input").trigger("focus"),b.addClass("ui-state-active"),this._isOpen=!0,this._trigger("open")}},close:function(){if(!1!==this._trigger("beforeclose")){var b=this.options,c=b.hide,d=this.speed,e=[];a.isArray(b.hide)&&(c=b.hide[0],d=b.hide[1]||this.speed),c&&(e=[c,d]),a.fn.hide.apply(this.menu,e),this.button.removeClass("ui-state-active").trigger("blur").trigger("mouseleave"),this._isOpen=!1,this._trigger("close")}},enable:function(){this._toggleDisabled(!1)},disable:function(){this._toggleDisabled(!0)},checkAll:function(){this._toggleChecked(!0),this._trigger("checkAll")},uncheckAll:function(){this._toggleChecked(!1),this._trigger("uncheckAll")},getChecked:function(){return this.menu.find("input").filter(":checked")},destroy:function(){return a.Widget.prototype.destroy.call(this),this.button.remove(),this.menu.remove(),this.element.show(),this},isOpen:function(){return this._isOpen},widget:function(){return this.menu},getButton:function(){return this.button},_setOption:function(b,c){var d=this.menu;switch(b){case"header":d.find("div.ui-multiselect-header")[c?"show":"hide"]();break;case"checkAllText":d.find("a.ui-multiselect-all span").eq(-1).text(c);break;case"uncheckAllText":d.find("a.ui-multiselect-none span").eq(-1).text(c);break;case"height":d.find("ul").last().height(parseInt(c,10));break;case"minWidth":this.options[b]=parseInt(c,10),this._setButtonWidth(),this._setMenuWidth();break;case"selectedText":case"selectedList":case"noneSelectedText":this.options[b]=c,this.update();break;case"classes":d.add(this.button).removeClass(this.options.classes).addClass(c);break;case"multiple":d.toggleClass("ui-multiselect-single",!c),this.options.multiple=c,this.element[0].multiple=c,this.refresh()}a.Widget.prototype._setOption.apply(this,arguments)}})}(b),function(a){function b(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}var c=/[\-\[\]{}()*+?.,\\\^$|#\s]/g;a.widget("ech.multiselectfilter",{options:{label:"Filter:",width:null,placeholder:"Enter keywords",autoReset:!1,debounceMS:250},_create:function(){var c=this.options,d=a(this.element),e=this.instance=d.data("echMultiselect")||d.data("multiselect")||d.data("ech-multiselect"),f=(this.header=e.menu.find(".ui-multiselect-header").addClass("ui-multiselect-hasfilter"),this.wrapper=a('<div class="ui-multiselect-filter">'+(c.label.length?c.label:"")+'<input placeholder="'+c.placeholder+'" type="search"'+(/\d/.test(c.width)?'style="width:'+c.width+'px"':"")+" /></div>").prependTo(this.header));this.inputs=e.menu.find('input[type="checkbox"], input[type="radio"]'),this.input=f.find("input").bind({keydown:function(a){13===a.which&&a.preventDefault()},input:a.proxy(b(this._handler,c.debounceMS),this),search:a.proxy(this._handler,this)}),this.updateCache(),e._toggleChecked=function(a,b){var c=b&&b.length?b:this.labels.find("input"),d=this,e=d._isOpen?":disabled, :hidden":":disabled";c=c.not(e).each(this._toggleState("checked",a)),this.update();var f={};c.each(function(){f[this.value]=!0}),this.element.find("option").filter(function(){!this.disabled&&f[this.value]&&d._toggleState("selected",a).call(this)}),c.length&&this.element.trigger("change")};var g=a(document).bind("multiselectrefresh."+e._namespaceID,a.proxy(function(){this.updateCache(),this._handler()},this));this.options.autoReset&&g.bind("multiselectclose."+e._namespaceID,a.proxy(this._reset,this))},_handler:function(b){var d=a.trim(this.input[0].value.toLowerCase()),e=this.rows,f=this.inputs,g=this.cache;if(d){e.hide();var h=new RegExp(d.replace(c,"\\$&"),"gi");this._trigger("filter",b,a.map(g,function(a,b){return-1!==a.search(h)?(e.eq(b).css("display","block"),f.get(b)):null}))}else e.show();this.instance.menu.find(".ui-multiselect-optgroup-label").each(function(){var b=a(this);b[b.nextUntil(".ui-multiselect-optgroup-label").filter(function(){return"none"!==a.css(this,"display")}).length?"show":"hide"]()})},_reset:function(){this.input.val("").trigger("keyup")},updateCache:function(){this.rows=this.instance.menu.find(".ui-multiselect-checkboxes li:not(.ui-multiselect-optgroup-label)"),this.cache=this.element.children().map(function(){var b=a(this);return"optgroup"===this.tagName.toLowerCase()&&(b=b.children()),b.map(function(){return this.innerHTML.toLowerCase()}).get()}).get()},widget:function(){return this.wrapper},destroy:function(){a.Widget.prototype.destroy.call(this),this.input.val("").trigger("keyup"),this.wrapper.remove()}})}(b),b.when.all===undefined&&(b.when.all=function(a){var c=new b.Deferred;return b.when.apply(b,a).then(function(){c.resolve(Array.prototype.slice.call(arguments))},function(){c.reject(Array.prototype.slice.call(arguments))}),c}),b.settle||(b.settle=function(a){arguments.length>1&&(a=Array.prototype.slice.call(arguments)),b.isArray(a)||(a=[a]);var c=new b.Deferred,d=a.map(function(a){var c=new b.Deferred;return a.then(function(){var a=Array.prototype.slice.call(arguments);c.resolve({success:!0,results:a.length>1?a:a[0]})},function(){var a=Array.prototype.slice.call(arguments);c.resolve({success:!1,results:a.length>1?a:a[0]})}),c});return b.when.apply(b,d).always(function(){c.resolve(Array.prototype.slice.call(arguments))}),c}),function(a){a.number=function(a,b,c,d){d=void 0===d?",":d,c=void 0===c?".":c,b=isFinite(+b)?Math.abs(b):0;var e="\\u"+("0000"+c.charCodeAt(0).toString(16)).substr(-4);a=(a+"").replace(RegExp(e,"g"),".").replace(RegExp("[^0-9+-Ee.]","g"),"");var f=isFinite(+a)?+a:0,g="";return g=(b?function(a,b){var c=Math.pow(10,b);return""+Math.round(a*c)/c}(f,b):""+Math.round(f)).split("."),g[0].length>3&&(g[0]=g[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,d)),b>(g[1]||"").length&&(g[1]=g[1]||"",g[1]+=Array(b-g[1].length+1).join("0")),g.join(c)}}(b),function(a){a.fn.setCursorPosition=function(a){return this.each(function(b,c){if(c.setSelectionRange)c.setSelectionRange(a,a);else if(c.createTextRange){var d=c.createTextRange();d.collapse(!0),d.moveEnd("character",a),d.moveStart("character",a),d.select()}}),this},a.fn.getCursorPosition=function(){var b=a(this).get(0),c=0;if("selectionStart"in b)c=b.selectionStart;else if("selection"in document){b.focus();var d=document.selection.createRange(),e=document.selection.createRange().text.length;d.moveStart("character",-b.value.length),c=d.text.length-e}return c}}(b),function(a){var b=a.fn.attr;a.fn.attr=function(){if(0===arguments.length){if(0===this.length)return null;var c={};return a.each(this[0].attributes,function(){this.specified&&(c[this.name]=this.value)}),c}return b.apply(this,arguments)}}(b),d.load=function(b,c,d){function e(){}function f(a){return Object(a)===a}function g(a){return"string"==typeof a}function h(){o&&o.parentNode||(o=c.body.getElementsByTagName("script")[0])||(o=c.body.getElementsByTagName("div")[0])}function i(){if(!p||!p.parentNode){var a=c.body.getElementsByTagName("script");p=a[a.length-1],p||(a=c.body.getElementsByTagName("div"),p=a[a.length-1])}}function j(a){var b=a.readyState;if(!b)return!0;if(!/loaded|complete/.test(b))return"uninitialized"===b;var c=b;if(a.children,"loaded"!==c||"loading"!==a.readyState)return!0;onError()}function k(a,c,d){d&&(d.onload=d.onreadystatechange=d.onerror=null),c.call(b)}function l(){return b.$A&&b.$A.lockerService||a.platform&&a.utils.inPlatform&&a.utils.inPlatform(a.constants.LIGHTNING)}function m(a,b){function h(){!w&&j(v)&&(w=1,r(y),k(n,b,v),z.resolve())}function m(){if(!w){w=1,r(y);var a=new Error("Timeout: "+n);b(a),z.reject(a),v.parentNode&&v.parentNode.removeChild(v)}}var n,o,t,v,w,x,y,z=d.Deferred(),A=z.promise();if(g(a)?n=a:f(a)&&(n=a._url||a.src,o=a.attrs,t=a.timeout),b=b||e,o=o||{},!n){var B=new Error("You must provide a valid script to load.");return b(B),z.reject(B),A}if(n in s)return s[n];if(!n.startsWith("data:")&&d("script[src='"+n+"']").length)return z.resolve(),k(n,b,v),A;s[n]=A,v=c.createElement("script"),t=t||u.errorTimeout,l()||(v.async=!1),v.src=n;for(x in o)v.setAttribute(x,o[x]);return y=q(m,t),l()?(v.addEventListener("load",h),v.addEventListener("error",m)):(v.onreadystatechange=v.onload=h,v.onerror=function(){m()}),i(),p.parentNode.appendChild(v),A}function n(a,i){var j,k,l,m={},n=d.Deferred(),p=n.promise();if(f(a)?(j=a._url||a.href,m=a.attrs||{}):g(a)&&(j=a),i=i||e,d("link[href='"+j+"']").length)return n.resolve(),i.call(b),p;l=c.createElement("link"),l.href=j,l.rel="stylesheet",l.media="only x",l.type=m.type||"text/css",q(function(){l.media=m.media||"all"});for(k in m)l.setAttribute(k,m[k]);return a&&a.insertBefore?a.insertBefore.parentNode.insertBefore(l,a.insertBefore):a&&a.insertAfter?a.insertAfter.parentNode.insertBefore(l,a.insertAfter.nextSibling):(h(),o.parentNode.appendChild(l)),t()?(l.onload=function(){n.resolve(),i.call(b)},l.onerror=function(){n.resolve(),i.call(b)}):q(function(){n.resolve(),i.call(b)}),p}var o,p,q=b.setTimeout,r=b.clearTimeout,s={},t=function(){var a=c.createElement("link"),b="onload"in a;return b||(a.setAttribute("onload","return;"),b="function"==typeof a.onload),a=null,b},u={errorTimeout:4e4,js:m,css:n};return u}(window,document,b),function(a){a.widget("custom.combobox",{options:{parentElem:a("<div>"),source:function(b,c){var d=new RegExp(a.ui.autocomplete.escapeRegex(b.term),"i");c(this.element.children("option").map(function(){var c=a(this).text();if(this.value&&(!b.term||d.test(c)))return{label:c,value:c,option:this}}))},delay:0,searchicon:a("<div>"),menuClass:"ui-combobox"},_create:function(){this.wrapper=this.options.parentElem.addClass("custom-combobox").insertAfter(this.options.parentElem),this.element.hide(),this._createAutocomplete(),this._createShowAllButton()},_createAutocomplete:function(){var b,c=this,d=c.element.children(":selected"),e=c.options.value||d.val()&&d.text()||"",f=a('<div class="ui-combobox-container"></div>'),g={delay:c.options.delay,minLength:0,source:c.options.source,select:c.options.onChange,focus:function(b,d){if(c.options.showLabelInTextInput){var e="object"==typeof d.item?d.item.label:null;return e&&a(this).val(e),!1}}};c.options.appendDropdown&&a.extend(g,{appendTo:f}),c.input=a("<input>").appendTo(c.wrapper).autocomplete(g).val(e),c.input.appendTo(c.wrapper),c.input.focus(function(a){c.options.onFocus&&c.options.onFocus(a)}),c.input.blur(function(a){c.options.onBlur&&c.options.onBlur(a)}),c.options.appendDropdown?(f.insertAfter(c.wrapper.children().last()),b=f.find("ul.ui-autocomplete")):b=a("body").find("ul.ui-autocomplete"),b.addClass(c.options.menuClass).removeClass("ui-front"),c.options.parentElem&&(c.options.parentElem.append(c.options.searchicon),c.options.parentElem.is(c.input)&&c.input.css("padding-right","22px"))},_createShowAllButton:function(){var b=this,c=b.input,d=!1;a("<a>").attr("tabIndex",-1).tooltip().appendTo(b.wrapper).button({icons:{primary:"fa fa-chevron-down"},text:!1}).removeClass("ui-corner-all ui-button ui-widget ui-state-default ui-button-icon-only").addClass("nx-combobox-renderer-button").on("mousedown",function(){d=c.autocomplete("widget").is(":visible")}).on("click",function(){c.trigger("focus"),d||c.autocomplete("search","")})}})}(b),function(a){a.widget("ui.dialog",a.ui.dialog,{_allowInteraction:function(){return!0}})}(b),function(a){function b(b){this.$textarea=a(b),this._init()}b.prototype={_init:function(){var b=this;this.$textarea.wrap('<div class="flex-text-wrap" />').before("<pre><span /><br /></pre>"),this.$span=this.$textarea.prev().find("span"),this.$textarea.on("input propertychange keyup change",function(){b._mirror()}),a.valHooks.textarea={get:function(a){return a.value.replace(/\r?\n/g,"\r\n")}},this._mirror()},_mirror:function(){this.$span.text(this.$textarea.val())}},a.fn.flexText=function(){return this.each(function(){a.data(this,"flexText")||a.data(this,"flexText",new b(this))})}}(b),Array.prototype.reduce||(Array.prototype.reduce=function(a){if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var b,c=Object(this),d=c.length>>>0,e=0;if(2==arguments.length)b=arguments[1];else{for(;e<d&&!(e in c);)e++;if(e>=d)throw new TypeError("Reduce of empty array with no initial value");b=c[e++]}for(;e<d;e++)e in c&&(b=a(b,c[e],e,c));return b}),b.fn.extend({insertAtCaret:function(a){return this.each(function(){if(document.selection){this.focus();document.selection.createRange().text=a,this.focus()}else if(this.selectionStart||"0"==this.selectionStart){var b=this.selectionStart,c=this.selectionEnd,d=this.scrollTop;this.value=this.value.substring(0,b)+a+this.value.substring(c,this.value.length),this.focus(),this.selectionStart=b+a.length,this.selectionEnd=b+a.length,this.scrollTop=d}else this.value+=a,this.focus()})}})}(window.skuid,window.jQuery),function(){var a=function(){for(var a=3,b=document.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e",c[0];);return a<=4&&!window.ActiveXObject&&"ActiveXObject"in window?11:a>4?a:void 0}(),b=function(){function a(a){for(var b,c=getComputedStyle(a).fontFamily,d={};null!==(b=f.exec(c));)d[b[1]]=b[2];return d}function b(b,d){if(!b[e].parsingSrcset){var f=a(b);if(f["object-fit"]=f["object-fit"]||"fill",!b[e].s){if("fill"===f["object-fit"])return;if(!b[e].skipTest&&h&&!f["object-position"])return}var g=b[e].ios7src||b.currentSrc||b.src;if(d)g=d;else if(b.srcset&&!j&&window.picturefill){var i=window.picturefill._;b[e].parsingSrcset=!0,b[i.ns]&&b[i.ns].evaled||i.fillImg(b,{reselect:!0}),b[i.ns].curSrc||(b[i.ns].supported=!1,i.fillImg(b,{reselect:!0})),delete b[e].parsingSrcset,g=b[i.ns].curSrc||g}if(b[e].s)b[e].s=g,d&&(b[e].srcAttr=d);else{b[e]={s:g,srcAttr:d||k.call(b,"src"),srcsetAttr:b.srcset},b.src=e;try{b.srcset&&(b.srcset="",Object.defineProperty(b,"srcset",{value:b[e].srcsetAttr})),c(b)}catch(l){b[e].ios7src=g}}b.style.backgroundImage='url("'+g+'")',b.style.backgroundPosition=f["object-position"]||"center",b.style.backgroundRepeat="no-repeat",/scale-down/.test(f["object-fit"])?(b[e].i||(b[e].i=new Image,b[e].i.src=g),function m(){if(b[e].i.naturalWidth)return void(b[e].i.naturalWidth>b.width||b[e].i.naturalHeight>b.height?b.style.backgroundSize="contain":b.style.backgroundSize="auto");setTimeout(m,100)}()):b.style.backgroundSize=f["object-fit"].replace("none","auto").replace("fill","100% 100%")}}function c(a){var c={get:function(){return a[e].s},set:function(c){return delete a[e].i,b(a,c),c}};Object.defineProperty(a,"src",c),Object.defineProperty(a,"currentSrc",{get:c.get})}function d(a,c){var f=!m&&!a;if(c=c||{},a=a||"img",i&&!c.skipTest)return!1;"string"==typeof a?a=document.querySelectorAll("img"):"length"in a||(a=[a]);for(var g=0;g<a.length;g++)a[g][e]=a[g][e]||c,b(a[g]);f&&(document.body.addEventListener("load",function(a){"IMG"===a.target.tagName&&d(a.target,{skipTest:c.skipTest})},!0),m=!0,a="img"),c.watchMQ&&window.addEventListener("resize",d.bind(null,a,{skipTest:c.skipTest}))}var e="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",f=/(object-fit|object-position)\s*:\s*([-\w\s%]+)/g,g=new Image,h="object-fit"in g.style,i="object-position"in g.style,j="string"==typeof g.currentSrc,k=g.getAttribute,l=g.setAttribute,m=!1;return d.supportsObjectFit=h,d.supportsObjectPosition=i,function(){i||(HTMLImageElement.prototype.getAttribute=function(a){return!this[e]||"src"!==a&&"srcset"!==a?k.call(this,a):this[e][a+"Attr"]},HTMLImageElement.prototype.setAttribute=function(a,b){!this[e]||"src"!==a&&"srcset"!==a?l.call(this,a,b):this["src"===a?"src":a+"Attr"]=String(b)})}(),d}();(a>8||a===undefined)&&skuid.$(function(){b()})}(),window.sforce=window.sforce||{},sforce.internal={},sforce.StringBuffer=function(){this.buffer=[],this.append=function(a){return this.buffer.push(a),this},this.toString=function(){return this.buffer.join("")}},sforce.Base64Binary=function(a){this.input=a},sforce.Base64Binary.prototype.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",sforce.Base64Binary.prototype.toString=function(){var a,b,c,d,e,f=[],g="",h="",i=0;do{a=this.input.charCodeAt(i++),b=this.input.charCodeAt(i++),g=this.input.charCodeAt(i++),c=a>>2,d=(3&a)<<4|b>>4,e=(15&b)<<2|g>>6,h=63&g,isNaN(b)?e=h=64:isNaN(g)&&(h=64),f.push(this.keyStr.charAt(c)+this.keyStr.charAt(d)+this.keyStr.charAt(e)+this.keyStr.charAt(h)),a=b=g="",c=d=e=h=""}while(i<this.input.length);return f.join("")},sforce.Base64Binary.prototype.decode=function(a){var b,c,d,e,f,g=[],h="",i="",j=0;/[^A-Za-z0-9\+\/\=]/g.exec(a)&&alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/', and '='\nExpect errors in decoding."),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{d=this.keyStr.indexOf(a.charAt(j++)),e=this.keyStr.indexOf(a.charAt(j++)),f=this.keyStr.indexOf(a.charAt(j++)),i=this.keyStr.indexOf(a.charAt(j++)),b=d<<2|e>>4,c=(15&e)<<4|f>>2,h=(3&f)<<6|i,g.push(String.fromCharCode(b)),64!=f&&g.push(String.fromCharCode(c)),64!=i&&g.push(String.fromCharCode(h)),b=c=h="",d=e=f=i=""}while(j<a.length);return g.join("")},sforce.internal.dateToString=function(a){var b=a;return b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate()},sforce.internal.dateTimeToString=function(a){var b=a,c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getTimezoneOffset(),j=i<0?"+":"-";i=Math.abs(i);var k=i/60,l=i%60;h<=9&&(h="0"+h);var m=b.getMilliseconds();0!==m&&(m="."+m,m.length>4&&(m=m.substring(0,4)),h+=m);var n;return 0===i?n="Z":(l<10&&(l="0"+l),k<10&&(k="0"+k),n=j+k+":"+l),d<=9&&(d="0"+d),e<=9&&(e="0"+e),f<=9&&(f="0"+f),g<=9&&(g="0"+g),c+"-"+d+"-"+e+"T"+f+":"+g+":"+h+n},sforce.internal.stringToDate=function(a){if(null===a||0===a.length)throw"Unable to parse dateTime";if("+"==a.charAt(0)&&(a=a.substring(1)),"-"==a.charAt(0)&&(a=a.substring(1),!0),10!=a.length)throw"Unable to parse date, "+a+" length != 10";if("-"!=a.charAt(4)||"-"!=a.charAt(7))throw"Unable to parse date";var b=a.substring(0,4),c=a.substring(5,7),d=a.substring(8,10),e=new Date(b,c-1,d,0,0,0);return e.setMilliseconds(0),e},sforce.internal.stringToDateTime=function(a){if(null===a||0===a.length)throw"Unable to parse dateTime";if("+"==a.charAt(0)&&(a=a.substring(1)),"-"==a.charAt(0)&&(a=a.substring(1),!0),a.length<19)throw"Unable to parse dateTime";if("-"!=a.charAt(4)||"-"!=a.charAt(7)||"T"!=a.charAt(10))throw"Unable to parse dateTime";if(":"!=a.charAt(13)||":"!=a.charAt(16))throw"Unable to parse dateTime";var b=a.substring(0,4),c=a.substring(5,7),d=a.substring(8,10),e=a.substring(11,13),f=a.substring(14,16),g=a.substring(17,19),h=new Date(b,c-1,d,e,f,g),i=19;if(i<a.length&&"."==a.charAt(i)){for(var j=0,k=++i;i<a.length&&sforce.internal.isDigit(a.charAt(i));)i++;var l=a.substring(k,i);3==l.length?j=l:l.length<3?j=(l+"000").substring(0,3):(j=l.substring(0,3),l.charAt(3)>="5"&&++j),h.setMilliseconds(j)}var m=6e4*h.getTimezoneOffset();if(i+5<a.length&&("+"==a.charAt(i)||"-"==a.charAt(i))){if(!(sforce.internal.isDigit(a.charAt(i+1))&&sforce.internal.isDigit(a.charAt(i+2))&&":"==a.charAt(i+3)&&sforce.internal.isDigit(a.charAt(i+4))&&sforce.internal.isDigit(a.charAt(i+5))))throw"Unable to parse dateTime";var n=10*(a.charAt(i+1)-"0")+a.charAt(i+2)-"0",o=10*(a.charAt(i+4)-"0")+a.charAt(i+5)-"0",p=60*(60*n+o)*1e3;"+"==a.charAt(i)&&(p=-p),h=new Date(h.getTime()-m+p),i+=6}if(i<a.length&&"Z"==a.charAt(i)&&(i++,h=new Date(h.getTime()-m)),i<a.length)throw"Unable to parse dateTime";return h},sforce.internal.isDigit=function(a){return"0"==a||"1"==a||"2"==a||"3"==a||"4"==a||"5"==a||"6"==a||"7"==a||"8"==a||"9"==a},sforce.Xml=function(a){},sforce.Xml.prototype.toXml=function(a,b,c){c.writeStartElement(b,a),this._xsiType&&c.writeXsiType(this._xsiType);for(var d in this)if("_name"==d||"_xsiType"==d);else{var e=this[d];if("function"!=typeof e)if(Array.isArray(e))for(var f=0;f<e.length;f++)this.writeValue(a,c,d,e[f]);else this.writeValue(a,c,d,e)}c.writeEndElement(b,a)},sforce.Xml.prototype.writeValue=function(a,b,c,d){if(null===d)return void b.writeNameValueNode("fieldsToNull",c);void 0!==d&&(d.toXml?d.toXml(a,c,b):b.writeNameValueNode(c,d))},sforce.Xml.prototype.get=function(a){return this[a]?this[a]:null},sforce.Xml.prototype.set=function(a,b){this[a]=b},sforce.Xml.prototype.getArray=function(a){var b=this[a];return b?b.join?b:[b]:[]},sforce.Xml.prototype.getBoolean=function(a){return"true"==this[a]},sforce.Xml.prototype.getDate=function(a){return this[a]?this[a].getFullYear?this[a]:sforce.internal.stringToDate(this[a]):null},sforce.Xml.prototype.getDateTime=function(a){return this[a]?this[a].getFullYear?this[a]:sforce.internal.stringToDateTime(this[a]):null},sforce.Xml.prototype.getInt=function(a){if(this[a])return"number"==typeof this[a]?this[a]:parseInt(this[a],10);throw"Unable to parse int field: "+a},sforce.Xml.prototype.getFloat=function(a){if(this[a])return"number"==typeof this[a]?this[a]:parseFloat(this[a]);throw"Unable to parse float field: "+a},sforce.Xml.prototype.getBase64Binary=function(a){if(this[a])return sforce.Base64Binary.prototype.decode(this[a]);throw"Unable to parse base64Binary field: "+a},sforce.Xml.prototype.toString=function(){var a=new sforce.StringBuffer;a.append("{");for(var b in this){var c=this[b];if(c)if("object"==typeof c)a.append(b).append(":").append(c.toString());else if(c.join){a.append(b).append(":").append("[");for(var d=0;d<c.length;d++)a.append(c[d]),d<c.length-1&&a.append(", ");a.append("]")}else{if("function"==typeof c)continue;a.append(b).append(":").append("'"+c+"'")}else a.append(b).append(":").append(""+c);a.append(", ")}return a.append("}"),a.toString()},sforce.internal.Debug=function(){this.output=null,this.trace=!1,this.apexTrace=!1,this.win=null,this.traceQueue=[],this.quiet=!1,this.open=function(){this.println("","print")},this.println=function(a,b){if(!this.quiet){if("function"==typeof println)return void println(a,b);null!==this.win&&this.win.document||(this.output=null,this.win=window.open("undefined"!=typeof window.UserContext?UserContext.getUrl("/soap/ajax/41.0/debugshell.html"):"/soap/ajax/41.0/debugshell.html","","width=800,height=400,toolbar=no,location=no,directories=no,alwaysRaised=yes,status=no,menubar=no,scrollbars=yes,copyhistory=yes,resizable=yes")),null===this.output&&this.findOutput(),null!==this.output?(sforce.debug.traceQueue.length>0&&this.traceCallback(),this.win.println(a,b)):(sforce.debug.traceQueue.push({message:a,type:b}),setTimeout(sforce.debug.traceCallback,1e3))}},this.traceCallback=function(){if(sforce.debug.findOutput(),null===sforce.debug.output)return void setTimeout(sforce.debug.traceCallback,1e3);for(var a=0;a<sforce.debug.traceQueue.length;a++){var b=sforce.debug.traceQueue[a];sforce.debug.win.println(b.message,b.type)}sforce.debug.traceQueue=[]},this.findOutput=function(){return null===this.output&&(this.output=this.win.document.getElementById("output")),this.output},this.logXml=function(a){a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a="<textarea cols=80 rows=5 wrap=hard>"+a+"</textarea>",this.println(a,"printxml")},this.log=function(a){this.println(a,"print")},this.logApex=function(a){var b=a.indexOf("<debugLog>"),c=a.indexOf("</debugLog>");-1===b?b=0:b+="<debugLog>".length,-1===c&&(c=a.length);var d=a.substring(b,c);this.println(d,"printxml")}},sforce.debug=new sforce.internal.Debug,sforce.internal._connections=[],sforce.internal.ConnectionHolder=function(a,b){this.connection=a,this.callback=b,this.timedout=!1},sforce.Transport=function(a){this.url=a,this.connection=null,this.newConnection=function(){try{this.connection=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{this.connection=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){this.connection=new XMLHttpRequest}}return this.connection},this.send=function(a,b,c,d){this.newConnection(),c&&(this.connection.onreadystatechange=this.httpConnectionCallback);var e=new sforce.internal.ConnectionHolder(this.connection,b);sforce.internal._connections.push(e),this.connection.open("POST",this.url,c),this.connection.setRequestHeader("Content-Type","text/xml; charset=UTF-8"),this.connection.setRequestHeader("SOAPAction",'""'),this.connection.setRequestHeader("Accept","text/xml"),this.connection.setRequestHeader("X-SFDC-User-Agent","SFAJAX 1.0"),this.connection.send(a),c&&void 0!==d&&this.setTimeoutOn(e,d),c||this.httpConnectionCallback()},this.setTimeoutOn=function(a,b){function c(){4!==a.connection.readyState&&(a.timedout=!0,a.connection.abort())}setTimeout(c,b)},this.httpConnectionCallback=function(){for(var a=0;a<sforce.internal._connections.length;a++){var b=sforce.internal._connections[a];if(null!==b)if(b.timedout)sforce.internal._connections[a]=null,sforce.internal._connections.slice(a,1),b.callback.httpCallback("Remote invocation timed out",!1);else if(4==b.connection.readyState){sforce.internal._connections[a]=null,sforce.internal._connections.slice(a,1);var c=200==b.connection.status;sforce.debug.trace&&(sforce.debug.log("Response : status - "+b.connection.status),sforce.debug.logXml(b.connection.responseText)),sforce.debug.apexTrace&&sforce.debug.logApex(b.connection.responseText),b.connection.responseXML&&b.connection.responseXML.documentElement?b.callback.httpCallback(b.connection.responseXML.documentElement,c):b.callback.httpCallback("Remote invocation failed, due to: "+b.connection.responseText+" status code: ",b.connection.status)}}}},sforce.XmlWriter=function(){this.buffer=new sforce.StringBuffer,this.namespaces={},this.prefixCount=0,this.writingStartElement=!1},sforce.XmlWriter.prototype.writeStartElement=function(a,b,c){this.writingStartElement&&this.buffer.append(">"),this.buffer.append("<");var d=!1;b&&(this.namespaces[b]||""===this.namespaces[b]||(d=!0),c||(c=this.getPrefix(b)),null!==c&&""!==c&&(this.buffer.append(c),this.buffer.append(":"))),this.buffer.append(a),!0===d&&this.writeNamespace(b,c),this.writingStartElement=!0},sforce.XmlWriter.prototype.writeEndElement=function(a,b){if(this.writingStartElement)this.buffer.append("/>");else{if(this.buffer.append("</"),b){var c=this.getPrefix(b);c&&""!==c&&(this.buffer.append(c),this.buffer.append(":"))}this.buffer.append(a),this.buffer.append(">")}this.writingStartElement=!1},sforce.XmlWriter.prototype.writeNamespace=function(a,b){b&&""!==b?(this.namespaces[a]=b,this.buffer.append(" "),this.buffer.append("xmlns:"),this.buffer.append(b)):(this.namespaces[a]="",this.buffer.append(" "),this.buffer.append("xmlns")),this.buffer.append('="'),this.buffer.append(a),this.buffer.append('"')},sforce.XmlWriter.prototype.writeText=function(a){if(!this.writingStartElement)throw"Can only write text after a start element";this.buffer.append(">"),this.writingStartElement=!1,"string"==typeof a&&(a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;")),this.buffer.append(a)},sforce.XmlWriter.prototype.writeXsiType=function(a){
this.writeNamespace("http://www.w3.org/2001/XMLSchema-instance","xsi"),this.writeAttribute("xsi:type",a)},sforce.XmlWriter.prototype.writeAttribute=function(a,b){this.buffer.append(" "+a+'="'+b+'"')},sforce.XmlWriter.prototype.getPrefix=function(a){var b=this.namespaces[a];return b||""===b?b:(b="ns"+this.prefixCount,this.prefixCount++,this.namespaces[a]=b,b)},sforce.XmlWriter.prototype.toString=function(){return this.buffer.toString()},sforce.XmlWriter.prototype.soapNS="http://schemas.xmlsoap.org/soap/envelope/",sforce.XmlWriter.prototype.startEnvelope=function(){this.writeStartElement("Envelope",this.soapNS,"se")},sforce.XmlWriter.prototype.endEnvelope=function(){this.writeEndElement("Envelope",this.soapNS)},sforce.XmlWriter.prototype.startHeader=function(){this.writeStartElement("Header",this.soapNS,"se")},sforce.XmlWriter.prototype.endHeader=function(){this.writeEndElement("Header",this.soapNS)},sforce.XmlWriter.prototype.startBody=function(){this.writeStartElement("Body",this.soapNS,"se")},sforce.XmlWriter.prototype.endBody=function(){this.writeEndElement("Body",this.soapNS)},sforce.XmlWriter.prototype.writeNameValueNode=function(a,b){if(null===b)return this.writeStartElement(a),this.writeNamespace("http://www.w3.org/2001/XMLSchema-instance","xsi"),this.writeAttribute("xsi:nill","true"),void this.writeEndElement(a);if(b.toUTCString&&(b=sforce.internal.dateTimeToString(b)),"boolean"==typeof b&&(b=b?"true":"false"),b&&b.join)for(var c=0;c<b.length;c++)this.writeStartElement(a),this.writeText(b[c]),this.writeEndElement(a);else this.writeStartElement(a),this.writeText(b),this.writeEndElement(a)},sforce.XmlReader=function(a){this.envelope=a},sforce.XmlReader.prototype.getEnvelope=function(){if(this.isTag("Envelope",this.envelope))return this.envelope;throw"Unable to find soap envelope, but found "+this.envelope.nodeName},sforce.XmlReader.prototype.getBody=function(){return this.getChild("Body",this.envelope)},sforce.XmlReader.prototype.getHeader=function(){return this.getChild("Header",this.envelope)},sforce.XmlReader.prototype.getChild=function(a,b){for(var c=b.childNodes,d=0;d<c.length;d++)if(1==c[d].nodeType&&this.isTag(a,c[d]))return c[d];return null},sforce.XmlReader.prototype.getFirstElement=function(a){for(var b=a.childNodes,c=0;c<b.length;c++)if(1==b[c].nodeType)return b[c];return null},sforce.XmlReader.prototype.isTag=function(a,b){var c=b.nodeName.split(":");return 2==c.length&&c[1]==a||1==c.length&&c[0]==a},sforce.XmlReader.prototype.isNameValueNode=function(a){for(var b=a.childNodes,c=0;c<b.length;c++)if(3!=b[c].nodeType)return!1;return!0},sforce.XmlReader.prototype.getTextValue=function(a){if(3==a.nodeType)return a.nodeValue;if("true"==a.getAttribute("xsi:nil"))return null;for(var b="",c=a.childNodes,d=0;d<c.length;d++){if(3!=c[d].nodeType)throw"Not a simple name value node";b+=c[d].nodeValue}return b},sforce.XmlReader.prototype.toXmlObject=function(a){if("true"==a.getAttribute("xsi:nil"))return null;var b=new sforce.Xml,c=[];for(c.push({node:a,obj:b});c.length>0;)for(var d=c.shift(),e=d.node.firstChild;null!==e;e=e.nextSibling)if(1==e.nodeType){var f=e.nodeName,g=f.indexOf(":");f=-1==g?f:f.substring(g+1);for(var h,i=!0,j="",k=e.firstChild;null!==k;k=k.nextSibling){if(3!=k.nodeType){i=!1;break}j+=k.nodeValue}if(i?h="true"==e.getAttribute("xsi:nil")?null:j:(h=new sforce.Xml,c.push({node:e,obj:h})),d.obj[f])if(d.obj[f].push)d.obj[f].push(h);else{var l=d.obj[f];"Id"===f&&l===h||(d.obj[f]=[],d.obj[f].push(l),d.obj[f].push(h))}else d.obj[f]=h}return b},sforce.SoapTransport=function(){this.connectionCallback=null,this.result=null,this.fault=null,this.isAsync=!0,this.isArray=!1},sforce.SoapTransport.prototype.onFailure=function(a,b){alert("ERROR: ........... "+a),this.result=null},sforce.SoapTransport.prototype.send=function(a,b,c,d){this.isArray=c;var e=new sforce.Transport(a);if(this.isAsync=!!d,!this.isAsync){if(e.send(b.toString(),this,this.isAsync),null!==this.fault)throw this.fault;return this.result}this.connectionCallback=d,e.send(b.toString(),this,this.isAsync,d.timeout)},sforce.SoapTransport.prototype.httpCallback=function(a,b){try{if(!0===b){var c=new sforce.XmlReader(a),d=(c.getEnvelope(),c.getBody()),e=c.getFirstElement(d);if(null===e)throw"Unable to find operation response element";for(var f=[],g=e.childNodes,h=0;h<g.length;h++)1==g[h].nodeType&&(c.isNameValueNode(g[h])?f.push(c.getTextValue(g[h])):f.push(c.toXmlObject(g[h])));if(this.isArray)this.result=f;else{if(f.length>1)throw"Found more than one response: "+f;this.result=f[0]}if(this.isAsync)try{if(this.beforeCallback(),"function"==typeof this.connectionCallback)this.connectionCallback(this.result);else{if(!this.connectionCallback.onSuccess)throw"Unable to find onSuccess method in the callback object";this.connectionCallback.onSuccess(this.result,this.connectionCallback.source)}}finally{this.afterCallback()}}else if("undefined"!=typeof a.nodeName){var i=new sforce.XmlReader(a),j=(i.getEnvelope(),i.getBody()),k=i.getFirstElement(j),l=i.toXmlObject(k);this.sendFault(l)}else this.sendFault(a)}catch(m){this.sendFault(m)}},sforce.SoapTransport.prototype.sendFault=function(a){if(this.isAsync)if(this.connectionCallback.onFailure)try{this.beforeCallback(),this.connectionCallback.onFailure(a,this.connectionCallback.source)}finally{this.afterCallback()}else this.onFailure(a);else this.fault=a},sforce.SoapTransport.prototype.beforeCallback=function(){},sforce.SoapTransport.prototype.afterCallback=function(){},sforce.SObject=function(a){this.type=a},sforce.SObject.prototype=new sforce.Xml("sObjects"),sforce.LeadConvert=function(){},sforce.LeadConvert.prototype=new sforce.Xml("leadConverts"),sforce.MergeRequest=function(){},sforce.MergeRequest.prototype=new sforce.Xml("request"),sforce.DescribeSoqlListViewsRequest=function(){},sforce.DescribeSoqlListViewsRequest.prototype=new sforce.Xml("request"),sforce.DescribeSoqlListViewParams=function(){},sforce.DescribeSoqlListViewParams.prototype=new sforce.Xml("listViewParams"),sforce.QuickAction=function(){},sforce.QuickAction.prototype=new sforce.Xml("quickActions"),sforce.Connection=function(){this.sessionId=null,this.updateMru=null,this.allowFieldTruncation=null,this.disableFeedTracking=null,this.streamingEnabled=null,this.allOrNone=null,this.client=null,this.defaultNamespace=null,this.batchSize=null,this.loginScopeHeader=null,this.emailHeader=null,this.assignmentRuleHeader=null,this.duplicateRuleHeader=null,this.transferToUserId=null,this.debuggingHeader=null,this.serverUrl="undefined"!=typeof window.UserContext?UserContext.getUrl("/services/Soap/u/41.0"):"/services/Soap/u/41.0"},sforce.internal.Parameter=function(a,b,c){this.name=a,this.value=b,this.isArray=c},sforce.Connection.prototype.sforceNs="urn:partner.soap.sforce.com",sforce.Connection.prototype.sobjectNs="sobject.partner.soap.sforce.com",sforce.Connection.prototype.writeOne=function(a,b,c,d){null===c?a.writeNameValueNode(b,null):c.toXml?c.toXml(d,b,a):a.writeNameValueNode(b,c)},sforce.Connection.prototype.init=function(a,b){this.sessionId=a,this.serverUrl=b},sforce.Connection.prototype.login=function(a,b){var c=new sforce.internal.Parameter("username",a,!1),d=new sforce.internal.Parameter("password",b,!1),e=this.invoke("login",[c,d],!1,null);return this.sessionId=e.sessionId,e},sforce.Connection.prototype.describeSObject=function(a,b){var c=new sforce.internal.Parameter("sObjectType",a,!1);return this.invoke("describeSObject",[c],!1,b)},sforce.Connection.prototype.describeSObjects=function(a,b){var c=new sforce.internal.Parameter("sObjectType",a,!0);return this.invoke("describeSObjects",[c],!0,b)},sforce.Connection.prototype.describeSearchLayouts=function(a,b){var c=new sforce.internal.Parameter("sObjectType",a,!0);return this.invoke("describeSearchLayouts",[c],!0,b)},sforce.Connection.prototype.describeListViews=function(a,b){var c=new sforce.internal.Parameter("sObjectType",a,!0);return this.invoke("describeListViews",[c],!0,b)},sforce.Connection.prototype.describeSoqlListViews=function(a,b,c){var d=new sforce.DescribeSoqlListViewParams;d.developerNameOrId=a,d.sobjectType=b;var e=new sforce.DescribeSoqlListViewsRequest;e.listViewParams=[d];var f=new sforce.internal.Parameter("request",e,!1);return this.invoke("describeSoqlListViews",[f],!1,c)},sforce.Connection.prototype.describeGlobal=function(a){return this.invoke("describeGlobal",[],!1,a)},sforce.Connection.prototype.describeLayout=function(a,b,c,d){var e=new sforce.internal.Parameter("sObjectType",a,!1);b||(b=null);var f=new sforce.internal.Parameter("layoutName",b,!1);c||(c=[]);var g=new sforce.internal.Parameter("recordTypeIds",c,!0);return this.invoke("describeLayout",[e,f,g],!1,d)},sforce.Connection.prototype.describeAvailableQuickActions=function(a,b){var c=new sforce.internal.Parameter("parentType",a,!1);return this.invoke("describeAvailableQuickActions",[c],!0,b)},sforce.Connection.prototype.describeQuickActions=function(a,b){var c=new sforce.internal.Parameter("quickActionNames",a,!0);return this.invoke("describeQuickActions",[c],!0,b)},sforce.Connection.prototype.performQuickActions=function(a,b){var c=new sforce.internal.Parameter("quickActions",a,!0);return this.invoke("performQuickActions",[c],!0,b)},sforce.Connection.prototype.describeCompactLayouts=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1);b||(b=[]);var e=new sforce.internal.Parameter("recordTypeIds",b,!0);return this.invoke("describeCompactLayouts",[d,e],!1,c)},sforce.Connection.prototype.describePathAssistants=function(a,b,c,d){var e=new sforce.internal.Parameter("sObjectType",a,!1);b||(b=null);var f=new sforce.internal.Parameter("picklistValue",b,!1);c||(c=[]);var g=new sforce.internal.Parameter("recordTypeIds",c,!0);return this.invoke("describePathAssistants",[e,f,g],!1,d)},sforce.Connection.prototype.describePrimaryCompactLayouts=function(a,b){var c=new sforce.internal.Parameter("sObjectTypes",a,!0);return this.invoke("describePrimaryCompactLayouts",[c],!0,b)},sforce.Connection.prototype.describeApprovalLayout=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1);b||(b=[]);var e=new sforce.internal.Parameter("approvalProcessNames",b,!0);return this.invoke("describeApprovalLayout",[d,e],!1,c)},sforce.Connection.prototype.describeSObjectListViews=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1),e=new sforce.internal.Parameter("recentlyViewed",b,!1),f=new sforce.internal.Parameter("isSoqlCompatible",isSoqlCompatible,!1),g=new sforce.internal.Parameter("limit",limit,!1),h=new sforce.internal.Parameter("offset",offset,!1);return this.invoke("describeSObjectListViews",[d,e,f,g,h],!0,c)},sforce.Connection.prototype.describeTabs=function(a){return this.invoke("describeTabs",[],!0,a)},sforce.Connection.prototype.describeAllTabs=function(a){return this.invoke("describeAllTabs",[],!0,a)},sforce.Connection.prototype.describeAppMenu=function(a,b,c){var d=new sforce.internal.Parameter("appMenuType",a,!1),e=new sforce.internal.Parameter("networkId",b,!1);return this.invoke("describeAppMenu",[d,e],!0,c)},sforce.Connection.prototype.describeFlexiPages=function(a,b){var c=new sforce.internal.Parameter("FlexiPage",a,!1);return this.invoke("describeFlexiPages",[c],!0,b)},sforce.Connection.prototype.describeTheme=function(a){return this.invoke("describeTheme",[],!0,a)},sforce.Connection.prototype.describeGlobalTheme=function(a){return this.invoke("describeGlobalTheme",[],!0,a)},sforce.Connection.prototype.describeSoftphoneLayout=function(a){return this.invoke("describeSoftphoneLayout",[],!1,a)},sforce.Connection.prototype.describeMiniLayout=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1),e=new sforce.internal.Parameter("recordTypeIds",b,!0);return this.invoke("describeMiniLayout",[d,e],!1,c)},sforce.Connection.prototype.describeSearchScopeOrder=function(a){return this.invoke("describeSearchScopeOrder",[],!0,a)},sforce.Connection.prototype.create=function(a,b){var c=new sforce.internal.Parameter("sObjects",a,!0);return this.invoke("create",[c],!0,b)},sforce.Connection.prototype.update=function(a,b){var c=new sforce.internal.Parameter("sObjects",a,!0);return this.invoke("update",[c],!0,b)},sforce.Connection.prototype.upsert=function(a,b,c){var d=new sforce.internal.Parameter("externalIDFieldName",a,!1),e=new sforce.internal.Parameter("sObjects",b,!0);return this.invoke("upsert",[d,e],!0,c)},sforce.Connection.prototype.deleteIds=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("delete",[c],!0,b)},sforce.Connection.prototype.impersonateUser=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("impersonateUser",[c],!0,b)},sforce.Connection.prototype.query=function(a,b){var c=new sforce.internal.Parameter("queryString",a,!1);return this.invoke("query",[c],!1,b)},sforce.Connection.prototype.queryAll=function(a,b){var c=new sforce.internal.Parameter("queryString",a,!1);return this.invoke("queryAll",[c],!1,b)},sforce.Connection.prototype.queryMore=function(a,b){var c=new sforce.internal.Parameter("queryLocator",a,!1);return this.invoke("queryMore",[c],!1,b)},sforce.Connection.prototype.retrieve=function(a,b,c,d){var e=new sforce.internal.Parameter("fieldList",a,!1),f=new sforce.internal.Parameter("sObjectType",b,!1),g=new sforce.internal.Parameter("ids",c,!0);return this.invoke("retrieve",[e,f,g],!0,d)},sforce.Connection.prototype.getAccessInfo=function(a){return this.invoke("getAccessInfo",[],!1,a)},sforce.Connection.prototype.getUserInfo=function(a){return this.invoke("getUserInfo",[],!1,a)},sforce.Connection.prototype.resetPassword=function(a,b){var c=new sforce.internal.Parameter("userId",a,!1);return this.invoke("resetPassword",[c],!1,b)},sforce.Connection.prototype.setPassword=function(a,b,c){var d=new sforce.internal.Parameter("userId",a,!1),e=new sforce.internal.Parameter("password",b,!1);return this.invoke("setPassword",[d,e],!1,c)},sforce.Connection.prototype.search=function(a,b){var c=new sforce.internal.Parameter("searchString",a,!1);return this.invoke("search",[c],!1,b)},sforce.Connection.prototype.getDeleted=function(a,b,c,d){var e=new sforce.internal.Parameter("sObjectType",a,!1),f=new sforce.internal.Parameter("startDate",b,!1),g=new sforce.internal.Parameter("endDate",c,!1);return this.invoke("getDeleted",[e,f,g],!1,d)},sforce.Connection.prototype.getUpdated=function(a,b,c,d){var e=new sforce.internal.Parameter("sObjectType",a,!1),f=new sforce.internal.Parameter("startDate",b,!1),g=new sforce.internal.Parameter("endDate",c,!1);return this.invoke("getUpdated",[e,f,g],!1,d)},sforce.Connection.prototype.getServerTimestamp=function(a){return this.invoke("getServerTimestamp",[],!1,a)},sforce.Connection.prototype.convertLead=function(a,b){var c=new sforce.internal.Parameter("leadConverts",a,!0);return this.invoke("convertLead",[c],!0,b)},sforce.Connection.prototype.merge=function(a,b){var c=new sforce.internal.Parameter("request",a,!0);return this.invoke("merge",[c],!0,b)},sforce.Connection.prototype.findDuplicates=function(a,b){var c=new sforce.internal.Parameter("sObjects",a,!0);return this.invoke("findDuplicates",[c],!0,b)},sforce.Connection.prototype.findDuplicatesByIds=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("findDuplicatesByIds",[c],!0,b)},sforce.Connection.prototype.undelete=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("undelete",[c],!0,b)},sforce.Connection.prototype.process=function(a,b){var c=new sforce.internal.Parameter("actions",a,!0);return this.invoke("process",[c],!0,b)},sforce.Connection.prototype.sendEmail=function(a,b){var c=new sforce.internal.Parameter("messages",a,!0);return this.invoke("sendEmail",[c],!0,b)},sforce.Connection.prototype.emptyRecycleBin=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("emptyRecycleBin",[c],!0,b)},sforce.Connection.prototype.invalidateSessions=function(a,b){var c=new sforce.internal.Parameter("sessionIds",a,!0);return this.invoke("invalidateSessions",[c],!0,b)},sforce.Connection.prototype.logout=function(a){return this.invoke("logout",[],!0,a)},sforce.Connection.prototype.remoteFunction=function(a){function b(){if(sforce.debug.trace&&sforce.debug.log("callback called ..."),4==c.readyState)if(200==c.status)if("text/plain"==a.mimeType)a.onSuccess(c.responseText,c);else{if("text/xml"!=a.mimeType)throw"unsupported mime type: "+a.mimeType;if(!c.responseXML||!c.responseXML.documentElement)throw"Response not text/xml mime type: "+c.responseText;a.onSuccess(c.responseXML.documentElement,c)}else a.onFailure?a.onFailure(c.responseText,c):sforce.debug.log(c.responseText)}if(!a.url)throw"url not defined";if(!a.onSuccess)throw"onSuccess method not defined";if(a.method||(a.method="GET"),a.mimeType||(a.mimeType="text/plain"),"undefined"==typeof a.async&&(a.async=!0),"undefined"==typeof a.cache&&(a.cache=!1),"text/plain"!=a.mimeType&&"text/xml"!=a.mimeType)throw"Unknown mime type "+a.mimeType;sforce.debug.trace&&sforce.debug.log("Open connection to ... "+a.url);var c=(new sforce.Transport).newConnection(),d="undefined"!=typeof window.UserContext?UserContext.getUrl("/services/proxy"):"/services/proxy";if(d=a.cache?d+"?end-point-url="+a.url:d+"?no-cache="+(new Date).getTime(),c.open(a.method,d,a.async),a.requestHeaders)for(var e in a.requestHeaders)"function"!=typeof a.requestHeaders[e]&&c.setRequestHeader(e,a.requestHeaders[e]);c.setRequestHeader("SalesforceProxy-Endpoint",a.url),c.setRequestHeader("SalesforceProxy-SID",this.sessionId),a.async&&(c.onreadystatechange=b),sforce.debug.trace&&sforce.debug.log("Sending ..."),a.requestData?c.send(a.requestData):c.send(null),sforce.debug.trace&&sforce.debug.log("Done Sending ..."),a.async||b()},sforce.Connection.prototype.writeHeader=function(a,b){if(a.startHeader(),a.writeNamespace(b,"sfns"),null!==this.sessionId&&(a.writeStartElement("SessionHeader",b),a.writeNameValueNode("sessionId",this.sessionId),a.writeEndElement("SessionHeader",b)),"undefined"!=typeof this.organizationId)throw"Use sforce.connection.loginScopeHeader.organizationId instead of sforce.connection.organizationId";if(null!==this.loginScopeHeader&&(a.writeStartElement("LoginScopeHeader",b),null!==this.loginScopeHeader.organizationId&&a.writeNameValueNode("organizationId",this.loginScopeHeader.organizationId),null!==this.loginScopeHeader.portalId&&a.writeNameValueNode("portalId",this.loginScopeHeader.portalId),a.writeEndElement("LoginScopeHeader",b)),null===this.client&&null===this.defaultNamespace||(a.writeStartElement("CallOptions",b),null!==this.client&&a.writeNameValueNode("client",this.client),null!==this.defaultNamespace&&a.writeNameValueNode("defaultNamespace",this.defaultNamespace),a.writeEndElement("CallOptions",b)),null!==this.batchSize&&(a.writeStartElement("QueryOptions",b),a.writeNameValueNode("batchSize",this.batchSize),a.writeEndElement("QueryOptions",b)),null!==this.allowFieldTruncation&&(a.writeStartElement("AllowFieldTruncationHeader",b),a.writeNameValueNode("allowFieldTruncation",this.allowFieldTruncation),a.writeEndElement("AllowFieldTruncationHeader",b)),null!==this.disableFeedTracking&&(a.writeStartElement("DisableFeedTrackingHeader",b),a.writeNameValueNode("disableFeedTracking",this.disableFeedTracking),a.writeEndElement("DisableFeedTrackingHeader",b)),null!==this.streamingEnabled&&(a.writeStartElement("StreamingEnabledHeader",b),a.writeNameValueNode("StreamingEnabled",this.streamingEnabled),a.writeEndElement("StreamingEnabledHeader",b)),null!==this.allOrNone&&(a.writeStartElement("AllOrNoneHeader",b),a.writeNameValueNode("allOrNone",this.allOrNone),a.writeEndElement("AllOrNoneHeader",b)),null!==this.updateMru&&(a.writeStartElement("MruHeader",b),a.writeNameValueNode("updateMru",this.updateMru),a.writeEndElement("MruHeader",b)),null!==this.emailHeader&&(a.writeStartElement("EmailHeader",b),this.emailHeader.triggerAutoResponseEmail&&a.writeNameValueNode("triggerAutoResponseEmail",this.emailHeader.triggerAutoResponseEmail),this.emailHeader.triggerOtherEmail&&a.writeNameValueNode("triggerOtherEmail",this.emailHeader.triggerOtherEmail),this.emailHeader.triggerUserEmail&&a.writeNameValueNode("triggerUserEmail",this.emailHeader.triggerUserEmail),a.writeEndElement("EmailHeader",b)),null!==this.assignmentRuleHeader&&(a.writeStartElement("AssignmentRuleHeader",b),this.assignmentRuleHeader.assignmentRuleId&&a.writeNameValueNode("assignmentRuleId",this.assignmentRuleHeader.assignmentRuleId),this.assignmentRuleHeader.useDefaultRule&&a.writeNameValueNode("useDefaultRule",this.assignmentRuleHeader.useDefaultRule),a.writeEndElement("AssignmentRuleHeader",b)),null!==this.transferToUserId&&(a.writeStartElement("UserTerritoryDeleteHeader",b),a.writeNameValueNode("transferToUserId",this.transferToUserId),a.writeEndElement("UserTerritoryDeleteHeader",b)),null!==this.duplicateRuleHeader&&(a.writeStartElement("DuplicateRuleHeader",b),this.duplicateRuleHeader.allowSave&&a.writeNameValueNode("allowSave",this.duplicateRuleHeader.allowSave),this.duplicateRuleHeader.includeRecordDetails&&a.writeNameValueNode("includeRecordDetails",this.duplicateRuleHeader.includeRecordDetails),this.duplicateRuleHeader.runAsCurrentUser&&a.writeNameValueNode("runAsCurrentUser",this.duplicateRuleHeader.runAsCurrentUser),a.writeEndElement("DuplicateRuleHeader",b)),null!==this.debuggingHeader){if(a.writeStartElement("DebuggingHeader",b),this.debuggingHeader.debugLevel&&a.writeNameValueNode("debugLevel",this.debuggingHeader.debugLevel),this.debuggingHeader.debugCategories)for(var c=this.debuggingHeader.debugCategories,d=0;d<c.length;d++){var e=c[d].split(",");2==e.length&&(a.writeStartElement("categories"),a.writeNameValueNode("category",e[0]),a.writeNameValueNode("level",e[1]),a.writeEndElement("categories"))}a.writeEndElement("DebuggingHeader",b)}a.endHeader()},sforce.Connection.prototype.namespaceMap=[{ns:sforce.Connection.prototype.sforceNs,prefix:null},{ns:sforce.Connection.prototype.sobjectNs,prefix:"ns1"}],sforce.Connection.prototype.invoke=function(a,b,c,d){return this._invoke(a,b,c,d,this.namespaceMap,this.serverUrl,this.sforceNs,this.sobjectNs)},sforce.Connection.prototype._invoke=function(a,b,c,d,e,f,g,h){if(d)if("function"==typeof d);else{if(!d.onSuccess)throw"onSuccess not defined in the callback";if(!d.onFailure)throw"onFailure not defined in the callback"}var i=new sforce.XmlWriter;i.startEnvelope(),this.writeHeader(i,g),i.startBody(),i.writeStartElement(a);for(var j=0;j<e.length;j++)i.writeNamespace(e[j].ns,e[j].prefix);for(var j=0;j<b.length;j++){var k=b[j];if("undefined"==typeof k.value)throw"arg "+j+" '"+k.name+"' not specified";if(null!==k.value){if(k.isArray&&!k.value.push)throw"arg "+j+" '"+k.name+"' is an array. But passed in value is not an array";if(!k.isArray&&k.value.push)throw"arg "+j+" '"+k.name+"' is not an array. But passed in value is an array"}if(null===k.value)this.writeOne(i,k.name,null,h);else if(k.value.push)for(var l=0;l<k.value.length;l++){var m=k.value[l];if(!m)throw"Array element at "+l+" is null.";this.writeOne(i,k.name,m,h)}else this.writeOne(i,k.name,k.value,h)}return i.writeEndElement(a),i.endBody(),i.endEnvelope(),sforce.debug.trace&&(sforce.debug.log("Request: server- "+f),sforce.debug.logXml(i.toString())),(new sforce.SoapTransport).send(f,i,c,d)},sforce.QueryResultIterator=function(a){this.queryResult=a,this.index=0,this.records=this.queryResult.getArray("records")},sforce.QueryResultIterator.prototype.hasNext=function(){return this.records.length>this.index||(null!==this.queryResult.queryLocator&&(this.queryResult=sforce.connection.queryMore(this.queryResult.queryLocator),this.records=this.queryResult.getArray("records"),this.index=0),this.records.length>this.index)},sforce.QueryResultIterator.prototype.next=function(){if(this.records.length>this.index){var a=this.records[this.index];return this.index++,a}throw"Index out of bound : "+this.index},sforce.Email=function(){},sforce.Email.prototype=new sforce.Xml("messages"),sforce.MassEmailMessage=function(){},sforce.MassEmailMessage.prototype=new sforce.Xml("messages"),sforce.MassEmailMessage.prototype._xsiType="MassEmailMessage",sforce.SingleEmailMessage=function(){},sforce.SingleEmailMessage.prototype=new sforce.Xml("messages"),sforce.SingleEmailMessage.prototype._xsiType="SingleEmailMessage",sforce.ProcessRequest=function(){},sforce.ProcessRequest.prototype=new sforce.Xml("actions"),sforce.ProcessSubmitRequest=function(){},sforce.ProcessSubmitRequest.prototype=new sforce.Xml("actions"),sforce.ProcessSubmitRequest.prototype._xsiType="ProcessSubmitRequest",sforce.ProcessWorkitemRequest=function(){},sforce.ProcessWorkitemRequest.prototype=new sforce.Xml("actions"),sforce.ProcessWorkitemRequest.prototype._xsiType="ProcessWorkitemRequest",sforce.connection=new sforce.Connection;var UserContext="undefined"!=typeof window.UserContext?window.UserContext:{siteUrlPrefix:"",getUrl:function(a){return void 0!==a&&"undefined"!=typeof UserContext.siteUrlPrefix&&UserContext.siteUrlPrefix?0!=a.indexOf("/")?a:0==a.indexOf(UserContext.siteUrlPrefix)?a:UserContext.siteUrlPrefix+a:a}};"undefined"!=typeof __sfdcSiteUrlPrefix&&(UserContext.siteUrlPrefix=__sfdcSiteUrlPrefix),sforce.connection.serverUrl="undefined"!=typeof window.UserContext?UserContext.getUrl("/services/Soap/u/41.0"):"/services/Soap/u/41.0","undefined"!=typeof __sfdcSessionId&&(sforce.connection.sessionId=__sfdcSessionId),window.Sfdc&&Sfdc.xdomain&&window.location.hostname.indexOf(".visual.force.")>-1&&(sforce._consoleApiUrl="/support/console/35.0/integration.js",setTimeout(function(){skuid.load.js(sforce._consoleApiUrl)},0)),function(){var a;try{a=!!new Blob}catch(b){}a?(skuid.utils||(skuid.utils={}),skuid.utils.saveAs=skuid.utils.saveAs||function(a){if(!(void 0===a||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var b=a.document,c=function(){return a.URL||a.webkitURL||a},d=b.createElementNS("http://www.w3.org/1999/xhtml","a"),e="download"in d,f=function(a){var b;try{b=new MouseEvent("click")}catch(b){b=document.createEvent("MouseEvent"),b.initEvent("click",!0,!1)}a.dispatchEvent(b)},g=/constructor/i.test(a.HTMLElement)||a.safari,h=/CriOS\/[\d]+/.test(navigator.userAgent),i=function(b){(a.setImmediate||a.setTimeout)(function(){throw b},0)},j=function(a){var b=function(){"string"==typeof a?c().revokeObjectURL(a):a.remove()};setTimeout(b,4e4)},k=function(a,b,c){b=[].concat(b);for(var d=b.length;d--;){var e=a["on"+b[d]];if("function"==typeof e)try{e.call(a,c||a)}catch(f){i(f)}}},l=function(a){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),a],{type:a.type}):a},m=function(b,i,m){m||(b=l(b));var n,o=this,p=b.type,q="application/octet-stream"===p,r=function(){k(o,"writestart progress write writeend".split(" "))};if(o.readyState=o.INIT,e)return n=c().createObjectURL(b),void setTimeout(function(){d.href=n,d.download=i,f(d),r(),j(n),o.readyState=o.DONE});!function(){if((h||q&&g)&&a.FileReader){var d=new FileReader;return d.onloadend=function(){var b=h?d.result:d.result.replace(/^data:[^;]*;/,"data:attachment/file;");a.open(b,"_blank")||(a.location.href=b),b=undefined,o.readyState=o.DONE,r()},d.readAsDataURL(b),void(o.readyState=o.INIT)}if(n||(n=c().createObjectURL(b)),q)a.location.href=n;else{a.open(n,"_blank")||(a.location.href=n)}o.readyState=o.DONE,r(),j(n)}()},n=m.prototype,o=function(a,b,c){return new m(a,b||a.name||"download",c)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(a,b,c){return b=b||a.name||"download",c||(a=l(a)),navigator.msSaveOrOpenBlob(a,b)}:(n.abort=function(){},n.readyState=n.INIT=0,n.WRITING=1,n.DONE=2,n.error=n.onwritestart=n.onprogress=n.onwrite=n.onabort=n.onerror=n.onwriteend=null,o)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content),"undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs})):(skuid.utils||(skuid.utils={}),skuid.utils.saveAs=function(){})}()}!function(a){a.version={date:"1523547789",major:11,minor:1,patch:7,number:"11.1.7",name:"Millau (11.1.7)"}}(skuid),function(a){var b={ADDRESS:"ADDRESS",ANYTYPE:"ANYTYPE",ARRAY:"ARRAY",BASE64:"BASE64",BOOLEAN:"BOOLEAN",BUTTONGROUP:"BUTTONGROUP",COMBOBOX:"COMBOBOX",CURRENCY:"CURRENCY",CUSTOM:"CUSTOM",DATE:"DATE",DATETIME:"DATETIME",DOUBLE:"DOUBLE",EMAIL:"EMAIL",ENCRYPTEDSTRING:"ENCRYPTEDSTRING",FORMULA:"FORMULA",ID:"ID",IMAGE:"IMAGE",INTEGER:"INTEGER",LOCATION:"LOCATION",MULTIBUTTONGROUP:"MULTIBUTTONGROUP",MULTIPICKLIST:"MULTIPICKLIST",NUMBER:"NUMBER",OBJECT:"OBJECT",PHONE:"PHONE",PICKLIST:"PICKLIST",PERCENT:"PERCENT",REFERENCE:"REFERENCE",STRING:"STRING",TEXT:"TEXT",TEXTAREA:"TEXTAREA",RICHTEXT:"RICHTEXT",TIME:"TIME",URL:"URL",UUID:"UUID"},c={CHILDREL:"CHILDREL",COMBO:"COMBO",FILE:"FILE",IMAGE:"IMAGE"},d={BOOLEAN:"boolean",NUMBER:"number",STRING:"string",OBJECT:"object",FUNCTION:"function",UNDEFINED:"undefined"},e={JSON:"application/json",ZIP:"application/zip",FORM_URL_ENCODED:"application/x-www-form-urlencoded"},f={GET:"GET",PATCH:"PATCH",POST:"POST",PUT:"PUT",DELETE:"DELETE",MERGE:"MERGE"},g={GLOBAL:"global",MODEL:"model",ROW:"row"},h=["font-awesome","foundation-icons","icons8-win10","ionicons","material-icons"],i={"font-awesome":"Font Awesome 4","foundation-icons":"Foundation","icons8-win10":"Icons8 Windows 10",ink:"Ink",ionicons:"Ion","material-icons":"Material"},j={SEARCH_CONDITION:"__default_searchbox",GLOBAL_SEARCH_CONDITION:"search"},k={REUSABLE:"reusable",EVENT_TRIGGERED:"event-triggered",VOICE_COMMAND:"voice-command"},l={COMPONENT:"component",MODEL:"model",PAGE:"page",SKUID:"skuid",GLOBAL:"global"},m={medium:1024,small:480},n={NOW:"NOW",YESTERDAY:"YESTERDAY",TODAY:"TODAY",TOMORROW:"TOMORROW",LAST_90_DAYS:"LAST_90_DAYS",NEXT_90_DAYS:"NEXT_90_DAYS",LAST_N_DAYS:"LAST_N_DAYS",NEXT_N_DAYS:"NEXT_N_DAYS",N_DAYS_AGO:"N_DAYS_AGO",LAST_WEEK:"LAST_WEEK",THIS_WEEK:"THIS_WEEK",NEXT_WEEK:"NEXT_WEEK",LAST_N_WEEKS:"LAST_N_WEEKS",NEXT_N_WEEKS:"NEXT_N_WEEKS",N_WEEKS_AGO:"N_WEEKS_AGO",LAST_MONTH:"LAST_MONTH",THIS_MONTH:"THIS_MONTH",NEXT_MONTH:"NEXT_MONTH",LAST_N_MONTHS:"LAST_N_MONTHS",NEXT_N_MONTHS:"NEXT_N_MONTHS",N_MONTHS_AGO:"N_MONTHS_AGO",LAST_QUARTER:"LAST_QUARTER",THIS_QUARTER:"THIS_QUARTER",NEXT_QUARTER:"NEXT_QUARTER",LAST_N_QUARTERS:"LAST_N_QUARTERS",NEXT_N_QUARTERS:"NEXT_N_QUARTERS",N_QUARTERS_AGO:"N_QUARTERS_AGO",LAST_YEAR:"LAST_YEAR",THIS_YEAR:"THIS_YEAR",NEXT_YEAR:"NEXT_YEAR",LAST_N_YEARS:"LAST_N_YEARS",NEXT_N_YEARS:"NEXT_N_YEARS",N_YEARS_AGO:"N_YEARS_AGO"},o={DEV:"development",PROD:"production",TEST:"test"},p={DIRECTION:{"x-axis":"row","y-axis":"column",auto:null},ALIGNMENT:{top:"flex-start",middle:"center",bottom:"flex-end",stretch:"stretch",baseline:"baseline",auto:"auto"},JUSTIFY:{left:"flex-start",center:"center",right:"flex-end",justify:"space-between",spaced:"space-around",auto:null}},q={ERROR:"error",WARNING:"warning",INFO:"info"},r={SUM:"sum",AVERAGE:"avg",MAXIMUM:"max",MINIMUM:"min",MEDIAN:"med",COUNT:"count"};a.constants={ACTION_SEQUENCE_TYPES:k,DISPLAY_TYPES:b,ENVIRONMENTS:o,EVENT_SCOPES:l,FIELD_TYPES:c,HTTP_VERBS:f,LOG_LEVELS:q,MERGE_CONTEXTS:g,MEDIA_QUERY_BREAKPOINTS:m,JS_TYPES:d,MIME_TYPES:e,DATASOURCE:j,WEB_ICON_SET_PREFIXES:h,WEB_ICON_SET_LABELS:i,DATE_KEYWORDS:n,FLEX:p,LOCAL:"local",SALESFORCE:"salesforce",NATIVE:"skuid-platform",VISUALFORCE:"visualforce",LIGHTNING:"lightning",AGGREGATION_TYPES:r,DATE_STORAGE_FORMAT:"YYYY-MM-DD"}}(skuid),function(a,b,c){function d(a,b){b=b||{};var c=this,d=b.primaryKey;c.name=a,c.primaryKey=d?{id:d.id,displayType:d.displayType||p,defaultValue:d.defaultValue||""}:{id:"id",displayType:p,defaultValue:""},c.indexes=b.indexes||[],i.each(c.indexes,function(a,b){if(!b.defaultValue)switch(b.type){case p:b.defaultValue="";break;case q:b.defaultValue=[];break;case r:b.defaultValue=0}}),b.expires&&(c.indexes.push({id:"expires",displayType:r,defaultValue:-1}),c.expires=b.expires),
b.expiresDate&&(c.expiresDate=b.expiresDate),b.isDefault&&(c.isDefault=b.isDefault),b.buildRow&&(c.buildRow=b.buildRow),b.buildIdField&&(c.buildIdField=b.buildIdField)}function e(a,b){var c=this;i.each(b,function(a,b){b.isDefault&&(c.defaultTableName=a)}),c.hasInitialized=!1,c.name=a,c.schema=b,c.tables={}}function f(a){a=a||{};var b=this,c=a.schema;b.name=a.tableName,b.databaseName=a.databaseName,b.isDefault=a.isDefault,b.schema=c,c.buildRow&&(b.buildRow=c.buildRow),b.primaryKey=c.primaryKey,b.indexes=c.indexes}function g(a,b){var c=this;i.each(b,function(a,b){b.isDefault&&(c.defaultTableName=a)}),c.hasInitialized=!1,c.name=a,c.schema=b,c.tables={}}function h(a){a=a||{};var b=this,c=a.schema;b.name=a.tableName,b.databaseName=a.databaseName,b.isDefault=a.isDefault,b.schema=c,c.buildRow&&(b.buildRow=c.buildRow),b.primaryKey=c.primaryKey,b.indexes=c.indexes}var i=a.$,j=a.utils,k=a.storage={},l={},m={},n=b,o={STRING:"string",ARRAY:"array",INTEGER:"integer"},p=o.STRING,q=o.ARRAY,r=o.INTEGER,s=n?"IndexedDB":"LocalStorage",t=function(){var a=new Date;return a.setDate(a.getDate()+7),a.getTime()},u=[{name:"pages",indexes:[{id:"name"}],expires:!0,expiresDate:t,buildRow:function(a){return i.extend(a,{id:a.id,name:a.name,data:a.data})}},{name:"entityData",expires:!0,expiresDate:t,buildIdField:function(a){var b,c=a.dataSource.name,d=a.data,e=a.objectName,f=d.fields&&d.fields.length?w(d.fields):"null",g=d.orderByClause?d.orderByClause.replace(" ",""):"null";return f||(f="null"),a.conditions&&a.conditions.length&&(b=x(a.conditions,d.conditionLogic)),b=b||"null",c+"--"+e+"--"+b+"--"+f+"--"+g},buildRow:function(a){var b,c=j.isString(a.dataSource)?a.dataSource:a.dataSource.name,d=a.data,e=a.objectName;return a.conditions&&a.conditions.length&&(b=x(a.conditions,d.conditionLogic)),i.extend(a,{id:this.buildIdField(a),data:a.data,dataSource:c,objectName:e,conditions:b,fields:d.fields,recordsLimit:a.data.recordsLimit,orderBy:d.orderByClause})}},{name:"entityMetadata",expires:!0,expiresDate:t,buildIdField:function(a){var b=a.data,c=a.dataSource.name,d=a.objectName,e=b.fields&&b.fields.length&&w(b.fields);return c+"--"+d+(e?"--"+e:"")},buildRow:function(a){var b=a.data,c=a.dataSource.name;return i.extend(a,{id:this.buildIdField(a),dataSource:c,objectName:a.objectName,data:b})}},{name:"dataSourceMetadata",expires:!0,expiresDate:t,buildRow:function(a){return i.extend(a,{id:a.dataSource.name,data:a.data})}},{name:"queries",expires:!0,expiresDate:t,buildRow:function(a){return i.extend(a,{id:a.id,data:a.data})}},{name:"saves",expires:!0,expiresDate:t,buildRow:function(a){return i.extend(a,{id:a.id,data:a.data})}}],v=function(a){try{a=JSON.parse(JSON.stringify(a))}catch(b){}return a},w=function(a){var b=i.map(a,function(a){return a.id}),c=[];return i.each(b,function(a,b){b.indexOf(".")>-1&&-1===i.inArray(b.split(".")[0],c)&&c.push(b.split(".")[0])}),b=b.concat(c),i.map(b,function(b){var c=a.find(function(a){return a.id===b});if(i.isArray(c)&&(c=c[0]),!c||!c.idField&&!c.uiOnly)return b}).sort().join(",")},x=function(a,b){return(b?b+"_":"")+i.map(a,function(a){var b,c="",d=a.encloseValueInQuotes;if(b=a.values&&a.values.length?a.values.join(","):d?"'"+a.value+"'":a.value,!a.inactive)return a.name?c+=a.name:a.field?c+=a.field:"param"===a.sourceType&&(c+=a.sourceParam),c+=a.operator+(b||"")}).sort().join("&")},y=function(a){var b=i.Deferred();return i.when(a).then(function(a){b.resolve(a)})["catch"](function(a){b.reject(a)}),b.promise()},z=function(a,b){var c={},d=b.schema,e=i.map(a.tables,function(a){return a.toArray().then(function(b){c[a.name]=b})});return i.when.all(e).then(function(){return a["delete"]()}).then(function(){var c={};return i.each(d,function(a,b){var d,e=b.primaryKey.id;b.indexes&&(d=i.map(b.indexes,function(a){return a.id}).join(",")),c[a]=e,d&&(c[a]+=","+d)}),a=new n(b.name),a.version(.1).stores(c),a.open()}).then(function(){var b=[];return i.each(a.tables,function(e,f){var g=i.Deferred(),h=c[f.name],j=f.name;if(b.push(g.promise()),!h||!h.length)return void g.resolve();i.each(d[j].indexes,function(a,b){var c=b.id;i.each(h,function(a,d){d[c]||(d[c]=b.defaultValue)})}),a.table(j).bulkAdd(h).then(function(){g.resolve()})}),i.when.all(b)}).then(function(){return a})},A=function(a,b,d){var e=a+":"+b,f=JSON.parse(c.getItem(e)),g=d(f);return c.setItem(e,JSON.stringify(f)),i.when(g)};n&&delete window.Dexie,i.extend(e.prototype,{getName:function(){return this.name},getSchema:function(){return this.schema},initialize:function(){var a=this,b=i.Deferred(),c=a.name,d=a.schema,e={},g=new n(c);return g.open().then(function(){for(var c=g.tables,e=!1,f=0;f<c.length;f++){var h=c[f],k=h.name,l=h.schema,m=d[k];if(!m){e=!0;break}if(0===j.size(m.indexes)&&l.indexes.length>0){e=!0;break}if(j.size(m.indexes)>0&&0===l.indexes.length){e=!0;break}if(l.primKey.name!==m.primaryKey.id){e=!0;break}if(l.indexes.length&&i.each(l.indexes,function(a,b){-1===m.indexes.findIndex(function(a){return b.name===a.id})&&(e=!0)}),e)break}e?z(g,a).then(function(a){g=a,b.resolve()}):b.resolve()})["catch"](function(f){["Database "+c+" doesnt exist","UnknownError"].includes(f.message)?(a.version=1,i.each(d,function(a,b){var c,d=b.primaryKey.id;b.indexes&&(c=i.map(b.indexes,function(a){return a.id}).join(",")),e[a]=d,c&&(e[a]+=","+c)}),g.version(.1).stores(e),g.open().then(function(){b.resolve()})["catch"](function(a){b.reject("Open failed: "+a.message)})):b.reject("Database creation failed: "+f.message)}),i.when(b).then(function(){return l[c]=g,i.each(g.tables,function(b,c){a[c.name]=a.tables[c.name]=new f({table:c,tableName:c.name,databaseName:g.name,isDefault:c.name===a.defaultTableName,schema:a.schema[c.name]})}),a.hasInitialized=!0,a})},getTable:function(a){var b=this,c=b.tables[a];return c||b.tables[b.defaultTableName]},getTables:function(){return this.tables},remove:function(){var a=this,b=a.getName(),c=i.Deferred(),d=l[b];return d?(d["delete"]().then(function(){delete l[b],c.resolve()})["catch"](function(a){c.reject(a)}),c.promise()):i.when()}}),i.extend(f.prototype,{get:function(a,b){var c=this,d=l[c.databaseName],e=c.getPrimaryKey(),f=e.id;return a?(j.isObject(a)&&c.schema.buildIdField&&(a=c.schema.buildIdField(a)),d.open(),y(d.table(c.name).where(b||f).equals(a).first())):j.reject()},add:function(a,b){var c=this,d=c.schema,e=l[c.databaseName],f=c.getPrimaryKey(),g=f.id,h={};return b&&(a||d.buildIdField)?(a||(a=d.buildIdField(b)),b=d.buildRow?d.buildRow(b):b,d.expires&&j.isUndefined(b.expires)&&(d.expiresDate?b.expires=d.expiresDate():b.expires=-1),b[g]=a,h=b.alreadyTransferable?b:v(b),delete h.alreadyTransferable,e.open(),y(e.table(c.name).put(h)).then(function(){return h})):j.reject()},remove:function(a){var b=this,c=l[b.databaseName],d=b.getPrimaryKey(),e=d.id;return a?(c.open(),y(c.table(b.name).where(e).equals(a)["delete"]().then(function(){return a}))):j.reject()},clear:function(){var a=this,b=l[a.databaseName];return b.open(),y(b.table(a.name).clear())},all:function(){var a=this,b=l[a.databaseName];return b.open(),y(b.table(a.name).toArray())},each:function(a){var b=this,c=l[b.databaseName],d=[];return c.open(),y(c.table(b.name).each(function(b){var c=a(b);j.isUndefined(c)||d.push(c)})).then(function(){return d})},clean:function(){var a=this,b=[],c=new Date,d=c.getTime();return a.each(function(a){if((0!==a.expires||-1!==a.expires)&&a.expires<d)return a}).then(function(c){var d=i.Deferred();b.push(d.promise()),i.each(c,function(b,c){d.resolve(a.remove(c[a.getPrimaryKey().id]))})}),i.when.all(b)},getPrimaryKey:function(){return this.primaryKey},getIndexes:function(){return this.indexes}}),i.extend(g.prototype,{getName:function(){return this.name},getSchema:function(){return this.schema},initialize:function(){var a=this,b=a.name,d=a.schema;return i.each(d,function(a){var d=b+":"+a,e=c.getItem(d);e&&"{}"!==e?c.setItem(d,e):c.setItem(d,"{}")}),i.each(a.schema,function(c,d){a[c]=a.tables[c]=new h({table:d,tableName:c,databaseName:b,isDefault:c===a.defaultTableName,schema:d})}),a.hasInitialized=!0,j.resolve(a)},getTable:function(a){var b=this,c=b.tables[a];return c||b.tables[b.defaultTableName]},getTables:function(){return this.tables},remove:function(){var a=this,b=a.getName(),d=a.getTables();return i.each(d,function(a,d){c.removeItem(b+":"+d.name)}),i.when()}}),i.extend(h.prototype,{get:function(a,b){var c=this;return a?(j.isObject(a)&&c.schema.buildIdField&&(a=c.schema.buildIdField(a)),A(c.databaseName,c.name,function(c){if(j.size(c))return b?i.map(c,function(c){if(c[b]===a)return c})[0]:c[a]})):j.reject()},add:function(a,b){var c=this,d=c.schema,e=c.getPrimaryKey(),f=e.id,g={};return b&&(a||d.buildIdField)?(a||(a=d.buildIdField(b)),b=d.buildRow?d.buildRow(b):b,d.expires&&j.isUndefined(b.expires)&&(d.expiresDate?b.expires=d.expiresDate():b.expires=-1),b[f]=a,g=b.alreadyTransferable?b:v(b),delete g.alreadyTransferable,A(c.databaseName,c.name,function(a){var b=g[f];return a[b]=g,a[b]})):j.reject()},remove:function(a){var b=this;return a?A(b.databaseName,b.name,function(b){return delete b[a],a}):j.reject()},clear:function(){var a=this;return A(a.databaseName,a.name,function(a){return{}})},all:function(){var a=this;return A(a.databaseName,a.name,function(a){return i.map(a,function(a){return a})})},each:function(a){var b=this;return A(b.databaseName,b.name,function(b){var c=[];return i.each(b,function(b,d){var e=a(d);e&&c.push(e)}),c})},clean:function(){var a=this,b=[],c=new Date,d=c.getTime();return a.each(function(a){if((0!==a.expires||-1!==a.expires)&&a.expires<d)return a}).then(function(c){var d=i.Deferred();b.push(d.promise()),i.each(c,function(b,c){d.resolve(a.remove(c[a.getPrimaryKey().id]))})}),i.when.all(b)},getPrimaryKey:function(){return this.primaryKey},getIndexes:function(){return this.indexes}}),i.extend(k,{LocalStorageDatabase:g,IndexedDBDatabase:e,createDb:function(a,b,c){var f,h=this,k={};if(i.each(c,function(a,b){var c=b.name;k[c]=new d(c,b)}),"LocalStorage"===b)f=new g(a,k);else{if("IndexedDB"!==b)return j.reject("Invalid database type.  Options are 'IndexedDB' and 'LocalStorage'");f=new e(a,k)}return f.initialize().then(function(){return j.size(h.databases)||(h.defaultDatabaseName=a),m[a]=f,f})},getDb:function(a){return m[a]},getDbs:function(){return m},removeDb:function(a){var b=m,c=b[a];return c?c.remove().then(function(){delete b[a]}):j.resolve()},initialize:function(){var a=j.runningTests()?"Skuid_Test":"Skuid";return k.createDb(a,s,u).then(function(a){k.tables=a.getTables()})}})}(skuid,window.Dexie,window.localStorage),function(a,b){function c(c){this.themeSettingsMap=c,this.colors={};var d=this.colors;c.palette&&b.each(c.palette,function(b,c){d[b]=new a.themes.Color(c)})}var d,e=a.themeSettings={},f=a.utils;e.load=function(e){d=new c(b.extend({},a.utils.parseAsJSONIfString(e))),a.events.publish("ui.themeSettings.loaded")},e.getAll=function(){return d&&d.getAll()},e.getColor=function(a,b){return d.getColor(a,b)},e.getToken=function(a,b){return d.getToken(a,b)},e.getShadow=function(a){return(d.getToken("shadow",a)||[]).map(function(a){return a.x+" "+a.y+" "+a.blur+" "+a.spread+" "+a.color+(a.inset?" inset":"")}).join(", ")},c.prototype.getAll=function(){return this.themeSettingsMap},c.prototype.getColor=function(a,b){return this.colors[a]&&this.colors[a].getTone(b)},c.prototype.getToken=function(a,b){return f.getObjectProperty(this.themeSettingsMap,"tokens."+a+"."+b)||""}}(skuid,skuid.$),function(a,b,c){function d(){return a.utils}function e(){return i.fontsloaded}function f(a){return d().startsWith(a,j)}function g(e){e===c&&(e={});var g=d().size,h=d().getSafeRelativeUrl,i=b.extend({},e),k=i.custom,l=d().inPlatform(a.constants.LIGHTNING);return k!==c&&(l&&k.localurls&&k.localurls.length&&(k.localurls.forEach(function(a,b){k.urls[b]=a}),delete k.localurls),k.urls&&k.urls.length&&k.urls.forEach(function(b,c){var d=b;d=f(b)?a.platform.getResourceUrl({name:"Fonts",ns:"skuid",path:b.substring(j.length),modstamp:a.version?a.version.date:null}):h(b),k.urls[c]=d}),g(k)&&k.families!==c&&k.families.length||delete i.custom),k=i.google,k!==c&&(g(k)&&k.families!==c&&k.families.length||delete i.google),k=i.typekit,k!==c&&(g(k)&&k.id!==c&&"string"==typeof k.id||delete i.typekit),i}function h(c){function e(){var b=window.sforce,c=b&&b._consoleApiUrl,d=function(){a.events.publish("ui.fontsloaded")};i.fontsloaded=!0,c?a.load.js(c).always(function(){d()}):d()}c=d().parseAsJSONIfString(c);var f,g,h,j=i.processFontConfig(c&&c.fontConfig),k=c?c.cssResources:null,l=d().getSafeRelativeUrl,m=b("link#themeLink")[0];if(j.custom||j.google||j.typekit?(j.active=e,j.inactive=e,i.attemptedToLoadFonts=!0,WebFont.load(j)):e(),k)for(g=0;g<k.length;g++)f=k[g],h=null,d().isString(f)?h=f:"static"===f.type?(h=a.platform.themeBuilder.getThemeResourceUrl(f),b("body").find('link[href="'+h.substring(h.indexOf("force.com")).replace("force.com","")+'"]').remove()):h=f.url||f.path,h&&d().loadCSS(l(h),{insertAfter:m})}var i=a.webfonts={attemptedToLoadFonts:!1,fontsloaded:!1},j="/resource/skuid__Fonts/";b.extend(i,{haveFontsLoaded:e,load:h,processFontConfig:g})}(skuid,skuid.$),function(a,b){b.fn.skootip=function(c,d){var e,f=this,g={position:{my:"center bottom",at:"center top-10",collision:"fit",using:function(a,c){b(this).css({top:a.top,left:a.left});var d=a.left+c.element.width/2,f=c.target.left+c.target.width/2;e=Math.floor(f-d-4)}},show:{delay:700},open:function(a,c){var d=b("<div>").addClass("sk-hastooltip").css("left",e+"px");c.tooltip.append(d)}};return c&&f.attr("title",c),d&&b.extend(!0,g,d),a.utils._oniOS()?f:f.tooltip(g)}}(skuid,skuid.$),function(a,b){function c(){return t.ingestConstructorArguments.apply(window,arguments)}function d(a,b,d,e){c(this,{name:a,label:b},{parameters:d,metadata:e})}function e(a,b,d,e){c(this,{name:a,label:b,displayType:d},{metadata:e}),this.displayType=this.displayType.toUpperCase()}function f(a,b,d,e){c(this,{eventService:a,topic:b},{callback:d,channel:e}),this.id=""+t.generateGUID()}function g(){function c(){return r+"-"+t++}function d(a){p[a]=1,setTimeout(function(){delete p[a]},5)}function e(a){return!!p[a]}function g(a,b,c){n[a]||(n[a]=[]);var d=c&&c.channel,e=new f(q,a,b,d);return n[a].push(e),e}function h(f,g,h){function i(){if(p){if(e(p))return;d(p)}if(j=[],g&&(b.isArray(g)?Array.prototype.push.apply(j,g):j.push(g)),j.push({uniqueId:p}),n[f]&&n[f].length&&b.each(n[f].slice(0),function(a,b){var c=b.getCallback(),d=b.getChannel();!c||d&&d!==l||c.apply(window,j)}),m===s.GLOBAL&&a.platform&&a.platform.publishEvent){var c={};l&&(c.channel=l),a.platform.publishEvent(f,j,c)}}h||(h={}),h.buffer&&!o[f]?o[f]={interval:h.buffer}:!1===h.buffer&&o[f]&&delete o[f];var j,k=o[f],l=h.channel,m=h.scope,p=h.uniqueId,q=n[f]&&n[f].length,r=a.platform&&a.platform.publishEvent&&m===s.GLOBAL;(q||r||k)&&(p||(p=h.uniqueId=c()),k?(!k.initialCallTime||(new Date).getTime()-k.initialCallTime>k.interval)&&(setTimeout(i,k.interval),k.initialCallTime=(new Date).getTime()):i())}function i(a,c,d){return a instanceof Array?b.map(a,function(a){return g(a,c,d)}):g(a,c,d)}function j(a,c,d){var e=c?null:b.Deferred(),f=i(a,function(){l(f),c?c.apply(b,arguments):e.resolve.apply(b,arguments)},d);return c?f:e.promise()}function k(a){var b,c=a.getTopic(),d=a.getId(),e=n[c];if(e&&e.length){for(b=e.length-1;b>=0;b--)if(e[b].getId()===d){e.splice(b,1);break}e.length||delete n[c]}}function l(a){b.isArray(a)?a.forEach(k):k(a)}function m(a){function b(a){var b=n[a];return b&&b.length?b.length:0}if(a)return b(a);var c={};for(a in n)c[a]=b(a);return c}var n={},o={},p={},q=function(){},r=Date.now()+"-"+u++,t=2;return b.extend(q,{count:m,publish:h,subscribe:i,subscribeOnce:j,unsubscribe:l}),q}function h(a,b){var c,d=b||a;return b?(c=r[a])?c[d]:void 0:q[d]}function i(a){return b.map(a,function(a){return a}).sort(function(a,b){return a.getLabel()>b.getLabel()})}function j(){return i(q)}function k(a){if(a){var c=r[a];return c?i(c):[]}var d={};return b.each(r,function(a,b){d[a]=i(b)}),d}function l(a){if(!(a instanceof d))throw"Expected an instance of skuid.event.Event";var b=a.getName();q[b]||(q[b]=a)}function m(a,b){if(!(b instanceof d))throw"Expected an instance of skuid.event.Event";var c=b.getName(),e=r[a];e||(e=r[a]={}),e[c]||(e[c]=b,b.setComponentType(a))}function n(a){b.isArray(a)?a.forEach(l):t.isUndefined(a)||l(a)}function o(a,c){b.isArray(c)?c.forEach(function(b){m(a,b)}):m(a,c)}var p,q={},r={},s=a.constants.EVENT_SCOPES,t=a.utils,u=2;d.prototype={getName:function(){var a=this.getComponentType();return a?a.type+"."+this.name:this.name},getLabel:function(){var a=this.getComponentType();return a?(a.label||a.type)+": "+this.label:this.label},getParam:function(a){var b=this.parameters,c=0;if(b)for(;c<b.length;c++)if(b[c].getName()===a)return b[c]},getParameters:function(){return this.parameters||[]},getScope:function(){if(this.metadata&&this.metadata.scope)return this.metadata.scope},isSubscribable:function(){return!this.metadata||!1!==this.metadata.subscribable},isComponentEvent:function(){return!!this._cmpType},getComponentType:function(){if(this._cmpType)return a.componentType.get(this._cmpType)},setComponentType:function(b){if(!a.componentType.get(b))throw"Invalid Component Type: "+b;return this._cmpType=b,this}},e.prototype={getName:function(){return this.name},getLabel:function(){return this.label},getDisplayType:function(){return this.displayType},getMetadata:function(){return this.metadata}},f.prototype={getCallback:function(){return this.callback},getChannel:function(){return this.channel},getId:function(){return this.id},getTopic:function(){return this.topic},unsubscribe:function(){this.eventService.unsubscribe(this)}},p=new g,a.events={Event:d,EventParameter:e,EventService:g,get:h,getRegisteredGlobalEvents:j,getRegisteredComponentEvents:k,register:n,registerComponentEvents:o,count:p.count,publish:p.publish,subscribe:p.subscribe,subscribeOnce:p.subscribeOnce,unsubscribe:p.unsubscribe}}(skuid,skuid.$),function(a,b){function c(){return a.utils}function d(a,c){var d=a[c],e=i[a];e||(e=i[d]={}),b.extend(e,a)}function e(d){var e={},f={};return b.each(d,function(d,g){var h,k=g.objectType,l=g.dataSourceName,m=g.idField,n=g.fields,o=g.records,p=e[d]={};b.each(o,function(e,g){var o,q={},r={},s=0,t={};b.each(n,function(a,b){r[b]=1,s++}),s&&(o=i[g],o&&b.each(r,function(a){var b=c().getObjectProperty(o,a);c().isUndefined(b)||(t[a]=b,delete r[a],s--)}),s&&(b.each(a.model.list(),function(a,d){if(d.data&&d.data.length&&(d.objectName===k&&(o=d.getRowById(g))&&b.each(r,function(a){a in o&&(t[a]=d.getFieldValue(o,a,!0),delete r[a],s--)}),s)){var e={},f=d.fields;f&&f.length&&b.each(f,function(a,c){var d=c.referenceTo;c.displaytype===j&&d&&d.length&&b.each(d,function(a,b){if(b.objectName===k)return e[c.id]=c.rel,!1})}),c().size(e)&&b.each(e,function(a,e){if(b.each(d.data,function(d,f){if(c().getObjectProperty(f,a)===g&&(b.each(r,function(a){var b=c().getObjectProperty(f,e+"."+a);c().isUndefined(b)||(t[a]=b,delete r[a],s--)}),!s))return!1}),!s)return!1})}}),s&&(h=f[k],h||(h=f[d]={objectType:k,dataSourceName:l,idField:m,fields:{},records:[]}),h.records.push(g),h.fields[m]=1,b.each(r,function(a){h.fields[a]=1})))),b.extend(q,t),p[g]={record:q,isDone:0===s}})}),{data:e,serverRequests:f}}function f(a){var b=e(a);return c().size(b.serverRequests)?null:b.data}function g(f){var g,h,i=e(f),j=i.serverRequests,m=i.data;return c().size(j)?(g=k++,h=b.map(j,function(d){var e=new a.model.Model({conditions:[{field:d.idField,operator:"IN",type:"multiple",values:d.records}],dataSource:a.dataSource.get(d.dataSourceName),doClone:!1,doQuery:!0,fields:b.map(d.fields,function(a,b){return{id:b}}),id:"data_req_"+c().generateGUID(),objectName:d.objectType,recordsLimit:d.records.length});return e.calloutIterator=g,e.lastSuccessfulCallout=function(){return l},e}),j={},a.model.load(h).then(function(){return b.each(h,function(a,c){var e=c.getIdField(),f=c.getKeyPrefix(),g=m[f];b.each(c.data,function(a,c){"attributes"in c&&delete c.attributes;var f=c[e],h=g[f];h||(h=g[f]={}),b.extend(h,c),h.isDone=!0,d(c,e)})}),l=h[0].lastSuccessfulCallout,m})):b.Deferred().resolve(m)}var h=a.data={},i={},j=a.constants.DISPLAY_TYPES.REFERENCE,k=0,l=0;h.get=g,h.getSync=f,h.add=d,h.localStorage=window.localStorage,h.sessionStorage=window.sessionStorage}(skuid,skuid.$),function(a,b){function c(a){g[f]=a}function d(){return g[f]}function e(b,c){var d=Array.prototype.slice.call(arguments,2);return a.$.Deferred(function(e){d.push(function(b,c){c.status?e.resolve(a.utils.parseAsJSONIfString(b)):e.reject(c.message)}),d.push({escape:!1}),b[c].apply(null,d)})}var f="_cls",g=a.remote=function(){var c,d=a.utils.getObjectProperty,e=g[f],h=d(window,e),i=d(window,"skuid.RemotingStubs");return"skuid.RemotingStubs"!==e?(c=i||{},h&&b.extend(c,h)):c=h||i,c};c("skuid.RemotingStubs"),g.set=c,g.get=d,g.promisify=e}(skuid,skuid.$),function(a,b){function c(a){return"[object Date]"===Object.prototype.toString.call(a)}function d(a){P=a}function e(){var b=window.Intl&&window.Intl.DateTimeFormat&&window.Intl.DateTimeFormat();return b&&(b=b.resolved?b.resolved.timeZone:b.resolvedOptions?b.resolvedOptions().timeZone:null),!b&&a[R]&&(b=a[R].tz.guess()),b}function f(b,c){if(S(b))throw"A valid TimeZone Id is required.";var d,f=M,g=P,h=e(),i=!1,j=!S(c)&&g!==c||f!==b,k=function(){var d=a[R];Q=!S(d),M=b,P=d?d.tz.zone(M).offset(new Date):S(c)?P:c},l=a.utils,m=l.resolve;return j?(i=S(h)?O!==c:h!==b,d=i&&!a[R]?l.loadJS(l.getStaticResourceUrl("MomentJS","skuid",null,l.getCacheTimestamp())):m(),d.then(function(){return k(),a.events.publish("ui.timeZoneChanged",[{oldTimeZone:f,newTimeZone:b}]),{changed:!0}})["catch"](function(){throw"Unable to load information for timezone."})):m({changed:!1})}function g(){var c,d=a.utils;return c=a[R]?b.Deferred().resolve():d.loadJS(d.getStaticResourceUrl("MomentJS","skuid",null,d.getCacheTimestamp())),c.then(function(){h(),a.events.subscribe("skuid.settings.modified:userLocale",h)})["catch"](function(){throw"Unable to initialize moment locale information."}),c.promise()}function h(){var b=function(b){return a.settings.get("userLocale",b)};a[R].updateLocale("sk-user-locale",{months:b("monthNames"),monthsShort:b("monthNamesShort"),weekdays:b("dayNames"),weekdaysShort:b("dayNamesShort"),weekdaysMin:b("dayNamesMin"),meridiem:function(a){return a<12?b("amPm")[0]:b("amPm")[1]}})}function i(){return M}function j(a){if(!a)return!1;if(c(a))return a;var b=a.split&&a.split("T"),d=b&&b.length&&b[0].split("-");return!(!d||3!==d.length)&&new Date(d[0],d[1]-1,d[2])}function k(b){if(b){if(c(b)){var d=b.getMonth()-0+1+"",e=b.getDate()+"";return 1===d.length&&(d="0"+d),1===e.length&&(e="0"+e),b.getFullYear()+"-"+d+"-"+e}return a.utils.isString(b)&&3===b.split("-").length?b:null}return null}function l(b){if(!b)return"";var c;return c=a.utils.isDate(b)?k(b):b,1===c.split(" ").length?n(j(c)):m(j(c))}function m(a){return n(u(a))}function n(c){return c?b.datepicker.formatDate(a.utils.userLocale.dateFormat,c):""}function o(a){return q(a)}function p(b){var c=a.utils;if(!b&&0!==b)return!1;var d,e=Date.parse,f=[1,4,5,6,7,10,11],g=0;if(d=T.exec(b)){for(var h,i=0;h=f[i];++i)d[h]=+d[h]||0;return d[2]=(+d[2]||1)-1,d[3]=+d[3]||1,"Z"===d[8]||c.isUndefined(d[9])||(g=60*d[10]+d[11],"+"===d[9]&&(g=0-g)),Date.UTC(d[1],d[2],d[3],d[4],d[5]+g,d[6],d[7])}return c.isString(b)&&-1!==b.split(":")[0].indexOf("N_")?NaN:e?e(b):NaN}function q(a){if(c(a))return a;var b=p(a);return!isNaN(b)&&!1!==b&&new Date(b)}function r(b){return b&&"function"==typeof b.toISOString?b.toISOString():b&&a.utils.isString(b)?b:null}function s(b){return Q?a[R].tz.zone(M).offset(b):P}function t(b){return Q?a[R].tz.zone(e()).offset(b):O}function u(a){if(!a)return!1;var b=a.getTime(),c=new Date(b);return c.setMinutes(c.getMinutes()-(s(b)-t(b))),c}function v(a){if(!a)return!1;var b=a.getTime(),c=new Date(b);return c.setMinutes(a.getMinutes()+(s(b)-t(b))),c}function w(b){if(b){var d=c(b)?b:q(b),e=u(d),f=a.utils.userLocale;if(e)return f.showTimeBeforeDate?y(f.timeFormat,e)+" "+n(e):n(e)+" "+y(f.timeFormat,e)}return""}function x(d,e){if(void 0!==e&&void 0!==d){var f,g,h=a.utils.isString;return h(e)&&!h(d)&&c(d)?(f=d,g=e):(h(e)&&(e=q(e)),f=e,g=d),b.datepicker.formatDate(g,f)}return""}function y(b,c){if(!c&&0!==c)return"";a.utils.isString(c)&&(c=q(c));var d,e=function(a){var c=d+1<b.length&&b.charAt(d+1)===a;return c&&d++,c},f=function(a){return a.getHours()%12},g=function(a,b,c){var d=""+b;if(e(a))for(;d.length<c;)d="0"+d;return d},h="",i=!1;if(c)for(d=0;d<b.length;d++)if(i)"'"!==b.charAt(d)||e("'")?h+=b.charAt(d):i=!1;else switch(b.charAt(d)){case"a":h+=A(c);break;case"h":var j=f(c);0===j&&(j=12),h+=g("h",j,2);break;case"K":h+=g("h",f(c),2);break;case"k":h+=g("k",c.getHours()+1,2);break;case"H":h+=g("H",c.getHours(),2);break;case"m":h+=g("m",c.getMinutes(),2);break;case"s":h+=g("s",c.getSeconds(),2);break;case"S":h+=g("S",c.getMilliseconds(),3);break;case"Z":var k=t(c),l=Math.floor(Math.abs(k)/60),m=Math.abs(k)-60*l;l<10&&(l="0"+l),m<10&&(m="0"+m),h+=(k<0?"+":"-")+l+m;break;case"'":e("'")?h+="'":i=!0;break;default:h+=b.charAt(d)}return h}function z(b,c){var d,e,f=a.utils,g=f.isUndefined;return b||0===b?(f.isString(b)?(e=(d=T.exec(b))&&!g(d[3])&&g(d[4]),(b=e?j(b):q(b))&&!e&&(b=u(b))):f.isNumber(b)&&(b=new Date(b)),b&&f.isDate(b)?(c&&(b=Date.prototype[c].call(b)),b):null):null}function A(b){var c=a.time.amPm,d=z(b,"getHours");return null!==d?d>11?c[1]:c[0]:null}function B(a){var b=z(a,"getMonth");return null!==b?1+b:null}function C(a){var b=z(a,"getUTCMonth");return null!==b?1+b:null}function D(b){var c=z(b,"getMonth");return null!==c?a.time.monthNames[c]:null}function E(b){var c=z(b,"getMonth");return null!==c?a.time.monthNamesShort[c]:null}function F(a){var b=z(a,"getDay");return null!==b?1+b:null}function G(a){var b=z(a,"getUTCDay");return null!==b?1+b:null}function H(b){var c=z(b,"getDay");return null!==c?a.time.dayNames[c]:null}function I(b){var c=z(b,"getDay");return null!==c?a.time.dayNamesShort[c]:null}function J(a,b,c){b=b||{},c=c||{};var d,e,f=b.years||0,g=b.quarters||0,h=(b.months||0)+3*g,i=b.weeks||0,j=b.days||0,k=(b.hours||0)+24*j+168*i,l=b.minutes||0,m=b.seconds||0,n=b.milliseconds||0,o=c.baseDate,p=c.useDeviceTimezone;switch(e=o?new Date(o.getTime()):p?new Date:u(new Date),a){case U:e.setMonth(0);case V:e.setMonth(e.getMonth()-e.getMonth()%3);case W:e.setDate(1);case Y:e.setHours(0);case Z:e.setMinutes(0);case $:e.setSeconds(0);case _:e.setMilliseconds(0);break;case X:e.setHours(-24*e.getDay()),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)}return f&&e.setFullYear(e.getFullYear()+f),h&&(d=(e.getMonth()+h)%12,e.setMonth(e.getMonth()+h),e.getMonth()>d&&e.setDate(-e.getDate())),k&&e.setHours(e.getHours()+k),l&&e.setMinutes(e.getMinutes()+l),m&&e.setSeconds(e.getSeconds()+m),n&&e.setMilliseconds(e.getMilliseconds()+n),o||p||(e=v(e)),e}function K(a){if("string"!=typeof a||0===a.length)return a;var c,d,e,f=J,g=function(a){return f(Y,a)},h=function(a){return f(X,a)},i=function(a){return f(W,a)},j=function(a){return f(V,a)},k=function(a){return f(U,a)};switch(a=a.split(":"),b.isNumeric(a[1])&&(e=parseInt(a[1])),a[0]){case ba:c=d=new Date;break;case ca:c=g({days:-1}),d=g();break;case da:c=g(),d=g({days:1});break;case ea:c=g({days:1}),d=g({days:2});break;case fa:c=g({days:-90}),d=g();break;case ga:c=g({days:1}),d=g({days:91});break;case ha:if(!e)return a;c=g({days:-e}),d=g();break;case ia:if(!e)return a;c=g({days:1}),d=g({days:e+1});break;case ja:if(!e)return a;c=g({days:-e}),d=g({days:1-e});break;case ka:c=h({weeks:-1}),d=h();break;case la:c=h(),d=h({weeks:1});break;case ma:c=h({weeks:1}),d=h({weeks:2});break;case na:if(!e)return a;c=h({weeks:-e}),d=h();break;case oa:if(!e)return a;c=h({weeks:1}),d=h({weeks:1+e});break;case pa:if(!e)return a;c=h({weeks:-e}),d=h({weeks:1-e});break;case qa:c=i({months:-1}),d=i();break;case ra:c=i(),d=i({months:1});break;case sa:c=i({months:1}),d=i({months:2});break;case ta:if(!e)return a;c=i({months:-e}),d=i();break;case ua:if(!e)return a;c=i({months:1}),d=i({months:1+e});break;case va:if(!e)return a;c=i({months:-e}),d=i({months:1-e});break;case wa:c=j({quarters:-1}),d=j();break;case xa:c=j(),d=j({quarters:1});break;case ya:c=j({quarters:1}),d=j({quarters:2});break;case za:if(!e)return a;c=j({quarters:-e}),d=j();break;case Aa:if(!e)return a;c=j({quarters:1}),d=j({quarters:1+e});break;case Ba:if(!e)return a;c=j({quarters:-e}),d=j({quarters:1-e});break;case Ca:c=k({years:-1}),d=k();break;case Da:c=k(),d=k({years:1});break;case Ea:c=k({years:1}),d=k({years:2});break;case Fa:if(!e)return a;c=k({years:-e}),d=k();break;case Ga:if(!e)return a;c=k({years:1}),d=k({years:1+e});break;case Ha:if(!e)return a;c=k({years:-e}),d=k({years:1-e});break;default:return a[0]}return[c,d]}function L(){var a=new Date;return a.setMilliseconds(0),a}var M,N=a.time={},O=(new Date).getTimezoneOffset(),P=(new Date).getTimezoneOffset(),Q=!1,R="moment",S=function(a){return a===undefined},T=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::?(\d{2}))?)?)?$/;Date.prototype.toISOString||function(){function a(a){return a<10?"0"+a:a}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),b.each({getYear:"getFullYear",getDay:"getDate",getHour:"getHours",getMinute:"getMinutes",getSecond:"getSeconds",getMillisecond:"getMilliseconds",getUTCYear:"getUTCFullYear",getUTCDay:"getUTCDate",getUTCHour:"getUTCHours",getUTCMinute:"getUTCMinutes",getUTCSecond:"getUTCSeconds"},function(a,b){N[a]=function(a){return z(a,b)}});var U="YEAR",V="QUARTER",W="MONTH",X="WEEK",Y="DAY",Z="HOUR",$="MINUTE",_="SECOND",aa=a.constants.DATE_KEYWORDS,ba=aa.NOW,ca=aa.YESTERDAY,da=aa.TODAY,ea=aa.TOMORROW,fa=aa.LAST_90_DAYS,ga=aa.NEXT_90_DAYS,ha=aa.LAST_N_DAYS,ia=aa.NEXT_N_DAYS,ja=aa.N_DAYS_AGO,ka=aa.LAST_WEEK,la=aa.THIS_WEEK,ma=aa.NEXT_WEEK,na=aa.LAST_N_WEEKS,oa=aa.NEXT_N_WEEKS,pa=aa.N_WEEKS_AGO,qa=aa.LAST_MONTH,ra=aa.THIS_MONTH,sa=aa.NEXT_MONTH,ta=aa.LAST_N_MONTHS,ua=aa.NEXT_N_MONTHS,va=aa.N_MONTHS_AGO,wa=aa.LAST_QUARTER,xa=aa.THIS_QUARTER,ya=aa.NEXT_QUARTER,za=aa.LAST_N_QUARTERS,Aa=aa.NEXT_N_QUARTERS,Ba=aa.N_QUARTERS_AGO,Ca=aa.LAST_YEAR,Da=aa.THIS_YEAR,Ea=aa.NEXT_YEAR,Fa=aa.LAST_N_YEARS,Ga=aa.NEXT_N_YEARS,Ha=aa.N_YEARS_AGO;b.extend(N,{formatDate:x,formatTime:y,getAnchoredDate:J,getDayName:H,getDayNameShort:I,getDayOfWeek:F,getLocalDateTime:u,getMonth:B,getMonthName:D,getMonthNameShort:E,getParseDateTimeResult:p,getPeriod:A,getRealJSDateTimeFromLocal:v,getSFDate:k,getSFDateTime:r,getUTCDayOfWeek:G,getUTCMonth:C,makeFormattedDate:l,makeFormattedDateFromJS:m,makeFormattedDateFromLocal:n,makeFormattedLongDateTime:w,parseDateString:q,parseDateTimeString:q,parseSFDate:j,parseSFDateTime:o,resolveDateKeyword:K,roundedNow:L,initializeMomentLocale:g,setUserTimeZone:f,getUserTimeZone:i,getDeviceTimeZone:e,setUserTimeZoneOffset:d})}(skuid,skuid.$),function(a,b){function c(a){b.extend(j,a)}function d(a,b){return a in j?j[a]:-1===a.indexOf("__")&&"skuid__"+a in j?j["skuid__"+a]:b||""}function e(c,e,f){var g=a.label.parse(c,e,f),h=g[0],i=g[1],j="";return b(i).each(function(a){j+=this;var b=h[a];b&&(j+=d(b.substring(b.indexOf(".")+1,b.length-1)))}),j}function f(c){var d="string"==typeof c,e=d?c:c.template,f=(d?Array.prototype.slice.call(arguments,1):c.data)||[],g=c&&c.leftMerge,h=c&&c.rightMerge,i=a.label.parse(e,g,h),j=i[0],k=i[1],l="";return b(k).each(function(a){l+=this;var b=j[a];b&&(l+=f[b.substring(1,b.length-1)])}),l}function g(a,b,c){b||(b="{"),c||(c="}");var d=b+"__"+c,e=d in k?k[d]:k[d]=new RegExp("\\"+b+"[^"+b+"\\"+c+"]+\\"+c,"g");return[a.match(e)||[],a.split(e)]}function h(){return j}var i=a.label={},j={},k={};b.extend(i,{add:c,read:d,labelize:e,merge:f,parse:g,getAll:h,map:j}),a.$L=d}(skuid,skuid.$),function(a){function b(){return g.conversionRates||[]}function c(a){var b=h[a];return b||"$"}function d(a,b){b||(b={})
;var d,e,h,i=g.userLocale,j=g.userInfo.defaultCurrency,k=b.decimalPlaces||0,l=b.decimalsSeparator||i.decimalsSeparator||".",m=b.thousandsSeparator||i.thousandsSeparator||",",n=b.recordCurrency;return a||0===a||(a=""),e=a,""!==a&&(e=f.number(a,k,l,m),g.isMultiCurrencyOrganization?(e=n+" "+e,n&&n!=j&&(d=g.convertCurrency(a,n,j))&&d!=a&&(e+=" ("+j+" "+f.number(d,k,l,m)+")")):(h=c(j),h.match(/^(\$?[a-zA-Z\.\/]+\$?)/)&&(h+=" "),e=h+e)),e}var e=a.currency={},f=a.$,g=a.utils,h={AED:".",AFN:"",ALL:"Lek",AMD:"",AOA:"Kz",ARS:"$",AWG:"f",AUD:"$",BSD:"$",BBD:"$",BYR:"p.",BZD:"BZ$",BMD:"$",BOB:"$b",BAM:"KM",BWP:"P",BRL:"R$",BND:"$",BDT:"",BGN:"",BHD:"..",BIF:"Fr",BOV:"-",BRB:"",BTN:"Nu.",CAD:"$",KYD:"$",CLP:"$",CNY:"",COP:"$",CRC:"c",HRK:"kn",CZK:"Kc",CDF:"Fr",CLF:"UF",CUP:"$",CVE:"Esc",DKK:"kr",DOP:"RD$",DJF:"Fr",DZD:".",ERN:"Nfk",ETB:"Br",XCD:"$",EGP:"",SVC:"$",EEK:"kr",EUR:"",FKP:"",FJD:"$",GBP:"",GHC:"c",GIP:"",GTQ:"Q",GGP:"",GYD:"$",GEL:"",GHS:"",GMD:"D",GNF:"Fr",HTG:"G",HNL:"L",HKD:"$",HUF:"Ft",ISK:"kr",IDR:"Rp",IMP:"",ILS:"",INR:"",IQD:".",IRR:"",JMD:"J$",JPY:"",JEP:"",JOD:".",KES:"Sh",KGS:"",KHR:"",KMF:"Fr",KPW:"",KRW:"",KWD:".",KZT:"",LAK:"",LKR:"",LSL:"L",LYD:".",LVL:"Ls",LBP:"",LRD:"$",LTL:"Lt",MYR:"RM",MXN:"$",MZN:"MT",MAD:". .",MDL:"L",MGA:"Ar",MKD:"",MMK:"Ks",MNT:"",MOP:"P",MRO:"UM",MUR:"",MVR:".",MWK:"MK",MXV:"$",NGN:"",NPR:"",NAD:"$",ANG:"f",NZD:"$",NIO:"C$",NOK:"kr",OMR:"..",PGK:"K",PHP:"",PKR:"",PAB:"B/.",PYG:"Gs",PEN:"S/.",PLN:"zl",QAR:".",RSD:".",RUB:"",RWF:"Fr",RON:"lei",SHP:"",SGD:"$",SBD:"$",SOS:"S",ZAR:"R",SEK:"kr",CHF:"CHF",SRD:"$",SYP:"",SAR:".",SCR:"",SDG:"..",SLL:"Le",SSP:"",STD:"Db",SZL:"L",THB:"",TJS:"",TMT:"m",TND:".",TOP:"T$",TZS:"Sh",TWD:"NT$",TTD:"TT$",TRY:"TL",TRL:"",TVD:"$",USD:"$",UYU:"$U",UAH:"",UGX:"Sh",UZS:"",VND:"",VUV:"Vt",VEF:"Bs",WST:"T",XAF:"Fr",XOF:"Fr",XPF:"Fr",YER:"",ZMK:"ZK",ZWL:"Z$",ZWD:"Z$"};f.extend(e,{getConversionRates:b,getDisplayValue:d,getSymbol:c})}(skuid),function(a){function b(a,b){e[a]=b}function c(a){delete e[a]}function d(a){return e[a]}var e={};a.snippet={registerSnippet:b,register:b,getSnippet:d,get:d,unregister:c}}(skuid),function(a,b){function c(b,c){j[b]=c,c.type=b,c.styleSettings&&(c.styleSettingsVariants={"default":c.styleSettings}),c.styleSettingsVariants&&c.styleSettingsVariants["default"]&&(c.getStyles||c.styles)&&a.themes.registerComponentTypeStyles(c),c.events&&a.events.registerComponentEvents(b,c.events)}function d(c){c&&(a.utils.isString(c)&&c in j?(a.themes.unregisterComponentTypeStyles(c),delete j[c]):c instanceof Array&&b.each(c,function(b,d){d&&d in j&&(a.themes.unregisterComponentTypeStyles(c),delete j[d])}))}function e(a){if(a)return j[a]}function f(){return b.map(j,function(a){return a})}function g(){return j}function h(){return Object.keys(j)}var i=a.componentType={},j={};b.extend(i,{get:e,register:c,unregister:d,list:f,map:g,getAll:h})}(skuid,skuid.$),function(a,b){function c(c,d){var e=[],f=c.is("conditions")?c.children():c.children("conditions").first().children(),g=c.attr("rowid");if(f){var h,i,j;d&&(j=d.model,i=d.rows,h=d.row||i&&i.length&&i[0]||null),f.each(function(){var c=new a.model.Condition(b(this)),d=c.mergeField;if("contextrow"==c.type){var f=g;!f&&h&&j&&(f=j.getFieldValue(h,d,!0)),f&&(c.value=f)}else"contextrows"==c.type&&j&&i&&i.length&&(c.values=i.map(function(a){return j.getFieldValue(a,d,!0)}));e.push(c)})}return e}function d(a){var b=a.type();!b||b in q||(q[b]=[]),q[b].push(a),p[a.id()]=a}function e(a){if(a){var b=q[a];return b||{}}return q}function f(){return b.map(p,function(a){return a})}function g(a){return p[a]}function h(c,d,e,f){var g,h,i,k;if(1==arguments.length){var m=arguments[0];c=m.element,d=m.xmlDefinition||m.definition,e=m.type||d&&d.componentType,g=m.context,f=m.options,h=m.state}if(f||(f={}),!e&&!d)throw"Either a Component Type or XML Definition must be provided.";if(c?c.jquery||(c=b(c)):c=b("<div>"),d&&(d instanceof a.$||n.isString(d)||d instanceof Element?(n.isString(d)&&(d=n.makeXMLDoc(d)),d.jquery||(d=b(d)),d.length&&(d=d.first()),e||(e=d.prop("tagName")),d.attr("uniqueid")&&(f.uniqueId=d.attr("uniqueid")),d.attr("cssclass")&&c.addClass(d.attr("cssclass"))):d.uniqueId=f.uniqueId=d.uniqueId||n.generateUniqueId()),i=a.componentType.get(e)){var o,p,q,s=new j(c,e,b.extend(f,{state:h})),t=i.schema;return d&&(d instanceof b?(s.xmlDefinition=s.definition=d,o=d.attr(s.modelAttributeName()),t&&(d=s.definition=l.parseXML(d[0],t))):t&&(d=s.definition=l.processJSDefinition(d,t)),d instanceof b&&("skuidpage"!==e||!a.createPageStylesTEMPORARY)||(d.context=g||d.context,d.uniqueId||(d.uniqueId=s._GUID),k=d.projector,k||"skuidpage"===e||(d.projector=a.virtualDom.createProjector()),s.set(d),s._classMap=a.themes.getThemedClassMapForComponent(s))),o&&(p=a.$M(o)),p&&(q=p.loadAsync),f.ignoreConditionalRendering?s.render({context:g,xmlDefinition:d}):s.conditionallyRender({context:g,xmlDefinition:d}),!k&&d&&d.projector&&(i.appendToProjector?d.projector.append(c[0],s.renderVDom,s):d.projector.merge(c[0],s.renderVDom,s)),q&&!s.onlyRenderOnce&&s.needsModelMetadata()&&p.subscribeOnce("loaded.async",function(){s.rerender()}),s}return r(e)}function i(a,c,d,e,f){var g=[],i=[];f=f||{};var k=f.parentComponent;return b.each(a,function(a){var b=k&&k.get&&k.get("projector"),c=k&&k.get&&k.get("uniqueId");b&&(this.projector=b),c&&(this.attr?this.attr("uniqueId",this.attr("uniqueId")||c+"__"+(k.childComponents.length+a)):this.uniqueId=this.uniqueId=this.uniqueId||c+"__"+(k.childComponents.length+a));var f=h({definition:this,context:d,state:e});f&&f instanceof j&&(f.element&&i.push(f.element),g.push(f))}),c&&(c.append(i),b.each(i,function(){b(this).trigger("attach")})),g}function j(c,e,f){f||(f={});var g,h=this,i=a.componentType.get(e),j=i.cpi;j&&((g=i._cpiKeys)||(g=i._cpiKeys=Object.keys(j))),f.state&&b.extend(h,f.state),h.element=c,h._componentType=e,h._GUID=f.uniqueId||c.prop("id")||n.generateUniqueId(),h._shortcuts={},h[v]=new m.EventService,h[w]={},h[t]={},h[u]=[],h[s]=[],h.isRendered=!1,c.prop("id")!==h._GUID&&c.prop("id",h._GUID),c.attr("data-rendered","false").data({rendered:!1,component:h}),h._cpi={},g&&g.forEach(function(a){h._cpi[a]=function(){return j[a].apply(h,arguments)}}),d(h)}var k=b(document.body),l=a.component={},m=a.events,n=a.utils,o=a.constants,p={},q={},r=function(a){return"There is no Skuid Component Type called '"+a+"'"},s="childComponents",t="_skuidComponentEventProperties",u="_skuidComponentEventSubscriptions",v="_eventService",w="_skuidProperties",x=o.EVENT_SCOPES,y=o.LOG_LEVELS,z=y.WARNING,A=y.ERROR;j.prototype={id:function(){return this._GUID},getId:function(){return this.id()},type:function(){return this._componentType},getType:function(){return this.type()},setType:function(a){return this._componentType=a,this},_getCPI:function(){return this._cpi},getCPI:function(){var b=this._cpi,c=n.grab(a.componentType.get(this.type()),"schema","access","cpi","public"),d={};return c&&c.length&&c.forEach(function(a){d[a]=b[a]}),d},getElement:function(){return this.element},getPersonalizationService:function(){var b="_personalizationService",c=this[b];return c||(c=this[b]=a.personalization.createComponentService(this)),c},setParentPageId:function(a){var b=this;return b._parentPageId=a,b},getParentPage:function(){return p[this.getParentPageId()]},getParentPageId:function(){var a,b,c,d=this,e=d._parentPageId||this[w].parentPageId;return e||(this[w].parentPageId=function(){if((c=q.skuidpage)&&1===c.length)return c[0].id();if(a=d.getParentComponentId(),a&&p[a]&&(b=d.getParentComponent())&&(e=b.getParentPageId()),e)return e;var f=d.element.parent().closest(".nx-page");return f.length&&f.data("component")?f.data("component").id():c[0].id()}())},setParentComponentId:function(a){var b=this;return b._parentComponentId=a,b},getParentComponent:function(){return p[this.getParentComponentId()]},getParentComponentId:function(){return this._parentComponentId},getStyledClasses:function(b){return a.themes.getClasses(b,this._classMap)},getChildStyleVariantHandle:function(a,b){return this.getType()+"--"+this.get("styleSettingsVariant")+"__"+a+"--"+b+(this.get("styles")?"--"+this.get("uniqueId"):"")},render:function(b){function c(){g.isBeingRendered=!1,g.set("rendered",!0),g.isRendered=!0,g.element.attr("data-rendered","true").data("rendered",!0),g.publish("rendered",!0)}function d(b){g.isBeingRendered=!1,g.set("rendered",!1),g.isRendered=!1,g.element.attr("data-rendered","false").data("rendered",!1);var c,d=b&&b.message?b.message:b;a.utils.isString(d)&&(d="There was a problem rendering a component of type "+g.getType()+": "+d),c=a.component.getByType("skuidpage"),"skuidpage"===g.getType()?g.addProblem(d):c&&c.length&&c[0].addProblem(d),g.publish("rendered",!1),n.log(d,A)}var e,f,g=this,h=g.getType(),i=a.componentType.get(h);if(b||(b={}),!i)return r(h);if(b.context&&(g.context=b.context),b.xmlDefinition?g.xmlDefinition=g.definition=e=b.xmlDefinition:e=g.xmlDefinition,g.element.empty&&i&&!i.onlyRenderOnce&&!1!==i.emptyBeforeRender&&g.element.empty(),g.get("enableConditions")&&a.utils.conditionallyDo(function(){g.set("disabled",!1)},function(){g.set("disabled",!0)},g.get("enableConditions"),g.element),g.get("selectedConditions")&&a.utils.conditionallyDo(function(){g.set("selected",!0)},function(){g.set("selected",!1)},g.get("selectedConditions"),g.element),!g.isBeingRendered&&(!g.isRendered||g.isRendered&&!i.onlyRenderOnce)){g.isBeingRendered=!0;var j;switch(typeof i){case"function":j=i;break;case"object":if("render"in i){j=i.render;break}default:throw"Invalid Component Type definition. Component Type must be a JavaScript Object with a render() method."}try{f=j.call(i,g.element,e,g)}catch(k){d(k)}f&&a.utils.isPromise(f)?f.then(c,d):c()}return g},unrender:function(){var c=this,d=c.getType(),e=a.componentType.get(d);return"function"==typeof c.beforeUnrender&&c.beforeUnrender(),c.element.data&&b.each(c.element.data(),function(a,b){"component"!==a&&"object"!==a&&b&&"object"==typeof b&&b.widget&&b.widget._destroy&&b.widget._destroy()}),c.unsubscribeAll(),c.unregisterChildComponents(),c.element.empty&&e&&!e.onlyRenderOnce?c.element.removeAttr("style").empty():e&&e.onlyRenderOnce&&c.xmlDefinition.attr("domid")&&k.append(c.element.children().hide().detach()),c.element.attr("data-rendered","false").data("rendered",!1),c.set("rendered",!1),c.isRendered=!1,c.publish("rendered",!1),"function"==typeof c.afterUnrender&&c.afterUnrender(),c},rerender:function(){return this.unrender().render()},unregisterChildComponents:function(){var a=this,b=a[s];return b.forEach(function(a){n.removeEventSubscriptions(a.element),a.unregister&&a.unregister()}),b.length=0,a},conditionallyRender:function(b){var c=this;return c.get("renderConditions")&&a.componentType.get(c.type())&&a.componentType.get(c.type()).renderVDom?(c.render(b),n.conditionallyDo(function(){c.set("show",!0),m.publish("ui.reflow",[{component:c}])},function(){c.set("show",!1),m.publish("ui.reflow",[{component:c}])},c.get("renderConditions"),c.element)):n.conditionallyRender(function(a,d,e,f){c.render(b),f&&f.eventSubscriptions&&(c._crEventSubscriptions=(c._crEventSubscriptions||[]).concat(f.eventSubscriptions)),m.publish("ui.reflow",[{component:c}])},function(){m.publish("ui.reflow",[{component:c}]),c.unrender()},c.xmlDefinition,c.element,c._GUID,b),c},_markAsDirty:function(){this._dirty=!0,this.getParentComponent()&&this.getParentComponent()._markAsDirty()},_markAsClean:function(){this._dirty=!1},_isDirty:function(){return this._dirty},_makeTooltip:function(a,c){var d=c.definition.tooltip,e=c.definition.context,f=d[0].nodeName?d.attr():d[0],g=f.text,h=b.extend({},f,{context:e});return n.ink.createTooltipOnHover(a,g,h,c)},_applyInteractions:function(c,d){if(!1!==d.get("autoApplyInteractions")){var e=b(d.definition.interactions);a.interactions.disableInteractions(b(c)),a.interactions.enableInteractions(b(c),{interactionsDef:e,component:d})}},_afterCreate:function(a,b){var c=b.definition.interactions,d=b.definition.tooltip;d&&d.length&&b._makeTooltip(a,b),c&&c.length&&b._applyInteractions(a,b)},scheduleVirtualRender:function(){var a=this.get("projector");a&&(this._markAsDirty(),a.scheduleRender())},renderVDom:function(){var c=this,d=c.getType(),e=a.componentType.get(d);if(c._isDirty()||!c._VNodeCache){if(e&&e.renderVDom&&!1!==c.get("show")){if(c._VNodeCache=e.renderVDom(c),c._VNodeCache.properties||(c._VNodeCache.properties={}),c.definition.styles&&c.definition.styles.spacing&&(c._VNodeCache.properties.styles||(c._VNodeCache.properties.styles={}),b.extend(c._VNodeCache.properties.styles,c.definition.styles.spacing)),(c.definition.tooltip||c.definition.interactions)&&!c.get("_afterCreateCreated")){var f=c._VNodeCache.properties.afterCreate;c.set("_afterCreateCreated",!0,{renderOnChange:!1}),c._VNodeCache.properties.afterCreate=function(){c._afterCreate.apply(this,[arguments[0],c]),f&&f.apply(this,arguments)}}}else c._VNodeCache=a.virtualDom.hyperScript(c.get("rootElementTag")||"div",{key:c.get("uniqueId")+"-empty",allowFunctionUpdating:!0,classes:{},styles:{}});c._markAsClean()}return c._VNodeCache},createConditionsFromXml:function(b,d){var e=this,f=b||e.xmlDefinition,g=e.element,h=d&&d.context||e&&e.context,i=[];if(i=c(f,h),g){var j=f.attr("controllingcomponent")||e._controllingComponent;j&&(g.controllingComponent=a.component.getById(j)),g.conditions=i}return i},addProblem:function(a){var c=this;b(function(){var b=c.getParentPage(),d=c._GUID;!b||b.id()===d&&d||b.addProblem(a)})},addProblems:function(a){var c=this;b(function(){var b=c.getParentPage(),d=c._GUID;!b||b.id()===d&&d||b.addProblems(a)})},unregister:function(c){c=b.extend({removeElement:!0},c);var d,e=this,f=e.getType(),g=a.componentType.get(f),h=q[f];e.id()in p&&delete p[e.id()],d=b.inArray(e,h),-1!==d&&h.splice(d,1),e.unregisterChildComponents({removeElement:!1}),["_crEventSubscriptions",u].forEach(function(a){var b=e[a];b&&b.length&&b.forEach(function(a){a.unsubscribe()})}),g&&g.onlyRenderOnce&&e.xmlDefinition.attr("domid")&&k.append(e.element.children().hide().detach()),c.removeElement&&this.element.remove(),this.get("styleNode")&&this.get("styleNode").remove()},createChildComponent:function(a,b,c,d){return this.createChildComponents([a],b,c,d)[0]},createChildComponents:function(a,b,c,d){d||(d={}),d._parentComponentId=this._GUID,d._parentPageId=d._parentPageId||this._parentPageId||this.getParentPageId();var e=i(a,b,c,d,{parentComponent:this});return Array.prototype.push.apply(this[s],e),e},getChildComponents:function(){return this[s]},getChildComponent:function(a){var b=this.getChildComponents().filter(function(b){return b.getId()===a});return b.length>0?b[0]:null},modelAttributeName:function(){return"model"},needsModelMetadata:function(){return!1},get:function(a){return n.getObjectProperty(this[w],a)},has:function(a){return n.hasObjectProperty(this[w],a)},set:function(a,b,c){var d,e=this[w],f=this,g=this.getState(),h=n.setObjectProperty;return"string"!=typeof a?(c=b||{},Object.keys(a).forEach(function(b){var i=a[b];d=g[b],h(e,b,i),d!==i&&(f.publish("stateChange:"+b,Array.isArray(i)?[i]:i,{scope:x.COMPONENT,provideDefaultData:!1}),!1!==c.renderOnChange&&f.scheduleVirtualRender())})):(c=c||{},d=f.get(a),h(e,a,b),d!==b&&(f.publish("stateChange:"+a,Array.isArray(b)?[b]:b,{scope:x.COMPONENT,provideDefaultData:!1}),!1!==c.renderOnChange&&f.scheduleVirtualRender())),this},getState:function(){return this[w]},unset:function(){var a=this[w];return Array.prototype.forEach.call(arguments,function(c){c&&b.isArray(c)?c.forEach(function(b){n.unsetObjectProperty(a,b)}):n.unsetObjectProperty(a,c)}),this},bind:function(a,b,c){var d=this;c=c||a,d.set(a,d.get(a)||b.get(c)),b.set(c,d.get(a)||b.get(c)),d.subscribeChange(a,function(a){b.set(c,a)}),b.subscribeChange(c,function(b){d.set(a,b)})},bindMultiple:function(a,b){var c=this;a.forEach(function(a){c.bind(a,b)})},subscribeChange:function(a,b){return this.subscribe("stateChange:"+a,b)},storeSubscription:function(a){return this[u].push(a),this},publish:function(a,c,d){d||(d={});var e,f,g=d.channel,h=this.getType(),i=!1!==d.qualifyEventName,j=i?h+"."+a:a,k="skuidpage"===h&&!this.isInclude,l=k?null:this.getParentPage(),o=this[v],p=n.rfc4122v4GUID(),q={scope:x.COMPONENT,uniqueId:p},r={uniqueId:p};return n.isUndefined(c)&&!1!==d.provideDefaultData&&(c={component:this}),e=b.isArray(c)?c:[c],f=d&&d.scope?d.scope:x.PAGE,r.scope=f,g&&(r.channel=g,q.channel=g),n.setObjectProperty(this[t],a,c),o.publish(a,e,q),f!==x.COMPONENT&&(!k&&l&&l.publish(j,e,q),f!==x.SKUID&&f!==x.GLOBAL||m.publish(j,e,r)),this},subscribe:function(a,b,c){var d,e={scope:x.COMPONENT};return c&&c.channel&&(e.channel=c.channel),d=this[v].subscribe(a,b,e),this.storeSubscription(d),d},subscribeToPageEvent:function(a,b,c){var d,e={scope:x.PAGE};return c&&c.channel&&(e.channel=c.channel),d=this.getParentPage().subscribe(a,b,e),this.storeSubscription(d),d},unsubscribe:function(a){for(var b=this[u],c=b.length-1,d=this[v];c>=0;c--)if(b[c].id===a.id){b.splice(c,1),d.unsubscribe(a);break}return this},countEventSubscribers:function(a){return this[v].count(a)},once:function(a,c,d){var e,f=b.Deferred(),g=this[t],h=!(d&&!1===d.cache),i=n.getObjectProperty(g,a),j=this,k=this[v],l=function(a){c&&c(j,a),f.resolve(j,a)};return h&&i?l(i):(e=k.subscribeOnce(a,function(b){n.setObjectProperty(g,a,b),l(b)}),this.storeSubscription(e)),f.promise()},subscribeOnce:function(a,b){return this.once(a,b,{cache:!1})},unsubscribeAll:function(){var a=this[u];return a.length&&(a.forEach(function(a){a.unsubscribe()}),a.length=0),this},shortcut:function(a){var b=this,c=this._shortcuts[a];return c||(c=this._shortcuts[a]=function(){return b[a].apply(b,arguments)}),c}},b.extend(l,{Component:j,createConditionsFromXml:c,getByType:e,getAll:f,getById:g,factory:h,register:d,createChildComponents:function(){return n.log('"skuid.component.createChildComponents" is deprecated. Use the skuid.component.Component instance method instead: https://docs.skuid.com/latest/en/skuid/api/skuid_component.html#skuid.component.createChildComponents',z),i.apply(null,arguments)}}),a.$C=g}(skuid,skuid.$),function(a){function b(b,c){"string"==typeof c&&(c=a.componentType.get(c).schema),"node"===f&&c.schema&&(c=a.componentType.get(c.schema).schema),c=i.extend(!0,{},{_:{alreadyExtended:!0},attributes:j.attributes,properties:j.properties},c);var f="array"===c.type?"array":"node";switch(f){case"array":return e(b,c);case"node":return d(b,c);default:return{}}}function c(b,c){var d,e;if(b!==undefined){switch(c.type){case"number":if(b=parseFloat(b),isNaN(b))throw'Invalid component definition: "'+b+'" is not a number';return b;case"date":if(b=b?a.moment(b):a.moment(),!b.isValid())throw'Invalid component definition: "'+b+'" must be a valid ISO Date string: https://www.w3.org/TR/NOTE-datetime';return b;case"boolean":if("true"===b||!0===b)return!0;if("false"===b||!1===b)return!1;throw'Invalid component definition: "'+b+'" is not a boolean';case"model":if(d=b instanceof a.model.Model?b:a.$M(b))return d;throw'Invalid component definition: model "'+b+'" does not exist';case"picklist":if(!c.options||!c.options.length)throw'Schema attributes of type "picklist" must have an "options" property filled with an array of potential values';if(-1===c.options.indexOf(b))throw'Invalid component definition: "'+b+"' is not a valid value for this attribute";return b;case"multipicklist":if(!c.options||!c.options.length)throw'Schema attributes of type "multipicklist" must have an "options" property filled with an array of potential values';return e=i.isArray(b)?b:b.split(c.delimiter||","),e.forEach(function(a){if(-1===c.options.indexOf(a))throw'Invalid component definition: "'+a+"' is not a valid value for this attribute"}),e;case"object":return b}return b}}function d(d,e){var f,j,m,n,o,p,q,r={_:{tagName:d.tagName}},s=i(d).children(),t=a.utils.isUndefined,u=d.attributes,v=e.properties||{},w=e.attributes||{},x=e.nodes||{};for(0===s.length&&d.textContent&&(r._.textContent=d.textContent),i.each(w,function(a){t(r[a])&&!t(this["default"])&&(r[a]=this["default"])}),m=0;m<u.length;m++){if(p=u[m],o=p.name,n=k[o]||o,!(q=w[n]))throw'Invalid component XML: "'+o+'" is not a valid attribute of <'+d.tagName+"/>";r[n]=c(p.value,q)}if(i.each(w,function(a){if(this.required&&t(r[a]))throw"Invalid component XML: <"+d.tagName+'/> must have a(n) "'+a+'" attribute'}),s.length)for(m=0;m<s.length;m++)if(f=s[m],j=x[f.tagName])r[f.tagName]=b(f,j);else if(v.styles&&"styles"===f.tagName)r.styles=g(f);else if(l.indexOf(f.tagName)>-1&&v[f.tagName])r[f.tagName]=i(f);else if(v.actions&&v.actions.indexOf&&v.actions.indexOf(f.tagName)>-1)r[f.tagName]=i(f);else{if(!v.components||"components"!==f.tagName)throw"Invalid component XML: <"+f.tagName+"/> is not a valid child of <"+d.tagName+"/>";r.components=h(f)}return r}function e(a,c){var d,e,f=[],g=i(a).children();return g.length&&i.each(g,function(g,h){if(f||(f=[]),!(d=c.childNode[h.tagName]))throw"Invalid component XML: <"+h.tagName+"/> is not a valid child of <"+a.tagName+"/>";(e=b(h,d))!==undefined&&f.push(e)}),f}function f(b,d){"string"==typeof d&&(d=a.componentType.get(d).schema),d=i.extend(!0,{},{_:{alreadyExtended:!0},attributes:j.attributes,properties:j.properties},d);var e,g=d.attributes||{},h=d.nodes||{},m=d.properties||{},n=a.utils.isUndefined,o={};return i.each(g,function(a){a=k[a]||a,o[a]=n(o[a])?this["default"]:b[a]}),i.each(b,function(b,d){b=k[b]||b;var j=g[b],n=h[b];if(j)o[b]=c(d,j);else if("context"===b&&m[b])o[b]=d;else if(l.indexOf(b)>-1&&m[b])o[b]=i(d);else if(m.actions&&m.actions.indexOf&&m.actions.indexOf(b)>-1)o[b]=i(d);else if("components"===b&&m[b]){if(!Array.isArray(d))throw'The "components" attribute must be an array';o[b]=d.map(function(b){return f(b,a.componentType.get(b.componentType).schema)})}else{if(!n)throw'Invalid definition: "'+b+'" is not a valid attribute';if("array"===n.type){if(!Array.isArray(d)){if(d===undefined)return[];throw"Invalid definition child; an array was expected but instead "+d+" was given"}e=n.childNode[Object.keys(n.childNode)[0]],o[b]=d.map(function(a){return f(a,e)})}else{if("node"!==n.type||"object"!=typeof d)throw'Invalid schema child type: "'+n.type+'"';o[b]=f(d,n.schema||n)}}}),i.each(g,function(a){if(this.required&&n(o[a]))throw'Invalid definition: definition must have a(n) "'+a+'" attribute'}),o}function g(b){var c,d,e,f,g,h,j=i(b).children(),k={},l={},m=a.utils.spacing;if(j)for(var n=0;n<j.length;n++)if(c=j[n],"tokens"===c.tagName&&c.children){d=j[n];for(var o=0;o<d.children.length;o++)e=d.children[o],f=e.getAttribute("name"),g=e.getAttribute("value"),h=e.getAttribute("variable"),"spacing"===h&&(g=m.getByName(g)),a.utils.setObjectProperty(k,f,g)}else if("spacing"===c.tagName){var p="true"===c.getAttribute("variable"),q=p?m.getByName:m.get,r=c.getAttribute("top"),s=c.getAttribute("right"),t=c.getAttribute("bottom"),u=c.getAttribute("left");r&&(l["margin-top"]=q(r)),s&&(l["margin-right"]=q(s)),t&&(l["margin-bottom"]=q(t)),u&&(l["margin-left"]=q(u))}return{spacing:l,tokens:k}}function h(c){var d=i(c).children()||[],e=[];return i.each(d,function(){var c=a.componentType.get(this.tagName);if(c){var d=b(this,c.schema);d.componentType=d._.tagName,e.push(d)}}),e}var i=a.$,j={attributes:{projector:{type:"object"},styleSettingsVariant:{type:"string","default":"default"},componentType:{type:"string"},uniqueId:{type:"string"},styles:{type:"object"},_:{type:"object"}},properties:{context:!0}},k={uniqueid:"uniqueId"},l=["actions","interactions","resultActions","enableConditions","renderConditions","selectedConditions","styles","hotkeys","context","filters","tooltip","skuidvis__chart","skuidvis__chartset"];i.extend(a.component,{parseXML:b,processJSDefinition:f})}(skuid),function(a,b){function c(){return a.utils}function d(a){return{xhr:function(){var c=b.ajaxSettings.xhr();return c.upload&&c.upload.addEventListener("progress",function(b){a.notify(b)},!1),c}}}function e(a){return a.idempotent||"GET"===a.method}function f(a){var b,c,d,e=0;if(0===a.length)return e;for(b=0,c=a.length;b<c;b++)d=a.charCodeAt(b),e=(e<<5)-e+d,e|=0;return e}function g(a){return f([a.modelDataSource||"",a.url,a.method||"GET",c().size(a.headers)?JSON.stringify(a.headers):"{}",a.body||""].join(" - "))}function h(c){var d,f,h=c.modelDataSource,i=a.dataSource.get(h),j={_foundCache:!1};return i&&i.isAuthenticated&&e(c)?(d=g(c),f=n[d],f?j._foundCache=!0:(f=n[d]=b.Deferred(),j.deferred=function(){return f}),j.promise=function(){return f.promise()}):(f=b.Deferred(),j.deferred=function(){return f}),j.markComplete=function(){d&&delete n[d]},j.wasFound=function(){return j._foundCache},j.promise=function(){return f.promise()},j}function i(d,e){function f(){a.remote().proxy(o?JSON.stringify(d):d,function(d,e){g.markComplete(),d=c().parseAsJSONIfString(d),d&&(j=d.setCookies),j&&j.length&&(b.cookie.raw=!0,b.each(j,function(d,e){var f,g={};b.each(["path","secure","domain"],function(a,b){b in e&&(g[b]=e[b])}),"expires"in e&&(f=e.expires,g.expires=!1===c().isNumber(f)?a.time.parseDateTimeString(f):parseInt(f,10)),b.cookie(e.name,e.value,g)}),b.cookie.raw=!1),d&&!d.error&&0!==d.statusCode&&(!d.statusCode||d.statusCode<400)?i.resolve(d):(!d&&e&&e.message&&(d={statusCode:0,status:"",error:e.message}),i.reject(d))},e)}var g,i,j,k=d.body,l=b.extend({},d.headers),m=c().isString,n=a.platform,o="function"!=typeof n.requiresSerializedProxyRequests||n.requiresSerializedProxyRequests();return delete d.originalRequest,d.contentType&&(l["Content-Type"]=d.contentType),d.headers=l,g=h(d),delete d.idempotent,g.wasFound()?g.promise():(i=g.deferred(),e||(e={}),e.escape=!1,!k||m(k)||k instanceof FormData||k instanceof Blob||(d.body=JSON.stringify(k)),o&&k instanceof Blob?c().readFileAsBase64(k).then(function(a){d.body=a,f()},function(a){i.reject(a)}):f(),i.promise())}function j(e){var f,g=e.body,i=h(e),j=a.offline,l=a.storage;return i.wasFound()?i.promise():(f=i.deferred(),!g||c().isString(g)||g instanceof FormData||g instanceof Blob?e.data=g:e.data=JSON.stringify(g),delete e.originalRequest,delete e.idempotent,b.extend(e,d(f)),e.offline&&j.networkDown()?l.tables.queries.get(e.url).then(function(a){return a.data}):(b.ajax(e).always(function(){i.markComplete()}).done(function(a,b,c){var d={statusCode:c.status,body:a,status:c.statusText,headers:k(c.getAllResponseHeaders())};e.offline&&l.tables.queries.add(e.url,{data:d}),f.resolve(d)}).fail(function(a){var b={statusCode:a.status,body:a.responseText,status:a.statusText,headers:k(a.getAllResponseHeaders())};f.reject(b)}),f.promise()))}function k(a){for(var b,c=/^(.*?):[ \t]*([^\r\n]*)$/gm,d={};b=c.exec(a);)d[b[1]]=b[2];return d}function l(a,b){var d,e,f=b?b+": ":"",g=c().isString,h=a&&!g(a)?a.response||a.body:a;if(h)try{d=c().parseAsJSONIfString(h),d&&(d.message&&g(d.message)?e=d.message:d[0]&&d[0].message&&(e=d[0].message),e&&(f+=e))}catch(i){g(h)&&(f+=h)}return f}var m=a.ajax={},n={};b.extend(m,{proxy:i,direct:j,getResponseHeaderObject:k,getErrorMessage:l})}(skuid,skuid.$),function(a,b){function c(){return a.utils.getCSSSizeObj.apply(this,arguments)}function d(a){return m.spacing.get(a)}function e(d,e){var f,h,i,j;if(e.columnGutter&&(f=c(e.columnGutter))&&(h=f.number/2*-1+f.unit),e.rowGutter&&(i=c(e.rowGutter))&&(j=-1*i.number+i.unit),h||j?d.css({margin:(j||"0")+" "+(h||"0")+" 0 "+(h||"0")}):d.css({margin:""}),"rigid"===e.layoutMode&&e.precision&&d.children().length>e.precision&&!d.children(".sm-grid-division-filler").length)for(var k=0;k<e.precision;k++){var l=a.mobile?"sm-card sm-grid-division sm-grid-division-filler":"sk-card sk-grid-division sk-grid-division-filler",m=b("<article>").addClass(l);g(m,{parentMinWidth:e.minWidth,columnGutter:e.columnGutter,rowGutter:e.rowGutter}),d.append(m)}}function f(a){a.css({margin:""}),b.each(a.children(),function(){j(this)})}function g(a,b){b=b||{};var d,e,f,g,h,i,j,k,l,m,n;b.columnGutter&&(h=c(b.columnGutter))&&(i=h.number/2+h.unit),b.rowGutter&&(j=c(b.rowGutter))&&(k=j.number+j.unit),(k||i)&&a.css({margin:(k||"0")+" "+(i||"0")+" 0 "+(i||"0")}),"top"===b.verticalAlign?a.css({"-webkit-justify-content":"flex-start","justify-content":"flex-start"}):"center"===b.verticalAlign?a.css({"-webkit-justify-content":"flex-start","justify-content":"center"}):"bottom"===b.verticalAlign&&a.css({"-webkit-justify-content":"flex-start","justify-content":"flex-end"}),"specified"===b.behavior?a.css({width:b.width,"-webkit-flex":"none",flex:"none"}):"fit"===b.behavior?a.css({width:"","-webkit-flex":"none",flex:"none"}):(m=c(b.minWidth),n=c(b.maxWidth),l=c(b.parentMinWidth),d=b.relativeSize||1,e=b.relativeSize||1,m?f=m.number+m.unit:l&&(f=l.number*(b.relativeSize||1)+l.unit),g=d+" "+e+" "+f,a.css({"-webkit-flex":g,flex:g,width:"","max-width":n.unit?n.number+n.unit:undefined}))}function h(a,b){a.css({flexDirection:n.DIRECTION[b.flexDirection],justifyContent:n.JUSTIFY[b.justifyContent],alignItems:n.ALIGNMENT[b.alignItems]})}function i(a,b){b=b||{};var e,f,g,h,i,j=d(b.columnGutter),k=d(b.rowGutter),l=b.relativeSize||1,m=l,o=l,p=n.ALIGNMENT[b.alignSelf];(k||j)&&(i=(k||"0")+" "+(j||"0")+" 0 "+(j||"0")),h=c(b.minWidth),g=c(b.parentMinWidth),h?e=h.number+h.unit:g&&(e=g.number*(b.relativeSize||1)+g.unit),f=m+" "+o+" "+e,a.css({flex:f,alignSelf:p,margin:i,width:null,maxWidth:b.maxWidth})}function j(a){a.css({margin:"",width:"","-webkit-flex":"none",flex:"none","-webkit-justify-content":"","justify-content":""})}function k(a){var c,d=parseInt(a.data("voffset"),10),e=parseInt(a.data("vpercent"),10),f=parseInt(a.data("precision"),10);if((d||0===d)&&e||0===e?(c=(a.offsetParent().outerHeight()-d)*(e/100),a.addClass("sm-grid-fixed-vertical").css("height",c+"px")):a.removeClass("sm-grid-fixed-vertical").css("height",""),f){var g,h=0;a.children(".sm-grid-division-forcewrap").remove(),b.each(a.children(".sm-grid-division"),function(){var a,c=b(this),d=c.data("size"),e=c.data("component"),i=e&&e.xmlDefinition&&e.xmlDefinition.attr("type"),j=c[0].offsetTop;a=!i||"specified"!==i&&"fit"!==i?parseInt(d,10)||1:1,j!==g&&(h=0),h+=a,h>f&&(c.before(b("<div>").addClass("sm-grid-division-forcewrap")),j=c[0].offsetTop,h=a),g=j})}}function l(){a.events.publish("ui.reflow"),a.events.publish("ui.resize")}var m=a.utils,n=a.constants.FLEX,o=a.responsive={config:{resizeWaitTime:100}},p=!1;b(window).on("resize orientationchange",function(){!1!==p&&clearTimeout(p),p=setTimeout(a.responsive.handleResize,a.responsive.config.resizeWaitTime)}),b.extend(o,{handleResize:l,prepareDivision:g,prepareFlexDivision:i,prepareGrid:e,prepareFlexGrid:h,processGrid:k,unMakeDivision:j,unMakeGrid:f})}(skuid,skuid.$),function(a,b){function c(c,d){if(!c)return!1;c&&a.utils.isString(c)&&(c=a.utils.makeXMLDoc(c)),c.jquery||(c=b(c));var e=c.attr("uniqueid");d&&("__header"!==e&&"__footer"!==e||(e+=d)),k[e]={xmlDefinition:c}}function d(){k={}}function e(a){return k[a]}function f(){var a=[];return b.each(k,function(b,c){a.push(c)}),a}function g(){return k}function h(a,b){a.unregisterChildComponents().createChildComponents(b.children(),a.element,a.context)}function i(b,c){var d,f=a.$C(b),g=e(c);g&&(d=g.xmlDefinition.children("components").first(),h(f,d))}var j=a.region={},k={};b.extend(j,{get:e,list:f,map:g,register:c,unregisterAll:d,setContent:h,setContentByIds:i})}(skuid,skuid.$),function(a){function b(){return a.platform.getName()}function c(a){var c=b();return pc.isArray(a)?-1!==a.indexOf(c):c===a}function d(){return a.environment===vc.ENVIRONMENTS.TEST}function e(){return a.utils.userInfo}function f(a){pd=a}function g(){return pd}function h(a){var b,c,d,e,f=!a;return nc&&f?nc:(a||(a=g()),c=a.split("."),d=c[0],"c"===d||na(d,"--c")?b=a:(pa(d,"--")?(e=d.split("--"),e.pop(),e.push("c"),c[0]=e.join("--")):c[0]="c",b=c.join(".")),f&&(nc=b),b)}function i(){return na(g().split(".")[0],"--skuid")}function j(b,c,d,e){return a.platform.getResourceUrl({name:b,namespace:c,nestedPath:d,modstamp:e})}function k(b){var c=b&&oa(b,"/"),d=a.page.sitePrefix;return d&&"null"!==d&&c&&!oa(b,d)?(na(d,"/s")&&(d=d.substring(0,d.length-2)),d+b):b}function l(b){
return j(s(a.platform.getDefaultImagePath?a.platform.getDefaultImagePath():"","DefaultPhotos"),"skuid",("org"===b?"Org":"Profile")+".jpg",a.version.date)}function m(b,c,d){var e={},f=d&&d.mode||"row";return b&&b.context&&pc.extend(e,b.context),c&&pc.extend(e,c),e.model||(b&&b.model?e.model=b.model:b&&b.list&&b.list.model&&(e.model=b.list.model)),e.row||(e.item&&e.item.row?e.row=e.item.row:!b||!b.row||b instanceof a.model.Model?b&&b.item&&b.item.row&&(e.row=b.item.row):e.row=b.row),e.list||b&&b.list&&(e.list=b.list),e.editor||b&&b.editor&&(e.editor=b.editor),"model"===f&&(e.row=undefined,e.list=undefined,e.rows=undefined),e}function n(){return e().isApiEnabled}function o(a,b){Array.prototype.push.apply(a,b)}function p(){var a=Array.prototype.slice.call(arguments||[]),b=a.shift(),c=a[0],d=0;for(pc.isArray(c)&&(a=c);d<a.length;d++){try{b=b[a[d]]}catch(e){return}if(ga(b))return}return b}function q(){if("nodata"===bd)try{bd="sessionStorage"in a.data&&null!==a.data.sessionStorage}catch(b){bd=!1}return bd}function r(a){if(a&&a.length)return a.charAt(0).toUpperCase()+a.slice(1)}function s(){return u.apply(this,["/"].concat(Array.prototype.slice.apply(arguments)))}function t(a,b,c){a||(a=""),b||(b=""),c||(c="");var d=a.length,e=b.length,f=c.length;return(d&&na(a,c)?a.substring(0,d-f):a)+(d&&e?c:"")+(e&&oa(b,c)?b.substring(f,e):b)}function u(a,b){var c=pc.isArray(b)?b:Array.prototype.slice.call(arguments,1);return a||(a=""),c.reduce(function(b,c){if(!c)return b;if(!b)return c;var d=na(b,a),e=oa(c,a);return d||e?d&&e?b+c.substring(a.length):b+c:b+a+c},"")}function v(b,c,d){if(!ga(b)){var e=qc["canUse"+r(d)]();return ga(c)?e?a.data[d].getItem(b):pc.cookie(b):e?(a.data[d].setItem(b,c),c):pc.cookie(b,c)}}function w(a,b){return v(a,b,"sessionStorage")}function x(a){if(a&&qc.isString(a))try{a=JSON.parse(a)}catch(b){}return a}function y(a,b,c,d){d||(d=dd);var e=c&&c.model?c.row?Cc:Bc:Ac,f=pc("<div>"),g=a.attr(b);if(void 0!==g)return e===Cc?f.append(hb(Cc,g,d,c.model,c.row)):e===Bc?f.append(hb(Bc,g,d,c.model)):f.append(hb(Ac,g,d)),f.text()}function z(b){if(b){var c,d=b.model,e=b.row,f=b.url,g=b.title||"",h=b.window,i=d?e?Cc:Bc:Ac,j=pc.extend(dd,b.mergeSettings||{}),l=!(!window.sforce||!sforce.one)&&sforce.one,m=!!(window.sforce&&sforce.console&&sforce.console.isInConsole())&&sforce.console,n=f&&oa(f,"/"),o=d&&e?d.getRowId(e):null,p="blank"===h;f&&(f=gb(i,f,j,d,e),a.utils.inPlatform(a.constants.LIGHTNING)?n&&!p?(c=window.$A.get("e.force:navigateToURL"),c.setParams({url:f}),c.fire()):window.open(f):l?l.navigateToURL(f,p):m?n?(d&&e&&(oa(f,"/"+o)||oa(f,"/"+o.substring(0,15)))&&d.getRowById(o)&&(g=d.getNameFieldValueForRow(e)),a.ui.openConsoleTabForUrl(f,g)):window.open(f):(n&&(f=k(f)),p?window.open(f):"parent"===h?parent.location=f:"top"===h?window.top.location.href=f:window.location=f))}}function A(a,b){var c=window&&window.console;if(c)switch(b){case Hc.ERROR:c.error(a);break;case Hc.WARNING:c.warn(a);break;default:c.log(a)}}function B(b,c,d){if(!b)return null;c||(c={}),d||(d={});var e=pc("<div>").attr("title",y(b,"title",c,{createFields:!0,registerFields:!1})),f=[],g=[],h=!0,i=!0;return c.popup=e,"false"!==b.attr("modal")&&!1!==d.modal||(h=!1),"false"!==b.attr("resizable")&&!1!==d.resizable||(i=!1),b.children("components").first().children().each(function(){var b=a.component.factory({definition:this,context:c});f.push(b.element),g.push(b)}),e.append(f).dialog({close:function(){g&&pc.each(g,function(){this.unregister&&this.unregister()}),e.dialog("destroy").remove(),d.close&&d.close.apply(this);var f=b.children("afterclose");f.length&&a.actions.runActionsNode(f,null,c)},open:function(){function c(a){var b=window.innerHeight,c=parseInt(.8*b,10),d=function(){e.css({"overflow-y":"scroll",height:c-f.find(".ui-dialog-titlebar").outerHeight()+"px"}),e.find(".popup-content-padding").length||e.append(pc('<div class="popup-content-padding">').css({height:"15px"})),f.css({height:c+"px",top:parseInt(.1*b,10)+"px",position:"fixed"})};f.innerHeight()>c?d():a&&d()}var f=e.parent();c(!1),pc(window).resize(function(){c(!0)}),a.events.subscribe("skuid.includepanel.loadcomplete",function(){c(!0)}),f.find(".ui-dialog-titlebar-close .ui-icon").after(pc(a.ui.createIcon(b.attr("closeicon")||"sk-icon-close")).css({left:"0",display:"inline-block"})).remove(),d.open&&d.open.apply(this)},beforeClose:function(){d.beforeClose&&d.beforeClose.apply(this)},modal:h,resizable:i,width:b.attr("width")||"600px",buttons:d.buttons||[]}),e}function C(a,b,c){return B(a.children("popup").first(),b,c)}function D(a){a||(a={});var b,c,d,e,f={registerFields:!1,nl2br:!1},g=a.fieldMetadata;if(g&&(d=g.rel,e=g.id),!("template"in a||"fieldMetadata"in a))throw"skuid.utils.calculateReferenceText: Either fieldMetadata or a template must be provided.";if(a.template){var h=e.indexOf(".");c=e&&-1!=h?e.substring(0,h+1):"",b=a.template,f.fieldPrefix=c+d+"."}else{var i,j;if(g.ref&&-1!=g.ref.indexOf(",")||g.referenceTo&&g.referenceTo.length>=2){if(a.targetObject){var k=a.targetObject.split(".");i=k[k.length-1]}else i=g.referenceTo[0].objectName;j="Name"}else i=g.ref,j=a.model.getDataSource().getNameField(i||a.model.objectName);d?(-1!=e.indexOf(".")&&(d=e.substring(0,e.lastIndexOf(".")+1)+d),b="{{"+d+"."+j+"}}"):b="{{"+j+"}}"}return a.model.getRowMergeResult(a.row,b,f)}function E(a){return D(a).merges.text()}function F(a,b){var c=a.split(".");c.pop();var d=c.join(".");return b.displaytype===ad?(d?d+".":"")+b.rel:d}function G(a){return a.referenceTo[0]}function H(a,b,c){var d=Da(G(b).objectName,c);if(d)return F(a,b)+"."+d}function I(b){var c=id[b]||b,d=e();return"ismulticurrencyorganization"===b?a.utils.isMultiCurrencyOrganization:c in d?d[c]:void 0}function J(a,b,c){var d,e=!0,f=b.length;if(c||(c={}),a?(d=a.toLowerCase().replace(/\s+/g,""),Jc.test(d)||(e=!1)):e=!1,!e)throw"Invalid Condition Logic: "+a;for(c.customAndString&&(d=d.replace(/and/g,c.customAndString)),c.customOrString&&(d=d.replace(/or/g,c.customOrString));f>0;f--)d=d.replace(f,b[f-1]);return d}function K(b,c){return a.formula.evaluate(J(b,c,{customAndString:"&&",customOrString:"||"}))}function L(a){var b=a.left,c=a.right,d=a.op,e=a.displaytype,f=rd[d]||rd["="],g=e===Zc,h=e===$c,i=rc.resolveDateKeyword,j=g?function(a){return rc.getRealJSDateTimeFromLocal(rc.parseSFDate(a))}:rc.parseSFDateTime;if(g||h){if(typeof b===Oc&&(b=j(b)),!b)return!1;b=b.getTime(),typeof c===Oc&&(c=j(c)||c),typeof c===Oc?(c=i(c),pc.isArray(c)?(c[0]=c[0].getTime(),c[1]=c[1].getTime(),f=sd[d]||sd["="]):(b=a.left,c=a.right)):c=c.getTime()}return f(b,c)}function M(a,b,c){b&&pc.each(b,function(b,c){if(ga(c))throw"Required constructor argument not provided for "+a.constructor.name;a[b]=c}),c&&pc.each(c,function(b,c){ga(c)||(a[b]=c)})}function N(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,J,M,N,O,P,Q,R,S=!0,T=!1,U=!1;for(c||(c={}),k=c.context,B=c.logicType||"and","custom"===B?(A=c.logic,d=[]):"or"===B?U=!0:T=!0,b instanceof Array||(b=[b]),x=0;x<b.length;x++){if(H=!0,g=b[x],P=g.sourceType||Dc,Q=P===Dc,O=g.sourceProperty,G=g.operator,j=g.type||Dc,E=null,J=null,u=null,h=g.value,i=g.values,Q||na(P,"property")){if(g.fieldModel){if((E=a.$M(g.fieldModel))&&E.data)if(c.row&&(c.model&&c.model.id===E.id||E.getRowById(E.getRowId(c.row))))J=c.row;else if(E.data.length)J=E.data[0],g.fieldRow=E.getRowId(J);else if(Q){if("deactivate"===(F=g.noSourceRowBehavior||"deactivate"))continue;return"skipandrender"===F}}else c.row&&(J=c.row,c.model&&(E=c.model));"function"==typeof J&&(J=J()),E&&(u=E.getField(g.field))}if(Q?s=E?E.getFieldValue(J,g.field,!0):X(J,g.field):"userinfo"===P?s=I(g.sourceUserInfoType):"param"===P?s=a.page.params[g.sourceParam]:"snippet"===P?(N=a.snippet.get(g.sourceSnippet),s=!N||N(),G="=",h=!0):"feature"===P?(s=a.platform.hasFeature&&a.platform.hasFeature(h),"!="!==G&&(G="="),h=!0):"datasourceuserinfo"===P?(q=g.dataSourceName,p=a.dataSource.getDataSource(q),r=p&&p.getDataSourceType(),s=r&&r.evaluateUserInfoConditionSourceType?r.evaluateUserInfoConditionSourceType(p,g.sourceDataSourceTypeUserInfo):p&&p.getUserInfoProperty(g.sourceDataSourceTypeUserInfo)):"nofeature"===P?(s=a.platform.hasFeature&&a.platform.hasFeature(h),G="=",h=!1):na(P,"property")&&O&&E&&(tc(O,["hasRows","hasNoRows"])>-1?(s=!(!E.data||!E.data.length),h="hasRows"===O,G="=",j=Dc):"rowproperty"===P?J?(j||(j=Dc),h||!1===h||0===h||(h=!0),G||(G="="),"isCloned"===O?s=E.isRowUnsavedClone(J):"isNew"===O?s=E.isNewRow(J):"isSaved"===O?s=!E.isNewRow(J):"hasChanged"===O?s=E.isRowChanged(J):"isMarkedForDeletion"===O?s=E.isRowMarkedForDeletion(J):"rowid"===O&&(s=E.getRowId(J))):H=!1:("data.length"===O&&(h=parseInt(h,10)),s=X(E,O))),y=null===s||""===s||void 0===s,y&&(s=""),"userinfo"===j?h=I(g.userInfoType):"datasourceuserinfo"===j?h=E?E.getDataSource().getUserInfoProperty(g.userInfoType):undefined:"param"===j&&(h=a.page.params[h]),k)if(l=k.model,m=k.row,n=k.rows,C=g.mergeField,"contextrow"===j&&m)D=C?l.getFieldValue(m,C,!0):l.getRowId(m),ga(D)||(h=D);else if("contextrows"===j&&n){for(R={},M=0;M<n.length;M++)o=n[M],D=C?l.getFieldValue(o,C,!0):l.getRowId(o),ga(D)||D in R||(R[D]=1);i=Object.keys(R)}if("blank"===j)"!="===G?y&&(H=!1):y||(H=!1);else if(-1!==pc.inArray(j,["multiple","contextrows"])){if(i&&i instanceof Array)if(z="includes"===G,w=i.length,"in"===G&&-1===tc(s,i))H=!1;else if("not in"===G&&-1!==tc(s,i))H=!1;else if("includes"===G||"excludes"===G)if(t=s.split(";"),t.length){for(e=0;e<i.length;e++)if(f=i[e],-1!==tc(f,t)){if(!z){H=!1;break}}else if(z){H=!1;break}}else z&&w&&(H=!1)}else v=u&&u.displaytype,da(h)&&pc.inArray(v,gd)>-1&&(h=parseInt(h,10)),L({left:s,op:G,right:h,displaytype:v})||(H=!1);if(T&&!H){S=!1;break}if(U){if(S=H,H)break}else A&&d.push(H)}return A&&d&&d.length&&(S=K(A,d)),S}function O(a,b,c,d){return N(b,{row:a,model:d,context:c})}function P(b,c){var d=a.utils._ie;if(!(d&&d<10)){for(var e=atob(b),f=new Array(e.length),g=0;g<e.length;g++)f[g]=e.charCodeAt(g);var h=new Uint8Array(f),i=new Blob([h],{type:"octet/stream"});i.size<=1||a.utils.saveAs(i,c)}}function Q(b,c,d){var e=a.utils._ie;if(e&&e<10)throw"File download is not supported for this browser.";if(da(b)){var f=new Blob([b],{type:d||"text/csv"}),g=a.utils.saveAs(f,c);return a.events.publish("filedownload",[{data:f,filename:c}]),g}}function R(a,b,c,d){if(a&&a.length){return b&&b.length?a.filter(function(a){return O(a,b,c,d)}):a}return[]}function S(a,b){return function(c){return c.attr("datasource")===a&&c.attr("x-entityname")===b}}function T(a){return a&&a.toLowerCase()in jd}function U(a){return!isNaN(a-0)}function V(a){return a!==a}function W(a,b){var c=a;return a!==undefined&&(b?c=a.toString():"false"===a?c=!1:"true"===a?c=!0:U(a)&&!1!==a&&!0!==a&&(c=-1!==a.toString().indexOf(".")?parseFloat(a):parseInt(a,10))),c}function X(a,b){if(a&&b){for(var c,d,e,f=yb(b),g=0;g<f.length;){if(c=f[g],!a)return;if(a instanceof Array&&"length"!==c){e=null;try{d=parseInt(c,10)}catch(h){e=h}if((e||isNaN(c))&&a.length){a=a[0];continue}if(d>=0){a=a[d],g++;continue}}a=a[c],g++}return a}}function Y(a,b){if(a&&b){for(var c=yb(b),d=0,e=!1;d<c.length;){if(!(a&&c[d]in a))return!1;a=a[c[d++]],e=!0}return e}return!1}function Z(a,b,c){if(a&&b){for(var d,e,f,g=yb(b),h=0,i=g.length-1;h<i;){d=g[h];{if(!a)break;if(a instanceof Array){f=null;try{e=parseInt(d,10)}catch(j){f=j}!f&&!isNaN(d)&&e>=0&&(a=a[e])}else a=!ga(a[d])&&ia(a[d])?a[d]:a[d]={};h++}}a&&(a instanceof Array&&isNaN(g[i])?a.push(c):a[g[i]]=c)}}function $(a,b){if(a&&b){for(var c,d,e,f=yb(b),g=0,h=f.length-1;g<h;){c=f[g];{if(!a)break;if(a instanceof Array){e=null;try{d=parseInt(c,10)}catch(i){e=i}!e&&!isNaN(c)&&d>=0&&(a=a[d])}else{if(!(c in a))throw"No property at this location.";a=a[c]}g++}}a&&(pc.isArray(a)&&!isNaN(f[h])?a.splice(f[h],1):delete a[f[h]])}}function _(a){return a&&da(a)?a.replace(Ic,""):a}function aa(a){return a.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")}function ba(a){return da(a)?a&&pc("<div/>").html(a).text():a}function ca(a){return da(a)?a&&String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):a}function da(a){return typeof a===Oc||a instanceof String}function ea(a){return typeof a===Qc}function fa(a){return"[object Date]"===Object.prototype.toString.call(a)}function ga(a){return typeof a===Rc}function ha(a){return 0!==a&&"boolean"!=typeof a&&!a}function ia(a){return null!==a&&typeof a===Pc}function ja(a){return a&&a.replace(/(\r\n|\n|\r)/gm,"<br>")}function ka(a){return a&&da(a)?a.toLocaleLowerCase?a.toLocaleLowerCase():a.toLowerCase():a}function la(a){return a&&da(a)?a.toLocaleUpperCase?a.toLocaleUpperCase():a.toUpperCase():a}function ma(a,b,c,d){return!!(a&&b&&c)&&(d&&(b=ka(b),c=ka(c)),a(b,c))}function na(a,b,c){return ma(function(a,b){return-1!==a.indexOf(b,a.length-b.length)},a,b,c)}function oa(a,b,c){return ma(function(a,b){return 0===a.lastIndexOf(b,0)},a,b,c)}function pa(a,b,c){return ma(function(a,b){return-1!==a.indexOf(b)},a,b,c)}function qa(a,b){return a&&b&&typeof a===Oc&&a.length>b?a.substring(0,b):a}function ra(a,b){return a&&b&&typeof a===Oc&&a.length>b?a.substring(a.length-b,a.length):a}function sa(a,b){for(var c=0;c<a.length;c++)if(tc(a[c],b)>-1)return!0}function ta(a,b){return a.length==b.length&&a.every(function(a,c){return a===b[c]})}function ua(a){return void 0!==a?(a.indexOf(Ec)>-1&&(a=a.replace(/"/g,Fc)),pc.each(Gc,function(b,c){if(a.indexOf(c)>-1)return a=Ec+a+Ec,!1})):a="",a}function va(a){return a&&a.replace(/\./g,"\\.")}function wa(a){return a&&a.replace(/'/g,"\\'")}function xa(a,b,c){var d=null;return function(){var e=arguments;clearTimeout(d),d=setTimeout(function(){a.apply(c||this,e)},b)}}function ya(a){var b={},c={buffer:!1};return b[a]=[""],za(b,c)}function za(b,c){c||(c={});var d,e,f,g=pc.Deferred(),h=!c||!1!==c.cache,i=function(a){var b={},d=c&&!0===c.json;pc.each(a,function(a,c){var e=b[a]={};pc.each(c,function(a,b){e[a]=d?x(b):b})}),g.resolve(b)};return h&&(lc||(lc={}),d={},pc.each(b,function(a,b){var c,e=lc[a];return e?(c=d[a]={},pc.each(b,function(a,b){if(!e[b])return d=!1,!1;c[b]=e[b]}),!!d):(d=!1,!1)})),d?i(d):(f=JSON.stringify(b),oc||(oc={}),e=oc[f],e||(e=oc[f]=pc.Deferred(),a.remote().getBodiesOfZIPResourceFiles(f,function(a){delete oc[f],a=x(a),a&&!a.error?(h&&pc.each(a,function(a,b){var c=lc[a];c||(c=lc[a]={}),pc.each(b,function(a,b){c[a]=b})}),e.resolve(a)):e.reject(a&&a.error?a.error:a)},{escape:!1,buffer:!1!==c.buffer})),e.done(i)),g.promise()}function Aa(a,b){return za(a,pc.extend({json:!0},b))}function Ba(a,b,c,d){var e={},f=(b?b+"__":"")+a;return e[f]=[c],za(e,d).then(function(a){var b=a[f];if(b&&b[c]){if(b=b[c],d&&!0===d.json&&da(b))try{b=JSON.parse(b)}catch(e){throw"Unable to parse body of file at path: "+c}return b}throw"ZIP resource contained no file at path: "+c})}function Ca(a,b,c,d){return Ba(a,b,c,pc.extend({json:!0},d))}function Da(b,c){var d=c&&c.dataSourceType||a.dataSource.getType("salesforce");return d&&d.getNameField(b,c)}function Ea(a,b,c){var d=ld();return d&&d.getMetadataForRecordTypes(a,b,c.dataSource)}function Fa(a){var b=ld();return b&&b.getAPIDescribeLayout(a)}function Ga(a){var b=ld();return b&&b.getAPIDescribeSObject(a)}function Ha(a,b,c,d){var e=ld();return e&&e.getPicklistEntriesValidForRecordTypes(a,b,c,d)}function Ia(a,b){return pc.each(b,function(b,c){-1!==a.indexOf("?")?a+="&"+b+"="+c:a+="?"+b+"="+c}),a}function Ja(b){var c,d=pc(".bodyDiv"),e=pc("ul#tabBar"),f=e.children("li.zen-active, li.active"),g=f.find("span.zen-assistiveText, span.assistiveText").detach(),h=a.utils.sfTabs[b];f.removeClass("zen-active primaryPalette primaryPalette active").find("a").attr("title",function(a,b){return b.replace(" - Selected","")}),b&&h&&(c=e.children("li").has('a[href="'+b+'"]')),c.length&&(c.first().addClass("zen-active active primaryPalette").find("a").attr("title",function(a,b){return b+" - Selected"}).after(g),h.color&&(c.css({"background-color":"#"+h.color,"border-color":"#"+h.color}),d.css("border-top-color","#"+h.color)))}function Ka(a,b,c){return a?b:c}function La(a,b,c){c<=0?a.prepend(b):a.children().eq(c-1).after(b)}function Ma(b,c){return a.platform.isNative()&&-1===b.indexOf("http://")&&-1===b.indexOf("https://")&&(b=a["native"].instanceUrl+b),a.load.js(b,c)}function Na(b){if(a.CKEDITOR)return void b(a.CKEDITOR);if(Na.loading)return void Na.loading.done(function(){b(a.CKEDITOR)});Na.loading=pc.Deferred();var c,d=j("CKEditor","skuid","ckeditor.js",Zb());Ma(d,function(){c=a.CKEDITOR=window.CKEDITOR,Na.configured||(Na.configured=!0,c.disableAutoInline=!0),b(c),Na.loading.resolve()})}function Oa(b,c){return ia(b)?c=pc.extend(b,c):c.href=b,a.platform.isNative()&&-1===c.href.indexOf("http://")&&-1===c.href.indexOf("https://")&&(c.href=a["native"].instanceUrl+c.href),a.load.css(c,c.callback)}function Pa(a,b,c){return"MULTIPICKLIST"===b?"="===a||"exact"===a?"=":"includes":b===_c||"Id"===c||na(c,".Id")?"=":"exact"===a?"=":a}function Qa(a,b,c,d,e){e||(e={});var f,g=e.delimiter||" ",h=e.searchOperator||"contains",i=1;return b.subConditions=[],b.subConditionLogic="",f=e.tokenize?c.split(g):[c],pc.each(f,function(c){var e=this+"",g=[];if(!e)return!0;pc.each(d,function(c,d){var f=d.searchOperator||h,j=a.getField?a.getField(d.id):d;j||(j=d);var k=!(!j||!j.displaytype)&&j.displaytype,l=k===ad?H(d.id,d,a.getDataSource()):d.id,m={name:"__default_searchbox_subcondition",type:"fieldvalue",field:l,inactive:!1};if(m.operator=Pa(f,k,l),"MULTIPICKLIST"===k)"="===m.operator||"exact"===m.operator?m.value=e:m.values=[e];else if(k===_c||"Id"===l||na(l,".Id")){if(!e||18!==e.length&&15!==e.length)return!0;m.value=e}else m.value=e;if(k===ad){var n=a.getField(l);n&&n.targetObjects&&(m.fieldTargetObjects=n.targetObjects)}else d.targetObjects&&(m.fieldTargetObjects=d.targetObjects);b.subConditions.push(m),g.push(i),i++}),b.subConditionLogic+="("+g.join(" OR ")+")",c<f.length-1&&(b.subConditionLogic+=" AND ")}),b}function Ra(b,c){c||(c={});var d={},e=ib(),f=function(a){if(a instanceof Array)for(var b=0;b<a.length;b++){var g=a[b];if("name"===g[0]||"&"===g[0]||"#"===g[0]||"^"===g[0]){var h,i=g[1];""!==i&&(h=e[i],c.ignoreGlobals&&(h||-1!==i.indexOf("$")||-1!==i.indexOf("Model."))||c.ignoreFunctions&&"function"==typeof h||(d[i]=1))}g.length>=5&&g[4]instanceof Array&&f(g[4])}};return f(a.Mustache.parse(b,["{{","}}"])),f(a.Mustache.parse(b,["{{{","}}}"])),Object.keys(d)}function Sa(b,c,d,e){var f,g,h,i,j=a.$M(b),k=Ta(e);return d||(d=null,e=null),j&&(f=d&&j.getField(d),f&&(g=f.displaytype),g&&k&&g!==k&&(g===Uc?e=parseInt(e,10):g===Yc&&(e=parseFloat(e))),h=j.getRows(),d&&(h=h.filter(function(a){return j.getFieldValue(a,d,!0)===e}))),h&&h.length&&(i=j.getFieldValue(h[0],c,!0)),i}function Ta(a){if(null!==a)switch(typeof a){case Mc:return Tc;case Nc:return a%1==0?Uc:Yc;case Pc:if(a){if(a instanceof Array)return"ARRAY";if(a instanceof Date)return $c}return"OBJECT";case Oc:if(Date.parse(a)){if(-1!==a.indexOf("T"))return $c;if(3===a.split("-").length)return Zc}else if(pa(a,"://"))return"URL";try{if(!isNaN(+a))return-1!==a.indexOf(".")?Yc:Uc}catch(b){return"STRING"}}return"STRING"}function Ua(a){return a+="",[a.match(Kc)||[],a.split(Kc)]}function Va(){var b=this;return function(c,d){return ca(b.Model?a.$M(b.Model.id).getRowId(b):b.Id||"")+'">'+d(c)}}function Wa(){return function(b){return a.label.read(b)}}function Xa(){return function(a,b){var c=b(a);return-1===a.indexOf("{{{")&&(c=pc("<div>").html(c).text()),encodeURIComponent(c)}}function Ya(){return function(a,b){var c=b(a);return-1===a.indexOf("{{{")&&(c=pc("<div>").html(c).text()),decodeURIComponent(c)}}function Za(){return function(a,b){return b(a).replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/"/g,'\\"').replace(/'/g,"\\'")}}function $a(a){if(!a||!a.length)return{};pa(a,"?")&&(a=a.substr(a.indexOf("?")+1));for(var b,c=a.split("&"),d={},e=0;e<c.length;++e)b=c[e].split("="),2==b.length&&(d[decodeURIComponent(b[0])]=decodeURIComponent(b[1].replace(/\+/g," ")));return d}function _a(a){return pc.map(a,function(a,b){return encodeURIComponent(b)+"="+encodeURIComponent(a)}).join("&")}function ab(a,b,c,d){c||(c={});var e=c.model,f=c.row,g=d||ed;return g.apiExtensions=pc.extend({},g.apiExtensions,c),f&&e?a(Cc,b,g,e,f):e?a(Bc,b,g,e):a(Ac,b,g)}function bb(a,b,c){return ab(hb,a,b,c)}function cb(a,b,c,d,e){return c||(c={}),c.asData=!0,b?jb(a,b,c,d,e):null}function db(a,b){return ab(cb,a,b)}function eb(a,b,c){return ab(gb,a,b,c)}function fb(a,b){return ea(b)?function(){return b.apply(a,arguments)}:function(){return a[b].apply(a,arguments)}}function gb(a,b,c,d,e){return c||(c={}),"undefined"==typeof c.nl2br&&(c.nl2br=!1),c.asText=!0,b?jb(a,b,c,d,e):""}function hb(a,b,c,d,e){var f=jb(a,b,c,d,e);return ia(f)&&f.merges?f.merges:f}function ib(c){c||(c={});var d=c.mode||Ac,f=c.model,g=c.row,h=c.apiExtensions,i=e(),j=a.page,k=window.sforce?sforce.connection:{},l=pc.extend({},h,{$Label:a.label.map,$Model:a.model.map(),$Param:j.params,$Api:{Session_Id:k.sessionId||a.utils.userInfo.sessionId,Organization_Id:i.organizationId,User_Id:i.userId,Partner_Server_Url:k.partnerServerUrl,Enterprise_Server_Url:k.enterpriseServerUrl,Partner_Server_Urls:k.partnerServerUrls,Enterprise_Server_Urls:k.enterpriseServerUrls},$User:i,$Site:{CurrentSiteUrl:j.currentSiteUrl,Prefix:j.sitePrefix},$Platform:{Name:b()},SkuidField:Va,SkuidLabel:Wa,urlEncode:Xa,encodeUrl:Xa,urlDecode:Ya,decodeUrl:Ya,escapeJS:Za,escapeLiterals:Za});if(d!==Bc&&d!==Cc||pc.extend(l,{Model:{conditions:f.conditions,Data:f.data,data:f.data,Label:f.label,label:f.label,LabelPlural:f.labelPlural,labelPlural:f.labelPlural,fields:f.fields,Fields:f.fieldsMap,fieldsMap:f.fieldsMap,KeyPrefix:f.keyPrefix,keyPrefix:f.keyPrefix,ObjectName:f.objectName,objectName:f.objectName,id:f.id,updateable:f.updateable,createable:f.createable,deleteable:f.deleteable}}),d===Cc){var m=f.data.indexOf(g)+1,n=f.getRecordForRow(g),o=1===m,p=m===f.data.length,q={first:o,last:p,index:m};n&&(q.Record={id:n.getId(),index:m,isFirst:o,isLast:p,isNew:n.isNew(),isClone:n.isClone(),isMarkedForDeletion:n.isMoribund(),data:n&&n.get()}),pc.extend(l,q,g)}return l}function jb(b,c,d,e,f){var g=arguments[0];if(null!==g&&typeof g===Pc&&(b=g.mode,c=g.template,d=g.options,e=g.model,f=g.row),f&&"function"==typeof f&&(f=f()),f||"row"!==b||(e&&e.data&&e.data.length?f=e.data[0]:b="model"),e||"model"!==b||(b="global"),!c&&""!==c)throw"Required argument 'template' was not provided.";if(!(b&&b.toLowerCase()in fd))throw"Invalid merge mode. Valid modes are: global,model,row.";if(b=b.toLowerCase(),d||(d={}),!0===d.evaluateFormulas)return a.formula.evaluate(c,{model:e,row:f,apiExtensions:d.apiExtensions},{outputType:d.outputType});var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,Y,Z,$,_,aa=e,ca=aa?aa.fieldsMap:null,ea=d.apiExtensions,fa=!0===d.asText,ga=!0===d.asData,ha=!0===d.coerceToJSType,ia=fa||ga?!1!==d.allowHTML:!0===d.allowHTML,ka=d.nl2br,la=!1!==d.createFields,ma=la&&!1!==d.registerFields,na={fields:[]},pa=Ua(c),qa=pa[0],ra=pa[1],sa=1===qa.length&&""===ra.join(""),ta="",ua=d.parentRow||null,va=d.childRelName||!1,wa=-1,xa=ra.length;if(qa.length)p=ib({mode:b,apiExtensions:ea,model:aa,row:f});else if(fa||ga)return ia?c:qc.encodeHTML(c);if(ga){if(sa&&(y=Ra(qa[0]),1===y.length)){if(u=y[0],oa(u,"$Label."))return a.$L(u.substring(7));if((z=X(p,u))===undefined||null===z)return null;if(!ha)return z;if(u.match(/\.data\.\d+\./)?(v=u.split("."),K=oa(u,"$Model."),t=v.splice(0,K?4:3),t=K?a.$M(t[1]):aa,s=!!t&&t.getField(v.join("."))):aa&&(s=aa.getField(u)),!s)return z;if(Z=s.displaytype,V=tc(Z,gd)>-1,T=Z===Tc,U=tc(Z,hd)>-1,V)return window.parseFloat(z);if(T){if(da(z)){if("true"===z.toLowerCase())return!0;if("false"===z.toLowerCase())return!1}return!!z}return U?Z===Zc?a.time.getRealJSDateTimeFromLocal(a.time.parseSFDate(z)):a.time.parseSFDateTime(z):z}fa=!0}for(;xa>0;)if(B=ra[++wa],xa--,ta+=B,Y=qa[wa]){if(P="{{{"===Y.substring(0,3),u=Y.substring(P?3:2,Y.lastIndexOf(P?"}}}":"}}")),A=u.charAt(0),L=-1!==["#","/","^"].indexOf(A),O=L||-1!==["&","!"].indexOf(A),N="/"===A,M=L&&!N,J=oa(u,"$System")||oa(u,"$Date")||oa(u,"$Time"),n=null,x=null,$=null,Q=!0,oa(u,"$Label.")){ta+="{{#SkuidLabel}}"+u.substring(7)+"{{/SkuidLabel}}";continue}if(d.fieldPrefix&&(u=O?A+d.fieldPrefix+u.substr(1):d.fieldPrefix+u,Y="{{"+u+"}}"),-1!==u.indexOf(".records")&&L&&(M?(va=u.substring(1,u.indexOf(".records")),h=va.startsWith("$Model.")):N&&(va=!1,h=!1)),J){if(R=rc.getLocalDateTime(new Date),"$System.Now"===u)u=P?rc.getSFDateTime(R):rc.makeFormattedLongDateTime(R);else if(q=u.split("."),1===q.length)u="$Date"===u?rc.makeFormattedDateFromLocal(R):rc.formatTime(Sb().timeFormat,R);else switch(q[1]){case"Year":u=R.getFullYear();break;case"Month":u=R.getMonth()+1;break;case"Day":u=R.getDate();break;case"DayOfWeek":u=R.getDay();break;case"Hour":u=R.getHours();break;case"Minute":u=R.getMinutes()+1;break;case"Second":u=R.getSeconds();break;case"Millisecond":u=R.getMilliseconds();break;case"Period":u=rc.getPeriod(R)}ta+=u;continue}if(la&&!P&&"&"!==A&&(!L||-1!==u.indexOf(".records"))){if(Q=!1,"$System.Now"===u){ta+=rc.makeFormattedLongDateTime(new Date);continue}if(C=u.match(/^[#\/]?\$Model\.([^.]+)\.data\.(\d+)\.(.+)/),null!==C&&(F=a.$M(C[1]),H=C[2],D=C[3],E=F&&F.fieldsMap,G=F&&F.getRows()[H],va&&(va=D.substring(0,D.indexOf(".records")))),L||null!==(w=(null!==C?D:u).match(/(.+)\.records\.(\d+)\.(.+)/))&&(va=w[1],i=w[2],x=w[3],C&&F?(j=F,k=G||null):(j=e,k=f),l=j.getFieldValue(k,va),(m=l&&l.records?l.records:null)&&m[i]&&(n=j.getRowId(m[i]))),null!==C?$={isSectionChar:L,childRelName:va,fieldsMap:E,fieldName:x||!L&&D||u,mode:Cc,model:F,row:G,childRowId:n,token:Y}:h?$={isSectionChar:L,childRelName:va,fieldsMap:E,fieldName:u,mode:Cc,model:F,row:G,token:Y}:b!==Ac&&(o=va&&ua||f,!n&&va&&ca[va]&&"childRelationship"===ca[va].type&&(n=e.getChildIdFromRow(f,va)),$={isSectionChar:L,childRelName:va,fieldsMap:ca,fieldName:x||u,mode:b,model:e,row:o,childRowId:n,token:Y}),$&&(_=kb($),Q=null!==_)){ta+=_;continue}}if(u){ta+=!fa||L||la&&Q?"{{"+u+"}}":"{{{"+u+"}}}";continue}ta+=Y}r=ia||fa&&!0!==ka||!1===ka,W=a.Mustache.render(ta,p),I=r?W:ja(W),S=pc('<div class="nx-template">').html(I);var ya=S.find(".nx-merge").length,za=[];la&&ya&&pc.each(S.find(".nx-merge"),function(){var b,c,g,h,i=pc(this),j=i.data("model"),k=i.data("field"),m=i.data("parentfield"),n=i.attr("data-parentrowid"),o=j&&a.$M(j)||e,p=i.attr("data-rowid");if(!p&&f&&(p=o.getRowId(f)),da(p)&&(p=ba(p)),da(n)&&(n=ba(n)),f&&ua)b=f;else if(m&&n&&p){l=o.dataMap[n]&&o.dataMap[n][m],h=l&&l.records?l.records:null;var q=o.getIdFieldForChildRelationship(m);try{var r=JSON.parse(p);p=r[q]}catch(s){}h&&pc.each(h,function(a,c){if(q&&p&&c[q]===p)return b=c,!1})}else o&&(b=o.dataMap[p]);k&&b?(c={fieldId:k,editable:!1,register:ma},m&&(c.fieldContext=m),d.noLink&&(c.noLink=!0),g=new a.ui.Field(b,o,null,c),g.render(),na.fields.push(g),i.after(fa?"{fieldValues."+(za.push(g.element.text())-1)+"}":g.element),i.remove(),fa&&g.unregister()):fa&&(i.after("{fieldValues."+(za.push(i.text())-1)+"}"),i.remove())});var Aa=S.html();return fa?(la&&ya?(a.Mustache.parse(Aa,["",""]),W=a.Mustache.render(Aa,{fieldValues:za})):W=I,ia?W:qc.encodeHTML(W)):(na.merges=S,na)}function kb(a){var b,c,d,e=a.isSectionChar,f=a.childRelName,g=a.fieldsMap,h=a.fieldName,i=e&&f&&g&&f in g&&"childRelationship"===g[f].type,j=a.mode,k=a.model,l=a.row,m=a.token,n=null,o=k&&l?k.getRowId(l):null,p=a.childRowId;return i?b=!1:f&&!e?(c=g[f],d=c.subFieldsMap,b=d&&h in d||"Id"===h):b=g&&h in g||"Id"===h,b&&(n='<span class="nx-merge'+(k?'" data-model="'+k.id:"")+'" data-field="'+h,n+=j===Cc?f?'" data-parentfield="'+f+(o?'" data-parentrowid="'+ca(o):"")+'" data-rowid="'+(p?ca(p)+'">'+m:"{{#SkuidField}}"+m+"{{/SkuidField}}")+"</span>":(l&&o?'" data-rowid="'+ca(o):"")+'">'+m+"</span>":(f?'" data-parentfield="'+f:"")+'" data-rowid="{{#SkuidField}}'+m+"{{/SkuidField}}</span>"),n}function lb(a,b){for(var c,d,e=pc.isArray(b)?b.length:0,f=0,g={};f<a.length;f++)if(c=a[f],e>0)for(d=0;d<e;d++)c.hasOwnProperty(b[d])&&(g[c[b[d]]]=c);else c.hasOwnProperty(b)&&(g[c[b]]=c);return g}function mb(a,b,c){var d={};pc.each(b,function(a,b){d[b]=!0});var e=pc.map(a[0].attributes,function(a){return a.name});pc.each(e,function(b,c){d[c]||a.removeAttr(c)}),c||a.empty()}function nb(a){return a.outerHTML||function(a){var b,c=document.createElement("div");return c.appendChild(a.cloneNode(!0)),b=c.innerHTML,c=null,b}(a)}function ob(a){return a&&"function"==typeof a.then}function pb(a,b,c){var d,e=kd();if(d=a?da(a)?a:""+wb(a):"",e.length){for(var f,g,h,i,j,k="",l=0,m=0,n=d.length,o=0,p=0,q={};p<e.length&&n>o;){if(f=e[p],g=b.getField(f).length,h=n>=l+g,k=d.substring(l,h?l+g:n),i=!1,h&&k.length&&""!==pc.trim(k))for(j=k.length-1;j>-1;j--)if(""===pc.trim(k[j]))i=!1;else{if(i){m=j+1;break}i=!0}else m=k.length;b.updateRow(c,f,k.substring(0,m)),l+=m,o+=g,p++}for(;p<e.length;)f=e[p],q[f]=null,p++;if(b.updateRow(c,q),o<n)throw"The total number of characters in this Page's Layout ("+n+") exceeds the maximum number of characters available for each Page ("+o+"). Please split out some of your content into other Pages, and then include these Pages within this Page."}}function qb(a){var b=a[0]();return pc.each(a,function(a,c){a&&(b=b.then(function(){return c()}))}),b}function rb(a){var b,c=a.model,d=a.row,e=a.field,f=e.lastIndexOf("."),g=c.isAggregate,h=-1!==f?e.substring(0,f+1):"";return g?b=wc.getConversionRates()[0].IsoCode:(b=c.getFieldValue(d,h+"CurrencyIsoCode",!0))||(b=c.getFieldValue(d,"CurrencyIsoCode",!0)),b}function sb(b,c,d){var e,f=wc.getConversionRates(),g=a.utils.conversionRatesMap;if(!f||!f.length)return b;if(e=f[0].IsoCode,g||(g=a.utils.conversionRatesMap={},pc.each(f,function(a,b){g[b.IsoCode]=b})),g&&g[c]&&g[d]){var h=g[d],i=Math.pow(10,6);if(c!==e){var j=g[c];b=Math.round(b/j.ConversionRate*i)/i}return Math.round(b*h.ConversionRate*i)/i}}function tb(a){a&&(mc=a.substring(0,a.indexOf("?")))}function ub(a){return(mc||"")+"?file="+a+"&retURL="+encodeURIComponent(location.pathname+location.search)}function vb(a){return da(a)?pc(pc.parseXML(a)).children().first():pc(a).children().first()}function wb(b){return b instanceof a.$&&(b=b[0]),b.xml?b.xml:(new XMLSerializer).serializeToString(b)}function xb(a){if(ga(a)||null===a)return 0;if(pc.isPlainObject(a)){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c}return pc.isArray(a)||da(a)?a.length:U(a)?a.toString().replace(/\D/g,"").length:0}function yb(a,b){b||(b=".");var c=["\\\\","\\"+b,b];return a.indexOf(".")<0?[a]:a.indexOf("\\")<0?a.split("."):zb(a,c)}function zb(a,b){var c,d=b[0],e=[],f=[],g=d&&d.substring(1);return 1===b.length?a.split(d):(a.split(d).forEach(function(a){e.push(zb(a,b.slice(1,b.length)))}),c=e.length,pc.each(e,function(a,b){if(b.length){var d=b.length;pc.each(b,function(b,h){if(b===d-1&&a!==c-1){var i=h+g+e[a+1][0];for(e[a+1].shift();e[a+2]&&!e[a+1].length;)a++,i+=g+e[a+1][0],e[a+1].shift();f.push(i)}else f.push(h)})}}),f)}function Ab(a,b){return["\\",b||"."].reduce(function(a,b){return a.split(b).join("\\"+b)},a)}function Bb(a){function b(a,c,d,e){var f=d?d+".":d;if(f+=Ab(a),pc.isPlainObject(c))return void pc.each(c,function(a,c){b(a,c,f,e)});e[f]=c}var c={};return pc.each(a,function(a,d){b(a,d,"",c)}),c}function Cb(a){var b=pc.Deferred();return setTimeout(function(){b.resolve()},a||0),b.promise()}function Db(b,c,d){var e,f,g,h,i,j="change keydown";d=d||{},g=d.delayTime||400,f=d.dataPropertyName,f?b.data(f,b.val()):e=b.val(),j+=md?9===md?" selectionchange keyup":md<9?" keyup":" keyup input":" keyup input",b.on(j,function(d){if(!b.prop("disabled")){var j=b.val(),k=function(){if(clearTimeout(h),i&&a.events.unsubscribe(i),f&&(e=b.data(f)),j===b.val()&&j!==e){var d=e;f?b.data(f,j):e=j,c&&c(j,d)}};clearTimeout(h),i&&a.events.unsubscribe(i);var l="keydown"===d.type&&(d.which===xc.ENTER||d.which===xc.TAB||d.metaKey||d.ctrlKey);"change"===d.type||l?k():"keydown"!==d.type&&(i=a.events.subscribe("skuid.ui.commitUserInput",k),h=setTimeout(k,g))}})}function Eb(a){if(a&&a.eventType){
var b,c=a.eventType,d=a.delay||400,e=a.callback;(a.context||pc(window)).on(c,function(){clearTimeout(b),b=setTimeout(function(){e&&e()},d)})}}function Fb(a,b){pc.fn[a]=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):typeof c!==Pc&&c?void pc.error("Method "+c+" does not exist on jQuery."+a):b.init.apply(this,arguments)}}function Gb(a,b){var c=pc("html"),d=function(e){pc(e.target).closest(a).length||(c.off("click.skuidBlur",d),b())};c.on("click.skuidBlur",d)}function Hb(){return nd++}function Ib(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:3&b|8).toString(16)})}function Jb(a,b){var c=a.split("."),d=b||"";return d&&-1===d.indexOf(".")&&c.length>1?d+="."+c[c.length-1]:d||(d=a),d}function Kb(a){var b="";do{b=od[63&a]+b,a>>>=6}while(0!==a);return b}function Lb(a){var b=""+Kb(Date.now());return(1===arguments.length?a.prefix:"sk")+"-"+b.substring(0,b.length-2)+"-"+Hb()}function Mb(b,c,d,e){return a.utils.isString(c)&&(c=[c]),b&&pc.each(b,function(){var a=this;a[d]={},pc.each(c,function(b,c){a[c]&&a[c].length&&pc.each(a[c],function(b,c){var f;pc.each(e instanceof Array?e:[e],function(b,e){(f=c[e])&&"undefined"!=f&&(a[d][f]=c)})})})}),b}function Nb(a){return a instanceof Array?a:[a]}function Ob(b){b&&b.data(yc)&&(pc.each(b.data(yc),function(){a.events.unsubscribe(this)}),b.removeData(yc))}function Pb(a){return td[a]}function Qb(a,b,c,d,e,f){var g=c?c.attr("uniqueid"):"";f||(f={});var h=function(){var b,g=d.data("rendered");return!g&&(b=a(c,d,e,f),d.data("rendered",!0),b)},i=function(){var a,g=d.data("rendered");return!(!g&&g!==undefined)&&(a=b(c,d,e,f),d.data("rendered",!1),a)};return g&&!td[g]&&(td[g]={override:!1,doRender:!0}),f.renderOverride=td[g],f.uniqueid=g,Rb(h,i,f.renderConditions?f.renderConditions:c&&c.children?c.children("renderconditions"):null,f.eventParentElement||d,f)}function Rb(b,c,d,e,f){function g(a){return w&&w.override?!0===w.doRender:N(a,{row:r,model:s,logicType:n,logic:o})}function h(a){if(a?f.event=a:"event"in f&&delete f.event,!t){t=!0;var d;d=g(q)?b(f):c(f),f.component&&a&&a.name&&(ob(d)||(d=pc.Deferred().resolve()),d.then(function(){f.component.publish("handled."+a.name)})),t=!1}}function i(b){var c,d,e=s&&r&&s.id&&(!b.fieldModel||b.fieldModel===s.id),f=e?s.id:b.fieldModel?b.fieldModel:s?s.id:null,g=f?a.$M(f):null,h=e?r:b.fieldRow?b.fieldRow:r||null;return h&&ia(h)&&g?c=g.getRowId(h):ea(h)?(d=h())&&(c=g.getRowId(d)):c=h,{modelId:f,rowId:c}}function j(){q.length=0,k={};var b,c,d=e&&e.data(yc);if(u.length){if(pc.each(u,function(b,c){a.events.unsubscribe(c)}),d&&d.length)for(b=d.length-1;b>=0;b--){c=d[b];for(var f=0;f<u.length;f++)c===u[f]&&d.splice(b,1)}u.length=0}p&&p.each(function(){var b=new a.model.Condition(pc(this));q.push(b)}),q.length&&(pc.each(q,function(b,c){var d,e,f=i(c),g=f.modelId,h=f.rowId,j=c.field,l=g&&a.model.getModel(g),m=c.sourceType;g&&(d=k[g],d||(d=k[g]={}),h?(e=d[h])||(e=d[h]={}):"fieldvalue"===m&&(d.__conditionsNeedRows=!0),"hasChanged"===c.sourceProperty?"modelproperty"===m?d.__any=!0:e&&(e.__any=!0):e&&j&&(l&&l.isRelationshipField(j)&&(j=l.getReferenceFieldNameFromRelationshipField(j)),e[j]||(e[j]=1)))}),u.push(v("row.updated",function(a){var b,c=k[a.modelId],d=!1;c&&(b=c[a.rowId],b&&(pc.each(b,function(b){if(Y(a.updates,b))return d=!0,!1}),!d&&b.__any&&(d=!a.rowHadPriorChanges)),d||(c.__any?d=!a.modelHadPriorChanges:c.__conditionsNeedRows&&(delete c.__conditionsNeedRows,j(),d=!0))),d&&h({name:"row.updated",data:a})})),u.push(v("row.created",function(a){var b=k[a.modelId];b&&(b[a.rowId]=a.row,h({name:"row.created",data:a}))})),u.push(v("row.deleted",function(a){a.modelId in k&&h({name:"row.deleted",data:a})})),u.push(v("row.undeleted",function(a){a.modelId in k&&h({name:"row.undeleted",data:a})})),u.push(v("models.saved",function(a){var b=!1;pc.each(k,function(c,d){if(c in a.models){b=!0;var e=a.insertResults;e&&e.length&&pc.each(e,function(a,b){var c=b.oldId,e=b.id;b.success&&c&&e&&c in d&&(d[e]=d[c],delete d[c])})}}),b&&h({name:"models.saved",data:a})})),u.push(v("models.cancelled",function(a){pc.each(k,function(b){if(b in a.models)return h({name:"models.cancelled",data:a}),!1})})),u.push(v("models.loaded",function(a){pc.each(k,function(b){if(b in a.models)return h({name:"models.loaded",data:a}),!1})}))),u.push(v("actions.conditionaloverride",function(a){x===a.componentId&&h({name:"actions.conditionaloverride"})})),u.length&&(d?Array.prototype.push.apply(d,u):e&&e.data(yc,u))}f||(f={});var k,l=f.context||{},m=d&&d.attr,n=m?d.attr("logictype"):null,o=m?d.attr("logic"):null,p=m?d.children():null,q=[],r=f.row?f.row:l.row,s=f.model?f.model:l.model,t=!1,u=f.eventSubscriptions,v=a.events.subscribe,w=f.renderOverride,x=f.uniqueid;return u||(u=f.eventSubscriptions=[]),j(),w&&w.override&&w.doRender||q.length&&g(q)||!q.length?b(f):c(f)}function Sb(){return a.utils.userLocale}function Tb(a,b,c){var d,e=Sb().timeFormat,f=e.toLowerCase(),g=f.indexOf("a"),h=f.indexOf("h"),i=[],j=new Date;for(-1!=g&&(e=g<h?"a"+e.charAt(h):e.charAt(h)+"a"),a=a||0,b=b||24,d=a;d<=b;d++)j.setHours(d,0,0,0),i.push({value:d,label:rc.formatTime(e,j),isSelected:c===d});return i}function Ub(a,b,c,d){c=c||0;var e,f,g,h=a.scrollParent(),i=h[0],j=i.scrollTop,k=i.clientHeight,l=j+k;if(!d&&pc(b).is(":visible"))b.hide();else if(b.show(),e=a[0].offsetHeight,g=a[0].offsetTop-c,(f=g+e)>=l-1){var m=Math.min(f-k+18,g);m>j&&(md||h.animate({scrollTop:m},500))}}function Vb(a,b){b=b||0;var c=a.scrollParent(),d=c[0],e=d.clientHeight,f=a[0].offsetHeight,g=a[0].offsetTop+f-b,h=g-e+18;md||c.animate({scrollTop:h},500)}function Wb(a,b){Eb({eventType:"resize orientationchange",delay:b,callback:a})}function Xb(b,c,d){c.element&&(c=c.element);var e={},f={},g=[];d=d||{},d.removeInlineStyles&&c.removeAttr("style"),b.find("styleitem").each(function(){var b,c,h=pc(this),i=h.attr("property"),j=h.attr("value"),k=h.attr("type"),l=h.attr("datasource"),m=a.dataSource.get(l);"background"===k&&"image"===h.attr("bgtype")?(!d.whitelist||d.whitelist&&-1!==d.whitelist.indexOf("background-image"))&&(b=h.attr("bg-source"),(c=m&&m.getImageSource(b))&&c.getSrc&&g.push(c.getSrc({context:{},mergeSettings:{},dataSource:c.dataSource,xmlDef:h,prefix:"bg-"}).then(function(a){f["background-image"]=a?"url("+a+")":""},function(){f["background-image"]=""}))):i&&(!d.whitelist||d.whitelist&&-1!==d.whitelist.indexOf(i))&&(e[i]=j||"")}),pc.isEmptyObject(e)||c.css(e),pc.when.all(g).then(function(){pc.isEmptyObject(f)||c.css(f)})}function Yb(a,b){var c;return b=b||{},a&&(c=a.toString().match(/^([\d]*\.?[\d]+)([^\d]*)$/)),!!c&&(c[1]=c[1].indexOf(".")>=0?parseFloat(c[1]):parseInt(c[1],10),{original:c[0],number:c[1],unit:c[2]?c[2]:b.defaultUnit||"px"})}function Zb(){return a.dev||!a.version?qd:a.version.date}function $b(b){return a.$.Deferred().resolve(b).promise()}function _b(b){return a.$.Deferred().reject(b).promise()}function ac(a){var b=this;if(b._GUID="SelectItem-"+Hb(),!a)throw"You must provide a configuration object when creating a new SelectItem.";if(!("value"in a))throw"Value is required.";pc.extend(b,a),"label"in a||(b.label=b.value),b.isSelected||(b.isSelected=!1)}function bc(){this.items=[],this.itemsMap={},this.selectedIndex=this.selectedKey=!1}function cc(a){a||(a={});var b=this;b._get=a.get,b._set=a.set,b.key=b._createKey({id:a.id,type:a.type})}function dc(){var a,b=this,c=qc.generateUniqueId({prefix:"kvs"});b.__id=c,a=b.__getPropName("s"),b[a]={}}function ec(b,c){var d=this;return d.element=b,d.options=c||{},d.editor=new a.ui.Editor(b,{showHeader:!1,showMessages:!1,customContentClass:"nx-editor-contents-template"}),c.model&&(d.model=c.model,d.editor.registerModel(d.model)),!d.conditions&&c.conditions&&(d.conditions=c.conditions),c.controllingComponent||(d.editor.handleSave=function(a){a&&d.render()},d.editor.handleCancel=function(){d.render()},d.editor.handleDataRefresh=function(){d.render()},d.editor.handleChange=function(){d.render()}),d.render(),d}function fc(a){var b=a.uploadMethod,c=cd&&n()&&e().isAuthenticated;this.options=a,this.canUpload=!1,this.uploadMethod=a.uploadMethod,this.saveTo=a.saveTo,this.saveToModel=a.saveToModel,this.saveToField=a.saveToField,this.progressDiv=pc("<div>").addClass("nx-file-progress"),this.dragAndDrop=c,"field"===a.saveTo&&(b={}),b.supportsIframeUpload&&b.supportsIframeUpload()?this.canUpload=!0:c&&(this.canUpload=!0),this.iframe=pc(c?'<input style="display:none;" type="file" id="'+Lb()+'" multiple>':'<iframe style="display:none;" src="" frameborder="0">')}function gc(){try{return window.self!==window.top}catch(a){return!0}}function hc(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}function ic(a){var b=pc.Deferred(),c=new FileReader;return c.onload=function(a){var c=a.target.result;c?b.resolve(c.substring(c.indexOf(",")+1)):b.reject("No Content Found")},c.onerror=function(a){b.reject(a)},c.readAsDataURL(a),b.promise()}function jc(b,c){var d,e=this,f=c.uploadMethod,g=!1!==c.autoRefreshModelsOnUpload,h=c.onUploadSuccessActions,i=c.onUploadFailureActions,j=c.row,k=c.model;if(b.data("object",e).addClass("nx-fileupload"),e.elem=b,e.options=c,e.buttonText=c.label||sc("upload"),e.cacheBuster=c.cacheBuster,e.uploadMethod=f,e.model=k,e.row=j,"field"===c.saveTo&&(f={}),!f){if(!(d=k.getDataSource()))return b.text(a.label.merge(sc("error_invalid_file_upload_data_source"),k.id)),!1;if(f=d.getUploadMethod(c.storeAs),c.uploadMethod=e.uploadMethod=f,!f)return b.text(a.label.merge(sc("error_could_not_find_upload_method"),c.storeAs)),!1}if(f.needsRecordContext&&!j)return b.text("No record found for file component."),!1;if(b.off("imageuploadcomplete imageuploadstarted mouseenter mouseleave click drop dragleave dragenter dragover"),e.canCreateOrUpdateImage=!0,f.needsRecordContext){if(!k.accessible)return b.text("You do not have permission to upload files to this record."),!1;if(k.isRowNew(j)){b.text("This record must be saved before you can upload files.");var m=a.events.subscribe("models.saved",function(d){k.id in d.models&&(k.isRowNew(j)||(b.empty(),new jc(b,c),a.events.unsubscribe(m)))});return!1}}if(f.needsFieldContext){var o=e.fieldName=c.idField;if(!o)return b.text("No image field was specified."),!1;e.fieldValue=k.getFieldValue(j,o);var p=f.getFileIdField&&f.getFileIdField(e.fieldName),q=f.getFileNameField&&f.getFileNameField(e.fieldName),r=k.getField(e.fieldName);e.fileId=k.getFieldValue(j,p),e.fileName=k.getFieldValue(j,q),e.canCreateOrUpdateImage=k.accessible&&(e.options.editable||e.options.deleteable)&&(k.updateable&&r.editable||e.fieldValue)}if((e.canCreateOrUpdateImage||"field"===c.saveTo)&&(e.uploader=new fc(c,f),e.uploader.canUpload?(e.uploader.attach(e),j&&k.getRowId(j)&&e.uploader.setSource({row:j,model:k},e.elem,e.fieldName)):b.text(function(){var a=n();return a||cd?a&&!cd?"Your browser does not support HTML5 file uploads.":!a&&cd?"You do not have permission to upload files using the API.":void 0:"You either do not have permission to upload files using the API, or your browser does not support HTML5 file uploads."}())),e.uploader&&e.uploader.canUpload||(e.canCreateOrUpdateImage=!1),e.status=pc("<div>").addClass("nx-fileupload-status").css({"float":"none",display:"inline-block"}).appendTo(b).hide(),e.statustext=pc("<div>").appendTo(e.status),"filename"===c.displayAs||f.forceStoreAsFileName){var s,t;if(!1!==e.canCreateOrUpdateImage&&e.uploader&&(t=pc("<div>"),e.progressParentDiv=t,a.mobile?(t.addClass("sm-button").css("display","inline-block"),s=new a.mobile.ui.Button({icon:"fa-plus",label:e.buttonText,element:t,iconColor:"green"}),t.on("tap",function(){e.uploader.pickFile()})):t.text(e.buttonText).css("vertical-align","top").skooButton({icon:"sk-icon-upload"}).click(function(a){a.stopPropagation(),e.uploader.pickFile()}),t.appendTo(b)),a.mobile||(e.status.addClass("nx-actionselect nx-status").css({"margin-left":"4px","word-break":"break-all"}),e.statustext.addClass("nx-actionselect-text")),k&&k.updateable&&c.deleteable){if(a.mobile){e.deletebutton=pc('<div class="sm-button">');var u=new a.mobile.ui.Button({icon:"fa-minus",element:e.deletebutton,iconColor:"red"});e.deletebutton.on("tap",function(){u.startProcessing(),e.deleteImage()}),b.on("imagedeletecomplete",function(){u.stopProcessing()})}else e.deletebutton=pc('<div class="sk-icon inline sk-icon-delete">').css({border:"3px solid #EEE","vertical-align":"top","background-color":"#EEE","margin-top":"3px",cursor:"pointer"}),e.deletebutton.click(function(){e.deleteImage()});e.deletebutton.css("display","inline-block").appendTo(b)}b.on("imageuploadstarted",function(b,c){e.dragAndDrop||(e.fileName=c.fileName),e.setStatus(a.label.merge(sc("uploading"),c.fileName)),e.status.off("click.skuid"),s&&s.startProcessing()}),s&&b.on("imageuploadcomplete",function(){s.stopProcessing()})}else"image"===c.displayAs&&(e.progressParentDiv=e.elem,e.elem.children(".nx-edithover").remove(),e.elem.addClass("nx-attachmentimage"),e.defaultImageSrc=l(e.options.defaultImage||"person"),e.image=pc("<img>").addClass("nx-attachmentimage-image").css("max-width","100%").appendTo(b),!1!==e.canCreateOrUpdateImage&&e.elem.on("mouseenter",function(){e.options.editable&&e.uploader&&e.elem.append(pc("<div>").addClass("nx-edithover sk-icon inline sk-icon-edit").css({"background-color":"white",opacity:"0.8",border:"4px solid white"}).click(function(a){e.elem.find(".nx-error").remove(),e.uploader&&e.uploader.pickFile(),a.stopPropagation()})),e.fileId&&e.options.deleteable&&e.elem.append(pc("<div>").addClass("nx-edithover sk-icon inline sk-icon-delete").css({cursor:"pointer","background-color":"white",opacity:"0.8",border:"4px solid white",left:"4px"}).click(function(a){e.elem.find(".nx-error").remove(),e.deleteImage(),a.stopPropagation()}))}).on("mouseleave",function(){e.elem.find("div.nx-edithover").remove()}));b.on("imageuploadcomplete",function(b,d){var l,m,n=d&&(d.newFileId||d.newAttachmentId),o=new Date;e.cacheBuster=o.getTime(),d&&d.newFileName&&(e.fileName=d.newFileName),n&&(e.fileId=n,e.fieldValue=d.newFieldValue||d.newImageId,e.syncModel(),e.draw()),d&&d.message?(l={text:d.message,hideIn:4},e.fileId&&e.fileName?"image"!==c.displayAs&&(l.complete=function(){e.setStatus(e.fileName)}):!e.fileId&&e.fileName&&(e.fileName=""),e.setStatus(l),i&&a.actions.runActionsNode(i,e,{model:k,row:j,$Error:{Message:d.message}})):(f.needsFieldContext||(e.setStatus({text:sc("upload_successful"),hideIn:2}),f.canRunPostUploadSnippet&&c.snippetName&&a.snippet.get(c.snippetName)(d)),f.relatedObjectName&&g&&(m=[],pc.each(a.model.list(),function(){var a=this.objectName===f.relatedObjectName,b=this.dataSource===f.dataSource;a&&b&&(m.push(this),this.cancel())}),a.model.updateData(m)),h&&a.actions.runActionsNode(h,e,{model:k,row:j,apiExtensions:{$Result:{body:d&&d.body?d.body:{}}}}))}),e.draw()}function kc(a,b,c){return Math.min(c,Math.max(b,a))}a.utils||(a.utils={});var lc,mc,nc,oc,pc=a.$,qc=a.utils,rc=a.time,sc=a.$L,tc=pc.inArray,uc={}.toString,vc=a.constants,wc=a.currency,xc=pc.ui.keyCode,yc="_crEventSubscriptions",zc=vc.MERGE_CONTEXTS,Ac=zc.GLOBAL,Bc=zc.MODEL,Cc=zc.ROW,Dc="fieldvalue",Ec='"',Fc='""',Gc=[",",'"',"\n"],Hc=vc.LOG_LEVELS,Ic=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Jc=/^([and|or|\d|\(|\)]+)$/,Kc=/\{{2,3}[^\{\}]+\}{2,3}/g,Lc=vc.JS_TYPES,Mc=Lc.BOOLEAN,Nc=Lc.NUMBER,Oc=Lc.STRING,Pc=Lc.OBJECT,Qc=Lc.FUNCTION,Rc=Lc.UNDEFINED,Sc=vc.DISPLAY_TYPES,Tc=Sc.BOOLEAN,Uc=Sc.INTEGER,Vc=Sc.NUMBER,Wc=Sc.PERCENT,Xc=Sc.CURRENCY,Yc=Sc.DOUBLE,Zc=Sc.DATE,$c=Sc.DATETIME,_c=Sc.ID,ad=Sc.REFERENCE,bd="nodata",cd=window.File&&window.FileReader&&window.FileList&&window.Blob&&window.XMLHttpRequest,dd={createFields:!1,registerFields:!1},ed={createFields:!0,registerFields:!1},fd={global:1,model:1,row:1},gd=[Uc,Vc,Wc,Xc,Yc],hd=[Zc,$c],id={defaultcurrency:"defaultCurrency",firstname:"firstName",lastname:"lastName",organizationid:"organizationId",organizationname:"organizationName",profileid:"profileId",profilename:"profileName",sessionid:"sessionId",userid:"userId",username:"userName",userroleid:"userRoleId",usertype:"userType"},jd={includes:1,excludes:1,"in":1,"not in":1},kd=function(){return a.platform.getLayoutFields()},ld=function(){return a.dataSource.getType(vc.SALESFORCE)},md=function(){for(var a=3,b=document.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e",c[0];);return a<=4&&!window.ActiveXObject&&"ActiveXObject"in window?11:a>4?a:void 0}(),nd=2,od="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-".split(""),pd=window.location.host,qd=Date.now(),rd={"!=":function(a,b){return a!==b},"=":function(a,b){return a===b},gt:function(a,b){return a>b},lt:function(a,b){return a<b},gte:function(a,b){return a>=b},lte:function(a,b){return a<=b},"starts with":function(a,b){return oa(a,b,!0)},"does not start with":function(a,b){return!oa(a,b,!0)},"ends with":function(a,b){return na(a,b,!0)},"does not end with":function(a,b){return!na(a,b,!0)},contains:function(a,b){return pa(a,b,!0)},"does not contain":function(a,b){return!pa(a,b,!0)},includes:function(a,b){return-1!==tc(b,a.split(";"))},excludes:function(a,b){return-1===tc(b,a.split(";"))}},sd={"!=":function(a,b){return a<b[0]||a>=b[1]},"=":function(a,b){return a>=b[0]&&a<b[1]},gt:function(a,b){return a>=b[1]},lt:function(a,b){return a<b[0]},gte:function(a,b){return a>=b[0]},lte:function(a,b){return a<b[1]}},td={};ac.prototype.id=function(){return this._GUID},bc.prototype={getItems:function(){return this.items},addItem:function(a,b){var c,d=this,e=d.items;if(!a._GUID)throw"Invalid SelectItem.";if(-1!==tc(a,e))throw"Item is already in the List.";a.isSelected&&!1!==d.selectedIndex&&(e[d.selectedIndex].isSelected=!1),b?e.unshift(a):e.push(a),c=b?0:e.length-1,a.isSelected?(d.selectedIndex=c,d.selectedKey=a.value):b&&!1!==d.selectedIndex&&d.selectedIndex++,d.itemsMap[a.value]=a,!1===d.selectedIndex&&(d.selectedIndex=c,d.selectedKey=a.value,a.isSelected=!0)},getSelected:function(){return!1===this.selectedIndex?null:this.items[this.selectedIndex]},addItems:function(a,b){var c=this;a&&pc.each(a,function(){c.addItem(this,b)})},size:function(){return this.items?this.items.length:0},removeItemAtIndex:function(a){this._validateIndex(a);var b=this.items[a],c=b.isSelected;b&&(b.value&&b.value in this.itemsMap&&delete this.itemsMap[b.value],this.items.splice(a,1),b.isSelected=!1),!1!==c&&(this.selectedIndex=!1,this.selectedKey=!1,this.size()>0&&this.selectItemAtIndex(0))},getItemAtIndex:function(a){return this.items[a]},getItemById:function(a){return pc.grep(this.items,function(){return this.id()===a})},selectItemAtIndex:function(a){if(this._validateIndex(a),!1!==this.selectedIndex){if(a===this.selectedIndex)return!0;this.items[this.selectedIndex].isSelected=!1}this.items[a].isSelected=!0,this.selectedIndex=a,this.selectedKey=this.items[a].value},unselectItemAtIndex:function(a){this._validateIndex(a),a===this.selectedIndex&&(this.items[a].isSelected=!1,this.selectedIndex=!1,this.selectedKey=!1)},_getItemIndex:function(a){var b;if(-1!==(b=U(a)?a:this.indexOf(a)))return b;throw"Invalid Item"},selectItem:function(a){this.selectItemAtIndex(this._getItemIndex(a))},unselectItem:function(a){this.unselectItemAtIndex(this._getItemIndex(a))},removeItem:function(a){this.removeItemAtIndex(this._getItemIndex(a))},indexOf:function(a){return!(a instanceof ac)&&a.value&&a.value in this.itemsMap&&(a=this.itemsMap[a.value]),a?tc(a,this.items):-1},contains:function(a){return-1!==this.indexOf(a)},_validateIndex:function(a){if(a>=this.size()||a<0)throw"Invalid Index";return!0}},cc.prototype={_createKey:function(a){if(a&&a.id)switch(a.type){case"component":return"skuid.component("+a.id+")";case"model":return"skuid.model("+a.id+")";default:return typeof a.type===Oc?a.type+"("+a.id+")":a.id}},getSettings:function(){var a=this.key,b=this._get();return a&&b&&a in b?pc.extend(!0,{},b[a]):{}},updateSettings:function(a,b){var c=this.key,d=this._get(),e=pc.extend(!0,{},d[c],a);if(b&&!0===b.removeNulls){var f=0,g=function(a){var b,c;if(!(f>200)){c=[];for(b in a)c.push(b);pc.each(c,function(b,c){"undefined"==typeof a[c]||null===a[c]?delete a[c]:typeof a[c]===Pc&&(f++,g(a[c]),f--)})}};g(e)}d[c]=e,this._set(d)}},dc.prototype={get:function(a){var b=this,c=b.__getPropName("s"),d=b[c]||{};return d.hasOwnProperty(a)?d[a]:undefined},set:function(a,b){var c={};c[a]=b,this.extend(c)},extend:function(a){var b=this,c=b.__getPropName("s"),d=Object.getPrototypeOf(b),e=b[c]||(b[c]={});pc.each(a,function(a,b){if(d[a])return!0;e[a]=b})},__getPropName:function(a){return"__"+this.__id+"_"+a}},ec.prototype={unregister:function(){this.editor&&this.model&&this.editor.unregister()},render:function(){var a,b=this,c=b.model,d=b.options||{},e=d.templateBody||"",f=d.context,g=b.conditions,h={allowHTML:d.allowHTML,registerFields:!1};f!==undefined&&(h.apiExtensions=f),b.editor.contents.empty(),c?(a=g&&g.length?c.getRows(g,f):f&&c&&f.model&&f.row&&f.model===c?[f.row]:c.getRows(null,f),!d.isMultiRow&&a&&a.length?(a&&a.length>1&&!0===d.onlyShowFirstRow&&(a=[a[0]]),pc.each(a,function(a,d){d&&b.editor.contents.append(c.mergeRow(d,e,h))})):b.editor.contents.append(c.mergeModel(e,h))):b.editor.contents.append(hb(Ac,e,h))}},fc.prototype={setSource:function(a,b,c){var d=this.uploadMethod;if(!this.dragAndDrop){var e,f,g=this.options;g&&(e=this.options.description,f=this.options.filename),d&&d.getIframeSrc&&this.iframe.attr("src",d.getIframeSrc(a,b,c,e,f))}},pickFile:function(){this.dragAndDrop?this.iframe.click():this.iframe.contents().find("input[type=file]").click()},startProgress:function(){this.fileComponent.progressParentDiv&&this.fileComponent.progressParentDiv.append(this.progressDiv)},handleProgress:function(a){if(this.fileComponent.progressParentDiv){var b=Math.round(a.loaded/a.total*100);b<100&&this.progressDiv.css("width",b+"%")}},endProgress:function(){var a=this;this.fileComponent.progressParentDiv&&(this.progressDiv.css("width","100%"),setTimeout(function(){a.progressDiv.detach()},1e3))},uploadFile:function(a,b){var c=this,d=c.options,e=c.element,f=pc.Deferred(),g=d.uploadMethod.dataSource,h=function(a){c.startProgress(),e.trigger("imageuploadstarted",a)},i=function(a){c.endProgress(),e.trigger("imageuploadcomplete",a),a&&a.message?f.reject(a.message):f.resolve()},j=function(a){c.handleProgress(a)};return g.authenticate().then(function(){d.uploadMethod.upload(a,b,d,h,i,j)},function(a){i({message:a})}),f.promise()},attach:function(b){var c,d,e,f,g,h=this,i=b.elem,j=h.options,k=!1;if(h.iframe.appendTo(i),h.element=i,h.fileComponent=b,h.dragAndDrop){d=pc(document.body),e=pc("<div>").addClass("nx-file-droppable").text(b.buttonText),f=function(c){c.preventDefault();var d=c.originalEvent.dataTransfer?c.originalEvent.dataTransfer.files:c.target.files;if("field"===h.saveTo){h.startProgress(),i.trigger("imageuploadstarted",{});var e=a.$M(h.saveToModel),f=e.getRows()[0],g=new FileReader;return g.onload=function(a){var b={};b[h.saveToField]=a.target.result,e.updateRow(f,b),h.endProgress(),i.trigger("imageuploadcomplete",{newFileName:d[0].name})},void g.readAsText(d[0])}if(!d||!d.length)return!1;var j;pc.each(d,function(a,c){j=j?j.then(function(){return h.uploadFile(c,b)}):h.uploadFile(c,b)})};var l=function(){g&&clearTimeout(g),g=setTimeout(function(){e.detach(),k=!1,e.removeClass("nx-file-dropping")},100)};h.iframe.on("click",function(a){this.value=null,a.stopPropagation()}).on("change",f),i.on("dragover",function(a){md||a.stopPropagation(),a.preventDefault(),a.originalEvent.dataTransfer.dropEffect="copy"}).on("dragenter",function(a){md&&(a.stopPropagation(),a.preventDefault(),l()),e.addClass("nx-file-dropping"),md&&(k||(i.append(e),k=!0))}).on("dragleave",function(a){md&&(a.stopPropagation(),a.preventDefault()),e.removeClass("nx-file-dropping")}).on("drop",f),d.on("dragenter."+j._GUID,function(a){a.preventDefault(),md?(k||(i.append(e),k=!0),l()):(c=a.target,i.append(e))}).on("dragover."+j._GUID,function(a){a.preventDefault(),md&&l()}).on("dragleave."+j._GUID,function(a){md||c!==a.target||(e.detach(),e.removeClass("nx-file-dropping"))}).on("drop."+j._GUID,function(a){return a.preventDefault(),a.stopPropagation(),e.detach(),e.removeClass("nx-file-dropping"),c=null,!1})}},unregister:function(a){var b=a.options._GUID;pc(document.body).off("dragenter."+b+" dragleave."+b+" drop."+b)}},jc.prototype={draw:function(){var b=this,c=this.uploadMethod,d=b.cacheBuster?"&cachebuster="+b.cacheBuster:"",e=function(){if(b.fileId){var e,f=pc("<img>").css({"max-height":"600px","max-width":"800px"}),g=b.image&&b.image.attr("src");g?f.attr("src",g):c.getSrc&&c.getSrc({context:{id:b.fileId},paramString:d,dataSource:c.dataSource}).then(function(a){e=a,f.attr("src",a)},function(){f.attr("src","")}),f.load(function(){var a=pc("<div>").attr("title",ca(b.fileName)).append(f).dialog({close:function(){pc(this).remove()},modal:!0,width:"auto",resizable:!1,open:function(){pc(".ui-widget-overlay").on("click",function(){a.dialog("close")})},dialogClass:"nx-imageview"})}),f.error(function(){e&&a.dataSource.utils.downloadWithLink(b.fileName,e)})}};"filename"===b.options.displayAs||(c||{}).forceStoreAsFileName?b.fileId&&b.fileName&&b.fieldName?(b.setStatus(b.fileName),b.status.off("click.skuid").on("click.skuid",function(){e()}),b.options.deleteable&&b.deletebutton&&b.deletebutton.show()):(b.deletebutton&&b.deletebutton.hide(),b.status.hide()):"image"===b.options.displayAs&&(b.fileId?c.getSrc&&c.getSrc({context:{id:b.fileId},paramString:d,dataSource:c.dataSource}).then(function(a){b.image.attr("src",a)},function(){b.image.attr("src","")}):b.image.attr("src",b.defaultImageSrc),b.elem.off("click.skuid").on("click.skuid",function(){e()}),b.status&&b.status.hide())},setStatus:function(b){var c,d,e,f=this,g=f.status,h=f.statustext;b&&(da(b)?c=b:(c=b.text,d=b.hideIn,e=b.complete)),g&&h&&(f.statusTimeout&&clearTimeout(f.statusTimeout),a.ui.setStatus(g,h,c),d>=0&&(f.statusTimeout=setTimeout(function(){g.animate({opacity:0},{duration:2e3,complete:e||function(){g.hide()}})},1e3*d)))},deleteImage:function(){var a=this,b=a.uploadMethod,c=b.dataSource,d=function(){a.setStatus(sc("deleting"))},e=function(b){var c;b&&b.message?a.setStatus({text:b.message,hideIn:2,complete:function(){a.draw()}}):(c=a.fileId,a.fileId=null,a.fileName=null,a.fieldValue=null,a.elem.trigger("imagedeletecomplete",{oldFileId:c}),a.syncModel(),a.draw())};c.authenticate().then(function(){b.deleteFile({row:a.row,model:a.model},a.fieldName,d,e)},function(a){e({message:a})})},unregister:function(){this.elem&&this.elem.remove&&this.elem.remove(),this.uploader&&this.uploader.unregister(this)},syncModel:function(){var a=this,b={},c=a.model,d=a.row,e={},f=a.uploadMethod,g=f.getFileIdField&&f.getFileIdField(a.fieldName),h=f.getFileNameField&&f.getFileNameField(a.fieldName);if(b[c.getRowId(d)]=e,a.fieldName){a.fieldValue===d[a.fieldName]&&a.fileId===c.getFieldValue(d,g,!0)||(e[a.fieldName]=a.fieldValue);var i={};Z(i,g,a.fileId),Z(i,h,a.fileName),a.fieldValue?(pc.each(i,function(a,b){e[a]=b}),pc.extend(d,e)):(delete d[a.fieldName],pc.each(i,function(a){delete d[a]})),xb(e)&&c.notifyFieldsOfChange(b,{initiatorId:a._GUID})}}},pc.extend(qc,{addResizeHandler:Wb,adjustValueBasedOnQuotedness:W,applyURLParametersToURL:Ia,areConditionsMet:N,areArraysEqual:ta,calculateReferenceMerges:D,calculateReferenceText:E,canUseSessionStorage:q,capitalizeFirst:r,clamp:kc,combineStrings:t,combineUrls:s,conditionallyDo:Rb,conditionallyRender:Qb,contains:pa,convertCurrency:sb,createMapForArray:Mb,createPopupFromPopupXML:B,createPopupFromAction:C,createSearchSubConditions:Qa,debounce:xa,decodeHTML:ba,decodeXML:aa,delay:Cb,delayEventCallback:Eb,delayInputCallback:Db,deparam:$a,doArraysIntersect:sa,doesRowMeetConditions:O,downloadBase64StringAsFile:P,downloadStringAsFile:Q,encodeHTML:ca,endsWith:na,escapeCSVCell:ua,escapeFieldName:Ab,escapeSelector:va,escapeSingleQuotes:wa,extractFieldsFromTemplate:Ra,filterRowsByConditions:R,filterByDataSourceAndEntity:S,generateGUID:Hb,generateUniqueId:Lb,getAPIDescribeLayout:Fa,getAPIDescribeSObject:Ga,getBodiesOfZIPResourceFiles:za,getBodyOfStaticResource:ya,getBodyOfZIPResourceFile:Ba,getCacheTimestamp:Zb,getCSSSizeObj:Yb,getContextToUse:m,getCurrentDomain:g,getDefaultImageUrl:l,getDisplayTypeOfEntity:Ta,getFieldReference:H,getFieldRelationshipName:F,getHourOptions:Tb,getInvokable:fb,getJSONBodiesOfZIPResourceFiles:Aa,getJSONBodyOfZIPResourceFile:Ca,getLayoutFields:kd,getLocalVisualforceDomain:h,getMergeApi:ib,getMergeResult:jb,getMetadataForRecordTypes:Ea,getModelFieldIdChanges:Bb,getNameField:Da,getObjectProperty:X,getPicklistEntriesValidForRecordTypes:Ha,getRowCurrency:rb,getSafeRelativeUrl:k,getSearchOperatorForDisplayType:Pa,getStaticResourceUrl:j,determineIfInSkuidNamespace:i,getTargetObject:G,getUnescapedParts:yb,getUrlFromAttachmentId:ub,getUserInfoPropValue:I,getXML:wb,grab:p,hasObjectProperty:Y,highlightSFTab:Ja,ifElse:Ka,inPlatform:c,ingestConstructorArguments:M,insertAtIndex:La,isApiEnabled:n,isBlank:ha,isDate:fa,isExactlyNaN:V,isFunction:ea,isMultiValueOperator:T,isNumber:U,isPromise:ob,isString:da,isUndefined:ga,isObject:ia,joinStrings:u,keyBy:lb,loadJS:Ma,loadRichTextApi:Na,loadCSS:Oa,log:A,lowercase:ka,makeConditionLogicString:J,makeXMLDoc:vb,merge:hb,mergeArrays:o,mergeAsDataInContext:db,mergeAsTextInContext:eb,mergeAsText:gb,mergeInContext:bb,mergeNodeProperty:y,modelLookup:Sa,niceExpand:Ub,nl2br:ja,outerHTML:nb,param:_a,parseAsJSONIfString:x,processStylesNode:Xb,readFileAsBase64:ic,redirect:z,registerBlurHandler:Gb,registerPlugin:Fb,reject:_b,removeAllAttrsExcept:mb,removeEventSubscriptions:Ob,removeScriptTags:_,renameFileWhileKeepingExtension:Jb,resolve:$b,rfc4122v4GUID:Ib,runPromiseReturningFunctionsInSeries:qb,runningTests:d,scrollTo:Vb,sessionStorage:w,setObjectProperty:Z,size:xb,startsWith:oa,substringLeft:qa,substringRight:ra,toArray:Nb,toClass:uc,unsetObjectProperty:$,uppercase:la,writeXmlToPageLayoutFields:pb,_getRenderOverride:Pb,_ie:md,_inIframe:gc,_oniOS:hc,_setAttachmentBaseUrl:tb,_setCurrentDomain:f,FileUploader:fc,FileComponent:jc,KeyValueService:cc,KeyValueStore:dc,SelectList:bc,SelectItem:ac,TemplateComponent:ec})}(window.skuid),function(a){function b(a,b){var c;1===arguments.length?b=a:(c=b,b={},b[a]=c),g.each(b,function(a,b){var c;if(h[a]){if(!((c=k[a])instanceof j))return!0}else c=new j,h[a]=c.get.bind(c),k[a]=c;c.extend(b)})}function c(a,b){if(!i.isString(a))return undefined;var c,d;return 1===arguments.length&&(c=a.match(/^([^.]*)\.?(.*)?/),a=c[1],b=c[2]),d=e(a),d?b?d.get(b):d:undefined}function d(b,c,d){if(!i.isString(b))throw"Invalid namespace";var f,h,j,k,m="",n="",o={},p={},q={};m=l+b,n=m+".",2===arguments.length&&(h=b.match(/^([^.]*)\.?(.*)?/),b=h[1],j=h[2],j?q[j]=c:q=c),3===arguments.length&&i.isString(c)&&!i.isObject(d)&&(q[c]=d),f=e(b),g.each(q,function(a,b){(k=f.get(a))!==b&&(o[a]=b,p[a]=k)}),f.extend(q),g.each(q,function(b,c){a.events.publish(n+b,[{event:n+b,newValue:c,previousValue:p[b]}])}),a.events.publish(m,[{event:m,values:q,newValues:o,previousValues:p}])}function e(a){var b=k[a];return b instanceof j?b:undefined}function f(){return g.map(Object.getOwnPropertyNames(k),e)}var g=a.$,h=a.settings={},i=a.utils,j=i.KeyValueStore,k=h.__stores={},l="skuid.settings.modified:";g.extend(a.settings,{init:b,get:c,set:d,__getStore:e,__getStores:f})}(window.skuid),function(a){function b(a){var b=a.getFullName();if(K[b]&&K[b]!==a)throw'A formula with the name "'+b+'" was already registered.';return K[b]=a,a}function c(a){var b=a.getFullName();return K[b]&&delete K[b],a}function d(a){return a=a.toUpperCase(),K[a]}function e(){return p({},K)}function f(){var a=o.map(K,function(a){var b=a._getIsDeprecated(),c=a.getLocalName(),d=a.getFullName(),e=a.getNamespace(),f=a.getDefaultBuilderState(),g=null!==e;if(!b)return{label:c.toUpperCase()+(g?" (custom - "+e+")":""),value:f||d+"()",isCustom:g,formula:a}});return a.sort(function(a,b){
var c=a.formula,d=b.formula,e=c.getLocalName().toUpperCase(),f=d.getLocalName().toUpperCase(),g=(c.getNamespace()||"").toUpperCase(),h=(d.getNamespace()||"").toUpperCase();return e<f?-1:e>f?1:g<h?-1:1}),a}function g(a,b){return s.isUndefined(b)&&(b=0),function(){var c=Array.prototype.slice.call(arguments),d=c[b];return s.isDate(d)&&(c[b]=r().getLocalDateTime(d)),a.apply(window,c)}}function h(a){var b=1,c=arguments.length,d=c%2==0,e=c-(d?2:1);if(c<3)throw"The CASE function requires at least 3 parameters.";for(;b<e;b+=2)if(a===arguments[b])return arguments[b+1];return d?arguments[c-1]:undefined}function i(a){var b,c=Array.prototype.slice.call(arguments,1),d=c.length;if(!s.isString(a)||!d)return!1;for(b=0;b<d;b++)if(-1!==a.indexOf(c[b]))return!0;return!1}function j(a){var b,c=Array.prototype.slice.call(arguments,1),d=c.length;if(!s.isString(a)||!d)return!1;for(b=0;b<d;b++)if(-1===a.indexOf(c[b]))return!1;return!0}function k(b,c,e){function f(a){var b=a["class"].major,c=a["class"].minor;return"expression"===b?g(c,a):i(c,a)}function g(a,b){var c,e,g,i,j=b.params;return"operational"===a?(c=f(j.head),j.operations?j.operations.forEach(function(a){c=h(c,a)}):j.operation&&(c=h(c,j.operation))):(i=(j.name||"").toUpperCase(),i.startsWith("C_")&&!i.startsWith("C__")&&(i="C__"+i.substring(2)),e=d(i),g=e&&j.arguments.map(function(a){return f(a)}),c=e&&e.evaluate(g)),c===undefined&&(c=null),c}function h(a,b){var c=b.operator,d=L[c["class"].minor][c.params.symbol],e=b.operand,g=d&&e&&f(e);return a===undefined&&(a=null),g===undefined&&(g=null),d&&d(a,g)}function i(a,b){var d,e=b.params.value;switch(null!==e&&e!==undefined||(e=""),a){case"keyword":switch(e.toLowerCase()){case"true":return!0;case"false":return!1;case"nan":return NaN;default:return null}case"number":return parseFloat(e);case"merge":d=s.mergeInContext("{{"+e+"}}",c,{asData:!0,coerceToJSType:!0,apiExtensions:c.apiExtensions});break;default:d=e}return d===undefined&&(d=null),d}return e||(e={}),function(b,c){var d=a.time;switch(c){case C:return parseInt(b,10);case F:case D:case E:case G:return parseFloat(b);case B:return(!s.isString(b)||"false"!==b.trim().toLowerCase())&&(null===b||b===undefined?b:!!b);case H:return s.isDate(b)&&(b=d.getLocalDateTime(b)),d.getSFDate(b);case I:return d.getSFDateTime(b)}return b}(f(b),e.outputType)}function l(a){try{this.__root=q.parser.parse(a)}catch(b){this.__error=b}}function m(a,b,c){return c||(c={}),k(q.parser.parse(a),b,c)}function n(a,b,c){if(!(this instanceof n))return new n(a,b,c);c=c||{};var d=this,e=J?null:c.namespace||"c",f=((J?"":e+"__")+a).toUpperCase();if(!s.isString(a)||!s.isFunction(b))throw"Bad Formula Initialization: both forumula formulaName and formula function must be defined";d[N]=a,d[O]=e,d[Q]=c.argCount||c.numArgs,d[R]=c.returnType,d[S]=b,d[P]=f,d[T]=c.defaultBuilderState||c.defaultState,d[U]=c.deprecated||!1,K[f]=d}var o=a.$,p=o.extend,q=a.formula={},r=function(){return a.time},s=a.utils,t=a.constants,u=t.LOG_LEVELS.WARNING,v=t.JS_TYPES,w=v.BOOLEAN,x=v.NUMBER,y=v.STRING,z="date",A=t.DISPLAY_TYPES,B=A.BOOLEAN,C=A.INTEGER,D=A.NUMBER,E=A.PERCENT,F=A.CURRENCY,G=A.DOUBLE,H=A.DATE,I=A.DATETIME,J=!1,K={},L={logical:{"|":function(a,b){return a||b},"&":function(a,b){return a&&b},"!=":function(a,b){return a!=b},"=":function(a,b){return a===b},"<":function(a,b){return a<b},"<=":function(a,b){return a<=b},">":function(a,b){return a>b},">=":function(a,b){return a>=b}},algebraic:{"+":function(a,b){return a+b},"-":function(a,b){return a-b},"*":function(a,b){return a*b},"/":function(a,b){return a/b},"%":function(a,b){return a%b}},unary:{"+":function(a){return+a},"-":function(a){return-a},"!":function(a){return!a}}};l.prototype={getTokenTree:function(){return this.__root||{}},getError:function(){return this.__error},evaluate:function(a,b){return this.__error?undefined:k(this.__root,a,b)}},o(document.body).one("pageload",function(){a.builder&&a.builder.core&&(a.builder.core.formula={getFormulasAsItems:f})});var M=1,N="_prop"+M++,O="_prop"+M++,P="_prop"+M++,Q="_prop"+M++,R="_prop"+M++,S="_prop"+M++,T="_prop"+M++,U="_prop"+M++;n.prototype={evaluate:function(a){var b=this[S];if(b)return 1===arguments.length&&o.isArray(a)||(a=arguments),b.apply(this,a)},getLocalName:function(){return this[N]},getNamespace:function(){return this[O]},getArgumentCount:function(){return this[Q]},getReturnType:function(){return this[R]},getFullName:function(){return this[P]},getDefaultBuilderState:function(){return this[T]},_getIsDeprecated:function(){return this[U]},register:function(){b(this)},unregister:function(){c(this)},getFunction:function(){return s.log("Formula.getFunction is deprecated. Use Formula.evaluate instead.",u),this[S]},getName:function(){return s.log("Formula.getName is deprecated. Use Formula.getLocalName instead.",u),this.getFullName()},getNumArgs:function(){return s.log("Formula.getNumArgs is deprecated. Use Formula.getArgumentCount instead.",u),this.getArgumentCount()}},function(){J=!0,o.each({ABS:{state:"ABS(number)",type:x,func:Math.abs},AMPM:{state:"AMPM(datetime)",type:z,func:g(r().getPeriod)},CASE:{state:"CASE(testValue, case1, result1, case2, result2, ..., default)",func:h},CEIL:{state:"CEIL(val)",type:z,func:Math.ceil},COMBINE_STRINGS:{state:"COMBINE_STRINGS(startString,endString,separator)",type:y,args:3,func:s.combineStrings,deprecated:!0},CONTAINS:{state:"CONTAINS(stringToExamine,stringToLookFor)",type:w,args:2,func:s.contains},CONTAINS_ALL:{state:"CONTAINS_ALL(stringToExamine, stringToLookFor1, stringToLookFor2, ...)",type:w,func:j},CONTAINS_ANY:{state:"CONTAINS_ANY(stringToExamine, stringToLookFor1, stringToLookFor2, ...)",type:w,func:i},ENDS_WITH:{state:"ENDS_WITH(stringToExamine,stringToLookFor)",type:w,args:2,func:s.endsWith},TODAY:{type:z,state:"TODAY()",args:0,func:function(){var a=new Date;return a.setHours(0,0,0,0),a}},DAY:{state:"DAY(date)",type:z,func:g(r().getDay)},DAY_NAME:{state:"DAY_NAME(date)",type:z,func:g(r().getDayName)},DAY_NAME_SHORT:{state:"DAY_NAME_SHORT(date)",type:z,func:g(r().getDayNameShort)},DAY_OF_WEEK:{state:"DAY_OF_WEEK(date)",type:z,func:g(r().getDayOfWeek)},DAY_OF_WEEK_UTC:{state:"DAY_OF_WEEK_UTC(date)",type:z,func:g(r().getUTCDayOfWeek)},FLOOR:{state:"FLOOR(val)",type:x,func:Math.floor},FORMAT_DATE:{state:"FORMAT_DATE(format,date)",type:z,args:2,func:g(r().formatDate,1)},FORMAT_TIME:{state:"FORMAT_TIME(format,datetime)",type:z,args:2,func:g(r().formatTime,1)},HOUR:{state:"HOUR(datetime)",type:z,func:g(r().getHour)},HOUR_UTC:{state:"HOUR_UTC(datetime)",type:z,func:r().getUTCHour},IF:{state:"IF(logic_test,value_if_true,value_if_false)",type:w,args:3,func:s.ifElse},ISBLANK:{state:"ISBLANK(val)",type:w,func:s.isBlank},JOIN_TEXT:{state:"JOIN_TEXT(separator,firstString,secondString,etcString)",type:y,args:3,func:s.joinStrings},LEFT:{state:"LEFT(string,numChars)",type:y,args:2,func:s.substringLeft},LEN:{state:"LEN(string)",type:y,func:s.size},LOWER:{state:"LOWER(string)",type:y,func:s.lowercase},MILLISECOND:{state:"MILLISECOND(datetime)",type:z,func:g(r().getMillisecond)},MINUTE:{state:"MINUTE(datetime)",type:z,func:g(r().getMinute)},MINUTE_UTC:{state:"MINUTE_UTC(datetime)",type:z,func:r().getUTCMinute},MODEL_LOOKUP:{state:"MODEL_LOOKUP(Lookup_Model_Id,Model_Field_To_Return,Model_Field_To_Search,Search_Value)",args:4,func:s.modelLookup},MONTH:{state:"MONTH(date)",type:z,func:g(r().getMonth)},MONTH_UTC:{state:"MONTH_UTC(date)",type:z,func:r().getUTCMonth},MONTH_NAME:{state:"MONTH_NAME(date)",type:z,func:g(r().getMonthName)},MONTH_NAME_SHORT:{state:"MONTH_NAME_SHORT(date)",type:z,func:g(r().getMonthNameShort)},NOW:{type:z,state:"NOW()",args:0,func:r().roundedNow},RIGHT:{state:"RIGHT(string,numChars)",type:y,args:2,func:s.substringRight},ROUND:{state:"ROUND(val)",type:x,func:Math.round},SECOND:{state:"SECOND(datetime)",type:z,func:g(r().getSecond)},SECOND_UTC:{state:"SECOND_UTC(datetime)",type:z,func:r().getUTCSecond},STARTS_WITH:{state:"STARTS_WITH(stringToExamine,stringToLookFor)",type:w,args:2,func:s.startsWith},UPPER:{state:"UPPER(string)",type:y,func:s.uppercase},VALUE:{state:"VALUE(text)",type:y,func:window.parseFloat},YEAR:{state:"YEAR(date)",type:z,func:g(r().getYear)},YEAR_UTC:{state:"YEAR_UTC(date)",type:z,func:r().getUTCYear}},function(a,b){new n(a,b.func,{argCount:b.args,returnType:b.type,defaultBuilderState:b.state,deprecated:b.deprecated})}),J=!1}(),o.extend(q,{CompiledFormula:l,FormulaFunction:n,evaluate:m,get:d,map:e,Formula:n}),a.utils.runningTests()&&(q.internalFunctions={CASE:h,CONTAINS_ALL:j,CONTAINS_ANY:i})}(window.skuid),function(a){function b(a,c,d,e){this.message=a,this.expected=c,this.found=d,this.location=e,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,b)}function c(a,c){function d(b,c){throw c=void 0!==c?c:i(Pc,Oc),k([g(b)],a.substring(Pc,Oc),c)}function e(a,b){return{type:"literal",text:a,ignoreCase:b}}function f(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function g(a){return{type:"other",description:a}}function h(b){var c,d=Qc[b];if(d)return d;for(c=b-1;!Qc[c];)c--;for(d=Qc[c],d={line:d.line,column:d.column};c<b;)10===a.charCodeAt(c)?(d.line++,d.column=1):d.column++,c++;return Qc[b]=d,d}function i(a,b){var c=h(a),d=h(b);return{start:{offset:a,line:c.line,column:c.column},end:{offset:b,line:d.line,column:d.column}}}function j(a){Oc<Rc||(Oc>Rc&&(Rc=Oc,Sc=[]),Sc.push(a))}function k(a,c,d){return new b(b.buildMessage(a,c),a,c,d)}function l(){var a,b,c,d,e=29*Oc+0,f=Uc[e];return f?(Oc=f.nextPos,f.result):(a=Oc,b=M(),b!==U?(c=w(),c!==U?(d=M(),d!==U?(Pc=a,b=X(c),a=b):(Oc=a,a=U)):(Oc=a,a=U)):(Oc=a,a=U),a===U&&(a=Oc,b=M(),b!==U?(c=t(),c!==U?(d=M(),d!==U?(Pc=a,b=X(c),a=b):(Oc=a,a=U)):(Oc=a,a=U)):(Oc=a,a=U),a===U&&(a=Oc,b=M(),b!==U?(c=m(),c!==U?(d=M(),d!==U?(Pc=a,b=X(c),a=b):(Oc=a,a=U)):(Oc=a,a=U)):(Oc=a,a=U),a===U&&(a=Oc,b=M(),b!==U&&(Pc=a,b=Y()),a=b))),Uc[e]={nextPos:Oc,result:a},a)}function m(){var a,b=29*Oc+1,c=Uc[b];return c?(Oc=c.nextPos,c.result):(a=n(),a===U&&(a=p())===U&&(a=q())===U&&(a=r())===U&&(a=s()),Uc[b]={nextPos:Oc,result:a},a)}function n(){var b,c,d,e,f=29*Oc+2,g=Uc[f];if(g)return Oc=g.nextPos,g.result;if(b=Oc,34===a.charCodeAt(Oc)?(c=Z,Oc++):(c=U,0===Tc&&j($)),c!==U){for(d=[],e=o(),e===U&&(_.test(a.charAt(Oc))?(e=a.charAt(Oc),Oc++):(e=U,0===Tc&&j(aa)));e!==U;)d.push(e),(e=o())===U&&(_.test(a.charAt(Oc))?(e=a.charAt(Oc),Oc++):(e=U,0===Tc&&j(aa)));d!==U?(34===a.charCodeAt(Oc)?(e=Z,Oc++):(e=U,0===Tc&&j($)),e!==U?(Pc=b,c=ba(d),b=c):(Oc=b,b=U)):(Oc=b,b=U)}else Oc=b,b=U;if(b===U)if(b=Oc,39===a.charCodeAt(Oc)?(c=ca,Oc++):(c=U,0===Tc&&j(da)),c!==U){for(d=[],e=o(),e===U&&(ea.test(a.charAt(Oc))?(e=a.charAt(Oc),Oc++):(e=U,0===Tc&&j(fa)));e!==U;)d.push(e),(e=o())===U&&(ea.test(a.charAt(Oc))?(e=a.charAt(Oc),Oc++):(e=U,0===Tc&&j(fa)));d!==U?(39===a.charCodeAt(Oc)?(e=ca,Oc++):(e=U,0===Tc&&j(da)),e!==U?(Pc=b,c=ba(d),b=c):(Oc=b,b=U)):(Oc=b,b=U)}else Oc=b,b=U;return Uc[f]={nextPos:Oc,result:b},b}function o(){var b,c,d,e,f,g,h,i,k=29*Oc+3,l=Uc[k];return l?(Oc=l.nextPos,l.result):(b=Oc,92===a.charCodeAt(Oc)?(c=ga,Oc++):(c=U,0===Tc&&j(ha)),c!==U?(d=Oc,e=Oc,ia.test(a.charAt(Oc))?(f=a.charAt(Oc),Oc++):(f=U,0===Tc&&j(ja)),f!==U?(ka.test(a.charAt(Oc))?(g=a.charAt(Oc),Oc++):(g=U,0===Tc&&j(la)),g===U&&(g=null),g!==U?(ka.test(a.charAt(Oc))?(h=a.charAt(Oc),Oc++):(h=U,0===Tc&&j(la)),h===U&&(h=null),h!==U?(ka.test(a.charAt(Oc))?(i=a.charAt(Oc),Oc++):(i=U,0===Tc&&j(la)),i===U&&(i=null),i!==U?(f=[f,g,h,i],e=f):(Oc=e,e=U)):(Oc=e,e=U)):(Oc=e,e=U)):(Oc=e,e=U),e===U&&(e=Oc,ka.test(a.charAt(Oc))?(f=a.charAt(Oc),Oc++):(f=U,0===Tc&&j(la)),f!==U?(ka.test(a.charAt(Oc))?(g=a.charAt(Oc),Oc++):(g=U,0===Tc&&j(la)),g!==U?(ka.test(a.charAt(Oc))?(h=a.charAt(Oc),Oc++):(h=U,0===Tc&&j(la)),h===U&&(h=null),h!==U?(f=[f,g,h],e=f):(Oc=e,e=U)):(Oc=e,e=U)):(Oc=e,e=U)),d=e!==U?a.substring(d,Oc):e,d!==U?(Pc=b,c=ma(d),b=c):(Oc=b,b=U)):(Oc=b,b=U),b===U&&(b=Oc,a.substr(Oc,2)===na?(c=na,Oc+=2):(c=U,0===Tc&&j(oa)),c!==U?(d=Oc,e=Oc,pa.test(a.charAt(Oc))?(f=a.charAt(Oc),Oc++):(f=U,0===Tc&&j(qa)),f!==U?(pa.test(a.charAt(Oc))?(g=a.charAt(Oc),Oc++):(g=U,0===Tc&&j(qa)),g!==U?(f=[f,g],e=f):(Oc=e,e=U)):(Oc=e,e=U),d=e!==U?a.substring(d,Oc):e,d!==U?(Pc=b,c=ra(d),b=c):(Oc=b,b=U)):(Oc=b,b=U),b===U&&(b=Oc,a.substr(Oc,2)===sa?(c=sa,Oc+=2):(c=U,0===Tc&&j(ta)),c!==U?(d=Oc,e=Oc,pa.test(a.charAt(Oc))?(f=a.charAt(Oc),Oc++):(f=U,0===Tc&&j(qa)),f!==U?(pa.test(a.charAt(Oc))?(g=a.charAt(Oc),Oc++):(g=U,0===Tc&&j(qa)),g!==U?(pa.test(a.charAt(Oc))?(h=a.charAt(Oc),Oc++):(h=U,0===Tc&&j(qa)),h!==U?(pa.test(a.charAt(Oc))?(i=a.charAt(Oc),Oc++):(i=U,0===Tc&&j(qa)),i!==U?(f=[f,g,h,i],e=f):(Oc=e,e=U)):(Oc=e,e=U)):(Oc=e,e=U)):(Oc=e,e=U),d=e!==U?a.substring(d,Oc):e,d!==U?(Pc=b,c=ra(d),b=c):(Oc=b,b=U)):(Oc=b,b=U),b===U&&(b=Oc,a.substr(Oc,2)===ua?(c=ua,Oc+=2):(c=U,0===Tc&&j(va)),c!==U&&(Pc=b,c=wa()),(b=c)===U&&(b=Oc,a.substr(Oc,2)===xa?(c=xa,Oc+=2):(c=U,0===Tc&&j(ya)),c!==U&&(Pc=b,c=za()),(b=c)===U&&(b=Oc,a.substr(Oc,2)===Aa?(c=Aa,Oc+=2):(c=U,0===Tc&&j(Ba)),c!==U&&(Pc=b,c=Ca()),(b=c)===U&&(b=Oc,a.substr(Oc,2)===Da?(c=Da,Oc+=2):(c=U,0===Tc&&j(Ea)),c!==U&&(Pc=b,c=Fa()),(b=c)===U&&(b=Oc,a.substr(Oc,2)===Ga?(c=Ga,Oc+=2):(c=U,0===Tc&&j(Ha)),c!==U&&(Pc=b,c=Ia()),(b=c)===U&&(b=Oc,a.substr(Oc,2)===Ja?(c=Ja,Oc+=2):(c=U,0===Tc&&j(Ka)),c!==U&&(Pc=b,c=La()),(b=c)===U&&(b=Oc,a.substr(Oc,2)===Ma?(c=Ma,Oc+=2):(c=U,0===Tc&&j(Na)),c!==U&&(Pc=b,c=Oa()),(b=c)===U&&(b=Oc,a.substr(Oc,2)===Pa?(c=Pa,Oc+=2):(c=U,0===Tc&&j(Qa)),c!==U&&(Pc=b,c=Ra()),(b=c)===U&&(b=Oc,a.substr(Oc,2)===Sa?(c=Sa,Oc+=2):(c=U,0===Tc&&j(Ta)),c!==U&&(Pc=b,c=Ua()),(b=c)===U&&(b=Oc,a.substr(Oc,2)===Va?(c=Va,Oc+=2):(c=U,0===Tc&&j(Wa)),c!==U&&(Pc=b,c=Xa()),(b=c)===U&&(b=Oc,a.substr(Oc,2)===Ya?(c=Ya,Oc+=2):(c=U,0===Tc&&j(Za)),c!==U&&(Pc=b,c=$a()),b=c))))))))))))),Uc[k]={nextPos:Oc,result:b},b)}function p(){var b,c,d,e,f,g,h=29*Oc+4,i=Uc[h];if(i)return Oc=i.nextPos,i.result;for(b=Oc,c=Oc,d=Oc,e=Oc,f=[],_a.test(a.charAt(Oc))?(g=a.charAt(Oc),Oc++):(g=U,0===Tc&&j(ab));g!==U;)f.push(g),_a.test(a.charAt(Oc))?(g=a.charAt(Oc),Oc++):(g=U,0===Tc&&j(ab));if(f!==U?(46===a.charCodeAt(Oc)?(g=bb,Oc++):(g=U,0===Tc&&j(cb)),g!==U?(f=[f,g],e=f):(Oc=e,e=U)):(Oc=e,e=U),e===U&&(e=null),e!==U){if(f=[],_a.test(a.charAt(Oc))?(g=a.charAt(Oc),Oc++):(g=U,0===Tc&&j(ab)),g!==U)for(;g!==U;)f.push(g),_a.test(a.charAt(Oc))?(g=a.charAt(Oc),Oc++):(g=U,0===Tc&&j(ab));else f=U;f!==U?(e=[e,f],d=e):(Oc=d,d=U)}else Oc=d,d=U;return c=d!==U?a.substring(c,Oc):d,c!==U&&(Pc=b,c=db(c)),b=c,Uc[h]={nextPos:Oc,result:b},b}function q(){var b,c,d,e,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v,w=29*Oc+5,x=Uc[w];if(x)return Oc=x.nextPos,x.result;if(b=Oc,a.substr(Oc,4).toLowerCase()===eb?(c=a.substr(Oc,4),Oc+=4):(c=U,0===Tc&&j(fb)),c!==U)if(M()!==U)if(d=Oc,e=Oc,_a.test(a.charAt(Oc))?(f=a.charAt(Oc),Oc++):(f=U,0===Tc&&j(ab)),f!==U?(_a.test(a.charAt(Oc))?(g=a.charAt(Oc),Oc++):(g=U,0===Tc&&j(ab)),g!==U?(_a.test(a.charAt(Oc))?(h=a.charAt(Oc),Oc++):(h=U,0===Tc&&j(ab)),h!==U?(_a.test(a.charAt(Oc))?(i=a.charAt(Oc),Oc++):(i=U,0===Tc&&j(ab)),i!==U?(f=[f,g,h,i],e=f):(Oc=e,e=U)):(Oc=e,e=U)):(Oc=e,e=U)):(Oc=e,e=U),(d=e!==U?a.substring(d,Oc):e)!==U)if(45===a.charCodeAt(Oc)?(e=gb,Oc++):(e=U,0===Tc&&j(hb)),e!==U)if(f=Oc,g=Oc,_a.test(a.charAt(Oc))?(h=a.charAt(Oc),Oc++):(h=U,0===Tc&&j(ab)),h!==U?(_a.test(a.charAt(Oc))?(i=a.charAt(Oc),Oc++):(i=U,0===Tc&&j(ab)),i===U&&(i=null),i!==U?(h=[h,i],g=h):(Oc=g,g=U)):(Oc=g,g=U),(f=g!==U?a.substring(f,Oc):g)!==U)if(45===a.charCodeAt(Oc)?(g=gb,Oc++):(g=U,0===Tc&&j(hb)),g!==U)if(h=Oc,i=Oc,_a.test(a.charAt(Oc))?(k=a.charAt(Oc),Oc++):(k=U,0===Tc&&j(ab)),k!==U?(_a.test(a.charAt(Oc))?(l=a.charAt(Oc),Oc++):(l=U,0===Tc&&j(ab)),l===U&&(l=null),l!==U?(k=[k,l],i=k):(Oc=i,i=U)):(Oc=i,i=U),(h=i!==U?a.substring(h,Oc):i)!==U){if(i=Oc,84===a.charCodeAt(Oc)?(k=ib,Oc++):(k=U,0===Tc&&j(jb)),k!==U)if(l=Oc,m=Oc,_a.test(a.charAt(Oc))?(n=a.charAt(Oc),Oc++):(n=U,0===Tc&&j(ab)),n!==U?(_a.test(a.charAt(Oc))?(o=a.charAt(Oc),Oc++):(o=U,0===Tc&&j(ab)),o!==U?(n=[n,o],m=n):(Oc=m,m=U)):(Oc=m,m=U),(l=m!==U?a.substring(l,Oc):m)!==U)if(58===a.charCodeAt(Oc)?(m=kb,Oc++):(m=U,0===Tc&&j(lb)),m!==U)if(n=Oc,o=Oc,_a.test(a.charAt(Oc))?(p=a.charAt(Oc),Oc++):(p=U,0===Tc&&j(ab)),p!==U?(_a.test(a.charAt(Oc))?(q=a.charAt(Oc),Oc++):(q=U,0===Tc&&j(ab)),q!==U?(p=[p,q],o=p):(Oc=o,o=U)):(Oc=o,o=U),(n=o!==U?a.substring(n,Oc):o)!==U){if(o=Oc,58===a.charCodeAt(Oc)?(p=kb,Oc++):(p=U,0===Tc&&j(lb)),p!==U)if(q=Oc,r=Oc,_a.test(a.charAt(Oc))?(s=a.charAt(Oc),Oc++):(s=U,0===Tc&&j(ab)),s!==U?(_a.test(a.charAt(Oc))?(t=a.charAt(Oc),Oc++):(t=U,0===Tc&&j(ab)),t!==U?(s=[s,t],r=s):(Oc=r,r=U)):(Oc=r,r=U),(q=r!==U?a.substring(q,Oc):r)!==U){if(r=Oc,46===a.charCodeAt(Oc)?(s=bb,Oc++):(s=U,0===Tc&&j(cb)),s!==U){if(t=Oc,u=[],_a.test(a.charAt(Oc))?(v=a.charAt(Oc),Oc++):(v=U,0===Tc&&j(ab)),v!==U)for(;v!==U;)u.push(v),_a.test(a.charAt(Oc))?(v=a.charAt(Oc),Oc++):(v=U,0===Tc&&j(ab));else u=U;t=u!==U?a.substring(t,Oc):u,t!==U?(Pc=r,s=mb(d,f,h,l,n,q,t),r=s):(Oc=r,r=U)}else Oc=r,r=U;r===U&&(r=null),r!==U?(Pc=o,p=nb(d,f,h,l,n,q,r),o=p):(Oc=o,o=U)}else Oc=o,o=U;else Oc=o,o=U;o===U&&(o=null),o!==U?(Pc=i,k=ob(d,f,h,l,n,o),i=k):(Oc=i,i=U)}else Oc=i,i=U;else Oc=i,i=U;else Oc=i,i=U;else Oc=i,i=U;if(i===U&&(i=null),i!==U){if(k=Oc,90===a.charCodeAt(Oc)?(l=pb,Oc++):(l=U,0===Tc&&j(qb)),l===U&&(a.substr(Oc,6)===rb?(l=rb,Oc+=6):(l=U,0===Tc&&j(sb)),l===U))if(l=Oc,43===a.charCodeAt(Oc)?(m=tb,Oc++):(m=U,0===Tc&&j(ub)),m!==U){if(n=[],48===a.charCodeAt(Oc)?(o=vb,Oc++):(o=U,0===Tc&&j(wb)),o!==U)for(;o!==U;)n.push(o),48===a.charCodeAt(Oc)?(o=vb,Oc++):(o=U,0===Tc&&j(wb));else n=U;n!==U?(m=[m,n],l=m):(Oc=l,l=U)}else Oc=l,l=U;l===U&&(l=null),k=l!==U?a.substring(k,Oc):l,k!==U?(Pc=b,c=xb(d,f,h,i,k),b=c):(Oc=b,b=U)}else Oc=b,b=U}else Oc=b,b=U;else Oc=b,b=U;else Oc=b,b=U;else Oc=b,b=U;else Oc=b,b=U;else Oc=b,b=U;else Oc=b,b=U;return Uc[w]={nextPos:Oc,result:b},b}function r(){var b,c,d,e,f=29*Oc+6,g=Uc[f];return g?(Oc=g.nextPos,g.result):(b=Oc,a.substr(Oc,4).toLowerCase()===yb?(c=a.substr(Oc,4),Oc+=4):(c=U,0===Tc&&j(zb)),c===U&&(a.substr(Oc,5).toLowerCase()===Ab?(c=a.substr(Oc,5),Oc+=5):(c=U,0===Tc&&j(Bb)),c===U&&(a.substr(Oc,4).toLowerCase()===Cb?(c=a.substr(Oc,4),Oc+=4):(c=U,0===Tc&&j(Db)),c===U&&(a.substr(Oc,9).toLowerCase()===Eb?(c=a.substr(Oc,9),Oc+=9):(c=U,0===Tc&&j(Fb)),c===U&&(a.substr(Oc,3).toLowerCase()===Gb?(c=a.substr(Oc,3),Oc+=3):(c=U,0===Tc&&j(Hb)))))),c!==U?(d=Oc,Tc++,Ib.test(a.charAt(Oc))?(e=a.charAt(Oc),Oc++):(e=U,0===Tc&&j(Jb)),Tc--,e===U?d=void 0:(Oc=d,d=U),d!==U?(Pc=b,c=Kb(c),b=c):(Oc=b,b=U)):(Oc=b,b=U),Uc[f]={nextPos:Oc,result:b},b)}function s(){var b,c,d,e,f,g,h,i,k=29*Oc+7,l=Uc[k];if(l)return Oc=l.nextPos,l.result;if(b=Oc,c=Oc,d=Oc,a.substr(Oc,3)===Lb?(e=Lb,Oc+=3):(e=U,0===Tc&&j(Mb)),e!==U?(f=M(),f!==U?(e=[e,f],d=e):(Oc=d,d=U)):(Oc=d,d=U),d!==U)if(e=Oc,Tc++,Nb.test(a.charAt(Oc))?(f=a.charAt(Oc),Oc++):(f=U,0===Tc&&j(Ob)),Tc--,f===U?e=void 0:(Oc=e,e=U),e!==U){if(f=Oc,g=[],Pb.test(a.charAt(Oc))?(h=a.charAt(Oc),Oc++):(h=U,0===Tc&&j(Qb)),h!==U)for(;h!==U;)g.push(h),Pb.test(a.charAt(Oc))?(h=a.charAt(Oc),Oc++):(h=U,0===Tc&&j(Qb));else g=U;f=g!==U?a.substring(f,Oc):g,f!==U?(g=Oc,h=M(),h!==U?(a.substr(Oc,3)===Rb?(i=Rb,Oc+=3):(i=U,0===Tc&&j(Sb)),i!==U?(h=[h,i],g=h):(Oc=g,g=U)):(Oc=g,g=U),g!==U?(Pc=c,d=Tb(f),c=d):(Oc=c,c=U)):(Oc=c,c=U)}else Oc=c,c=U;else Oc=c,c=U;if(c===U)if(c=Oc,d=Oc,a.substr(Oc,2)===Ub?(e=Ub,Oc+=2):(e=U,0===Tc&&j(Vb)),e!==U?(f=M(),f!==U?(e=[e,f],d=e):(Oc=d,d=U)):(Oc=d,d=U),d!==U)if(e=Oc,Tc++,Nb.test(a.charAt(Oc))?(f=a.charAt(Oc),Oc++):(f=U,0===Tc&&j(Ob)),Tc--,f===U?e=void 0:(Oc=e,e=U),e!==U){if(f=Oc,g=[],Pb.test(a.charAt(Oc))?(h=a.charAt(Oc),Oc++):(h=U,0===Tc&&j(Qb)),h!==U)for(;h!==U;)g.push(h),Pb.test(a.charAt(Oc))?(h=a.charAt(Oc),Oc++):(h=U,0===Tc&&j(Qb));else g=U;f=g!==U?a.substring(f,Oc):g,f!==U?(g=Oc,h=M(),h!==U?(a.substr(Oc,2)===Wb?(i=Wb,Oc+=2):(i=U,0===Tc&&j(Xb)),i!==U?(h=[h,i],g=h):(Oc=g,g=U)):(Oc=g,g=U),g!==U?(Pc=c,d=Tb(f),c=d):(Oc=c,c=U)):(Oc=c,c=U)}else Oc=c,c=U;else Oc=c,c=U;return c!==U&&(Pc=b,c=Yb(c)),b=c,Uc[k]={nextPos:Oc,result:b},b}function t(){var b,c,d,e,f,g,h,i,k,l,m,n,o=29*Oc+8,p=Uc[o];if(p)return Oc=p.nextPos,p.result;if(b=Oc,c=Oc,d=u(),(c=d!==U?a.substring(c,Oc):d)!==U)if((d=M())!==U)if(40===a.charCodeAt(Oc)?(e=Zb,Oc++):(e=U,0===Tc&&j($b)),e!==U)if(M()!==U){if(f=Oc,(g=v())!==U)if(M()!==U){for(h=[],i=Oc,44===a.charCodeAt(Oc)?(k=_b,Oc++):(k=U,0===Tc&&j(ac)),k!==U?(l=M(),l!==U?(m=v(),m!==U?(n=M(),n!==U?(Pc=i,k=bc(c,g,m),i=k):(Oc=i,i=U)):(Oc=i,i=U)):(Oc=i,i=U)):(Oc=i,i=U);i!==U;)h.push(i),i=Oc,44===a.charCodeAt(Oc)?(k=_b,Oc++):(k=U,0===Tc&&j(ac)),k!==U?(l=M(),l!==U?(m=v(),m!==U?(n=M(),n!==U?(Pc=i,k=bc(c,g,m),i=k):(Oc=i,i=U)):(Oc=i,i=U)):(Oc=i,i=U)):(Oc=i,i=U);h!==U?(Pc=f,g=cc(c,g,h),f=g):(Oc=f,f=U)}else Oc=f,f=U;else Oc=f,f=U;f===U&&(f=null),f!==U?(41===a.charCodeAt(Oc)?(g=dc,Oc++):(g=U,0===Tc&&j(ec)),g!==U?(Pc=b,c=fc(c,f),b=c):(Oc=b,b=U)):(Oc=b,b=U)}else Oc=b,b=U;else Oc=b,b=U;else Oc=b,b=U;else Oc=b,b=U;return Uc[o]={nextPos:Oc,result:b},b}function u(){var b,c,d,e,f,g,h=29*Oc+9,i=Uc[h];if(i)return Oc=i.nextPos,i.result;if(b=Oc,(c=N())!==U){for(d=[],e=Oc,46===a.charCodeAt(Oc)?(f=bb,Oc++):(f=U,0===Tc&&j(cb)),f!==U?(g=N(),g!==U?(f=[f,g],e=f):(Oc=e,e=U)):(Oc=e,e=U);e!==U;)d.push(e),e=Oc,46===a.charCodeAt(Oc)?(f=bb,Oc++):(f=U,0===Tc&&j(cb)),f!==U?(g=N(),g!==U?(f=[f,g],e=f):(Oc=e,e=U)):(Oc=e,e=U);d!==U?(c=[c,d],b=c):(Oc=b,b=U)}else Oc=b,b=U;return Uc[h]={nextPos:Oc,result:b},b}function v(){var b,c,d,e,f,g,h=29*Oc+10,i=Uc[h];return i?(Oc=i.nextPos,i.result):(b=w(),b===U&&(b=m())===U&&(b=Oc,c=M(),c!==U?(d=Oc,e=N(),d=e!==U?a.substring(d,Oc):e,d!==U?(e=M(),e!==U?(f=Oc,Tc++,40===a.charCodeAt(Oc)?(g=Zb,Oc++):(g=U,0===Tc&&j($b)),Tc--,g===U?f=void 0:(Oc=f,f=U),f!==U?(Pc=b,c=gc(d),b=c):(Oc=b,b=U)):(Oc=b,b=U)):(Oc=b,b=U)):(Oc=b,b=U),b===U&&(b=t())),Uc[h]={nextPos:Oc,result:b},b)}function w(){var a,b,c,d,e,f,g=29*Oc+11,h=Uc[g];if(h)return Oc=h.nextPos,h.result;if(a=Oc,(b=y())!==U){if(c=[],d=Oc,e=x(),e!==U?(f=y(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U),d!==U)for(;d!==U;)c.push(d),d=Oc,e=x(),e!==U?(f=y(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U);else c=U;c!==U?(Pc=a,b=ic(b,c),a=b):(Oc=a,a=U)}else Oc=a,a=U;return a===U&&(a=y()),Uc[g]={nextPos:Oc,result:a},a}function x(){var b,c,d,e,f,g,h=29*Oc+12,i=Uc[h];if(i)return Oc=i.nextPos,i.result;if(b=Oc,(c=M())!==U){if(d=Oc,e=Oc,124===a.charCodeAt(Oc)?(f=jc,Oc++):(f=U,0===Tc&&j(kc)),(e=f!==U?a.substring(e,Oc):f)!==U){for(f=[],124===a.charCodeAt(Oc)?(g=jc,Oc++):(g=U,0===Tc&&j(kc));g!==U;)f.push(g),124===a.charCodeAt(Oc)?(g=jc,Oc++):(g=U,0===Tc&&j(kc));f!==U?(Pc=d,e=lc(e),d=e):(Oc=d,d=U)}else Oc=d,d=U;d===U&&(a.substr(Oc,2).toLowerCase()===mc?(d=a.substr(Oc,2),Oc+=2):(d=U,0===Tc&&j(nc))),d!==U?(e=M(),e!==U?(Pc=b,c=oc(d),b=c):(Oc=b,b=U)):(Oc=b,b=U)}else Oc=b,b=U;return Uc[h]={nextPos:Oc,result:b},b}function y(){var a,b,c,d,e,f,g=29*Oc+13,h=Uc[g];if(h)return Oc=h.nextPos,h.result;if(a=Oc,(b=A())!==U){if(c=[],d=Oc,e=z(),e!==U?(f=A(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U),d!==U)for(;d!==U;)c.push(d),d=Oc,e=z(),e!==U?(f=A(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U);else c=U;c!==U?(Pc=a,b=ic(b,c),a=b):(Oc=a,a=U)}else Oc=a,a=U;return a===U&&(a=A()),Uc[g]={nextPos:Oc,result:a},a}function z(){var b,c,d,e,f,g,h=29*Oc+14,i=Uc[h];if(i)return Oc=i.nextPos,i.result;if(b=Oc,(c=M())!==U){if(d=Oc,e=Oc,38===a.charCodeAt(Oc)?(f=pc,Oc++):(f=U,0===Tc&&j(qc)),(e=f!==U?a.substring(e,Oc):f)!==U){for(f=[],38===a.charCodeAt(Oc)?(g=pc,Oc++):(g=U,0===Tc&&j(qc));g!==U;)f.push(g),38===a.charCodeAt(Oc)?(g=pc,Oc++):(g=U,0===Tc&&j(qc));f!==U?(Pc=d,e=lc(e),d=e):(Oc=d,d=U)}else Oc=d,d=U;d===U&&(a.substr(Oc,3).toLowerCase()===rc?(d=a.substr(Oc,3),Oc+=3):(d=U,0===Tc&&j(sc))),d!==U?(e=M(),e!==U?(Pc=b,c=oc(d),b=c):(Oc=b,b=U)):(Oc=b,b=U)}else Oc=b,b=U;return Uc[h]={nextPos:Oc,result:b},b}function A(){var a,b,c,d,e,f,g=29*Oc+15,h=Uc[g];if(h)return Oc=h.nextPos,h.result;if(a=Oc,(b=C())!==U){if(c=[],d=Oc,e=B(),e!==U?(f=C(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U),d!==U)for(;d!==U;)c.push(d),d=Oc,e=B(),e!==U?(f=C(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U);else c=U;c!==U?(Pc=a,b=ic(b,c),a=b):(Oc=a,a=U)}else Oc=a,a=U;return a===U&&(a=C()),Uc[g]={nextPos:Oc,result:a},a}function B(){var b,c,d,e,f,g,h,i=29*Oc+16,k=Uc[i];if(k)return Oc=k.nextPos,k.result;if(b=Oc,(c=M())!==U){if(d=Oc,e=Oc,f=Oc,33===a.charCodeAt(Oc)?(g=tc,Oc++):(g=U,0===Tc&&j(uc)),g===U&&(g=null),g!==U?(61===a.charCodeAt(Oc)?(h=vc,Oc++):(h=U,0===Tc&&j(wc)),h!==U?(g=[g,h],f=g):(Oc=f,f=U)):(Oc=f,f=U),(e=f!==U?a.substring(e,Oc):f)!==U){for(f=[],61===a.charCodeAt(Oc)?(g=vc,Oc++):(g=U,0===Tc&&j(wc));g!==U;)f.push(g),61===a.charCodeAt(Oc)?(g=vc,Oc++):(g=U,0===Tc&&j(wc));f!==U?(Pc=d,e=lc(e),d=e):(Oc=d,d=U)}else Oc=d,d=U;d!==U?(e=M(),e!==U?(Pc=b,c=oc(d),b=c):(Oc=b,b=U)):(Oc=b,b=U)}else Oc=b,b=U;return Uc[i]={nextPos:Oc,result:b},b}function C(){var a,b,c,d,e,f,g=29*Oc+17,h=Uc[g];if(h)return Oc=h.nextPos,h.result;if(a=Oc,(b=E())!==U){if(c=[],d=Oc,e=D(),e!==U?(f=E(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U),d!==U)for(;d!==U;)c.push(d),d=Oc,e=D(),e!==U?(f=E(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U);else c=U;c!==U?(Pc=a,b=ic(b,c),a=b):(Oc=a,a=U)}else Oc=a,a=U;return a===U&&(a=E()),Uc[g]={nextPos:Oc,result:a},a}function D(){var b,c,d,e,f,g,h=29*Oc+18,i=Uc[h];return i?(Oc=i.nextPos,i.result):(b=Oc,c=M(),c!==U?(d=Oc,e=Oc,xc.test(a.charAt(Oc))?(f=a.charAt(Oc),Oc++):(f=U,0===Tc&&j(yc)),f!==U?(61===a.charCodeAt(Oc)?(g=vc,Oc++):(g=U,0===Tc&&j(wc)),g===U&&(g=null),g!==U?(f=[f,g],e=f):(Oc=e,e=U)):(Oc=e,e=U),d=e!==U?a.substring(d,Oc):e,d!==U?(e=M(),e!==U?(Pc=b,c=oc(d),b=c):(Oc=b,b=U)):(Oc=b,b=U)):(Oc=b,b=U),Uc[h]={nextPos:Oc,result:b},b)}function E(){var a,b,c,d,e,f,g=29*Oc+19,h=Uc[g];if(h)return Oc=h.nextPos,h.result;if(a=Oc,(b=G())!==U){if(c=[],d=Oc,e=F(),e!==U?(f=G(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U),d!==U)for(;d!==U;)c.push(d),d=Oc,e=F(),e!==U?(f=G(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U);else c=U;c!==U?(Pc=a,b=ic(b,c),a=b):(Oc=a,a=U)}else Oc=a,a=U;return a===U&&(a=G()),Uc[g]={nextPos:Oc,result:a},a}function F(){var b,c,d,e,f=29*Oc+20,g=Uc[f];return g?(Oc=g.nextPos,g.result):(b=Oc,c=M(),c!==U?(d=Oc,zc.test(a.charAt(Oc))?(e=a.charAt(Oc),Oc++):(e=U,0===Tc&&j(Ac)),d=e!==U?a.substring(d,Oc):e,d!==U?(e=M(),e!==U?(Pc=b,c=Bc(d),b=c):(Oc=b,b=U)):(Oc=b,b=U)):(Oc=b,b=U),Uc[f]={nextPos:Oc,result:b},b)}function G(){var a,b,c,d,e,f,g=29*Oc+21,h=Uc[g];if(h)return Oc=h.nextPos,h.result;if(a=Oc,(b=I())!==U){if(c=[],d=Oc,e=H(),e!==U?(f=I(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U),d!==U)for(;d!==U;)c.push(d),d=Oc,e=H(),e!==U?(f=I(),f!==U?(Pc=d,e=hc(b,e,f),d=e):(Oc=d,d=U)):(Oc=d,d=U);else c=U;c!==U?(Pc=a,b=ic(b,c),a=b):(Oc=a,a=U)}else Oc=a,a=U;return a===U&&(a=I()),Uc[g]={nextPos:Oc,result:a},a}function H(){var b,c,d,e,f=29*Oc+22,g=Uc[f];return g?(Oc=g.nextPos,g.result):(b=Oc,c=M(),c!==U?(d=Oc,Cc.test(a.charAt(Oc))?(e=a.charAt(Oc),Oc++):(e=U,0===Tc&&j(Dc)),d=e!==U?a.substring(d,Oc):e,d!==U?(e=M(),e!==U?(Pc=b,c=Bc(d),b=c):(Oc=b,b=U)):(Oc=b,b=U)):(Oc=b,b=U),Uc[f]={nextPos:Oc,result:b},b)}function I(){var a,b,c,d=29*Oc+23,e=Uc[d];return e?(Oc=e.nextPos,e.result):(a=Oc,b=Oc,c=J(),c!==U&&(Pc=b,c=Ec(c)),b=c,b!==U?(c=I(),c!==U?(Pc=a,b=Fc(b,c),a=b):(Oc=a,a=U)):(Oc=a,a=U),a===U&&(a=K()),Uc[d]={nextPos:Oc,result:a},a)}function J(){var b,c,d,e,f=29*Oc+24,g=Uc[f];return g?(Oc=g.nextPos,g.result):(b=Oc,c=M(),c!==U?(d=Oc,Gc.test(a.charAt(Oc))?(e=a.charAt(Oc),Oc++):(e=U,0===Tc&&j(Hc)),d=e!==U?a.substring(d,Oc):e,d!==U?(e=M(),e!==U?(Pc=b,c=Ic(d),b=c):(Oc=b,b=U)):(Oc=b,b=U)):(Oc=b,b=U),Uc[f]={nextPos:Oc,result:b},b)}function K(){var b,c,d,e,f,g,h=29*Oc+25,i=Uc[h];return i?(Oc=i.nextPos,i.result):(b=Oc,40===a.charCodeAt(Oc)?(c=Zb,Oc++):(c=U,0===Tc&&j($b)),c!==U?(d=M(),d!==U?(e=l(),e!==U?(f=M(),f!==U?(41===a.charCodeAt(Oc)?(g=dc,Oc++):(g=U,0===Tc&&j(ec)),g!==U?(Pc=b,c=Jc(e),b=c):(Oc=b,b=U)):(Oc=b,b=U)):(Oc=b,b=U)):(Oc=b,b=U)):(Oc=b,b=U),b===U&&(b=L()),Uc[h]={nextPos:Oc,result:b},b)}function L(){var a,b=29*Oc+26,c=Uc[b];return c?(Oc=c.nextPos,c.result):(a=m(),a===U&&(a=t()),Uc[b]={nextPos:Oc,result:a},a)}function M(){var b,c,d=29*Oc+27,e=Uc[d];if(e)return Oc=e.nextPos,e.result;for(b=[],Kc.test(a.charAt(Oc))?(c=a.charAt(Oc),Oc++):(c=U,0===Tc&&j(Lc));c!==U;)b.push(c),Kc.test(a.charAt(Oc))?(c=a.charAt(Oc),Oc++):(c=U,0===Tc&&j(Lc));return Uc[d]={nextPos:Oc,result:b},b}function N(){var b,c,d,e,f=29*Oc+28,g=Uc[f];if(g)return Oc=g.nextPos,g.result;if(b=Oc,c=[],Mc.test(a.charAt(Oc))?(d=a.charAt(Oc),Oc++):(d=U,0===Tc&&j(Nc)),d!==U)for(;d!==U;)c.push(d),Mc.test(a.charAt(Oc))?(d=a.charAt(Oc),Oc++):(d=U,0===Tc&&j(Nc));else c=U;if(c!==U){for(d=[],Ib.test(a.charAt(Oc))?(e=a.charAt(Oc),Oc++):(e=U,0===Tc&&j(Jb));e!==U;)d.push(e),Ib.test(a.charAt(Oc))?(e=a.charAt(Oc),Oc++):(e=U,0===Tc&&j(Jb));d!==U?(c=[c,d],b=c):(Oc=b,b=U)}else Oc=b,b=U;return Uc[f]={nextPos:Oc,result:b},b}function O(a,b,c){this["class"]={major:a,minor:b},this.params=c}function P(a,b,c){return new O(a,b,c)}function Q(a,b){return P("expression",a,b)}function R(a,b){return P("literal",a,{value:b})}function S(a,b){return P("operator",a,{symbol:b})}c=void 0!==c?c:{};var T,U={},V={Expression:l},W=l,X=function(a){return a},Y=function(){return R("keyword","null")},Z='"',$=e('"',!1),_=/^[^"\\]/,aa=f(['"',"\\"],!0,!1),ba=function(a){return R("string",a.join(""))},ca="'",da=e("'",!1),ea=/^[^'\\]/,fa=f(["'","\\"],!0,!1),ga="\\",ha=e("\\",!1),ia=/^[1-7]/,ja=f([["1","7"]],!1,!1),ka=/^[0-7]/,la=f([["0","7"]],!1,!1),ma=function(a){var b=parseInt(a,8),c="";return b>=256&&(b=parseInt(a.substring(0,2),8),c=a.substring(2,3)),String.fromCharCode(b)+c},na="\\x",oa=e("\\x",!1),pa=/^[0-9a-f]/i,qa=f([["0","9"],["a","f"]],!1,!0),ra=function(a){var b=parseInt(a,16);return String.fromCharCode(b)},sa="\\u",ta=e("\\u",!1),ua="\\n",va=e("\\n",!1),wa=function(){return"\n"},xa="\\\n",ya=e("\\\n",!1),za=function(){return""},Aa="\\r",Ba=e("\\r",!1),Ca=function(){return"\r"},Da="\\t",Ea=e("\\t",!1),Fa=function(){return"\t"},Ga="\\b",Ha=e("\\b",!1),Ia=function(){return"\b"},Ja="\\f",Ka=e("\\f",!1),La=function(){return"\f"},Ma="\\v",Na=e("\\v",!1),Oa=function(){return"\x0B"},Pa="\\0",Qa=e("\\0",!1),Ra=function(){return"\0"},Sa="\\\\",Ta=e("\\\\",!1),Ua=function(){return"\\"},Va="\\'",Wa=e("\\'",!1),Xa=function(){return"'"},Ya='\\"',Za=e('\\"',!1),$a=function(){return'"'},_a=/^[0-9]/,ab=f([["0","9"]],!1,!1),bb=".",cb=e(".",!1),db=function(a){return R("number",parseFloat(a))},eb="date",fb=e("date",!0),gb="-",hb=e("-",!1),ib="T",jb=e("T",!1),kb=":",lb=e(":",!1),mb=function(a,b,c,d,e,f,g){return g},nb=function(a,b,c,d,e,f,g){return{second:f,millisecond:g||"0"}},ob=function(a,b,c,d,e,f){return f||(f={second:"0",millisecond:"0"}),{hour:d,minute:e,second:f.second,millisecond:f.millisecond}},pb="Z",qb=e("Z",!1),rb="+00:00",sb=e("+00:00",!1),tb="+",ub=e("+",!1),vb="0",wb=e("0",!1),xb=function(a,b,c,e,f){var g=0,h=0,i=0,j=0;a=parseInt(a),b=parseInt(b),c=parseInt(c),(b<1||b>12)&&d("A Valid Date");var k=new Date(a,b,1);k.setDate(0),(c<1||c>k.getDate())&&d("A Valid Date"),e&&(g=parseInt(e.hour),h=parseInt(e.minute),i=parseInt(e.second),j=parseInt(e.millisecond),(g>23||h>59||i>59||j>999)&&d("A Valid Date"));var l;return l=f?new Date(Date.UTC(a,b-1,c,g,h,i,j)):skuid.time.getRealJSDateTimeFromLocal(new Date(a,b-1,c,g,h,i,j)),R("date",new Date(l))},yb="true",zb=e("true",!0),Ab="false",Bb=e("false",!0),Cb="null",Db=e("null",!0),Eb="undefined",Fb=e("undefined",!0),Gb="nan",Hb=e("nan",!0),Ib=/^[a-z0-9_]/i,Jb=f([["a","z"],["0","9"],"_"],!1,!0),Kb=function(a){return R("keyword",a)},Lb="{{{",Mb=e("{{{",!1),Nb=/^[\/#\^]/,Ob=f(["/","#","^"],!1,!1),Pb=/^[^{}]/,Qb=f(["{","}"],!0,!1),Rb="}}}",Sb=e("}}}",!1),Tb=function(a){return a},Ub="{{",Vb=e("{{",!1),Wb="}}",Xb=e("}}",!1),Yb=function(a){return R("merge",a)},Zb="(",$b=e("(",!1),_b=",",ac=e(",",!1),bc=function(a,b,c){return c},cc=function(a,b,c){return[b].concat(c)},dc=")",ec=e(")",!1),fc=function(a,b){return Q("function",{name:a,arguments:b||[]})},gc=function(a){return R("identifier",a)},hc=function(a,b,c){return{operator:b,operand:c}},ic=function(a,b){return Q("operational",{head:a,operations:b})},jc="|",kc=e("|",!1),lc=function(a){return a
},mc="or",nc=e("or",!0),oc=function(a){return S("logical",a)},pc="&",qc=e("&",!1),rc="and",sc=e("and",!0),tc="!",uc=e("!",!1),vc="=",wc=e("=",!1),xc=/^[<>]/,yc=f(["<",">"],!1,!1),zc=/^[\-+]/,Ac=f(["-","+"],!1,!1),Bc=function(a){return S("algebraic",a)},Cc=/^[\/%*]/,Dc=f(["/","%","*"],!1,!1),Ec=function(a){return{operator:a}},Fc=function(a,b){return Q("operational",{head:b,operation:a,unary:!0})},Gc=/^[\-+!]/,Hc=f(["-","+","!"],!1,!1),Ic=function(a){return S("unary",a)},Jc=function(a){return a},Kc=/^[ \f\n\r\t\x0B\xA0\u1680\u180E\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]/,Lc=f([" ","\f","\n","\r","\t","\x0B","","","",["",""],"\u2028","\u2029","","","","\ufeff"],!1,!1),Mc=/^[a-z]/i,Nc=f([["a","z"]],!1,!0),Oc=0,Pc=0,Qc=[{line:1,column:1}],Rc=0,Sc=[],Tc=0,Uc={};if("startRule"in c){if(!(c.startRule in V))throw new Error("Can't start parsing from rule \""+c.startRule+'".');W=V[c.startRule]}if(O.prototype.is=function(a,b){return this["class"].major===a&&this["class"].minor===b},(T=W())!==U&&Oc===a.length)return T;throw T!==U&&Oc<a.length&&j(function(){return{type:"end"}}()),k(Sc,Rc<a.length?a.charAt(Rc):null,Rc<a.length?i(Rc,Rc+1):i(Rc,Rc))}!function(a,b){function c(){this.constructor=a}c.prototype=b.prototype,a.prototype=new c}(b,Error),b.buildMessage=function(a,b){function c(a){return a.charCodeAt(0).toString(16).toUpperCase()}function d(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+c(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+c(a)})}function e(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+c(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+c(a)})}function f(a){return g[a.type](a)}var g={literal:function(a){return'"'+d(a.text)+'"'},"class":function(a){var b,c="";for(b=0;b<a.parts.length;b++)c+=a.parts[b]instanceof Array?e(a.parts[b][0])+"-"+e(a.parts[b][1]):e(a.parts[b]);return"["+(a.inverted?"^":"")+c+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b,c,d=new Array(a.length);for(b=0;b<a.length;b++)d[b]=f(a[b]);if(d.sort(),d.length>0){for(b=1,c=1;b<d.length;b++)d[b-1]!==d[b]&&(d[c]=d[b],c++);d.length=c}switch(d.length){case 1:return d[0];case 2:return d[0]+" or "+d[1];default:return d.slice(0,-1).join(", ")+", or "+d[d.length-1]}}(a)+" but "+function(a){return a?'"'+d(a)+'"':"end of input"}(b)+" found."},a.skuid.formula.parser={SyntaxError:b,parse:c}}(this),function(a,b){function c(a,b){if("string"==typeof a){var c=d(b);return a in c?c[a]:c[a.toLowerCase()]}}function d(b){var c,d,e,f=j({},i.params);return b&&(k.isString(b)?(c=b,d=a.$C(c)):(d=b,c=d.id())),d&&(e=d.getPageParameters()),e||(e=i._parametersByPage[c]),e&&j(f,e),f}function e(){var b=[],c=a.component.getByType("skuidpage"),d={};return c&&c.length&&c.forEach(function(a){var c=a.problems;c&&c.length&&c.forEach(function(a){var c;a&&(c=k.isString(a)?a:a.message),c&&!c[d]&&b.push(a)})}),b}function f(c){var d=e(),f=i.problemsWrapper,g=!!c&&!0===c.justUpdateWrapper;f&&(g||i.problemsContainer.empty(),d.length?(g||b.each(d,function(){this.isDisplayed=!1,i.displayProblem(this)}),f.css("display","block"),i.problemsIndicator.text(a.label.merge(a.$L("skuid_page_problems"),d.length)).append(b("<div>").append(b('<div class="ui-icon ui-icon-close">')).addClass("nx-page-problems-dismiss").on("click",function(){f.hide()}))):f.css("display","none"))}function g(){i.rebuildPageProblems({justUpdateWrapper:!0})}function h(a){var c,d=this._uniqueProblemMessages,e=a.message;return d||(d=this._uniqueProblemMessages={}),!(!i.problemsContainer||a.isDisplayed||d[e])&&(c=b("<div>").addClass("nx-problem").appendTo(i.problemsContainer),c.text(c.index()-0+1+". "+a.message),a.isDisplayed=!0,d[e]=a,!0)}var i=a.page={_parametersByPage:{}},j=b.extend,k=a.utils;j(i,{getAllProblems:e,getParameter:c,getParameters:d,displayProblem:h,updateProblemsWrapper:g,rebuildPageProblems:f,params:k.deparam(window.location.search)})}(skuid,skuid.$),function(){var a=skuid.$,b=a(document.body),c=skuid.utils,d=function(a){return" sk-pagepanel-"+a},e=function(a){return" nx-page-withpanels-"+a};skuid.componentType.register("panel",function(f,g,h){var i=h.context,j="true"===g.attr("closeonpageclick"),k=a('<div class="nx-page-clickcatcher">'),l=g.attr("uniqueid"),m=g.children("interactions").first(),n=h.origin=g.attr("origin")||"left",o=h.getParentPage(),p=h.behavior=g.attr("behavior")||"overlay",q="left"===h.origin||"right"===h.origin,r=!q;h.size=g.attr("size")||"270px",h._open=!1,f.addClass("sk-pagepanel"+d(p)+d(n));var s={};s["overflow-"+(r?"x":"y")]=c._oniOS()?"scroll":"auto",s[r?"height":"width"]=h.size,f.css(s),h.createChildComponents(g.find("components").first().children(),f,i),m.length&&skuid.interactions.enableInteractions(f,{interactionsDef:m,component:h,context:i}),h.toggle=function(f){if(f!==h._open){var g,i=h.behavior,l=o.getContentElement(),m=o.getElement(),p=h.element,s=p[r?"outerHeight":"outerWidth"](!0)+"px",t="reveal"===i?l:m,u="right"===h.origin||"bottom"===h.origin?"-":"",v=r?"0,"+u+s+",0":u+s+",0,0";f=f!==undefined?f:!h._open,p[f?"addClass":"removeClass"](d("open")),"overlay"!==i&&"reveal"!==i||(p.addClass(d("animatable")),p.one("transitionend.skuid",function(){p.removeClass(d("animatable"))})),"reveal"!==i&&"push"!==i||(f?(a.each(o.panel.getAll(),function(a,b){b.id()!==h.id()&&b.close()}),(q||"push"===i)&&(g=b.scrollTop(),t.one("transitionend.skuid",function(){l.scrollTop(g)}))):g=l.scrollTop(),l.toggleClass(e("pushed"),f),f?(m.addClass("nx-page-withpanels "+e(n)),l.scrollTop(g),c._oniOS()&&l.css("overflow","scroll"),p.css("opacity",""),q?b.css("overflow-x","hidden"):(l["top"===h.origin?"append":"prepend"]('<div class="sk-slidingpanelhelper" style="height: '+s+'">'),"top"!==h.origin&&s&&l.scrollTop(l.scrollTop()+parseFloat(s)))):((q||"push"===i)&&(b.scrollTop(g),q||p.css({top:g+"px","z-index":1})),t.one("transitionend.skuid",function(){if(!h._open){p.css({opacity:0,top:"","z-index":""});a.each(o.panel.getAll(),function(a,b){return"overlay"===b.behavior||"reveal"===b.behavior}),m.removeClass("nx-page-withpanels "+e(n)),c._oniOS()&&l.css("overflow","")}}),q?t.one("transitionend.skuid",function(){h._open||b.css("overflow-x","")}):a(".sk-slidingpanelhelper").remove()),f?(t.css("transform","translate3d("+v+")"),p.css("z-index","")):(t.css("transform",""),t.one("transitionend.skuid",function(){h._open||p.css("z-index","-100")}))),f?j&&(l.append(k),t.one("transitionend.skuid",function(){h._open&&k.one("click.skuid",function(){k.remove(),h.close()})})):k.remove(),h._open=f}},h.close=function(){h.toggle(!1)},h.open=function(){h.toggle(!0)},h.isOpen=function(){return h._open},h.unregister=function(){skuid.component.Component.prototype.unregister.call(h),o.panel._detachById(l)},h.updateContext=function(a){var b=g.children("interactions").first();f.empty(),h.unregisterChildComponents(),h.createChildComponents(g.find("components").first().children(),f,a),b.length&&(skuid.interactions.disableInteractions(f),skuid.interactions.enableInteractions(f,{interactionsDef:b,component:h,context:a})),h.context=a},setTimeout(function(){h.toggle(!0)},0)})}(skuid),function(a,b){function c(a,b){return b?a:a&&a.body?o.parseAsJSONIfString(a.body):a}function d(d){d||(d={});var e,f,g,h,i=d.type,j=d.url,k=d.data,l=!k&&!0===d.cache,m=d.dataSource,n=x(m),r=n&&o.inPlatform(a.constants.VISUALFORCE),w=function(a){var b=c(a,r);return d.success&&d.success(b),b},y=function(a,b,c){if(a.responseJSON||n||(a.responseJSON=a.body),d.error)d.error(a,b,c);else{var e=a.responseJSON[0];window.alert("There was an error performing this "+i+" request:\n\nError code: "+e.errorCode+"\nMessage: "+e.message+"\n")}return a};if(!i)throw p;if(!j)throw q;var z=m&&m.name||"";f=i+" "+j+(z?" "+z:"");var A=o.getSafeRelativeUrl(t+s+j);return e={url:A,dataType:"json",headers:{"Content-Type":"application/json"},success:w,error:y},f in v?l?(g=v[f],e=b.Deferred(),e.done(w).resolve(g),e.promise()):void delete v[f]:!k&&f in u?u[f].done(w).fail(y):(d.crossDomain&&(e.crossDomain=!0),r?(e.type=i,e.headers.Authorization="Bearer "+a.utils.userInfo.sessionId,k&&(e.data=JSON.stringify(k)),h=b.ajax(e)):(e.method=i,e.contentType="application/json",e.url=o.combineUrls(m.serviceUrl,e.url),k&&(e.body=JSON.stringify(k)),h=m.authenticate().then(function(){return m.makeRequest(m.createHTTPRequest(e))}).then(e.success,e.error)),k||(u[f]=h,h.always(function(){delete u[f]}),l&&h.done(function(a){v[f]=a})),h)}function e(a){a||(a={});var b,c=a.type,d=a.url,e=a.data,f=a.dataSource,g=f&&f.name;if(!c)throw p;if(!d)throw q;if(b=c+" "+d+(g?" "+g:""),!e&&b in v)return v[b]}function f(a,b){this._type=a,"object"==typeof b&&n(this,b)}function g(a){a||(a={});var c=this,e=c.getFields(),f=c.getType(),g={},h=a.useToolingApi||"ApexClass"===f;return e&&b.each(e,function(a,b){var d=c[a];if(b.required&&(void 0===d||""===d)){if(!b.defaultValue)throw r+a;d=c[a]=b.defaultValue}g[a]=d}),d({type:"POST",url:"/"+(h?"tooling/":"")+"sobjects/"+f,data:g,success:function(b){b.success&&(c.Id=b.id,a.success&&a.success(b))},error:function(b,c,d){if(a.error)a.error(b,c,d);else{var e=b.responseJSON;e&&e.length&&window.alert("Unable to create new "+f+" due to error:\n\nError code: "+e[0].errorCode+"\nMessage: "+e[0].message)}}})}function h(a){a||(a={});var c=this,e=c.getFields(),f=c.getType(),g={};return e&&b.each(e,function(a){var b=c[a];void 0!==b&&(g[a]=b)}),d({type:"PATCH",url:"/"+(a.useToolingApi?"tooling/":"")+"sobjects/"+f+"/"+c.Id,data:g,success:a.success,error:function(b,d,e){if(a.error)a.error(b,d,e);else{var g=b.responseJSON;g&&g.length&&window.alert("Unable to update "+f+" with Id "+c.Id+" due to error:\n\nError code: "+g[0].errorCode+"\nMessage: "+g[0].message)}}})}function i(a){a||(a={});var b=this,c=b.getType(),e=a.useToolingApi||"ApexClass"===c;if(!b.Id)throw r+"Id";return d({type:"DELETE",url:"/"+(e?"tooling/":"")+"sobjects/"+c+"/"+b.Id,success:a.success,error:a.error})}function j(a,b){return b||(b={}),d({type:"GET",url:"/"+(b.useToolingApi?"tooling/":"")+"query/?q="+encodeURIComponent(a),success:b.success,error:function(a,c,d){if(b.error)b.error(a,c,d);else{var e=a.responseJSON;e&&e.length&&window.alert("There was an error performing this query: "+e[0].message)}}})}function k(a){return window.btoa(window.unescape(encodeURIComponent(a)))}var l=a.sfdc={},m=l.api={},n=b.extend,o=a.utils,p='Parameter "type" expected, e.g. "POST", "GET"',q='Parameter "url" expected, e.g. "/sobjects/Account", "/query/?q=select+Name+from+Account"',r="Missing object property: ",s=m.version="41.0",t="/services/data/v",u={},v={},w={StaticResource:{fields:{Name:{required:!0},Description:{required:!1},Body:{required:!0},CacheControl:{required:!0,defaultValue:"Public"},ContentType:{required:!0,defaultValue:"text/plain"}}},ApexPage:{fields:{Name:{required:!0},Markup:{required:!0},MasterLabel:{required:!0},ApiVersion:{required:!0,defaultValue:m.version}}},ApexClass:{fields:{Name:{required:!0},Body:{required:!0},ApiVersion:{required:!0,defaultValue:m.version}}}},x=function(a){if(!a)return!0;var b=a.dataSourceType;return!!b&&(!!b.isDataSourceNativeSalesforce&&b.isDataSourceNativeSalesforce(a))};f.prototype={insert:function(){return g.apply(this,arguments)},update:function(){return h.apply(this,arguments)},"delete":function(){return i.apply(this,arguments)},get:function(a){return this[a]},set:function(a,b){o.isString(a)?this[a]=b:n(this,a)},getType:function(){return this._type},getFields:function(){var a=w[this.getType()];return a?a.fields:null},getField:function(a){var b=this.getFields();return b?b[a]:null}},n(m,{getCachedResult:e,makeRequest:d,query:j,escapeMetadataBody:k,SObject:f})}(skuid,skuid.$),function(a){function b(){return l}function c(a){var b="px";return 0===a&&(b=""),a+b}function d(){var d=arguments;return Array.isArray(arguments[0])&&(d=arguments[0]),h.map(d,function(d){var e=parseFloat(d);return isNaN(e)?a.themeSettings.getToken("spacing",d):c(e*b())}).join(" ")}function e(a){return d(k[a]||1)}function f(){return k}function g(){return h.map(f(),function(a,b){return[{label:b,value:a}]})}var h=a.$,i=a.utils,j=i.spacing={},k={None:0,"X-Small":.5,Small:1,Medium:2,Large:4,"X-Large":8},l=8;a.events.subscribe("ui.themeSettings.loaded",function(){var b=a.themeSettings.getAll();b&&(l=parseFloat(a.utils.getObjectProperty(b,"tokens.spacing.small"))||8)}),h.extend(j,{get:d,getByName:e,getDefaults:f,getDefaultsAsPicklist:g})}(skuid),function(a,b){function c(a){var b=new Date;return new Date(a).getTime()-b.getTime()}function d(d,f){var g,h,i,j,k,l,m,p;if(!o){h=b("<div>"),i=b("<div>"),j=b("<div>").text("Continue").skooButton().click(function(){a.platform.forceSessionActivity&&a.platform.forceSessionActivity().then(function(a){e(a,f)})["catch"](function(){window.addEventListener("message",function(a){a.origin===window.location.origin&&"login_success"===a.data&&e(null,f)}),a.platform.openLoginWindow()}),l.dialog("close")}),k=b("<div>").text(z("cancel")).skooButton().click(function(){l.dialog("close")}),p=function(){var a=c(d),b=Math.floor(a/1e3),e=Math.floor(b/60);e>0&&b>0?(h.text("Your session will expire in "+e+" minute"+(1===e?"":"s")+"."),i.html('<br/>Click the "Continue" button below to renew your session and continue working.<br/><br/>')):b>0?(h.text("Your session will expire in "+b+" second"+(1===b?"":"s")+"."),i.html('<br/>Click the "Continue" button below to renew your session and continue working.<br/><br/>')):(j.button("option","label","Log In"),h.text("Your session has expired."),i.html('<br/>Press "Login" to open the login page in a new window.<br/><br/>(You may need to disable pop-up blocking for this site.)<br/><br/>'),clearInterval(g),l.dialog({position:m}))},clearTimeout(n),o=!0,p(),g=setInterval(p,1e3),l=b("<div>").append(h,i,j,k),m={my:"right-20 bottom-20",at:"right bottom",of:window};var q=a.events.subscribe("ui.resize",function(){l.dialog({position:m})});f.storeSubscription(q),l.dialog({title:"Session Warning",modal:!1,width:300,position:m,beforeClose:function(){q.unsubscribe(),o=!1,clearTimeout(n),clearInterval(g)}})}}function e(b,f){clearTimeout(n);var g=b?c(b)-60*x*1e3:0;g<0?d(b,f):n=setTimeout(function(){a.platform.checkSessionExpiration().then(function(a){return e(a,f)})},g)}function f(c,d){!c._unsavedChangesHandler&&d&&(c._unsavedChangesHandler=!0,b(window).on("beforeunload.skuid",function(){var c;return b.each(a.model.list(),function(){var b=this.getParentPage();if(this.hasChanged&&this[y]&&(!b||b[y]))return c=a.$L("unsaved_changes_warning"),!1}),c}))}function g(b,c,d){var e,f;!b||b.runningOnForceSite||c.isInclude||c.isReplace||a.mobile||(a.settings&&a.settings.globalFeedback?(f=a.settings.globalFeedback("position"),e=a.settings.globalFeedback("enabled")):(f=a.page.globalFeedbackPosition,e=a.page.globalFeedbackEnabled),e&&"false"!==d&&(c.globalFeedback=new a.globalFeedback.GlobalFeedback({position:f,pageComponent:c,element:q})))}function h(c,d,e){if("true"===e||!j(c,d))return!1;var f,g,h="PageBuilder"==a.page.name;h||a.platform.isNative()||(f=b("<div>").prop("id","skuidEditBtnContainer"),g=b("<div>").prop("id","skuidEditBtn").appendTo(f),b("<div>").addClass("inline sk-icon sk-icon-configure").css("margin-right","4px").appendTo(g),b("<div>").addClass("skuidEditButtonLabel").text(a.$L("edit_page")).appendTo(g),f.css("display","block").on("mouseover",function(){f.stop().animate({width:"90px"},400)}).on("mouseleave",function(){f.stop().animate({width:"16px"},400)}).on("click",function(){window.open(a.platform.getPageComposeUrlById(c.id),"_blank")}).appendTo(q))}function i(a,c){if(!j(a,c))return!1;var d,e,f,g=a.getAllProblems(),h=c.getContentElement();a.problemsIndicator?d=a.problemsWrapper:(d=b("<div>").addClass("nx-page-problems-wrapper clearfix"),e=b("<div>").addClass("nx-page-problems-indicator nx-error").css({display:"inline-block","text-align":"left",padding:"7px"}).click(function(){f.toggle()}),f=b('<div class="nx-page-problems-container">').css({display:"none","white-space":"wrap"}),b.extend(a,{problemsIndicator:e,problemsWrapper:d,problemsContainer:f}),d.append(e,f),h.prepend(d)),g.length?b.each(g,function(){a.displayProblem(this)}):d.css("display","none")}function j(b,c){return b&&b.editable&&!b.runningOnForceSite&&!a.mobile&&!c.isInclude&&!c.isReplace}function k(a){return a.has("isPageInclude")||a.set("isPageInclude",a.getElement().parent().hasClass("nx-include-panel")),a.get("isPageInclude")}function l(c,d,f){function g(a){r="mousedown"===a.type,d.set("usingMouse",r,{renderOnChange:!1})}function h(a){r||a.target.classList.add("sk-focus-keyboard")}function i(a){a.target.classList&&a.target.classList.remove("sk-focus-keyboard")}function j(a,b){y[0].addEventListener(a,b)}var l,m,n,o,p,q,r,s=d._pageRecord?d._pageRecord.Name:"",t=a.region.get("__header"+s),u=a.region.get("__footer"+s),v=f.children("components").first().children(),x=f.children("interactions").first(),y=d.getElement(),z=d.getContentElement(),A=d.getPanelsElement();if(!0===d.get("loading.stopped"))return void b.holdReady(!1);(d.isReplace||d.isInclude)&&d.previousPageComponent&&d.previousPageComponent.unrender().unregister({removeElement:!1}),l={_parentPageId:d.id()},q=d.context,t&&d.createChildComponents(t.xmlDefinition.children("components").first().children(),z,q,l),d.createChildComponents(v,z,q,l),u&&d.createChildComponents(u.xmlDefinition.children("components").first().children(),z,q,l),c.updateProblemsWrapper(),z.css("display","block"),y.css("display","block"),a.responsive.handleResize(),n=y.find(".nx-field > :input:visible:not(.hasDatepicker)"),n.first().focus(),o=b('a.zen-trigger[title="Publisher Type Overflow Menu"]'),p=o.next(),o.click(function(){p.toggle()}),p.click(function(){p.hide()}),x.length&&a.interactions.enableInteractions(z,{interactionsDef:x,component:d}),k(d)?y.append(z):y.append(z,A),m={page:d,component:d},d.publish("page.rendered",m,{qualifyEventName:!1,scope:w.SKUID}),d.publish("ui.reflow",m,{buffer:10,qualifyEventName:!1,scope:w.SKUID}),b.holdReady(!1),r=!0,function(){j("keydown",g),j("mousedown",g),j("focusin",h),j("focusout",i)}(),y.trigger("pageload"),a.platform.checkSessionExpiration&&!d.get("checking.session")&&a.utils.userInfo.isAuthenticated&&!a.offline.networkDown()&&(d.set("checking.session",!0),e(a.utils.userInfo.sessionExpireTime,d))}function m(c,d,e,f){return b.when.all(b.map(f,function(a){return a._createDefaultRowIfNeeded()})).then(function(){b.each(f,function(a,b){b._cloneRowsIfNeeded(d)}),b.each(e,function(a,b){delete b.realToFakeIdMap}),a.utils._oniOS()&&a.utils._inIframe()&&b(function(){q.removeClass("sk-scrollfix-ios-body"),b("html").removeClass("sk-scrollfix-ios-html"),q.addClass("sk-scrollfix-ios-body"),b("html").addClass("sk-scrollfix-ios-html")}),"Theme4d"===a.platform.get("SFUITheme")&&q.addClass("sk-body-nopadding")})}var n,o,p,q=b(document.body),r=a.component,s=r.Component,t=r.getById,u=a.events,v=u.Event,w=a.constants.EVENT_SCOPES,x=3,y="preventUnloadIfUnsavedChanges",z=a.$L;p={addProblem:function(b,c){var d=this,e=d.problems;("string"==typeof b||b instanceof String)&&(b={message:b}),a.page.displayProblem(b)&&e.push(b),!0!==c&&a.page.updateProblemsWrapper(),a.utils.runningTests()&&a.events.publish("pageProblem.created",b)},addProblems:function(c){var d=this;c instanceof Array?b.each(c,function(a,b){d.addProblem(b,!0)}):d.addProblem(c,!0),a.page.updateProblemsWrapper()},removeProblem:function(a){var b,c=this,d=c.problems;if(d&&d.length&&d instanceof Array)for(b=d.length-1;b>=0;b--)if(d[b]===a)return d.splice(b,1)[0]},removeProblems:function(){this.problems.length=0,a.page.updateProblemsWrapper()},unregisterChildComponents:function(){var c=this;return c.childComponents.length&&b.each(c.childComponents,function(){this.unregister()}),b.each(c.getModels(),function(){var b,d=a.platform.getName()===a.constants.VISUALFORCE&&a.utils.isUndefined(this.processOnClient);d&&(c.has("serverSideModelCache")||c.set("serverSideModelCache",[]),b=c.get("serverSideModelCache"),b.push(this)),this.unregister()}),c.globalFeedback&&c.globalFeedback.unregister(),c},unregister:function(){var b=this;return a.page.rebuildPageProblems(),(b.get("actionSequences")||[]).forEach(function(a){a.unregister()}),s.prototype.unregister.call(b)},getPageRecord:function(){return t(this.id())._pageRecord},getParameter:function(b){if("string"==typeof b){var c=a.page.getParameters(this);return b in c?c[b]:c[b.toLowerCase()]}},getPageParameters:function(){var b=this._pageParameters;return b||(b=this._pageParameters=a.page._parametersByPage[this.id()]),b},setPageParameters:function(c){var d=this,e=d._pageParameters;return e||(e=d._pageParameters=a.page._parametersByPage[d.id()]={}),b.extend(e,c),d},getContentElement:function(){var a=this;return a.has("contentElement")||a.set("contentElement",b('<div class="nx-page-content">')),a.get("contentElement")},getPanelsElement:function(){var a=this;return a.has("panelsElement")||a.set("panelsElement",k(a)?a.getParentPage().getPanelsElement():b('<div class="nx-page-panels">')),a.get("panelsElement")},getOriginalTopPadding:function(){var b,c=this;return c.has("originalTopPadding")||(b=this.getContentElement(),c.set("originalTopPadding",a.utils.getCSSSizeObj(b.css("padding-top")||"0px"))),c.get("originalTopPadding")}},a.componentType.register("skuidpage",{label:"Skuid Page",styles:a.pageStylesTEMPORARY?a.pageStylesTEMPORARY:undefined,onlyRenderOnce:!0,render:function(c,d,e){function j(){return m(x,e,t,v)}a.createPageStylesTEMPORARY&&c.addClass(e.getStyledClasses("skuidpage"));var k,n,o,q,r,s,t,v,w,x=a?a.page:null,z=e[y]="yes"===d.attr("unsavedchangeswarning"),A=d.attr("globalfeedbackenabled"),B=d.attr("hideeditbutton"),C={},D=e._getCPI(),E=a.utils.resolve;return"true"!==d.attr("useviewportmeta")||a.mobile||b("#sk-meta-viewport").length||b("head").append('<meta id="sk-meta-viewport" name="viewport" content="width=device-width, initial-scale=1">'),e.problems=[],b.extend(e,p),k=e.getContentElement(),n=e.getPanelsElement(),e.getModels=D.getModels,e.getModel=D.getModel,e.panel={create:function(a,b,c){var d=a.attr("uniqueid");return C[d]=e.createChildComponents(a,n,c)[0],C[d]},createFromAction:function(a,b,c){var d=a.children("panel").first(),f=d.attr("uniqueid");return C[f]=e.createChildComponents(d,n,c)[0],C[f]},getById:function(a){return C[a]},_detachById:function(a){C[a]&&delete C[a]},getAll:function(){return b.extend({},C)},closeAll:function(){b.each(C,function(){this.close()})}},f(x,z),a.utils.processStylesNode(d.children("styles"),k),h(x,e,B),i(x,e),g(x,e,A),e.set("actionSequences",a.actionSequences.initializeActionSequences(e)),q=d.children("models").children(),q.length&&q.each(function(){var c={_parentPageId:e.id()};e.isReplace&&(c.processOnClient=!0),new a.model.Model(b(this),c).register()}),e.has("serverSideModelCache")&&(s=e.get("serverSideModelCache"),b.each(s,function(){this.register()}),e.unset("serverSideModelCache")),o=[],t=e.getModels(),v=[],w=[],b.each(t,function(a,b){b.initialize({createDefaultRowIfNeeded:!1,cloneRowsIfNeeded:!1,pageComponent:e}),!b.processOnClient||!b.doQuery&&b.hasMetadataLoaded()?(b.errors&&b.errors.length&&e.addProblems(b.errors),v.push(b)):(b.loadAsync?w:o).push(b)}),b.holdReady(!0),r=(o.length?a.model.load(o,null,{pageComponent:e}):E()).then(j,j).then(function(){return!0===a.webfonts.haveFontsLoaded()?E():u.subscribeOnce("ui.fontsloaded")}).then(function(){return l(x,e,d)}),b.each(w,function(){this.load(null,{pageComponent:e})}),e.subscribeOnce("stop.loading",function(){e.set("loading.stopped",!0),r.reject&&r.reject()}),r.promise()},cpi:{$M:function(a){var b=this._getCPI().getModels(a);if(b.length)return b[0]},getModel:function(a){return this._getCPI().$M(a)},getModels:function(b){var c=this.getId();return a.model.list().filter(function(a){return a.getParentPageId()===c&&(!b||a.id===b)})},$C:function(a){return this.getChildComponent(a)},getComponent:function(a){return this._getCPI().$C(a)},createPopup:function(b){if(b.isInk)return a.utils.createPopupFromPopupXML(b,b.context)}}}),u.register([new v("page.rendered","Skuid Page: Rendered")])}(skuid,skuid.$),function(a){function b(b){return g[b||a.platform.getDefaultDataSourceTypeName()]}function c(){return e({},g)}function d(){return h.map(g,function(a){return a}).sort(function(a,b){return(a.label?a.label:a.name)>(b.label?b.label:b.name)})}var e=a.$.extend,f=a.dataSource||(a.dataSource={}),g={},h=a.$,i=a.utils,j=function(a){if(!1!==a){e(this,a);var b=this.name;if(!b)throw"Data Source Type name is required.";g.hasOwnProperty(b)||(g[b]=this)}};e(j.prototype,{prop:function(b){return this.properties?a.utils.getObjectProperty(this.properties,b):null},getActions:function(){return a.$.Deferred().resolve({})},runAction:function(b,c,d,e,f){var g=a.$;return f.getActions(f).then(function(h){var i={};a.utils.isFunction(h)&&(h=h(f)),g.isArray(h)?g.each(h,function(a,b){b.disabled||(i[b.name]=b)}):i=h;var j=i[b];return j?e.rows&&!e.row?g.when.all(g.map(e.rows,function(a){var b=g.extend({},e);return b.row=a,j.runtimeExecution(c,d,b,f)})):j.runtimeExecution(c,d,e,f):a.utils.reject("Invalid Data Source Action.")})},getNameFieldURLForReferenceField:function(b,c,d,e){var f,g=b.options.fieldXML,j={model:b.model,row:b.row},k=b.model.getDataSourceType(),l=g&&g.attr("redirecttype")||e,m=i.inPlatform(a.constants.NATIVE),n={},o="page"===l&&g.attr("page"),p="route"===l&&g.attr("route"),q="customurl"===l&&g.attr("window")||"self",r="customurl"===l&&g.attr("rooturl"),s='<a href="',t=!1;if("none"!==l&&l){if("datasourcedefault"===l&&k.getNameFieldURLForReferenceField&&k.getNameFieldURLForReferenceField!==this.getNameFieldURLForReferenceField)return k.getNameFieldURLForReferenceField(b,c,d,e);if("datasourcedefault"!==l)return h.each(g.children("params").children(),function(a,b){var c=h(b);n[c.attr("key")]=i.mergeAsTextInContext(c.attr("value"),j,{createFields:!1,registerFields:!1})}),m&&(o||p)&&(s+='#" onclick="skuid.loader.load('+i.encodeHTML(JSON.stringify({isReplace:!0,pageName:o,parameters:n,routeName:p}))+")",t=!0),"customurl"===l&&(f=i.mergeAsTextInContext(i.applyURLParametersToURL(r,n),j),"self"===q?s+=f:"blank"===q&&(s+='#" onclick="window.open(\''+i.encodeHTML(f)+"')"),t=!0),t?s+='" tabindex="-1">'+d+"</a>":void 0}},getNameFieldURLForTextField:function(a,b,c){return this.getNameFieldURLForReferenceField(a,c,b,"datasourcedefault")},getDefaultFieldsForReferenceField:function(b,c,d){if(!!(d&&d.dataSourceType&&d.dataSourceType.getNameField))return[a.utils.getFieldReference(b,c,d)]},modelsCanSearch:function(){return!1!==this.prop("canFieldsBeIndividuallySearched")||this.prop("hasDefaultSearch")&&this.prop("canServerSearch")},supportsVoiceCommands:function(){for(var b=["voiceCommands","voiceCommands.methods","voiceCommands.methods.beginConversation","voiceCommands.methods.conversationKillSwitch","voiceCommands.props","voiceCommands.props.page","voiceCommands.props.actionSequence","voiceCommands.props.actionSequence.topLevelProps","voiceCommands.props.actionSequence.shouldHaveInputs"],c=0;c<b.length;c++)if(!a.utils.getObjectProperty(this,b[c]))return!1;return!0},getPageParametersForVoiceCommands:function(b){var c=a.utils.getObjectProperty(this,"voiceCommands.props.page");if(!c)return{};var d=c(),e={};return h.each(d,function(a,c){e[c.id]=b.attr(c.id)}),e}}),e(f,{DataSourceType:j,getAllTypes:c,getAllDataSourceTypes:c,listAllTypes:d,mapTypes:c,mapDataSourceTypes:c,getType:b,getDataSourceType:b,libraries:{skuid:{}}})}(skuid),function(a){function b(a,b){var c={};return b.forEach(function(b){c[b]="{{"+a+"."+b+"}}"}),c}function c(b){return a.platform.getOAuthRedirectUri(b)}function d(a,b){var c=a.authentication,d=a.name,e=c.authMethod;return e?r.startsWith(e,"oauth")?d+(b?"::"+b:""):"apex"===e?d:void 0:c.url}function e(b){return q[b||a.platform.getDefaultDataSourceName()]}function f(b){b!==a.platform.getDefaultDataSourceName()&&delete q[b]}function g(b,c){var d,f,g=t.extend({useDefault:!0,nodeIdentifierAttribute:"id",allowNullReturn:!1},c);return b&&(d=g.customAttributeName?b.attr(g.customAttributeName):b.attr("datasource")||b.attr("service")),!d&&g.useDefault&&(d=a.platform.getDefaultDataSourceName()),f=d&&e(d),void 0!==f||g.allowNullReturn?f:(a.component.getByType("skuidpage")[0].addProblem(a.label.merge({template:a.$L("invalid_data_source"),data:[b.attr("datasource")||b.attr("service"),b.attr(g.nodeIdentifierAttribute)]})),e())}function h(){return u({},q)}function i(){return JSON.parse(s.localStorage.getItem(G)||"{}")}function j(a){u(this,a)}function k(a){u(this,a)}function l(b){var c=b.name,d=b.dataSourceTypeName;u(this,b),this.customConfig&&(this._c=this.customConfig,delete this.customConfig),this.dataSourceType=a.dataSource.getType(d||a.platform.getDefaultDataSourceTypeName()),this.entityMetadataCache={},this._cache={},this.dataSourceType&&this.dataSourceType.initializeDataSource&&this.dataSourceType.initializeDataSource(this),q.hasOwnProperty(c)||(q[c]=this)}function m(a){return a&&0!==a.length?a.length>1?a:1===a.length?a[0]:void 0:null}function n(a){this[F]=u(!0,{},a),this._isFull=!1}function o(a){return t.map(a,function(a){return a})}var p=a.dataSource||(a.dataSource={}),q={},r=a.utils,s=a.data,t=a.$,u=t.extend,v=a.constants,w=v.MIME_TYPES.FORM_URL_ENCODED,x=v.SALESFORCE,y=r.isString,z=r.mergeAsTextInContext,A=r.contains,B=r.isUndefined,C=r.startsWith,D="skuidDataSourceMetadata",E={},F="_m",G="skuidOAuth",H=b("$Auth",["BasicAuth","Client_Id","Client_Secret","Password","Username"]),I=b("$User",["Email","FederationId","FirstName","Id","LastName","Username"]),J={firstname:"firstName",lastname:"lastName",userid:"userId",username:"userName"};n.prototype={update:function(a){var b=this,c=this[F];c||(c=this[F]={}),delete this._fm,t.each(a,function(d,e){if(!a.hasOwnProperty(d))return!0;if(c.hasOwnProperty(d))if("fields"===d){var f=b.getFieldsMap({noCache:!0,onlyIdKey:!0});t.each(e,function(a,b){var c=b.id,d=f[c];d?t.each(b,function(a,b){null!==b&&void 0!==b&&(d[a]=b)}):f[c]=b}),c.fields=o(f)}else c[d]=e;else c[d]=e})},get:function(a){var b=this[F];if("string"==typeof a)return b[a];if(a instanceof Array){var c={};return t.each(a,function(a,d){c[d]=b[d]}),c}},getLabel:function(){return this[F].label},getLabelPlural:function(){return this[F].labelPlural},getPluralLabel:function(){return this.getLabelPlural()},getEntityName:function(){return this[F].objectName},getObjectName:function(){return this[F].objectName},getFieldsList:function(){return this[F].fields||[]},getSortedFieldsList:function(){var a=r.capitalizeFirst;return this.getFieldsList().slice().sort(function(b,c){var d=a(b.label||b.id)||"",e=a(c.label||c.id)||"";return d<e?-1:d>e?1:0})},getFieldsMap:function(a){var b=a&&a.noCache,c=a&&a.onlyIdKey,d=this.getFieldsList(),e=c?"id":["id","name"];return b?r.keyBy(d,e):(this._fm||(this._fm=r.keyBy(d,e)),this._fm)},getField:function(a){return this.getFieldsMap()[a]},getChildRelationshipsList:function(){return this[F].childRelationships||[]},getExtensions:function(a){var b=this[F].extensions||{};return a?r.getObjectProperty(b,a):b},_getCRMap:function(){return this._crm||(this._crm=r.keyBy(this[F].childRelationships,"relationshipName")),this._crm},getChildRelationship:function(a){return this._getCRMap()[a]},_unwrap:function(){return this[F]},setIsFullMetadata:function(){return this._isFull=!0,this},isFullMetadata:function(){return this._isFull}},l.prototype={save:function(b){var c=this,d=a.offline,e=c.dataSourceType.prop("neverCache");return d.isEnabled()&&d.networkDown()&&!e?d.save(b,{dataSource:c}):c.dataSourceType.save(b,{dataSource:c})},load:function(b,c){c=c||{};var d=this,e=a.offline,f=a.storage,g=d.dataSourceType.prop("neverCache");return e.isEnabled()&&e.networkDown()&&!g?e.load(b,u({},c,{dataSource:d})):d.dataSourceType.load(b,u({},c,{dataSource:d
})).then(function(a){return!e.isEnabled()||g?a:(t.each(a,function(a,c){var e=b.filter(function(a){return a.id===c.id})[0];if(!e||!1!==e.doQuery){var g=t.extend({},c);e&&!g.fields&&(g.fields=e.fields),e&&!g.conditions&&(g.conditions=e.conditions);try{g=JSON.parse(JSON.stringify(g))}catch(h){g.data=e?e.getRawRows():t.map(g.data,function(a,b){delete b.__skuid_record__})}f.tables.entityData.add(null,{dataSource:d,objectName:g.objectName,data:g,conditions:g.conditions})}}),a)})},getRowId:function(a,b){var c;try{c=this.dataSourceType.getRowId(a,b,this)}catch(d){}return(B(c)||null===c)&&(c=r.generateUniqueId()),c},getIdField:function(a){var b=this.dataSourceType;return b&&b.getIdField?b.getIdField(a):null},getIdFieldForChildRelationship:function(a,b){var c=this.dataSourceType;return c&&c.getIdFieldForChildRelationship?c.getIdFieldForChildRelationship(a,b):null},getKeyPrefix:function(a,b){var c=this.dataSourceType.getKeyPrefix;return c&&c(a,b,this)||a+"__"+this.name},getValueKeyPrefix:function(a,b,c){var d=this.dataSourceType.getValueKeyPrefix;return d&&d(a,b,c,this)||b+"__"+this.name},getRowName:function(a,b){return this.dataSourceType.getRowName(a,b,this)},getNameField:function(a,b){return this.dataSourceType.getNameField(a,this,b)},getConditionSourceProperties:function(a,b){var c=this.dataSourceType.getConditionSourceProperties;return c&&c(a,b)},getDataSourceType:function(){return this.dataSourceType},getDataSourceTypeName:function(){return this.dataSourceType&&this.dataSourceType.name},getEntityList:function(){return this.dataSourceType.getEntityList({dataSource:this})},search:function(a,b,c){var d=this;return a.dataSource||(a.dataSource=this),d.authenticate().then(function(){return d.dataSourceType.search(a,b,c)})},searchableEntities:function(){return this.dataSourceType.searchableEntities()},getFieldRenderers:function(){return!!this.dataSourceType.fieldRenderers&&this.dataSourceType.fieldRenderers()},getReferenceFieldRelationshipName:function(a,b){var c=this.dataSourceType.getReferenceFieldRelationshipName;if(c)return c(a,b)},getActions:function(a,b){var c=this,d=c._cacheService().getCachedValue("actionsMetadata");return d?(r.isFunction(d)&&(d=d(c,a,b)),t.Deferred().resolve(d).promise()):c.dataSourceType.getActions(c,a,b).then(function(a){return c._cacheService().setCachedValue("actionsMetadata",a),a})},_cacheService:function(){function a(a){var b=j._cache[a];return b||(b=j._cache[a]={})}function b(b,c,d){d=d||k;var e=a(d);r.setObjectProperty(e,b,c)}function c(b){var c=a(k);return r.getObjectProperty(c,b)}function d(a,b){a=a||m;var c=j._cache[a];return c||(c=j._cache[a]=f(a)||{}),b?r.getObjectProperty(c,b):c}function e(a){return a!==l&&(a=m),JSON.parse(s[a].getItem(D)||"{}")}function f(a){return e(a)[j.name]}function g(a){h(a,d(a))}function h(a,b){a!==l&&(a=m);var c=e(a);c[j.name]=b,s[a].setItem(D,JSON.stringify(c))}function i(a,b){var e=c(a);return B(e)&&(e=d(b,a)),e}var j=this,k="inMemoryOnly",l="sessionStorage",m="localStorage";return{setPersistentCachedValue:function(a,c,e){b(a,c,e);var f=d(e);return r.setObjectProperty(f,a,c),h(e,f),j},setPersistentCachedValues:function(a,c){var e=d(c);return t.each(a,function(a,d){b(a,d,c),e[a]=d}),h(c,e),j},setCachedValue:function(a,c){return b(a,c),j},setCachedValues:function(a){return t.each(a,function(a,c){b(a,c)}),j},batchCacheValue:function(a,c,d){b(a,c,d||m)},persistBatchedCaches:function(a){g(a||m)},getCachedValue:i,getCachedValues:function(a,b){var c={};return a.forEach(function(a){c[a]=i(a,b)}),c}}},batchCacheProperty:function(a,b,c){return this._cacheService().batchCacheValue(a,b,c)},persistBatchCache:function(a){return this._cacheService().persistBatchedCaches(a)},getCacheProperty:function(a,b){return this._cacheService().getCachedValue(a,b)},getCacheProperties:function(a,b){return this._cacheService().getCachedValues(a,b)},setCacheProperty:function(a,b){return this._cacheService().setCachedValue(a,b),this},setCacheProperties:function(a){return this._cacheService().setCachedValues(a),this},setPersistentCacheProperty:function(a,b,c){return this._cacheService().setPersistentCachedValue(a,b,c),this},setPersistentCacheProperties:function(a,b){return this._cacheService().setPersistentCachedValues(a,b),this},clearPropertiesCache:function(){var a=this.name;return this._cache={},["localStorage","sessionStorage"].forEach(function(b){var c=s[b].getItem(D);c&&(c=JSON.parse(c),c[a]&&(delete c[a],s[b].setItem(D,JSON.stringify(c))))}),this},unregister:function(){return f(this.name),this},runAction:function(a,b,c,d){var e=this;return e.dataSourceType.runAction(a,b,c,d,e)},getConfigProperty:function(a){return r.getObjectProperty(this._c||{},a)},getUploadMethod:function(a){var b=this.getUploadMethods(),c=b&&b[a];return c?(c.dataSource=this,new j(c)):null},getUploadMethods:function(){var a=this.getDataSourceType();return a.getUploadMethods?a.getUploadMethods(this):{}},getImageSources:function(){var b=this.getDataSourceType(),c=b.getImageSources?b.getImageSources(this):{},d={label:"URL",optionalRecordContext:!0,getSrc:function(b){var c=t.Deferred(),d=b.context,e=b.mergeSettings,f=b.prefix||"",g=b.definition?b.definition[f+"url"]:b.xmlDef.attr(f+"url"),h=r.getSafeRelativeUrl(r.mergeAsTextInContext(g,d,e));return a.platform.isNative()&&-1===h.indexOf("http")&&(h=a["native"].instanceUrl+h),h?c.resolve(h):c.reject(),c.promise()},builderProps:function(a,b,c){var d=c.additionalOnRefresh;return[{id:(c.prefix||"")+"url",label:"Image URL",type:"template",location:"attribute",onChange:function(){a.refresh(),d&&d()}}]}};return c.url=d,c||{}},getImageSource:function(a){this.name===x&&"external"===a&&(a="url");var b=this.getImageSources(),c=b&&b[a];return c?(c.dataSource=this,new k(c)):null},buildEntityMetadataRequest:function(a){var b=this.dataSourceType.buildEntityMetadataRequest(a);return b.dataSource=this,b},getEntityMetadataLoadingMessageFromBreadcrumb:function(a){return this.dataSourceType.getEntityMetadataLoadingMessageFromBreadcrumb(a)},prefillMetadataForObject:function(a,b){var c=this.dataSourceType.prefillMetadataForObject;c&&c({object:a,data:b,dataSource:this}),this.cacheEntityMetadata(this.getEntityMetadataCacheKey(a),b)},populateBreadcrumbFromEntityMetadata:function(a){var b=this,c=b.getDataSourceType(),d=c.populateBreadcrumbFromEntityMetadata;return d?(a.dataSource=b,d(a)):a.crumb},getModels:function(){var b=this;return a.model.list().filter(function(a){return a.getDataSource()===b})},getEntityMetadataCacheKey:function(a){var b=this;return r.isString(a)?a:b.dataSourceType.getEntityMetadataCacheKey?(a.dataSource||(a.dataSource=b),b.dataSourceType.getEntityMetadataCacheKey(a)):void 0},cacheEntityMetadata:function(b,c){var d=this,e=a.offline,f=a.storage;if(1===arguments.length&&r.size(arguments[0]))return t.map(arguments[0],function(a,b){return d.cacheEntityMetadata(b,a)});var g=d.entityMetadataCache,h=g[b];return h?h.update(c):h=g[b]=new n(c),e.isEnabled()&&!e.networkDown()&&f.tables.entityMetadata.add(null,{dataSource:d,objectName:b,data:h._unwrap()}),h},getCachedEntityMetadata:function(a){var b,c=this,d=c.entityMetadataCache;return a?(b=a.entities?a.entities:r.isString(a)?[{objectName:a}]:[a],t.isArray(b)||(b=[b]),m(t.map(b,function(a){return d[c.getEntityMetadataCacheKey(a)]}))):d},clearEntityMetadataCache:function(){return this.entityMetadataCache={},this},processEntityMetadataRequests:function(a){var b,c,d=this,e=a.entities,f=a.results,g=d.getDataSourceType().processEntityMetadataRequest;if(g){for(c=[],b=0;b<e.length;b++){var h=f[b];h?c.push(g({entity:e[b],result:h})):c.push(null)}return c}return f},getEntityMetadata:function(a){var b,c,d=this,e=t.Deferred(),f=a.entities,g=a.ignoreCache||!1,h=[],i=[],j=function(){e.resolve(m(i))};return f&&(t.isArray(f)||(f=[f]),t.each(f,function(a,c){try{c.dataSource=d}catch(e){}b=null,g||(b=d.getCachedEntityMetadata(c)),b&&b.isFullMetadata()?i.push(b):h.push(c)})),h.length?(c={entities:h,dataSource:d,ignoreCache:g},d.dataSourceType.getEntityMetadata(c).then(function(a){i=t.map(d.processEntityMetadataRequests({entities:h,results:a}),function(a,b){return d.cacheEntityMetadata(d.getEntityMetadataCacheKey(h[b]),a).setIsFullMetadata()}),j()},function(a){e.reject(a)})):j(),e.promise()},createHTTPRequest:function(a){a||(a={});var b,c,d=this,e=d.authentication,f=u({},d.requestHeaders,a.headers),g={},h=u({model:a.model,row:a.row},a.apiExtensions,a.context),i=d.requestBodyParameters,j=a.url,k=A(j,"?"),l=a.contentType,m=a.body,n=u({},d.requestUrlParameters||{},a.parameters||{});return e&&e.success&&(h.$Auth=t.extend({},H,{Response:{Body:e.responseBody,Headers:e.responseHeaders}}),h.$User=t.extend({},I)),t.each(n,function(a,b){a&&b&&(k?j+="&":(j+="?",k=!0),j+=a+"="+encodeURIComponent(z(b,h,{createFields:!1})))}),j=z(j,h,{createFields:!1}),t.each(f,function(a,b){var c=b&&y(b)?z(b,h,{createFields:!1}):b;g[a]=c}),(i&&r.size(i)||m&&r.size(m))&&(l&&A(l,"json")&&t.isPlainObject(m)?(c={},i&&u(c,i),m&&u(c,m)):c=m),b={url:j,headers:g,method:a.method,modelDataSource:d.name,originalRequest:a},c&&(b.contentType=l,b.body=c),b.method||(b.method=c?"POST":"GET"),a.accept&&(b.accept=a.accept),e&&e.success&&(b.isAuthenticated=!0),b},makeRequest:function(b,c){function d(a){return h.call(f,a||f.createHTTPRequest(i),c)}function e(b){if(C(b,"Invalid Request: Unauthorized endpoint")){var c=!a.page.runningOnForceSite&&a.utils.userInfo.isAuthenticated,d="To make this request, a System Administrator for this Organization will need to configure a Remote Site Setting for this Data Source in Salesforce Setup.";if(c){if(window.confirm(d+"\n\nWould you like to do that now?\n")){var e=window.location.href+"",h=e.substring(e.indexOf("/",e.indexOf("//")+2),e.length),i="SkuidDS_"+f.name.replace(/[\W]+/g,"");r.redirect({url:"/0rp/e?"+r.param({setupid:"SecurityRemoteProxy",IsActive:1,retURL:h,cancelURL:h,EndpointUrl:f.serviceUrl||"",SiteName:i.length>40?i.substring(0,40):i,DescriptionField:'Needed to make requests to Skuid Model Data Source "'+g+'"'})})}}else window.alert(d+"\n\nPlease add a Remote Site Setting for the following URL:\n\n"+(f.serviceUrl||""));return!0}return!1}var f=this,g=f.name,h=a.ajax[f.useProxy?"proxy":"direct"],i=b.originalRequest,j=t.Deferred();return d(b).done(function(a){return j.resolve(a)}).fail(function(b){var c,g=f.authentication;return e(b.error)||401!==b.statusCode&&403!==b.statusCode||g&&"basicauth"===g.method?j.reject(b):(g.success?(f.invalidateAuthentication(),c=f.authenticate()):f.getPendingAuthenticationRequest()&&(c=f.getPendingAuthenticationRequest()),c?void c.then(function(){d().done(function(a){return j.resolve(a)}).fail(function(b){if(401!==b.statusCode&&403!==b.statusCode)return j.reject(b);f.logout().authenticate().then(function(){d().done(function(a){return j.resolve(a)}).fail(function(b){return a.platform.isPlatformSessionError(b.message,f)&&a.platform.attemptLogin(),j.reject(b)})})})},function(a){return j.reject(a)}):j.reject(b))}),j.promise()},processModelXMLExtensions:function(a,b){var c=this.getDataSourceType(),d=function(a){var b={};return t.each(a.attr(),function(a,c){b[a]=c}),a.children().each(function(a,c){var e=c.nodeName;(b[e]||(b[e]=[])).push(d(t(c)))}),b},e=a.extensions={};if(t.each(b.attr(),function(a,b){if(!C(a,"x-"))return!0;e[a.slice(2)]=b}),b.children().each(function(a,b){var c=b.nodeName;if(!C(c,"x-"))return!0;c=c.slice(2),(e[c]||(e[c]=[])).push(d(t(b)))}),c&&c.processModelXMLExtensions)return void c.processModelXMLExtensions(a,b)},getPendingAuthenticationRequest:function(){return E[d(this)]},isAuthenticated:function(){var a=this.authentication;return!a||a.success},getStoredAuthData:function(a){return r.getObjectProperty(i(),this.name+(a?"."+a:""))},setStoredAuthData:function(a){var b=i();return r.setObjectProperty(b,this.name,a),s.localStorage.setItem(G,JSON.stringify(b)),b},removeStoredAuthData:function(){var a=i(),b=a[this.name];return delete a[this.name],s.localStorage.setItem(G,JSON.stringify(a)),b},authenticate:function(){function b(a,c){a&&r.size(a)&&t.each(a,function(d,e){y(e)?a[d]=z(e,c):"object"==typeof e&&b(e,c)})}function e(a){var b,c=[];return y(a)?b=a:a&&a.error?y(a.error)?b=a.error:a.error&&a.error.message&&(b=a.error.message):a&&a.body&&(y(a.body.error)&&c.push(a.body.error),y(a.body.message)&&c.push(a.body.message),y(a.body.description)&&c.push(a.body.description),b=c.join(": ")),J.reject(b||"Authentication Failed"),J.promise()}function f(){var a,b=G.getUserInfo;return!b||I&&I.responseBody&&I.responseBody.userInfo?J.resolve(I):G.getUserInfo(D).then(function(b){b&&(a=I.responseBody,a||(a=I.responseBody={}),a.userInfo=b,D.setStoredAuthData(a)),D.getModels().forEach(function(a){a.updateDataSourceUserInfoConditions()}),J.resolve(I)})["catch"](function(a){!a||403!==a.statusCode&&401!==a.statusCode?J.reject(a):(D.invalidateAuthentication(),D.authenticate().then(function(a){J.resolve(a)})["catch"](function(){D.logout(),D.authenticate().then(function(a){J.resolve(a)})["catch"](function(a){J.reject(a)})}))}),J.promise()}function g(a){return a&&a.refresh_token}function h(){var b=I.providerType,h={force:!1},i=a.oauth(F),j=i?i.getAuthResponse():null,k=(I.defaultScopes||"").split(","),l={},m={id:I.clientId,name:F,type:b},n={},q={};if(j&&j.error&&D.logout(),t.each(k,function(a,b){b&&!l[b]&&(l[b]=1)}),r.size(l)&&(h.scope=Object.keys(l).join(",")),K||(I.grantType="implicit"),"implicit"!==I.grantType&&"client_credentials"!==I.grantType&&(h.response_type="code"),i.isSessionValid()||(j&&j.grantType&&j.responseBody&&(j=j.responseBody,D.setStoredAuthData(j.responseBody)),g(j)&&(h.display="none")),o=d(D,h.scope||""),p=E[o])return p.done(f).fail(e);I.url&&(n.auth=I.url),I.tokenUrl&&(n.grant=I.tokenUrl),"code"===h.response_type&&(n.response_type="code"),r.size(n)&&(m.oauth=n),q[F]=u(!0,{},a.oauth.services[b]||{},m);var s=c(I);a.oauth.init(q,{redirect_uri:s}),x=a.oauth.login(F,h).then(function(a){I.responseBody=a.authResponse,I.success=!0,f(),delete E[o]},function(a){I.success=!1,e(a),delete E[o]}),E[o]=x}var i,j,k,l,m,n,o,p,q,s,v,x,A,B,D=this,F=D.name,G=D.getDataSourceType(),I=D.authentication,J=t.Deferred(),K=D.useProxy;if(I)if(j=I.method,v=I.authMethod,n=I.verb||"POST",i=I.url,B=I.username,s=I.password,i&&C(i,"/")&&D.serviceUrl&&(i=r.combineUrls(D.serviceUrl,i)),I.success)f();else if("separateurl"===j){if(l={url:i,headers:I.requestHeaders,method:n,modelDataSource:D.name},k=I.requestBody,o=d(D),p=E[o])return p;m=l.headers,K?(b(m,{$Auth:H}),b(k,{$Auth:H})):(q={$Auth:t.extend({},H,{Username:B,Password:s})},b(m,q),b(k,q)),k&&(l.contentType=I.requestBodyContentType||w,l.body=l.contentType===w?r.param(k):JSON.stringify(k)),x=D.makeRequest(l,{buffer:!1}),E[o]=x,x.always(function(){delete E[o]}).done(function(a){I.responseHeaders=a.headers,I.responseBody=r.parseAsJSONIfString(a.body),I.success=!0,f()}).fail(function(a){I.success=!1,e(a)})}else if("basicauth"!==j||K)if("provider"===j){var L=0===v.indexOf("oauth"),M=I.grantType;if(L&&(A=D.getStoredAuthData())&&A.access_token){if(!(A.expires&&A.expires<(new Date).getTime()/1e3))return I.responseBody=A,I.success=!0,f();D.removeOAuthAccessToken()}if(L&&t.inArray(M,["password","saml2-bearer","client_credentials"])>-1){if(!K)return e("You must connect through the Proxy to use this OAuth grant type."),J.promise();if(l={url:I.tokenUrl,headers:I.requestHeaders,method:n,modelDataSource:F},k=I.requestBody,o=d(D),p=E[o])return p;k&&(l.contentType=I.requestBodyContentType||w,l.body=l.contentType===w?r.param(k):JSON.stringify(k)),x=a.ajax.proxy(l,{buffer:!1}),E[o]=x,x.always(function(){delete E[o]}).done(function(a){I.success=!0,I.responseHeaders=a.headers;var b=r.parseAsJSONIfString(a.body);!b.expires&&b.expires_in&&(b.expires=Math.floor((new Date).getTime()/1e3+(0|b.expires_in||31536e3))),I.responseBody=b,D.setStoredAuthData(b),f()}).fail(function(a){I.success=!1,e(a)})}else if(L)a.oauth?h():r.loadJS(r.getStaticResourceUrl("models/oAuthClient.js","skuid",undefined,r.getCacheTimestamp())).done(function(){a.oauth=window.hello}).done(h);else if("apex"===v){if(l={headers:I.requestHeaders,body:I.providerName,method:"GET",modelDataSource:D.name},o=d(D),p=E[o])return p;x=a.ajax.proxy(l,{buffer:!1}).done(function(a){I.responseHeaders=a.headers,I.responseBody=r.parseAsJSONIfString(a.body),I.success=!0,f()}).fail(function(a){I.success=!1,e(a)}).always(function(){delete E[o]}),E[o]=x.promise()}else I.success=!0,f()}else r.isString(I)||(I.success=!0),f();else{if(B&&s)return D.requestHeaders.Authorization="Basic "+btoa(B+":"+s),I.success=!0,f();if(!B)return I.success=!1,D.removeStoredAuthData(),e({error:"No Username provided."});if(!s)return I.success=!1,D.removeStoredAuthData(),e({error:"No Password provided."})}else f();return J.promise()},getUserInfo:function(){var a,b=this.authentication,c=b&&b.responseBody;if(b&&(c||(c=b.responseBody=this.getStoredAuthData()),c&&(a=c.userInfo)))return a},getUserInfoProperty:function(a){var b=J[a]||a,c=this.getUserInfo();if(c&&b in c)return c[b]},removeOAuthAccessToken:function(){var a=["access_token","expires","expires_in"],b=this.getStoredAuthData();return function(b){b&&a.forEach(function(a){delete b[a]})}(this.authentication.responseBody),b&&this.setStoredAuthData(this.authentication.responseBody),this},invalidateAuthentication:function(){function a(a){a&&t.isPlainObject(a)&&Object.keys(a).forEach(function(b){"refresh_token"!==b&&delete a[b]})}var b,c=this.authentication,d=this.getStoredAuthData();return c&&(b=c.authMethod&&C(c.authMethod,"oauth"),c.success=!1,delete c.responseHeaders,b?(a(c.responseBody),d&&a(d)):delete c.responseBody,d&&this.setStoredAuthData(c.responseBody)),this},logout:function(){var b=this.authentication,c=this.name;if(b&&(b.success=!1,delete b.responseHeaders,delete b.responseBody,b.authMethod&&C(b.authMethod,"oauth")&&"saml2-bearer"!==b.grantType)){var d=a.oauth&&a.oauth(c);d&&d.logout&&d.logout({name:c,options:{force:!0}})}return this.removeStoredAuthData(),this}},u(p,{DataSource:l,EntityMetadata:n,get:e,getDataSource:e,getDataSourceFromXML:g,map:h,mapDataSources:h})}(skuid),function(a){function b(a){return q.delay(q.runningTests()?1:a)}function c(a){var b={};return o.each(a,function(a,c){b[c.id]=c.data}),b}function d(){var a=o.Deferred();return y.text("Begin syncing changes made offline?"),y.append('<a href="#" class="sk-offline-send">'+s("start")+'</a><a href="#" class="sk-offline-cancel">'+s("cancel")+"</a>"),y.find("a").on("click",function(b){var c=b.target,d=c.classList;y.remove("a"),d.contains("sk-offline-send")?(y.text(s("saving_offline_changes")),a.resolve()):d.contains("sk-offline-cancel")&&(y.text("Cancelled..."),a.reject(x))}),y.animate({bottom:"30px"},{duration:500}),f(),a.promise()}function e(){var a=o.Deferred();return y.animate({bottom:"30px"},{duration:500,complete:function(){a.resolve()}}),f(),a.promise()}function f(){G(P,{syncElement:y})}function g(b,c){var d={};return o.each(b,function(b,e){var f=a.dataSource.get(b),g=f.name,h=e.operations,i={};o.each(h,function(a,b){if(q.size(b.originals)){var e=c.find(function(a){return g===a.getDataSourceName()&&b.type===a.objectName}),f=e&&e.objectName,h=i[f];if(!e)return;o.each(b.originals,function(a,c){var d=e.getRowById(a);o.each(c,function(e,f){d[e]!==f&&d[e]!==b.updates[a][e]&&(h||(h={}),h[a]={},h[a].update=b.updates[a],h[a].original=c)})}),q.size(h)&&(d[g]||(d[g]={}),d[g][f]=h)}})}),d}function h(a){var b,c=o.Deferred();return y.addClass("sk-offline-conflicts").text("Conflicts detected. Your changes may not be the most recent."),y.append('<a href="#" class="sk-offline-send">'+s("save_anyway")+'</a><a href="#" class="sk-offline-cancel">'+s("cancel")+"</a>"),y.find("a").on("click",function(a){var d=a.target;d.classList.contains("sk-offline-send")?(b="send",y.text(s("saving_offline_changes"))):d.classList.contains("sk-offline-cancel")&&(b="cancel",y.text("Canceling...")),y.remove("a"),y.removeClass("sk-offline-conflicts"),c.resolve(b)}),G(R,{syncElement:y,conflicts:a}),c.promise()}function i(b,c){var d=a.model.list();o.each(b,function(a,b){o.each(b,function(b,e){var f=c.find(function(c){return c.objectName===b&&a===c.getDataSourceName()}),g=d.filter(function(c){return c.objectName===b&&a===c.getDataSourceName()});o.each(g,function(a,b){var c=!1;o.each(e,function(a){var d=f.getRowById(a);if(d){var e=f.getRecordForRow(d).get(),g=b.getRowById(f.getRowId(d));c=!0,b.updateRow(g,e,{notify:!0,notifyFields:!1,preventTrackChanges:!0})}}),c&&b.notifyEditorsOfDataRefresh()})})}),G(S,{syncElement:y,conflicts:b})}function j(b,c){var d=o.map(b,function(b,c){return a.dataSource.get(c).save(b)});return o.when.all(d).then(function(a){var b=a;q.size(c)&&G(T,{syncElement:y,results:b,conflicts:c}),G(U,{syncElement:y,results:b})})}function k(a){y.text(s("send"===a?"saved":"cancelled")),b(2e3).then(function(){y.animate({opacity:"0"},{duration:500,complete:function(){y.detach()}})})}function l(c){return c===w?void y.detach():c===x?(G(Q,{syncElement:y,message:c}),b(2e3).then(function(){y.animate({opacity:"0"},{duration:500,complete:function(){y.detach()}})})):void(c!==w&&(a.model.Model.prototype.addPageProblems([c]),y.text("Failed..."),G(V,{syncElement:y,error:c}),b(2e3).then(function(){y.animate({opacity:"0"},{duration:500,complete:function(){y.detach()}})})))}var m,n,o=a.$,p=o(document.body),q=a.utils,r=window.applicationCache,s=a.label.read,t=a.constants,u=a.storage,v=a.offline={},w="There are no saves to sync.",x="Syncing cancelled",y=o('<div class="sk-offline-sync">'+s("saving_offline_changes")+"</div>"),z=q.runningTests()?"Skuid_Test":"Skuid",A=function(){return a.storage.getDb(z)instanceof a.storage.IndexedDBDatabase},B=a.settings,C=a.events,D=C.Event,E={scope:t.EVENT_SCOPES.GLOBAL,onlyGlobal:!0},F=C.subscribe,G=C.publish,H=v.networkDown=function(){return"disconnected"===v.state},I=v.isEnabled=function(){return!L&&B.offline&&!0===B.offline("enabled")},J=v.getSetting=function(a){return B.offline&&B.offline(a)},K=function(){return!J("syncAutomatically")&&J("syncDefaultStatusBarEnabled")},L=!1,M=a.dataSource.EntityMetadata,N="network.connected",O="network.disconnected",P="network.sync.started",Q="network.sync.cancelled",R="network.conflicts",S="network.cancel.conflicts",T="network.send.conflicts",U="network.sync.success",V="network.sync.failure",W=v.reconnect={reset:function(){W.state&&"inactive"!==W.state&&clearInterval(m),W.state="inactive",W.remaining=10},timer:function(){if("connecting"!==W.state)return W.remaining-=1,0===W.remaining?W.checkNow():void 0},checkNow:function(){if("waiting"===W.state)return W.state="connecting",v.check()}};v.setState=function(a){v.state=a},v.setState("connected");var X=!1;v.init=function(){if(!v.initiated&&!q.inPlatform([t.LIGHTNING])){v.initiated=!0;var c,d=a.ui.createIcon("sk-icon-refresh",{ariaLabel:"Retry Connection"}),e=s("currently_offline")+'<span tabindex=0 class="sk-offline-retry">'+d+"</span>",f=s("reconnecting"),g=function(a){return a.preventDefault(),c.html(f),W.checkNow()},h=function(a){if(13===a.which)return n.find(".sk-offline-retry").click(),!1},i=function(a){a=a||{},c=n.find(".sk-offline-content"),c.html(e),w&&p.prepend(n),n.removeClass("sk-offline-connected").addClass("sk-offline-disconnected"),n.find(".sk-offline-retry").on("click",g),n.find(".sk-offline-retry").on("keypress",h),a.noFadeIn?(n.css("top",0),p.find(".sk-headerwrapper-fixed").css("top","20px"),p.css("padding-top","20px")):(n.animate({top:"0"},500),p.find(".sk-headerwrapper-fixed").animate({top:"20px"},500),p.animate({"padding-top":"20px"},500))},j=function(a){var b=0;return a.length?(o.each(a,function(a,c){var d=c.data.operations;o.each(d,function(a,c){o.each(c.updates,function(){b++}),o.each(c.inserts,function(){b++}),o.each(c.deletes,function(){b++})})}),b):b},k=function(){return K()?u.tables.saves.all().then(function(a){return j(a)}):o.when(!1)},l=function(){if(K())return u.tables.saves.all().then(function(a){if(a&&a.length){var b=j(a);m(b)}})},m=function(a){v.setState("disconnected"),n.css("display","inline-block"),c=n.find(".sk-offline-content"),c.html("You have "+a+' unsaved change(s) across your pages. <span class="sk-offline-retry">Begin Syncing Process</span>'),p.css("padding-top","20px"),p.find(".sk-headerwrapper-fixed").css("top","20px"),n.css("top",0),w&&p.prepend(n),c.find(".sk-offline-retry").on("click",function(a){a.preventDefault(),p.css("padding-top","0"),p.find(".sk-headerwrapper-fixed").css("top",0),n.detach(),w=!0,y.text(s("saving_offline_changes")),r=!1,v.check().then(function(){return r=!0,v.sync({action:!0})})}),q.runningTests()&&G("showSyncsWaitingToBeSavedBar")},r=!0,w=!0;n=p.find(".sk-offline"),n.length||(n=o('<div role="alert" class="sk-offline"><div class="sk-offline-content">'+e+"</div></div>")),n.addClass("sk-offline-"+a.offline.state),F(N,function(){if(r)return c=n.find(".sk-offline-content"),c.html(f),b(500).then(function(){return n.removeClass("sk-offline-disconnected").addClass("sk-offline-connected"),c.html(s("connected")),G("network.connected.marked"),b(1e3)}).then(function(){k().then(function(a){if(a)return G("network.disconnected.stay",{savesToShow:a});p.animate({"padding-top":"0"},400),p.find(".sk-headerwrapper-fixed").animate({top:0},400),n.animate({top:"-20px"},{duration:400,complete:function(){n.detach(),w=!0}})})})}),"disconnected"===v.state?i({noFadeIn:!0}):l(),F(O,i),F("network.disconnected.confirmed",function(){c=n.find(".sk-offline-content"),c.html()===f&&b(500).then(function(){c.html(e),n.find(".sk-offline-retry").on("click",g),n.find(".sk-offline-retry").on("keypress",h)})}),F("network.disconnected.stay",function(a){return X=!0,a.savesToShow?m(a.savesToShow):l()})}},v.check=function(){if(!v.shouldCheck)return q.resolve();var b=function(){"connected"!==v.state&&(v.setState("connected"),G(N),q.inPlatform([a.constants.LIGHTNING])&&G("network.connected.marked"))},c=function(){G("network.disconnected.confirmed"),X=!1,v.setState("disconnected"),G(O)};return a.platform.services.checkNetwork().then(b)["catch"](c)},v.startEverything=function(){return v.init(),v.isEnabled()?a.offline.check():o.when()},r&&(r.addEventListener("updateready",function(){if(r.status==r.UPDATEREADY)try{r.swapCache(),confirm("A new version of this site is available. Load it?")&&window.location.reload()}catch(a){}}),r.addEventListener("obsolete",function(){window.location.reload()})),F(O,function(){W.reset(),W.state="waiting",m=setInterval(W.timer,1e3)}),F("network.disconnected.confirmed",function(){"connecting"===W.state&&(W.state="waiting",W.remaining=10)}),F(N,function(){v.state="connected",m&&clearInterval(m),W.reset()}),v.shouldCheck=!0,v.disable=function(a){L=a},v.load=function(a,b){if(b=b||{},!A())return q.resolve();var c=[];return o.when.all(o.map(a,function(a){return u.tables.entityData.get({objectName:a.objectName,dataSource:b.dataSource,conditions:a.conditions,data:{fields:a.fields,orderByClause:a.orderByClause,conditionLogic:a.conditionLogic}})})).then(function(a){return o.when(v.populateDataSourceMetadata(),v.populateMetadata()).then(function(){return a})}).then(function(b){var d=[],e=[];return o.each(b,function(b,f){var g;f&&q.size(f.data)?(g=o.extend({},f.data,{cachedData:!0,dataSourceName:f.dataSource}),d.push(g)):(g=a.filter(function(a){return u.tables.entityData.schema.buildIdField({objectName:a.objectName,dataSource:a.dataSource,conditions:a.conditions,data:{fields:a.fields,orderByClause:a.orderByClause,conditionLogic:a.conditionLogic}})===f.id})[0])&&e.push(g),g&&c.push(g)}),v.populateSaves(d)}).then(function(){return c})},v.save=function(b,c){var d=o.Deferred(),e=c.dataSource,f=e.name,g=b.operations,h={deleteResults:[],updateResults:[],insertResults:[],globalErrors:[]},i=function(a,b){h[a].push(o.extend({errors:[],messages:[],success:!0},b))};return o.each(g,function(b,c){c.originals||(c.originals={}),o.each(c.updates,function(b){c.originals[b]=a.$M(c.id).originals[b]})}),u.tables.saves.get(f).then(function(a){return a?(o.each(b.operations,function(b,c){var d=a.data.operations,e=d.find(function(a){return a.id===c.id});e?(o.each(c.deletes,function(a,b){var c=e.inserts[a];delete e.updates[a],delete e.originals[a],c?delete e.inserts[a]:e.deletes[a]=b}),o.each(c.updates,function(a,b){var d=e.updates[a],f=e.inserts[a];f?(o.extend(f,b),delete c.originals[a]):d?o.extend(d,b):e.updates[a]=b}),o.each(c.inserts,function(a,b){e.inserts[a]=b}),o.each(c.originals,function(a,b){var c=e.originals[a];c?o.extend(c,b):e.originals[a]=b})):d.push(c)}),u.tables.saves.add(f,{data:a.data}).then(function(){G("offline.saved"),d.resolve()})):u.tables.saves.add(f,{data:b}).then(function(){G("offline.saved"),d.resolve()}),o.each(b.operations,function(a,b){var c=b.id;o.each(b.deletes,function(a){i("deleteResults",{id:a,record:null,source:c})}),o.each(b.updates,function(a,b){i("updateResults",{id:a,record:JSON.stringify(b),source:c})}),o.each(b.inserts,function(a,b){i("insertResults",{id:a,oldId:a,record:JSON.stringify(b),source:c})})}),X&&G("network.disconnected.stay"),h})},v.populateMetadata=function(){if(!A()||v.populatedMetadata)return q.resolve();var b={};return u.tables.entityMetadata.all().then(function(c){if(c){var d=a.dataSource.map();c=c.sort(function(a,b){return a=new Date(a.createdAt),b=new Date(b.createdAt),a>b?-1:a<b?1:0}),o.each(c,function(a,c){var d=c.data,e=d.fields,f=c.id.split("--"),g=f[0],h=f[1],i=b[g];i?i&&!i[h]?b[g][h]=d:o.each(e,function(a,c){i[h].fields.filter(function(a){return c.id===a.id}).length||b[g][h].fields.push(c)}):(b[g]={},b[g][h]=d)}),o.each(d,function(a,c){var d=c.entityMetadataCache,e=b[a];q.size(d)?q.size(d)&&q.size(e)&&o.each(d,function(a,b){var c=b._unwrap();if(e[a]){var f=e[a].fields;o.each(f,function(a,b){(c.fields&&c.fields.filter(function(a){return b.id===a.id})).length||c.fields.push(b)}),d[a]=new M(c)}}):o.each(e,function(a,b){c.entityMetadataCache[a]=new M(b)})}),v.populatedMetadata=!0}})},v.populateDataSourceMetadata=function(){return!A()||v.populatedDataSourceMetadata?q.resolve():u.tables.dataSourceMetadata.all().then(function(b){var c=a.dataSource.map();o.each(c,function(a,c){var d=b.filter(function(b){return b.id===a})[0];d&&(c.metadata=d.data)}),v.populatedDataSourceMetadata=!0})},v.populateSaves=function(b){var c=[];return o.each(b,function(b,d){var e=o.Deferred();c.push(e.promise()),u.tables.saves.get(d.dataSourceName).then(function(b){if(!b)return e.resolve(d);var c=b.data.operations.filter(function(a){return a.type===d.objectName})[0];if(c){var f=a.$M(c.id);if(!f)return e.resolve(d);o.each(c.deletes,function(a){var b=d.data.findIndex(function(b){return f.getRowId(b)===a});b>-1&&d.data.splice(b,1)}),o.each(c.updates,function(a,b){var c=d.data&&d.data.find(function(b){return f.getRowId(b)===a});c&&o.extend(c,b)}),o.each(c.inserts,function(a,b){var c=d.data;b[f.getIdField&&f.getIdField()]=a,c.unshift(b)})}e.resolve(d)})}),o.when.all(c)},v.sync=function(b){b=b||{};var f,m,n=!1!==J("syncAutomatically"),r=!0===J("syncInteractionRequired"),s={},t={},v=b.action;return L||!v&&!n?o.when():u.tables.saves.all().then(function(a){return a&&a.length?(t=c(a),p.append(y),r?d():e()):o.Deferred().reject(w).promise()}).then(function(){return a.loader.service.loadDataSourcesAndDependencies(o.map(t,function(a,b){return b}))}).then(function(){var b=[];return o.each(t,function(c,d){var e=a.dataSource.get(c),f=e.dataSourceType;o.each(d.operations,function(c,d){if(d.updates&&Object.keys(d.updates).length){var g=f.prop("offline.createConditionsForConflicts"),h=new a.model.Model({dataSource:e,id:q.generateUniqueId({prefix:"sk-offline"}),conditions:q.isFunction(g)?g(d):[],label:d.type,objectName:d.type,fields:o.map(d.returning,function(a){return{id:a}}),extensions:d.extensions});f.coerceConflictModel&&f.coerceConflictModel(h,d),h.initialize(),b.push(h)}})}),(b.length?a.model.load(b):o.when()).then(function(){return b})["catch"](function(){return b})}).then(function(a){return f=a,s=g(t,f),q.size(s)?h(s):o.when("send")}).then(function(a){return m=a,"cancel"===m?i(s,f):"send"===m?j(t,s):o.when()}).then(function(){u.tables.saves.clear(),k(m)})["catch"](l)},v.addActions=function(){return B.offline&&B.offline("enabled")?[{
value:"offline-syncing",label:function(){return"Sync Changes Made Offline"}}]:[]},v.runAction=function(a,b,c,d){if("offline-syncing"===a)return I()&&!H()?v.sync({action:!0,context:d}):q.resolve()},C.register([new D(N,"Network: Connected",[],E),new D(O,"Network: Disconnected",[],E),new D(P,"Offline Syncing: Started",[],E),new D(R,"Offline Syncing: Conflicts Detected",[],E),new D(S,"Offline Syncing: Cancelled with Conflicts",[],E),new D(T,"Offline Syncing: Approved with Conflicts",[],E),new D(U,"Offline Syncing: Successful",[],E),new D(V,"Offline Syncing: Failed",[],E)]),F(N,function(){var b=v.sync;return a.platform.forceSessionActivity?a.platform.forceSessionActivity().then(b,function(){a.platform.attemptLogin(0,!1,b)}):b()}),o(window).off("offline.skuid").on("offline.skuid",function(){v.check()})}(skuid),function(a){var b,c=a.$,d=a.utils,e=d.getInvokable,f=e(c,"Deferred"),g=e(c,"each"),h=e(c,"map"),i=d.mergeAsTextInContext,j=d.getObjectProperty,k=d.setObjectProperty,l=d.parseAsJSONIfString,m=function(a){var b={},c=n(a);return g(c,function(a,c){c.synonym&&(b[c.synonym]=c)}),b},n=function(a){return a.fieldsMap?a.fieldsMap:(a.fieldsMap=d.keyBy(a.fields,"id"),a.fieldsMap)},o=function(a){return Array.prototype.slice.call(a||[])};b=a.dataSource.utils={convertRequestObjToKey:function(a){return a.requestUri.split(".").join("\\.")},convertToNumber:function(a){var b=1*a;return isNaN(b)?0:b},mergeThenURLEncode:function(a,b,c){return encodeURIComponent(i(a,b,c))},getModelMergeConditions:function(a,b,c){b=b||{model:a},c=c||{};var d=a.conditions,e={},f={},h=!1!==c.urlEncode;return d&&d.length?(g(d,function(a,b){e[b.sourceParam||b.name]=b}),g(e,function(a,c){if(c.value!==undefined&&!c.inactive){var d=i(c.value||c.values&&c.values.join(",")||"",b);h&&(d=encodeURIComponent(d)),f[a]=d}}),f):f},applySynonym:function(a,b){var c=n(b),e=m(b);g(e,function(b,c){a[c.id]=j(a,b)}),g(a,function(b,e){var f,h,i,k,l="";c[b]&&(i=c[b].makeFlatList)&&e&&e.length&&(f=i.delimiter,h=i.fieldPath,k=d.isUndefined(i.space)?" ":i.space,f||(f=";"),h?g(e,function(a,b){if(b){var c=j(b,h);l&&(l+=f+k),l+=c+""}}):l=e.join(f+k),a[b]=l)})},revertSynonym:function(a,b){var c=n(b),e=m(b);g(a,function(b,e){var f,h,i,j,l,m=[];if(c[b]&&(i=c[b].makeFlatList)&&e&&d.isString(e)){if(!(e=e.replace(/\s/g,"")))return;f=i.delimiter,h=i.fieldPath,f||(f=";"),j=e.split(f),h?g(j,function(a,b){b&&(l={},k(l,h,b),m.push(l))}):g(j,function(a,b){b&&m.push(b)}),a[b]=m}}),g(e,function(b,c){a[c.id]&&(k(a,b,a[c.id]),delete a[c.id])})},getActionsStatic:function(a,c,d){return b.deferrable(this.createActions(a,c,d))},getEntityListStatic:function(a){return b.deferrable(h(this.prop("x-metadata"),function(b,c){if(!1!==b.queryable&&(!b.hidden||a.ignoreHidden)&&"__skuid_fieldDefaults"!==c)return{value:c,label:b.label}}))},makeLabelFromId:function(a){function b(a){if(a)return a[0].toUpperCase()+a.substring(1)}var c=a.replace(/\./g," ").replace(/_/g," ").split(/(?=[A-Z]|\s)/),d=[],e=0,f=!1;return g(c,function(a,c){(c=b(c.trim()))&&(f?1===c.length?d[e]+=c:(f=!1,e++,d[e]=c):(e++,1===c.length&&(f=!0),d[e]=c))}),d=h(d,function(a){if(a)return a}),d.join(" ")},queryEntityMetadataStatic:function(a){var d=this.getEntityMetadataCacheKey(a),e=this.prop("x-metadata"),h=e&&e[d],i=e&&e.__skuid_fieldDefaults,j=f();return h?(g(h.fields,function(a,e){i&&(e=h.fields[a]=c.extend({},i["*"],i[d],e)),e.createable=e.createable||e.writeable,e.editable=e.editable||e.writeable,e.label||(e.label=b.makeLabelFromId(e.id))}),j.resolve(h)):j.reject()},parseSuccessfulLoadResponseWithSynonyms:function(a,d,e){var f=l(a.body),g=d.pathToContent,h=g?j(f,g):f;return c.isArray(h)||(h=[h]),b.safeEach(h,function(a,c){b.applySynonym(c,e)}),h},parseSuccessfulSaveResponseWithSynonyms:function(a,c){var d,e,f=c.method,g=c.model,h=l(a.body);if(f&&g&&h)return d=f.pathToContent,e=d?j(h,d):h,b.applySynonym(e,g),e},safeEach:function(a,b){a instanceof Object&&g(a,b)},trimEmptyParameters:function(a){var b={};return g(a,function(a,e){d.isObject(e)&&c.isEmptyObject(e)||c.isArray(e)&&0===e.length||""!==e&&e!==undefined&&null!==e&&(b[a]=e)}),b},applyAccessTokenAsParam:function(a,b,c){-1===a.request.url.indexOf(c+"=")&&(-1===a.request.url.indexOf("?")?a.request.url+="?"+c+"="+b.access_token:a.request.url+="&"+c+"="+b.access_token)},downloadWithLink:function(a,b){var d=document.createElement("a");document.body.appendChild(d),d.style="display: none",d.href=b,d.target="__blank",d.download=a,d.click(),c(d).remove()},makeAWSRequest:function(b,c,d){var e={url:"/core/data/aws",type:"POST",headers:{"x-skuid-data-source-name":b}},f={method:c};return d&&(f.body=d),e.body=f,e.contentType="application/json",a.ajax.direct(e).then(function(a){return a.body},function(a){var b=l(a.body);return b?b.message:a.status})},compose:function(){var a=o(arguments).reverse();return function(b){return g(a,function(a,c){b=c(b)}),b}},deferrable:function(a){return a&&d.isPromise(a)?a:f().resolve(a).promise()},rejectable:function(a){return f().reject(a).promise()},extrapolateRowFromContext:function(a){return a.row?a.row:a.rows&&a.rows.length?a.rows[0]:a.model&&a.model.getFirstRow()?a.model.getFirstRow():void 0}}}(skuid),function(a){function b(){return a.utils}function c(a,b,d){qa.each(a,function(a,e){if(null!==e&&"object"==typeof e){if(e instanceof ba)return!0;c(e,b,d?d+"."+a:a)}else b.push(d?d+"."+a:a)})}function d(a){return b().isUndefined(a)}function e(a){return b().isString(a)}function f(a){return b().size(a)}function g(b,c,d){var f=e(b)?b:b.id,g=!e(c),h=g?c.name:c;return d||(d=a.page.id),"apex__"+(g&&c.customCookie?c.customCookie:"nx-page-"+d+"-model-condition-"+f+"-"+h)}function h(a){return b().isMultiValueOperator(a)}function i(a){var c=fb[a];return c||(c=fb[a]=b().getXML(b().makeXMLDoc("<"+a+"/>")[0]).length),c}function j(b){var c=b.dataSource;return c?c instanceof a.dataSource.DataSource||(c=b.dataSource=a.dataSource.getDataSource(c.name)):b.dataSource=c=a.dataSource.getDataSource(b.dataSourceName||ua()),c}function k(b,c){var d=c&&c.getParentPage()||a.component.getByType("skuidpage")[0];if(!d)return void qa(document).one("pageload",function(){k(b,c)});d.addProblems(b)}function l(a,b){return b?b+"("+a+")":a}function m(a,b){var c=Array.prototype.push;if(b.length<32766)return void c.apply(a,b);for(var d,e,f=Math.ceil(b.length/32766),g=0;g<f;g++)d=32766*g,e=d+32766,e>b.length&&(e=b.length),c.apply(a,b.slice(d,e))}function n(a,b,c,d,e){typeof c.attr(d)!==Qa?a[b]=c.attr(d):typeof e!==Qa&&(a[b]=e)}function o(a,c,d,e){return e=!1!==e,a&&(a=qa.trim(a).toUpperCase()),e?(c&&c.length&&!a&&(a="",qa.each(c,function(b){a+=b+1+" AND "}),b().endsWith(a," AND ")&&(a=a.substring(0,a.length-5))),a&&!b().startsWith(a,"(")&&d&&(a="("+a+")"),a):a||""}function p(a){var c=null,d="";if(a&&(c=qa(a),d=c.attr("field")),d)return b().makeXMLDoc('<field id="{id}" query="false"/>'.replace("{id}",d))}function q(c){var e,f,g,l,m,n,q,r,s,t,u,v,w=c.model,x=c.xml,y=x.children("conditions"),z=x.children("havings"),A=x.children("actions"),B=x.children("groupby"),C=x.children("fields"),D=x.children("idfields").first().children(),E={};if(x.attr("_parentpageid")&&(w._parentPageId=x.attr("_parentpageid")),w.dataSourceName=x.attr("datasource")||x.attr("service")||ua(),!(e=j(w)))return void k("Missing Data Source: "+w.dataSourceName,w);if(v=e&&e.processModelXMLExtensions,!(f=e.getDataSourceType()))return void k("Missing Data Source Type",w);g=f?f.name:wa,l=f.prop("runtime.metadataSource"),m="local"===l,n=m||"hybrid"===l,d(w.processOnClient)&&(w.processOnClient=!(w.dataSourceName===wa&&!a.platform.requiresClientSideModelLoading())||"true"===x.attr("processonclient")),qa.extend(w,{id:x.attr("id")||b().generateUniqueId(),objectName:x.attr("sobject"),type:x.attr("type"),createRowIfNoneFound:"true"===(x.attr("createrowifnonefound")||"false"),preventUnloadIfUnsavedChanges:"false"!==x.attr("unloadwarningifunsavedchanges"),recordsLimit:x.attr("limit")||null,orderByClause:x.attr("orderby"),rTypeFor:x.attr("rtypfor"),doQuery:"false"!==x.attr("query"),deferFieldRendering:"true"===x.attr("deferfieldrendering"),deferredFields:x.attr("fieldstodefer")?x.attr("fieldstodefer").split(","):"",loadAsync:"true"===x.attr("async"),readonly:x.attr("readonly"),pathToContent:x.attr("pathtocontent")}),qa.extend(w,{fields:qa.map(C.children(),function(a){return new _({model:w,xml:qa(a)})}),havings:qa.map(z.children(),function(a){return new $(qa(a),w)}),methods:qa.map(x.children("methods").children(),function(a){return new aa(qa(a))})}),qa.each(w.fields,function(a,b){E[b.id]=b}),n||"aggregate"===w.type||qa.each(y.children(),function(a,b){(t=p(b))&&(E[t.attr("id")]||w.fields.push(new _({model:w,xml:t})))}),u=F(w,y,E),w.conditions=u.conditions,w.uiOnlyConditions=u.uiOnlyConditions;var G=w.getPersonalizationService();qa.each(w.conditions.concat(w.uiOnlyConditions),function(a,c){var d,e,f=G.getCondition(c.name);f!==undefined&&("-off-"===f?c.inactive=!0:"-on-"===f?c.inactive=!1:(qa.isArray(f)?e=f:d=f,h(c.operator)&&(c.values=e||d&&b().isString(d)&&(-1!==d.indexOf(";")?d.split(";"):[d])||[]),c.value=d,c.inactive=!1))});var H=G.getOrderBy();switch(H&&(w.orderByClause=H),x.attr("doclone")){case"yes":w.doClone=!0;break;case"no":w.doClone=!1}B.length&&(w.groupByFields=qa.map(B.children(),function(a){return new _({model:w,xml:qa(a)})}),w.groupByMethod=B.attr("method")||"simple"),w.groupByFields&&w.groupByFields.length&&(w.fields=w.fields.concat(w.groupByFields)),g===wa&&(w.queryAllRows="true"===x.attr("queryallrows"),w.forView="true"===x.attr("forview")),A.length&&(w.actions=qa.map(A.children("action"),function(a){return new da(qa(a))})),w.needsMetadataLoad=!m,!w.pathToContent&&w.methods&&w.methods.length&&(q=w.methods.filter(function(a){return"query"===a.type&&a.pathToContent}),q.length&&(w.pathToContent=q[0].pathToContent)),r=x.attr("label"),s=x.attr("labelplural"),w.label||(w.label=r?b().mergeAsText("global",r):w.id),w.labelPlural||(w.labelPlural=s?b().mergeAsText("global",s):w.id),x.attr("namefield")&&(w.nameField=x.attr("namefield")),D.length&&(w.idFields=qa.map(D,function(a){if(a.textContent)return a.textContent;var c=b().getXML(a);return c.length>i("field")?c=b().decodeXML(c.substring(7,c.length-8)):null})),w.serviceUrl=x.attr("serviceurl")||x.attr("endpoint"),w.verb=x.attr("verb"),y.length&&(w.conditionLogic=o(y.attr("logic"),w.conditions,!1,f.prop("initializeConditionLogic"))),z.length&&(w.havingLogic=o(z.attr("logic"),w.havings)),v&&v.call(e,w,x,c)}function r(a,c,d,e){var f=d.attr(e),g=!1;return f&&(g=b().escapeSingleQuotes(f),a[c]=g),g}function s(a){return a&&a.type&&-1!==qa.inArray(a.type,[Xa,Ya])}function t(a,c){var e,f=c===Ma,g=c===Na,h=c===Oa,i=typeof a,j=d(a),k=null===a;if(f||g){if(i===Sa){if(f&&!ta.parseSFDate(a)||g&&!ta.parseSFDateTime(a)){var l=ta.resolveDateKeyword(a);return qa.isArray(l)?g?ta.getSFDateTime(l[0]):ta.getSFDate(ta.getLocalDateTime(l[0])):null}}else if(j||k||""===a)return null}else{if(h&&i!==Ta&&!k&&!j)return i===Sa&&"true"===a.toLowerCase()||i===Ra&&0!==a;if(-1!==qa.inArray(c,[Fa,Ga,Ha])&&i!==Ra&&a)try{e=parseFloat(a),b().isExactlyNaN(e)||(a=e)}catch(m){}else if(c===Ia&&i!==Ra&&!j&&!k&&a)try{e=parseInt(a,10),b().isExactlyNaN(e)||(a=e)}catch(m){}}return j?null:a}function u(a,b){a&&b&&a._GUID&&!(a._GUID in b)&&(b[a._GUID]=a)}function v(a,b){a&&b&&a._GUID&&a._GUID in b&&delete b[a._GUID]}function w(a,c,d){return a.getRows().filter(function(b){return!a.getRecordForRow(b)||!a.getRecordForRow(b).isMarkedForDeletion()}).map(function(e){var f={model:a,row:e};return{value:c?b().mergeAsDataInContext(c,f):a.getRowId(e),label:d?b().mergeAsDataInContext(d,f):a.getRowName(e)}})}function x(c,d){function e(){!1!==d.evaluateFormulaFields&&c.evaluateFormulaFields({preventTrackChanges:!0}),c.isInitialized=!0,c.publish("initialized")}d||(d={cloneRowsIfNeeded:!0,createDefaultRowIfNeeded:!0});var f,g,h="aggregate"===c.type,i=[],j={},k=b().createMapForArray;if(c.isAggregate=h,f=c.getDataSourceType(),f&&(c.dataSourceTypeName=f.name||wa,f.initialize&&f.initialize(c)),c.fields&&c.fields.forEach(function(b){var c,d,e,f=b.picklistSource,g=a.snippet.get(b.picklistSourceSnippet),h=function(){b.picklistEntries=w(c,d,e)};if(!0===s(b)&&b.subFields&&i.push(b),b.uiOnly&&b.calculated&&(b.createable=b.editable=!1),"rowsinmodel"===f&&a.$M(b.picklistSourceModel))c=a.$M(b.picklistSourceModel),d=b.picklistEntryValue,e=b.picklistEntryLabel,c.getRows().length&&h(),["cancelled","loaded","saved","row.created","row.updated"].forEach(function(a){c.subscribe(a,h)});else if("snippet"===f&&g){var k=g();k.length&&(b.picklistEntries=k)}if(b.displaytype===za&&b.rel){var l=b.id.split(".");l.pop(),l.push(b.rel);var m=l.join(".");j[m]={id:m,displaytype:"OBJECT",uiOnly:!0,accessible:!0,editable:!0,createable:!0}}}),i.length&&k(i,"subFields","subFieldsMap","id"),j&&qa.each(j,function(a,b){var d=!1;qa.each(c.fields,function(b,c){if(c.id===a)return d=!0,!1}),d||c.fields.push(b)}),k([c],"fields","fieldsMap",["id","name"]),h||(!1!==d.cloneRowsIfNeeded&&c._cloneRowsIfNeeded(d.pageComponent),D(c)),c._generateDataIndices(),c.processOnClient?H(c):(g=F(c),c.conditions=g.conditions,c.uiOnlyConditions=g.uiOnlyConditions,H(c),c.uiOnlyConditions.length&&(c.conditionLogic=o(null,c.conditions)),c.data=G(c)),N(c),c.hasMetadataLoaded()&&!1!==d.createDefaultRowIfNeeded){c._checkIfDefaultRowCreationNeedsToBeAsync()?c._createDefaultRowIfNeededAsync().then(function(){e()}):(c._createDefaultRowIfNeeded(),e())}else e();return c}function y(a){return!(e(a)&&(15===a.length||18===a.length))}function z(){return b().generateUniqueId()}function A(a,b){var c,d=b._findRow(a);return d&&(c=b.getRecordForRow(d)),!!c&&c.isClone()}function B(a,b){var c;return c=b instanceof ca?b:new ca(b),c.register(a),c}function C(a){var b;if(b=e(a)?K(a):a)return b.unregister(),b}function D(a){a.dataSourceTypeName===wa&&qa.each(a.data,function(b,c){var d=a.getRowId(c);c.Id15=d?d.substring(0,15):null})}function E(a,b,c,d){var e=(c-a)*Math.PI/180,f=(d-b)*Math.PI/180,g=Math.sin(e/2)*Math.sin(e/2)+Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(f/2)*Math.sin(f/2);return 2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g))*6378.137*1e3}function F(a,b,c){var d=[],e=[],f=b?b.children():a.conditions,g=a.uiOnly;return a.uiOnlyConditions?{uiOnlyConditions:a.uiOnlyConditions,conditions:a.conditions}:(c=c||a.fieldsMap,qa.map(f,function(f){var h=b?f.getAttribute("field"):f.field,i=b?new $(qa(f),a):f;g||c[h]&&c[h].uiOnly?d.push(i):e.push(i)}),{conditions:e,uiOnlyConditions:d})}function G(a){if(a.uiOnlyConditions){var b=function(a){return!a.inactive},c=a.uiOnlyConditions.filter(b);return a.getRows(c)}return a.data}function H(a){a.conditions||(a.conditions=[]),a.conditions.forEach(function(b){a.updateConditionValue(b);var c=b.subConditions;c&&c.length&&c.forEach(function(b){a.updateConditionValue(b)})})}function I(){return qa.map(db,function(a){return a})}function J(){return db}function K(a){return db[a]}function L(a){return eb[a]}function M(a){var b={};return qa.each(db,function(c,d){var e=d.dataSource&&d.dataSource.name;b[e]||(b[e]=[]),a&&a!==e||b[e].push(d)}),a!==undefined?b[a]:b}function N(c){var d=c?c.actions:null,e=c?c.id:null,f=b().startsWith,g=c[Za];g||(g=c[Za]=[]),g.length&&(g.forEach(function(a){a.unsubscribe()}),g.length=0),d&&d.length&&d.forEach(function(d){var h=d.events,i=d.actions,j=d.fields,k=d.conditions;b().isString(i)&&(i=b().makeXMLDoc(i)),h&&h.length&&h.forEach(function(d){var h=b().startsWith(d,Wa)?d.substring(7):d;g.push(c.subscribe(h,function(d){var g=!0;if("saved"!==h||d.totalsuccess){if("row.updated"===h&&j&&j.length&&!b().doArraysIntersect(Object.keys(d.updates),j))g=!1;else if(f(h,"condition.")){var l=d.conditionName,m=c.getConditionByName(l);g=c.isFilterableCondition(m)&&(!k||-1!==qa.inArray(l,k))}}else g=!1;if(g){var n=qa.extend({model:K(e),initiatorId:e},d),o=function(){a.actions.runActionsNode(i,c,n)},p=a.component.getByType("skuidpage");p&&p.length?o():qa(document.body).one("pageload",o)}}))})})}function O(d,g){g||(g={});var i,j,k,l,m,n,o=!1,p=qa.Deferred(),q={},r={},s={},t={},u={},v=[],w={},x=g.initiatorId,y=g.rollbackOnAnyError,z=function(a){var b={insertResults:[],updateResults:[],deleteResults:[],messages:[],totalsuccess:!0};return x&&(b.initiatorId=x),a&&qa.each(a,function(a,c){b[a]=c}),b},A={},B={},C=function(){qa.each(s,function(a,b){b.publish("saved",A[a])}),sa(Wa+"saved",[i])},D=function(){qa.each(s,function(a,b){b.publish("saveHandled",A[a])}),sa(Wa+"saveHandled",[i])};if(sa("skuid.ui.commitUserInput"),s=d.reduce(function(a,b){return!b.isBeingSaved&&b.hasChanged&&f(b.changes)&&(a[b.id]=b,b.isBeingSaved=!0),a},{}),i=z({models:s,event:Wa+"saved"}),sa(Wa+"saveInitiated",[{event:Wa+"saveInitiated",models:s,initiatorId:x}]),!0===y&&(r.rollbackOnAnyError=!0),qa.each(s,function(){var d,e,f,g,h,i=this,j=i.id,k={modelId:j,model:i,initiatorId:x},l=!1;e=i.getDataSource(),f=i.getDataSourceName(),g=i.getIdField(),h=B[j]={},A[j]=z(k),i.publish("saveInitiated",k),d={id:j,type:i.objectName},qa.each(i.registeredFields,function(a,b){b.messages=[]}),t[f]||(t[f]=[],u[f]=e),t[f].push(i),q[f]||(q[f]=[]),d.inserts={},d.updates={},d.deletes={},qa.each(i.changes,function(a,e){var f,j,k=i.record(a),m=k.row(),n=k.isMoribund(),o=k.isNew();n&&o?(h[a]=e,delete i.changes[a]):n?(f=d.deletes[a]={},l=!0,g?qa.isArray(g)?g.forEach(function(a){f[a]=i.getFieldValue(m,a,!0)}):f[g]=i.getFieldValue(m,g,!0):qa.each(m,function(a,b){a===bb||qa.isPlainObject(b)||qa.isArray(b)||(f[a]=b)})):(j=d[o?"inserts":"updates"][a]={},o&&(l=!0),qa.each(e,function(a,d){var e=i.getField(a),f=[],g=!0,h=b().isObject(d);if(e&&e.uiOnly)return l=!0,!0;e||!h?(j[a]=d,l=!0):!e&&h&&(l=!0,c(d,f,a),qa.each(f,function(){return i.getField(this)||(g=!1),-1}),g&&(j[a]=d))}))}),v=v.concat(this.validateRequiredFields()),d.returning=i.fields?qa.map(i.fields.filter(function(a){return a.type!==Xa&&!1!==a.query&&!0!==a.uiOnly}),function(a){return a.id}):[],i&&i.extensions&&a.offline.networkDown()&&(d.extensions=i.extensions),q[f].push(d),l?(o=!0,i.publish("beforeSaveCommitted",{operation:d,modelId:j,model:i,initiatorId:x})):i.needsReset=!0}),n=v.length>0,n&&(o=!1),o)k=[],l={},m={},sa(Wa+"beforeSaveCommitted",[{event:Wa+"beforeSaveCommitted",initiatorId:x,models:s,operations:q}]),qa.each(q,function(c,d){var g,n=t[c],o=u[c];r.operations=d,g=o.save(r).then(function(c){var d,e={},g={},k=function(a,b,c){qa.each(a,function(){this.rowId=c,this.model=b;var a,d=this.fields,e=0;if(d&&d.length)for(;e<d.length;e++)a=b.getField(d[e]),d[e]={id:a.id,label:a.label};A[b.id].messages.push(this),i.messages.push(this)})};return c.totalsuccess=!0,qa.each(n,function(a,b){g[b.id]=!0}),qa.each(["delete","insert","update"],function(a,b){var d=c[b+"Results"];d&&d.length&&qa.each(d,function(a,b){var d=b.source,e=s[d],f=b.id||b.oldId;b.success||(c.totalsuccess=!1,A[e.id].totalsuccess=!1,g[d]=!1,k(b.errors,e,f)),k(b.messages,e,f)})}),y&&c.totalsuccess||!y?(qa.each(c.deleteResults,function(a,b){if(b.success){var c=b.source;m[c]||(m[c]={}),m[c][b.id]=b.id}}),qa.each(c.insertResults,function(a,c){if(c.success){var d,f,g,h,i=c.source,j=s[i],k=c.oldId,m=j.getRowById(k),n=c.record=b().parseAsJSONIfString(c.record),o=j.registeredFieldsByRowThenField,p=j.registeredItemsByRow,q=j.record(k);k in j.changes&&delete j.changes[k],k in j.originals&&delete j.originals[k],d=c.hasOwnProperty("id")?c.id:n?j.getRowId(n):k,n&&q.setRow(n),q.setId(d).markSaved(),e[k]={row:m,id:d},j.dataSourceTypeName===wa&&(m.Id15=d?d.substring(0,15):d),d===k&&j.dataMap[d]||(delete j.dataMap[k],delete j.recordsMap[k],j.dataMap[d]=m,j.recordsMap[d]=q),f=k in o&&o[k],g=k in p&&p[k],!1!==f&&(delete o[k],o[d]=f),!1!==g&&(delete p[k],p[d]=g),n&&(h=l[i],h||(h=l[i]={}),h[d]=n)}}),qa.each(c.updateResults,function(a,c){if(c.success){var d,e,f,g=c.id,h=c.record,i=c.source,j=s[i];g in j.changes&&delete j.changes[g],g in j.originals&&delete j.originals[g],d=j.getRowById(g),f=j.getRecordForRow(d),f.markSaved(),h&&(h=c.record=b().parseAsJSONIfString(h),e=l[i],e||(e=l[i]={}),e[j.getRowId(d)]=h)}}),j={},qa.each([m,B],function(a,b){f(b)&&qa.each(b,function(a,b){f(b)&&(j[a]||(j[a]=[]),qa.each(b,function(b){j[a].push(b)}))})}),f(j)&&(qa.each(j,function(b,c){a.$M(b).abandonRows(c,{notify:!1})}),j={},m={},B={}),f(l)&&qa.each(l,function(a,b){s[a].updateRows(b,{preventSetActive:!1,preventTrackChanges:!0})}),d=a.model.list(),qa.each(d,function(){var a=this,b=a.conditions,c={};a.hasChanged&&qa.each(a.changes,function(b,d){qa.each(d,function(d,f){if(f){var g,h,i=e[f];i&&(g=a.getField(d))&&g.displaytype===za&&(h=c[b],h||(h=c[b]={}),h[d]=i.id,h[g.rel]=i.row)}})}),b&&b.length&&qa.each(b,function(a,b){if("modelmerge"===b.type){var c,d=K(b.model),f=d&&d.getIdField(),g=b.mergeField,i=d&&g?d.getField(g):null;(i&&i.displaytype===za||g===f)&&(h(b.operator)?(c=b.values)&&c.length&&qa.each(c,function(a,b){var d=e[b];d&&(c[a]=d.id)}):b.value&&b.value in e&&(b.value=e[b.value].id))}}),f(c)&&a.updateRows(c,{preventSetActive:!1,preventTrackChanges:!1})}),qa.each(d,function(){this.evaluateFormulaFields({preventTrackChanges:!0})})):y&&!c.totalsuccess&&f(B)&&qa.each(B,function(b,c){var d=a.$M(b).changes;qa.each(c,function(a,b){d[a]=b})}),qa.each(n,function(a,b){b.setHasChanged(!g[b.id]),qa.each(b.registeredEditors,function(a,c){c._GUID in w||(w[c._GUID]=c),!0!==c.hadErrors&&(c.hadErrors=b.hasChanged)})}),qa.each(n,function(a,b){b.isBeingSaved=!1}),{insertResults:c.insertResults,updateResults:c.updateResults,deleteResults:c.deleteResults,totalsuccess:c.totalsuccess}},function(a){e(a)&&(a=[a]);var b=qa.map(a,function(a){var b=e(a)?{message:a}:a;return b.severity||(b.severity="ERROR"),b});return qa.each(n,function(){var a=this;a.isBeingSaved=!1;var c=A[a.id];c.totalsuccess=!1,Array.prototype.push.apply(c.messages,b),qa.each(a.registeredEditors,function(b,c){c._GUID in w||(w[c._GUID]=c),!0!==c.hadErrors&&(c.hadErrors=a.hasChanged)})}),i.totalsuccess=!1,Array.prototype.push.apply(i.messages,b),b.map(function(a){return a.message})}),k.push(g.promise())}),qa.when.all(k).then(function(a){qa.each(s,function(a,b){qa.each(b.registeredLists,function(){this.render({resetItemModes:!0,resetPagination:this.options&&this.options.alwaysResetPagination,changedRows:l[b.id],destroyDeletedRows:!0})})}),qa.each(a,function(a,b){["insert","update","delete"].forEach(function(a){var c=a+"Results",d=b[c];d&&d.length&&(qa.merge(i[c],d),d.forEach(function(a){var b=A[a.source];b&&(b[c].push(a),a.success||(b.totalsuccess=!1))}))}),!1===b.totalsuccess&&(i.totalsuccess=!1)}),C(),p.resolve(i),g.callback&&g.callback(i)},function(a){C();var b=i.messages;b&&b.length?p.reject(qa.map(b,function(a){return qa.isPlainObject(a)&&a.message?a.message:a})):p.reject(a)}).always(function(){W(i.messages,s,x);var a=X(i.messages);if(D(),f(w)){var b=[];qa.each(w,function(){this.handleSave(!this.hadErrors,i),this.hadErrors=!1}),qa.each(w,function(){var c=g.initiatorId;this.clearInlineErrors(),c&&this._GUID!==c||(this.handleMessages(a,{initiatorId:c}),b.push(this._GUID)),qa.each(a,function(){var d=this,e=d.model&&d.model.registeredFieldsByRowThenField[d.rowId];e&&!e[0]&&(e=[e]),e&&e.length&&qa.each(e,function(){var e=this,f=d.fields;f&&f.length?qa.each(f,function(){var a=this;qa.each(e,function(){var c=this;qa.each(c,function(){this.id===a.id&&(this.handleMessage(d),b.push(this._GUID))})})}):qa.each(e,function(d,e){var f=e[c];if(f){var g=f.editor,h=g.id();-1===b.indexOf(h)&&(g.handleMessages(a),b.push(h))}})})})})}});else{i.totalsuccess=!n,y&&!i.totalsuccess?f(B)&&qa.each(B,function(b,c){var d=a.$M(b).changes;qa.each(c,function(a,b){d[a]=b})}):f(B)&&(j={},qa.each(B,function(a,b){f(b)&&(j[a]||(j[a]=[]),qa.each(b,function(b){j[a].push(b)}))}),f(j)&&qa.each(j,function(b,c){a.$M(b).abandonRows(c,{notify:!1})})),n&&(Array.prototype.push.apply(i.messages,v),qa.each(v,function(a,b){b.model&&A[b.model.id]&&(A[b.model.id].totalsuccess=!1)}));var E={};qa.each(s,function(a,b){var c=(!y||y&&i.totalsuccess)&&f(B)&&f(B[a]),d=b.registeredEditors,e=b.registeredLists;b.isBeingSaved=!1,b.setHasChanged(!!f(b.changes)),d&&f(d)&&qa.each(d,function(a,b){b._GUID in w||(w[b._GUID]=b)}),(c||b.needsReset)&&e&&f(e)&&qa.each(e,function(a,b){b._GUID in E||(E[b._GUID]=b)})}),W(v,s,x);var F=X(v);D(),f(w)&&qa.each(w,function(){this.handleSave(i.totalsuccess,i),x&&this._GUID!==x||this.handleMessages(F,i)}),n&&qa.each(v,function(){var a=this;qa.each(a.model.registeredFieldsByRowThenField[a.rowId],function(){var b=this;a.fields&&qa.each(a.fields,function(){var c=this;qa.each(b,function(){this.id===c.id&&this.handleMessage(a)})})})}),f(E)&&qa.each(E,function(){this.render({resetPagination:!0,resetItemModes:!0,destroyDeletedRows:!0})}),C(),g.callback&&g.callback(i),p.resolve(i)}return p.promise()}function P(a,b){if(a){a instanceof Array||(a=[a]),b||(b={});var c,d={},e={};qa.each(a,function(a,g){if(!1===g.hasChanged)return!0;qa.each(g.registeredFields,function(a,b){b.messages=[]});var h,i={},j={},k=[];qa.each(g.changes,function(a){g.originals[a]||(a||"0"===a)&&k.push(g.getRowById(a))}),g.abandonRows(k,{notify:!1}),c=g.changes,g.changes={},qa.each(g.originals,function(a,b){var d=g.getRowById(a),e=g.record(a),f=c[a],h=j[a]={};e.isNew()?(qa.each(d,function(a){h[a]=""}),i[a]={}):(qa.each(f,function(a){a in b||(h[a]=undefined)}),qa.each(b,function(a,b){h[a]=b})),e.isMoribund()&&e.unmarkForDeletion()}),f(j)&&g.updateRows(j,{preventSetActive:!1,preventTrackChanges:!0}),h=qa.extend(!0,{},g.originals),g.originals=i,g.setHasChanged(!1),g.evaluateFormulaFields({preventTrackChanges:!0}),g.notifyFieldsOfChange(h,b),g.registeredLists&&qa.each(g.registeredLists,function(){this._GUID in d||(d[this._GUID]=this)}),g.registeredEditors&&qa.each(g.registeredEditors,function(){this._GUID in e||(e[this._GUID]=this)})}),qa.each(d,function(a,b){b.render({resetItemModes:!0,resetPagination:this.options&&this.options.alwaysResetPagination,changedRows:c,destroyDeletedRows:!0})});var g={},h={event:"models.cancelled",models:g,initiatorId:b.initiatorId};return a.forEach(function(a){g[a.id]=a,a.publish("cancelled",{event:"cancelled",model:a,modelId:a.id,initiatorId:b.initiatorId})}),qa.each(e,function(a,b){b.handleCancel&&b.handleCancel(h)}),sa("models.cancelled",[h]),a}}function Q(a,b,c,d,e,f){var g,h=[c],i=!1;if(b||(b=[]),b.length)return b;for(e=e||[a[c].name];h.length>0&&(g=h.shift(),!b.length&&!a[g].isCircular);)qa.each(a[g].links,function(c,g){if(b.length)return!1;qa.each(a,function(c,j){if(j.name===g.name&&!j.isCircular){h.push(c),e.push(g.name);if(e.some(function(a,b){return e.indexOf(a)!==b})&&a[d].name!==f){for(var k,l={},m=0;m<e.length;m++)l.hasOwnProperty(e[m])?(k=e[m],l[e[m]].push(m)):e.lastIndexOf(e[m])!==m&&(l[e[m]]=[m]);var n=e.slice(l[k][0],l[k][1]);qa.each(a,function(b,c){qa.inArray(c.name,n)>-1&&(a[b].isCircular=!0)}),b.push(n)}else f=g.parent,Q(a,b,c,d,e,f),i=!0}})}),i&&(h=[]);return b}function R(a,b,c){return c=c||{},qa.extend(c,{loadAllMetadata:!0}),V(a,b,c)}function S(a,b,c){return V(a,b,c)}function T(a,b){return V(a,b,{syncOnly:!0})}function U(a,b,c){var d={addOnly:!0};return V(a,b,c?qa.extend(c,d):d)}function V(b,c,d){d=d||{};var g=qa.Deferred(),h=[],i={},j=[],l=d.initiatorId,m={},n=[],o={},p=[],q=Wa+"loaded",r={},s={},t={event:q,models:r,updatedRows:s,initiatorId:l},u=function(a,b){a.publish("loaded",{model:a,modelId:a.id,initiatorId:l,updatedRows:b})},v={},w=d.loadAllMetadata,x=function(b,c,f){a.loader.service.loadDataSourceAndDependencies(c).then(function(a){return a.load(b,d)}).always(function(){qa.each(b,function(a,b){b.isProcessing--})}).done(function(a){qa.each(a,function(a,c){var e,f=b[a],g=!1,h=d.syncOnly&&f.lastSyncTime,i=c.errors,j={evaluateFormulaFields:!1,pageComponent:d?d.pageComponent:oa};if(f.lastLoadTime=(new Date).getTime(),"function"==typeof f.lastSuccessfulCallout&&(f.lastSuccessfulCallout=f.lastSuccessfulCallout()),!(v[f.id]>f.lastSuccessfulCallout))return!0;if(f.lastSuccessfulCallout=v[f.id],d.addOnly||h||f._invalidateDataIndices(),i&&i.length&&(f.errors=i),d.loadAllMetadata||!f.hasMetadataLoaded()){if(f.hasMetadataLoaded()||(g=!0,f.setMetadataHasLoaded()),c.actions||delete c.actions,c.fields){var k={};c.fields&&c.fields.length&&qa.each(c.fields,function(a,b){b.id&&(k[b.id]=b)}),qa.each(f.fields,function(a,b){if(b.id){var c=k[b.id];c&&qa.extend(!0,c,b)}}),f.fields=c.fields,delete c.fields}qa.extend(f,c),f.initialize(j),g&&f.registerKeyPrefix(),f.loadAsync&&f.publish("loaded.async"),e=f.data}else{if(f.isInitialized||f.initialize(j),h){var l=f.getConditionByName("_sync",!1),m=[];f.deactivateCondition(l),f.queryAllRows=!1,c.data.forEach(function(a){f.dataSourceTypeName===wa&&a.IsDeleted?f.removeRowById(f.getRowId(a)):m.push(a)}),e=f.adoptRows(m,{evaluateFormulaFields:!1,notify:!1})}else e=d.addOnly?f.adoptRows(c.data,{doAppend:!0,evaluateFormulaFields:!1,notify:!1}):f.data=c.data||[];f.isAggregate||(f._cloneRowsIfNeeded(d?d.pageComponent:oa),f._createDefaultRowIfNeeded(),D(f)),f.conditions&&c.conditions&&qa.each(f.conditions,function(a,b){var d=c.conditions[a];d&&(b.values=d.values),qa.extend(b,d)}),f._generateDataIndices(),["canRetrieveMoreRows","debug","lastQueryDuration","lastQueryString","lastSyncTime","recordsLimit","soql"].forEach(function(a){c.hasOwnProperty(a)?f[a]=c[a]:delete f[a]})}c.cachedData&&(f.cachedData=c.cachedData),f._checkIfDefaultRowCreationNeedsToBeAsync()?f.once("initialized").then(function(){f.publish("initially-loaded")}):f.publish("initially-loaded"),f.doQuery=!0,s[f.id]=e}),qa.each(a,function(a){var c=b[a];if(c.evaluateFormulaFields({preventTrackChanges:!0,updatedRows:s[c.id]}),c.uiOnlyConditions){var d=function(a){return!a.inactive},e=c.uiOnlyConditions.filter(d);c.data=c.getRows(e)}}),qa.each(b,function(a,b){b.lastLoadTime=(new Date).getTime()}),qa.each(b,function(a,b){r[b.id]=b,qa.each(b.getDependentConditions(),function(a,b){var c=K(a);c&&qa.each(b,function(a,b){c.updateConditionValue(b)})})});var c=[];qa.each(b,function(a,b){b.batchLabelModels&&qa.each(b.batchLabelModels,function(a,d){var e=d.getConditionByName("__reference_batch"),f={};qa.each(b.data,function(b,c){var d=c[a];(d||0===d)&&(f[d]=!0)}),0!==Object.keys(f).length&&(d.setCondition(e,qa.map(f,function(a,b){return b})),d.referenceFieldId=a,d.referenceModelId=b.id,c.push(d))})}),c.length?V(c).then(function(a){qa.each(a.models,function(a,b){var c=K(b.referenceModelId),d=c.getField(b.referenceFieldId);d.rel&&qa.each(c.data,function(a,c){var e=c[b.referenceFieldId];(e||0===e)&&(c[d.rel]=b.dataSource.getDataSourceType().getReferenceHandler().getRowFromReferenceValue(b,e,d))})}),f.resolve(t)},function(a){f.reject(a)}):f.resolve(t)}).fail(function(a){e(a)?p.push({message:a,severity:"ERROR"}):a instanceof Array&&qa.each(a,function(a,b){p.push({message:b,severity:"ERROR"})}),qa.each(b,function(){var b=this;b.publish("initially-loaded"),b.registeredEditors&&qa.each(b.registeredEditors,function(a,b){b._GUID in o||(o[b._GUID]=b)}),f.reject(a)})})};if(qa.each(b,function(){var b=this,c=b.getDataSource(),e=b.getDataSourceName(),f=c&&!0===c.dataSourceType.prop("batchableEntityRequests"),g=c&&!0===c.dataSourceType.prop("serverSideModelMerge"),j=d.syncOnly&&b.lastSyncTime;if(b.publish("load-initiated"),b.hasChanged)throw"Model '"+b.id+"' has unsaved changes. To update this model's data, you must first save or cancel the changes.";if(j){var k=b.getConditionByName("_sync",!1);if(!b.fieldsMap.IsDeleted){var l={id:"IsDeleted"};b.fields.push(l),b.fieldsMap.IsDeleted=l}k||(k={name:"_sync",type:"fieldvalue",field:"LastModifiedDate",inactive:!1,operator:"gte",encloseValueInQuotes:!1},b.addCondition(k)),b.setCondition(k,b.lastSyncTime),b.queryAllRows=!0}b._dependsOn=[],b.getConditionsWithDependencies().forEach(function(c){var d=[];c.model&&d.push(c.model),c.locationModel&&d.push(c.locationModel),qa.each(d,function(c,d){var h=a.$M(d);if(-1===qa.inArray(d,b._dependsOn)){var j=h.getDataSourceName();(!f||!g||a.offline.networkDown()||j!==e||h&&h._dependsOn&&h._dependsOn.length>0)&&(b._dependsOn.push(d),i[b.id]=b)}}),b.updateConditionValue(c)}),d.addOnly||(delete b.offsetPageNumber,delete b.offsetPageSize),b.isProcessing++,v[b.id]=++b.calloutIterator,w||(b.doQuery=!0),delete b.errors,
0===b._dependsOn.length&&(f&&!a.offline.networkDown()?(m[e]||(m[e]=[]),m[e].push(b)):h.push(b))}),f(i)){var y=qa.map(b,function(a){return{name:a.id,links:qa.map(a._dependsOn,function(b){return{name:b,parent:a.id}}),isCircular:!1}}),z=[];f(m)&&qa.each(m,function(a,b){var c=m[a],d=[];qa.each(b,function(a,b){b.getConditionsWithDependencies().forEach(function(a){a.model in i&&d.push(b.id)})}),c=b.filter(function(a){if(-1===qa.inArray(a.id,d))return a;i[a.id]=a}),0===c.length&&delete m[a]}),qa.each(y,function(a,b){b.isCircular||Q(y,z,a,a)}),z.length&&qa.each(z,function(b,c){var d="Models ";qa.each(c,function(b,e){var f=b===c.length-1;d+=(f?"and ":"")+e+(f?" ":", "),-1===qa.inArray(e,j)&&j.push(e),h.push(a.$M(e))}),d+="have conditions that reference each other. These conditions may be set to inactive because the data has not been loaded yet from the referenced model.",k([d],a.$M(c[0]))})}qa.each(b,function(c,d){if(d._dependsOn.length&&-1===qa.inArray(d.id,j)){var e=qa.Deferred(),f=!1,g=d.getDataSourceName();qa.each(d._dependsOn,function(c,i){b.filter(function(a){return i===a.id}).length>0?(n.push(e),a.$M(i).subscribeOnce("initially-loaded",function(){0===d._dependsOn.filter(function(b){return a.$M(b).isProcessing>0}).length&&x([d],g,e)}),f=!0):f||d._dependsOn.length!==c+1||h.push(d)})}}),qa.each(h,function(a,b){var c=qa.Deferred(),d=b.getDataSourceName();n.push(c),x([b],d,c)});var A=[];return qa.each(m,function(a,b){var c=[],d=qa.Deferred(),e={},f=function(a,b){var d=[],g=!1;b=b||1,qa.each(a,function(a,f){var h=!1;f.getConditionsWithDependencies().forEach(function(a){var c=a.model;!c||e[c]&&1!==b||(h=!0)}),h?d.push(f):(g=!0,c.push(f),e[f.id]=1)}),d.length&&g?(b++,f(d,b)):d.length&&Array.prototype.push.apply(c,d)};n.push(d),b=b.map(function(a){if(-1===qa.inArray(a.id,j))return a}),f(b),x(c,a,d),A=A.concat(c)}),n.length&&qa.settle(n).always(function(a){function b(a,b){var c,d=a.registeredEditors,e=a.errors;if(e&&e.length&&(c=qa.map(e,function(a){return{message:a,severity:"ERROR"}})),f(c)){var g={};g[a.id]=a,W(c,g,b.initiatorId);var h=X(c);if(f(d)){var i=b.initiatorId;qa.each(d,function(){i&&this._GUID!==i||this.handleMessages(h,{initiatorId:i})})}else k(c,a)}}var h=[];if(qa.each(a,function(a,b){b.success||h.push(b.results)}),h.length)return function(a){var b,h=[],i=!1;qa.each(a,function(a,b){b instanceof Array?(qa.merge(h,b),i=!0):e(b)&&h.push(b)}),W(p,{},d.initiatorId);var j=X(p);f(o)?qa.each(o,function(){d.initiatorId&&this._GUID!==d.initiatorId||this.handleMessages(j,{initiatorId:d.initiatorId})}):qa.each(h,function(a,b){k(b,A[a])}),b=!1===i&&1===h.length?h[0]:h,c&&c(b),g.reject(b)}(h);!1!==d.notify&&(qa.each(r,function(a,c){var e=d.initiatorId,f=c.registeredItems,g=c.registeredFields,h=c.registeredLists,i=c.registeredEditors;f&&qa.each(f,function(){this.fields&&qa.each(this.fields,function(){d.addOnly||this.destroy()})}),g&&qa.each(g,function(){this.render&&this.render(),c.unregisterField(this)}),h&&qa.each(h,function(){this.render({doNotCache:!d.addOnly,initiatorId:e})}),i&&qa.each(i,function(a,b){b._GUID in o||(o[b._GUID]=b),b.clearMessages()}),b(c,{initiatorId:e})}),qa.each(o,function(a,b){b.handleDataRefresh&&b.handleDataRefresh({updatedModels:qa.map(r,function(a){return a})})})),qa.each(r,function(a,b){u(b,s[a])}),sa(q,[t]),c&&c(t),g.resolve(t)}),g.promise()}function W(a,b,c){qa.each(b,function(b,d){d.publish("messages",{messages:a,modelId:b,model:d,initiatorId:c})}),sa(Wa+"messages",[{initiatorId:c,messages:a,models:b}])}function X(a){return a.filter(function(a){return!a.handled})}function Y(a,b){b||(b={});var c={};qa.each(a,function(a,b){b.registeredFields&&qa.each(b.registeredFields,function(){b.unregisterField(this)}),b.registeredItems&&qa.each(b.registeredItems,function(){this.destroy()}),b.registeredLists&&qa.each(b.registeredLists,function(){this.render({doNotCache:!0})}),b.registeredEditors&&qa.each(b.registeredEditors,function(a,b){b._GUID in c||(c[b._GUID]=b)})}),qa.each(c,function(b,c){c.handleDataRefresh&&c.handleDataRefresh({updatedModels:a})});var d={},e=Wa+"loaded",f={event:e,models:d,initiatorId:b.initiatorId};qa.each(a,function(a,c){d[c.id]=c,c.publish("loaded",{modelId:c.id,model:c,initiatorId:b.initiatorId})}),sa(e,[f])}function Z(b){return!b||b.displaytype in a.ui.searchableDisplayTypes&&b.filterable}function $(c,d){var e,f,g,h,j,k,l,m,p,q,r,s,t,u,v=this,w=d?d.getDataSourceType():null,x=d&&d.getParentPageId();if(w&&w.setDefaultConditionState?w.setDefaultConditionState(v):(v.sourceType="fieldvalue",v.type="fieldvalue",v.operator="=",v.inactive=!1,v.encloseValueInQuotes=!0),c)if(c.jquery&&c.attr){if(u=c,f="false"!==u.attr("enclosevalueinquotes"),e=b().adjustValueBasedOnQuotedness,s=u.attr("sourcetype"),s&&s!==v.sourceType?v.sourceType=s:s=v.sourceType,k=u.attr("fieldmodel"),"fieldvalue"===s?(v.field=u.attr("field"),m=u.attr("nosourcerowbehavior"),m&&(v.noSourceRowBehavior=m),k&&(v.fieldModel=k,(q=a.$M(k))&&q.data&&q.data.length&&(r=q.data[0],v.fieldRow=q.getRowId(r)))):"param"===s?(v.sourceParam=u.attr("sourceparam"),v.sourceParam||u.attr("field")&&(v.field=u.attr("field"),v.sourceType=s="fieldvalue")):"snippet"===s?v.sourceSnippet=u.attr("sourcesnippet"):"userinfo"===s?v.sourceUserInfoType=u.attr("sourceuserinfotype"):"datasourceuserinfo"===s?(v.sourceDataSourceTypeUserInfo=u.attr("sourcedatasourcetypeuserinfo"),v.dataSourceName=u.attr("datasource")):b().endsWith(s,"property")&&(v.sourceProperty=u.attr("sourceproperty"),k&&(v.fieldModel=k)),v.operator=u.attr("operator")||"=",v.type=u.attr("type")||"fieldvalue",v.encloseValueInQuotes=f,v.value=e(u.attr("value"),f),v.state=u.attr("state"),v.inactive="true"===u.attr("inactive")||!1,v.mergeField=u.attr("mergefield"),j=v.type,qa.each(["name","fieldFunction","fieldTargetObjects","label","model","noValueBehavior","customCookie","units","locationSource","locationModel","latitudeField","longitudeField","locationNoValueBehavior","locationChangeBehavior","locationDelta"],function(a,b){n(v,b,u,b.toLowerCase())}),p=u.attr("row"))try{p=parseInt(p,10)}catch(y){p=0}v.row=p,"userinfo"===j||"datasourceuserinfo"===j?(v.userInfoType=u.attr("userinfotype"),v.mergeField=v.userInfoType,"userinfo"!==j||v.mergeField||(v.mergeField=v.value),v.value=null):"modelmerge"===j?(v.mergeField=u.attr("mergefield")||v.value,v.sourceParam=u.attr("sourceparam"),v.value=null):"multiple"===j?(t=v.values=[],u.children("values").first().children().each(function(){var a=b().getXML(this);a.length>i("value")?(a=b().decodeXML(a.substring(7,a.length-8)),t.push(e(a,f))):t.push("")})):"join"===j&&(v.joinObject=u.attr("joinobject"),v.joinField=u.attr("joinfield"),h=u.children("conditions"),g=u.children("condition"),h.length&&(v.subConditions=qa.map(h.children(),function(a){return new $(qa(a),d)})),g.length&&(v.subConditions=qa.map(g,function(a){return new $(qa(a),d)})),v.subConditionLogic=o(u.attr("logic"),v.subConditions))}else qa.extend(v,c);"param"===v.type?(v.value?v.value=a.page.getParameter(v.value,x):delete v.value,v.value||(v.value="","noquery"===v.noValueBehavior?d&&(d.doQuery=!1):"deactivate"===v.noValueBehavior&&(v.inactive=!0,v.originalInactive=!0)),v.originalValue=v.value,v.type="fieldvalue"):"fieldvalue"===v.type&&(l=a.page.getParameters(x),v.name in l&&(v.originalValue=v.value,v.value=l[v.name],v.inactive=!1)),v.originalInactive===undefined&&(v.originalInactive=v.inactive),v.originalValue===undefined&&(v.originalValue="multiple"!==j?v.value:v.values.join(";"))}function _(c){var d,e,f,g,h,j,k,l,m,p,q,s,t,u,v,w,x,y,z=c.xml,A=c.field||{},B=c.model,C=c.dataSourceType?c.dataSourceType:B?B.getDataSourceType():null,D="true"===z.attr("uionly")||C&&C.name===xa,E=C&&C.prop("runtime.metadataSource"),F="local"===E,G=F||"hybrid"===E,H="true"===z.attr("overridemetadata"),I=z.attr("readonly");if(f=A.id=b().escapeSingleQuotes(z.attr("id")),n(A,"targetObjects",z,"targetobjects"),r(A,"name",z,"name"),r(A,"function",z,"function"),n(A,"type",z,"type"),r(A,"orderByClause",z,"orderby"),"true"===z.attr("sortable")&&(A.sortable=!0),"false"===z.attr("query")&&(A.query=!1),(D||G)&&(A.accessible=!0),D&&(A.uiOnly=!0),H&&(A.overrideMetadata=!0),(H||D||G)&&(n(A,"displaytype",z,"displaytype"),n(A,"defaultvaluetype",z,"defaultvaluetype"),n(A,"mergefield",z,"mergefield"),n(A,"model",z,"model"),n(A,"userinfotype",z,"userinfotype"),z.attr("label")&&(A.label=z.attr("label")),z.attr("helptext")&&(A.inlineHelpText=z.attr("helptext")),"true"===z.attr("required")&&(A.required=!0),z.attr("placeholder")&&(A.placeholder=z.attr("placeholder")),A.createable="false"!==z.attr("createable"),A.editable="false"!==z.attr("editable"),"true"===I&&(A.createable=A.editable=!1),g=A.displaytype,g===La&&(g=A.displaytype=z.attr("returntype"),A.calculated=!0,D&&(A.createable=A.editable=!1,z.attr("readonly","true")),p="formula",q=z.children(p).first(),s=q&&q.length?b().getXML(q.get(0)):"",s=s.length>p.length+3?b().decodeXML(s.substring(p.length+2,s.length-p.length-3)):null,A.formula=s),[Aa,Ba,Ea,Ca,Da].indexOf(g)>-1?(z.attr("picklistsource")&&(A.picklistSource=z.attr("picklistsource")),z.attr("picklistmodel")&&(A.picklistSourceModel=z.attr("picklistmodel")),z.attr("snippet")&&(A.picklistSourceSnippet=z.attr("snippet")),z.attr("entryvalue")&&(A.picklistEntryValue=z.attr("entryvalue")),z.attr("entrylabel")&&(A.picklistEntryLabel=z.attr("entrylabel")),z.attr("limitentries")&&(A.limitEntries="true"===z.attr("limitentries")),k=z.children("picklistentries").children(),k.length&&(A.picklistEntries=qa.map(k,function(a){var b=qa(a),c={value:b.attr("value"),label:b.attr("label"),defaultValue:"true"===(b.attr("defaultValue")||"false"),active:!0};return"true"===b.attr("disabled")&&(c.disabled=!0),c}),A.customPicklistEntriesProvided=!0)):qa.inArray(g,[Fa,Ga,Ha])>-1?(h=z.attr("precision"),null===h&&D?A.precision=8:null!==h&&(A.precision=parseInt(h,10)),j=z.attr("scale"),null===j&&D?A.scale=2:null!==j&&(A.scale=parseInt(j,10))):g===Ia?(l=z.attr("digits"),null===l&&D?A.digits=8:null!==l&&(A.digits=parseInt(l,10))):g===Ka||g===Ja?(m=z.attr("length"),null===m||""===m||m===undefined?D&&(A.length=255):A.length=parseInt(m,10),g===Ka&&(z.attr("displayasrichtext")?A.htmlFormatted="true"===z.attr("displayasrichtext"):A.htmlFormatted=A.htmlFormatted!==undefined&&A.htmlFormatted)):g===za&&(d=a.dataSource.getDataSourceFromXML(z),e=d.getDataSourceType(),A.dataSourceName=d.name,e&&e.getReferenceHandler&&e.getReferenceHandler().getMetadataHandler(z,A,B,f,D)),n(A,"defaultValue",z,"defaultValue"),x=A.enclosedInQuotes="false"!==z.attr("enclosevalueinquotes"),y=A.defaultValues=[],z.children("values").first().children().each(function(){var a=b().getXML(this);a.length>i("value")?(a=b().decodeXML(a.substring(7,a.length-8)),y.push(b().adjustValueBasedOnQuotedness(a,x))):y.push("")})),-1!==qa.inArray(A.type,[Xa,Ya])&&(t=z.children("fields").first(),w=z.children("conditions").first(),t.length>0&&(u=A.subFields=[],t.children("field").each(function(){var a=qa(this);u.push(new _({xml:a,field:c.field,model:c.model,dataSourceType:c.dataSourceType}))})),A.type===Xa)){if((v=z.attr("limit"))||"0"===v)try{A.recordsLimit=parseInt(v,10),A.recordsLimit&&A.recordsLimit<1&&(A.recordsLimit=1)}catch(J){}z.attr("keyfield")&&(A.keyField=z.attr("keyfield"),A.anchorField=z.attr("anchorfield"),A.childObject=z.attr("childobject")),A.subConditions=qa.map(w.children(),function(a){return new $(qa(a),B)}),A.subConditionLogic=o(w.attr("logic"),A.subConditions)}return A}function aa(a){var b,c;a&&(a.jquery?(b=a.attr("type"),c={verb:a.attr("verb"),endpoint:a.attr("endpoint"),type:b,pathToContent:a.attr("pathtocontent"),sendChanges:a.attr("sendchanges"),successIf:a.attr("successif"),successField:a.attr("successfield"),successValue:a.attr("successvalue"),isBatch:"true"===a.attr("batch")},"insert"===b&&(c.insertResponse=a.attr("insertresponse"),c.createdRecordIdLocation=a.attr("createdrecordidlocation")),c.sendChanges&&(c.changeMapping=a.attr("changemapping"),c.changeMappingPrefix=a.attr("changemappingprefix"),"custompayloadinbody"===c.sendChanges&&(c.payloadSnippet=a.attr("payloadsnippet"),c.contentType=a.attr("contenttype")))):qa.isPlainObject(a)&&(c=a),qa.extend(this,c))}function ba(a,b,c){this._model=a,this._row=b||{},b[bb]=this,d(c)||(this[ab]=c)}function ca(c,d){var f,g=this,h=!1;if(d&&qa.extend(g,d),c)if(e(c))try{f=b().makeXMLDoc(c),q({model:g,xml:f})}catch(i){qa(document.body).one("pageload",function(){a.component.getByType("skuidpage")[0].addProblem("Unable to create Model: invalid Model XML string provided to Model constructor. "+i)})}else c.jquery?(f=c,q({model:g,xml:c})):(qa.extend(g,c),h=!0);g.id||(g.id=b().generateUniqueId()),g.conditions||(g.conditions=[]),g.fields||(g.fields=[]),g.data||(g.data=[]),g.changes={},g.originals={},g.registeredFields={},g.registeredFieldsByRowThenField={},g.registeredItems={},g.registeredItemsByRow={},g.registeredLists={},g.registeredEditors={},g.setHasChanged(!1),"preventUnloadIfUnsavedChanges"in g||(g.preventUnloadIfUnsavedChanges=!0),g.isProcessing=0,g.calloutIterator=0,g.lastSuccessfulCallout=0,g.events={},g[Va]=new ra.EventService,g[_a]=[],g[$a]={},g.extensions||(g.extensions={}),g.recordsMap={},j(g),!h&&f&&a.model.initializeCustomProperties(f,g)}function da(a){var b=a.children("actions"),c=a.children("fields").first().children("field"),d=a.children("events").first().children("event"),e=a.children("conditions").first().children("condition"),f={};return b.length&&(f.actions=b),c.length&&(f.fields=qa.map(c,function(a){return a.textContent})),d.length&&(f.events=qa.map(d,function(a){return a.textContent})),e.length&&(f.conditions=qa.map(e,function(a){return a.textContent})),f}function ea(a,b){var c,d,f=b[0],g={};if(b.length<2)return!1;e(b[1])?(d={},d[b[1]]=b[2],c=b[3]):(d=b[1],c=b[2]),g[a.getRowId(f)]=d,this.updates=g,this.options=c}function fa(a,b){this.list=a,this.map=b}function ga(a,c,d,f,g){f=f.toUpperCase();var h=e(a),i=h?a:a.id,j=h?null:a["function"],k=d.getField(i);k&&k.displaytype===za&&(i=b().getFieldReference(i,k,d.getDataSource()));var m=l(i,j)+" "+f+" NULLS LAST,"+g;return c.suffix=f+" NULLS LAST",m}function ha(a,b){var c=b.map[a];return!!c&&-1!==qa.inArray(c,b.list)}function ia(a,b){var c=b.map[a];if(c){var d=qa.inArray(c,b.list);-1!=d&&b.list.splice(d,1),a in b.map&&delete b.map[a]}}function ja(a,c){var d=e(a),f=d?a:a.id,g=d?a:a.name?a.name:f,h=c.getField(g);return h&&h.displaytype===za?b().getFieldReference(f,h,c.getDataSource()):f}function ka(a,b,c){var d,f,g;return e(a)?(d=b,g=null):(b=a.id,d=a.name?a.name:b,g=a["function"]),f=c.getField(d),f&&f.displaytype===za?l(b,g):d}function la(a,b,c){c=c.toUpperCase();var d=e(a);return l(ja(a,b),d?null:a["function"])+" "+c+" NULLS LAST,"+(b.orderByClause||"")}function ma(a){return a.list.map(function(a){return l(a.fieldId,a.fieldFunction)+" "+a.suffix}).join(",")}function na(a,b,c){var d=ja(a,b),f=e(a),g=ka(a,d,b),h=f?null:a["function"],i={fieldId:d,fieldName:g,suffix:c.toUpperCase()+" NULLS LAST"};return h&&(i.fieldFunction=h),i}var oa,pa=a.model||(a.model={}),qa=a.$,ra=a.events,sa=ra.publish,ta=a.time,ua=function(){return a.platform.getDefaultDataSourceName()},va=a.constants,wa=va.SALESFORCE,xa="Ui-Only",ya=va.DISPLAY_TYPES,za=ya.REFERENCE,Aa=ya.PICKLIST,Ba=ya.MULTIPICKLIST,Ca=ya.BUTTONGROUP,Da=ya.MULTIBUTTONGROUP,Ea=ya.COMBOBOX,Fa=ya.DOUBLE,Ga=ya.CURRENCY,Ha=ya.PERCENT,Ia=ya.INTEGER,Ja=ya.TEXT,Ka=ya.TEXTAREA,La=ya.FORMULA,Ma=ya.DATE,Na=ya.DATETIME,Oa=ya.BOOLEAN,Pa=ya.UUID,Qa="undefined",Ra="number",Sa="string",Ta="boolean",Ua=va.EVENT_SCOPES,Va="_eventService",Wa="models.",Xa="childRelationship",Ya="array",Za="_eventSubscriptionsActions",$a="_eventData",_a="_eventSubscriptionsGeneric",ab="__id",bb="__skuid_record__",cb=1,db={},eb={},fb={};ba.prototype={id:function(){return this.getId()},getId:function(){if(this.hasOwnProperty(ab))return this[ab];var a=this.model(),c=this.isNew()?b().generateUniqueId():a.getDataSource().getRowId(this.row(),a);return this.setId(c),c},setId:function(a){return this[ab]=a,this},name:function(){return this.model().getDataSource().getRowName(this.row(),this.model())},model:function(){return this._model},row:function(){return this._row},getRow:function(){return this._row},setRow:function(a){return this._row=a,a[bb]=this,this},isNew:function(){return!0===this.__new},isClone:function(){return!0===this.__cloned},isMoribund:function(){return this.isMarkedForDeletion()},isMarkedForDeletion:function(){return!0===this.__deleted},markForDeletion:function(){return this.__deleted=!0,this},unmarkForDeletion:function(){return delete this.__deleted,this},markNew:function(){return this.__new=!0,this},markCloned:function(){return this.__cloned=!0,this},markSaved:function(){var a=this;return["__new","__cloned","__deleted"].forEach(function(b){delete a[b]}),a},get:function(a){var c,d=this._row,e=b().getObjectProperty;return a?e(d,a):(c={},qa.each(d,function(a,b){a!==bb&&(c[a]=b)}),c)},set:function(){return 1===arguments.length?qa.each(arguments[0],function(a,c){b().setObjectProperty(this._row,a,c)}):2===arguments.length&&b().setObjectProperty(this._row,arguments[0],arguments[1]),this}},fa.prototype={indexOf:function(a){var b=-1;return qa.each(this.list,function(c,d){if(d.fieldName&&d.fieldName===a||d.fieldId===a)return b=c,!1}),b},size:function(){return this.list.length}},ca.prototype={addField:function(a){return this.fields.push(a),this.fieldsMap[a.id]=a,a.name&&(this.fieldsMap[a.name]=a),this},addFields:function(a){var b=this;return a.forEach(function(a){b.addField(a)}),b},addPageProblems:function(a){return k(a,this)},getDataSource:function(){return j(this)},getDataSourceName:function(){var a=this.getDataSource();return a?a.name:this.dataSourceName},getDataSourceType:function(){var a=this.getDataSource();return a&&a.getDataSourceType()},setParentPageId:function(a){var b=this;return b._parentPageId=a,b},getParentPage:function(){return a.$C(this._parentPageId)},getParentPageId:function(){return this._parentPageId},hasMetadataLoaded:function(){return!this.needsMetadataLoad},setMetadataHasLoaded:function(){return this.needsMetadataLoad=!1,this},isSingleRow:function(){var a=this,b=!1;return a.conditions&&a.conditions.length&&qa.each(a.conditions,function(a,c){if(c.field&&"id"===c.field.toLowerCase()&&c.type&&"param"===c.type)return b=!0,!1}),b},getField:function(a,b){var c,d,e=this.fieldsMap,f=e;return f&&!(f=a in e&&e[a])&&b&&b in e&&(c=e[b],(d=c&&c.type===Xa?c.subFieldsMap:null)&&a in d&&(f=d[a])),f},getFieldValue:function(a,c,d){if(!a)return null;var e,f=this,g=b().getObjectProperty(a,c);return g===undefined&&("Id"===c?(e=f.getRecordForRow(a))&&(g=e.id()):f.fieldsMap&&c in f.fieldsMap&&(g=null)),d?g:b().encodeHTML(g)},getFieldValues:function(a,b,c){var d=this;return b.map(function(b){return d.getFieldValue(a,b,c)})},getFirstRow:function(){return this.data[0]},getRowById:function(a){return a in this.dataMap&&this.dataMap[a]},getNameField:function(){var a=this.getDataSource();if(a.getNameField)return a.getNameField(this.objectName,this)},getNameFieldValueForRow:function(a,c){var d,e=this,f=e.objectName,g=e.getNameField();return e.dataSourceTypeName===wa&&f&&-1!==qa.inArray(f,["Lead","User","Contact"])?d=b().mergeAsText("row","{{#Name}}{{{Name}}}{{/Name}}{{^Name}}{{{FirstName}}} {{{LastName}}}{{/Name}}",{createFields:!1},e,a):g&&(d=e.getFieldValue(a,g,!0)),d&&!0!==c&&(d=b().encodeHTML(d)),d},load:function(a,b){return R([this],a,b)},updateData:function(a,c){var d=this,e=[],f=function(a){if(a.length){var c=qa.map(a,function(a){if(!a.inactive)return a});d._clientData=d.data.filter(function(a){return b().areConditionsMet(c,{row:a,model:d})})}d.notifyEditorsOfDataRefresh()};return d._serverConditions||(d._serverConditions={}),d._clientData&&delete d._clientData,qa.each(d.conditions,function(a,b){if(b.processOnClient&&("values"in b||"value"in b))(b.value||b.values&&b.values.length)&&e.push(b);else if(!b.processOnClient&&!b.inactive){var c,f=d._serverConditions[b.name];b.values&&b.values.length?c=b.values:b.value&&(c=b.value),f?f.values===b.values?delete d._serverConditions[b.name]:f.value===b.value?delete d._serverConditions[b.name]:d._serverConditions[b.name]=c:b.name&&(d._serverConditions[b.name]=c)}}),e.length?b().size(d._serverConditions)?S([d],a,qa.extend(c,{notify:!1})).then(function(a){return f(e),a}):qa.when().then(function(){f(e)}):S([d],a,c)},getOverrideableFieldMetadata:function(a){var b,c,d;return!0===a.overrideMetadata&&(b=a.displaytype,c=["displaytype","defaultValue","label","inlineHelpText","idField","nameField","placeholder","htmlFormatted"],d={overrideMetadata:!0},!0===a.calculated&&a.formula!==undefined&&c.push("calculated","createable","editable","formula"),!1===a.createable&&c.push("createable"),!1===a.editable&&c.push("editable"),-1!==qa.inArray(b,[Aa,Ba,Ea,Ca,Da])?c.push("picklistEntries"):-1!==qa.inArray(b,[Fa,Ga,Ha])?c.push("precision","scale"):b===Ia?c.push("digits"):-1!==qa.inArray(b,[Ja,Ka,"STRING",Ea,"ANYTYPE"])?c.push("length"):b===za&&c.push("isNamePointing","relationshipName","referenceTo","rel","ref"),qa.each(c,function(b,c){var e=a[c];e!==undefined&&(d[c]=qa.isArray(e)?qa.extend(!0,[],e):e)})),d},sync:function(a){return T([this],a)},getMoreData:function(a,b){return U([this],a,b)},loadNextOffsetPage:function(a,b){var c=this;if(c.canRetrieveMoreRows&&!c.isProcessing){if(c.offsetPageNumber&&c.offsetPageSize)c.offsetPageNumber++;else if(c.recordsLimit>2e3?c.offsetPageSize=2e3:c.offsetPageSize=c.recordsLimit||100,c.data.length>0){var d=c.offsetPageSize>0?Math.ceil(c.data.length/c.offsetPageSize):1;c.offsetPageNumber=d>1?d:2}else c.offsetPageNumber=1;c.getMoreData(function(){a&&a()},b)}},loadAllRemainingRecords:function(a){a=a||{};var b=this,c=a.batchSize||b.recordsLimit,d=function(e){if(b.canRetrieveMoreRows){var f=b.data.length;a.stepCallback&&a.stepCallback(f+1,f+c),a.batchSize&&(b.offsetSize=f,b.recordsLimit=c),b.loadNextOffsetPage(d,{notify:!1})}else a.batchSize&&(delete b.offsetSize,b.recordsLimit=e),b.notifyEditorsOfDataRefresh(),a.finishCallback&&a.finishCallback(b.data.length)};d(b.recordsLimit)},getRecords:function(){var a=this;return qa.map(a.data,function(b){return a.getRecordForRow(b)})},getRows:function(a,c){return b().filterRowsByConditions(this.data,a,c,this)},getRawRows:function(){var a=this;return a.getRows.apply(a,arguments).map(function(b){return a.getRecordForRow(b).get()})},adoptRow:function(a,b){var c=this.adoptRows([a],b);return c&&c.length?c[0]:null},adoptRows:function(a,b){b||(b={});var c=this,d=c.data,e=c.dataMap,f=c.recordsMap,g=[],h=[],i=d.length>0,j=!!b.doAppend;if(qa.each(a,function(a,b){var d=c.getRowId(b),j=i&&d&&c.getRowById(d);j?qa.extend(j,b):(j={},j=qa.extend(!0,j,b),h.push(j),e[d]=j,f[d]=new ba(c,j,d)),g.push(j)}),h.length)if(i)if(j)m(d,h);else{var k=d.splice(0,d.length);m(d,h),m(d,k)}else m(d,h);return!1!==b.evaluateFormulaFields&&c.evaluateFormulaFields({preventTrackChanges:!0,updatedRows:g}),!1!==b.notify&&c.notifyEditorsOfDataRefresh(),g},abandonRow:function(a){return this.abandonRows([a]),a},abandonRows:function(a,b){var c=this,d=c.changes,e=c.originals,g=c.registeredItemsByRow,h=c.registeredFieldsByRowThenField,i=[],j=!(b&&!1===b.notify);if(a&&a.length)return qa.each(a,function(a,b){var d=c._findRow(b);d&&i.push(d)}),i.length&&qa.each(i,function(a,b){var f=c.getRowId(b),i=qa.inArray(b,c.data),k=!!d&&d[f],l=!!e&&e[f];k&&delete d[f],l&&delete e[f],-1!=i&&(c.data.splice(i,1),delete c.dataMap[f],delete c.recordsMap[f]),j||c.registeredLists&&qa.each(c.registeredLists,function(){this.handleRowDeletion&&this.handleRowDeletion(f)}),f in g&&(qa.each(g[f],function(){c.unregisterItem(this)}),delete g[f]),f in h&&(qa.each(h[f],function(a,b){b.length&&qa.each(b,function(){c.unregisterField(this)})}),delete h[f])}),0===f(c.changes)&&c.setHasChanged(!1),j&&c.notifyEditorsOfDataRefresh(),a},sortData:function(a){var c=this,e=qa.map(c.data,function(a){return a});c.originalOrderSaved||(c.originalDataOrder=qa.map(this.data,function(a){return a})),c.originalOrderSaved=!0,a&&a.length?e=e.sort(function(){var c=function(a){var c=function(c,e){return b().isString(c)&&b().isString(e)&&(c=c.toLowerCase(),e=e.toLowerCase()),c===e?0:c&&d(e)?a?1:-1:e&&d(c)?a?-1:1:c<e?-1:1};return a?function(a,b){return-1*c(a,b)}:c},e=qa.map(a,function(a){return{name:a.name,func:c(a.desc)}});return function(b,c){for(var d,f,g,h=0;h<a.length&&(f=0,g=e[h],d=g.name,0===(f=g.func(b[d],c[d])));h++);return f}}()):c.originalOrderSaved&&(e=c.originalDataOrder),c.data.length=0,qa.each(e,function(a,b){c.data[a]=b}),c.notifyEditorsOfDataRefresh()},emptyData:function(){var a=this,b=a.data.slice(0);return a.data.length=0,a.changes={},a.originals={},a.setHasChanged(!1),a._invalidateDataIndices(),a.notifyEditorsOfDataRefresh(),qa.each(a.registeredItemsByRow,function(b,c){qa.each(c,function(){a.unregisterItem(this)})}),a.registeredItemsByRow={},qa.each(a.registeredFieldsByRowThenField,function(b,c){qa.each(c,function(b,c){qa.each(c,function(){a.unregisterField(this)})})}),a.registeredFieldsByRowThenField={},b},abandonAllRows:function(){return this.emptyData()},record:function(a){var c=b().isObject(a)?this.getRowId(a):a;return this.getRecordById(c)},getRecordById:function(a){return this.recordsMap[a]},applyAllConditionsToNewRow:function(a,c){var d=this;c.length&&qa.each(c,function(e,f){if(!f.inactive&&f.field&&"blank"!==f.type){var g,h=d.getField(f.field),i=h?h.displaytype:null,j=f.operator||"=",k=d.getDataSourceType();if(h&&h.createable&&("="===j||"starts with"===j))if(d.updateConditionValue(f),g=f.value,"="===j&&i===za)k&&k.handleDefaultReferenceFieldValue&&k.handleDefaultReferenceFieldValue(a,f,d,h,c);else{if(g=t(g,i),b().startsWith(i,Ma)&&!g)return!0;d.updateRow(a,f.field,g)}}})},createRowAsync:function(a){var b=this;return qa.when.all(qa.map(b.fields,function(a){var c=b.getDataSourceType();return c&&c.loadDefaultValueMetadata?c.loadDefaultValueMetadata(a,b):qa.Deferred().resolve().promise()})).then(function(){return b.createRow(a)})},createRow:function(a){a||(a={});var b,c,d=this,e=d.hasChanged,f={},g={},h=d.getDataSourceType(),i=[],j=a.additionalConditions;a.editModeForNewItems&&(g.editModeForNewItems=!0),d.setHasChanged(!0),b=new ba(d,f).markNew(),c=b.id(),a.doAppend?d.data.push(f):d.data.unshift(f),d.dataMap&&(d.dataMap[c]=f),d.recordsMap&&(d.recordsMap[c]=b),"ignoreDefaults"in a!=!1&&!0===a.ignoreDefaults||(["conditions","uiOnlyConditions"].forEach(function(a){var b=d[a];b&&b.length&&b.forEach(function(a){i.push(a)})}),j&&j.length&&qa.each(j,function(a,b){i.push(b)}),h&&h.coerceCreateRow&&h.coerceCreateRow(b,d,i),d.fields&&qa.each(d.fields,function(a,b){b.createable&&d.getDefaultValue(b,d)&&d.updateRow(f,b.id,b.evaluatedDefaultValue,{preventSetActive:!0})}),d.applyAllConditionsToNewRow(f,i)),c in d.changes||(d.changes[c]={}),d.evaluateFormulaFields({updatedRows:[f],updates:d.changes[c]}),d.registeredLists&&qa.each(d.registeredLists,function(){a.initiatorId&&this._GUID===a.initiatorId||this.handleNewRow(f,g)}),d.notifyEditorsOfChange({hadPriorChanges:e,changes:d.changes[c]});var k={modelId:d.id,model:d,rowId:c,row:f,initiatorId:a?a.initiatorId:null,event:"row.created"};return qa.extend(k,g),d.publish("row.created",k),sa("row.created",[k]),f},updateRow:function(){var a=new ea(this,arguments),b=this.updateRows(a.updates,a.options);return b&&b.length?b[0]:b},updateRows:function(a,c){var e,g,h,i,j=this,k=j.getDataSourceType(),l=j.hasChanged,m=[],n=b().getObjectProperty,o=b().hasObjectProperty,p=b().setObjectProperty;return!!a&&(c||(c={}),c.preventTrackChanges||(c.preventTrackChanges=!1),g=c.notifyFields,d(g)&&(g=!0),h=c.notify,d(h)&&(h=!0),k.coerceUpdateRows&&k.coerceUpdateRows(j,a,c),qa.each(a,function(a,d){var f,g,h=j.getRowById(a),i=j.isNewRow(h),k=!1;if(!h||!d)return!0;qa.each(d,function(l,m){var q,r,s,u,v=j.getField(l),w=v&&v.displaytype,x=v&&v.id&&b().isString(v.id),y=(!x||!!c._ignoreMetadata||(i?v.createable:v.editable))&&!c.preventTrackChanges,z=w===za,A=z&&!m,B=j.getDataSourceType(),C=z&&j.getReferenceFieldRelationshipName(l),D=j.getFieldValue(h,l,!0);if(s=w?t(m,w):m,(D===s||s!==s)&&!c.alwaysAddChanges)return!0;z&&!A&&(q=B&&B.getReferenceFieldRelatedData&&B.getReferenceFieldRelatedData(v,s,h,j,d)),y&&(l&&(f||(e||(e={}),e[a]={},f=j.changes[a],e[a].__hadPriorChanges=!!f,f||(f=j.changes[a]={})),u=s,j.isRelationshipField(l)&&(r=j.getReferenceFieldNameFromRelationshipField(l),o(f,r)||p(f,r,qa.extend(!0,{},n(h,r)))),p(f,l,u),p(e[a],l,u),C&&(A&&C!==l?delete f[C]:!0===z&&q&&(p(f,C,q),p(e[a],C,q)))),j.hasChanged||c.preventSetActive||j.setHasChanged(!0),i||(g||(g=j.originals[a])||(g=j.originals[a]={}),j.isRelationshipField(l)?o(g,l)||(r=j.getReferenceFieldNameFromRelationshipField(l),g.hasOwnProperty(r)||(g[r]=qa.extend(!0,{},n(h,r))),p(g,l,j.getFieldValue(h,l,!0))):g.hasOwnProperty(l)||(p(g,l,j.getFieldValue(h,l,!0)),A&&C&&p(g,C,n(h,C))))),p(h,l,s),C&&(A&&C&&C!==l?delete h[C]:!0===z&&q&&p(h,C,q)),k=!0}),k&&m.push(h)}),e&&(i=!1,qa.each(e,function(a,b){if(b&&f(b)>1)return i=!0,!1}),i&&(j.evaluateFormulaFields({updatedRows:m,updates:a,preventTrackChanges:c.preventTrackChangesSecondTime}),!1!==h&&j.notifyEditorsOfChange({hadPriorChanges:l,changes:e}),!1!==g&&!1!==h&&j.notifyFieldsOfChange(e,{initiatorId:c.initiatorId,hadPriorChanges:l}))),m)},notifyFieldsOfChange:function(a,b){var c=this,d=c.registeredFieldsByRowThenField;b=b||{},qa.each(a,function(a,e){var f=e.__hadPriorChanges;delete e.__hadPriorChanges,qa.each(e,function(c,e){a in d&&c in d[a]&&qa.each(d[a][c],function(){b.initiatorId&&this._GUID===b.initiatorId||this.handleChange&&this.handleChange(e,c)})});var g={event:"row.updated",modelId:c.id,model:c,rowId:a,row:c.getRowById(a),updates:e,rowHadPriorChanges:f,modelHadPriorChanges:b.hadPriorChanges,initiatorId:b?b.initiatorId:null};c.publish("row.updated",g),sa("row.updated",[g])})},_findRow:function(a){var b,c=this,d=typeof a;return"object"===d?a:(b=c.getRowById(a),b||d!==Ra||(b=c.data[a]),b)},deleteRows:function(a,b){b||(b={});var c=this,d={},e=c.hasChanged,f=!1!==b.notify;return a||(a=c.data),a.length&&(c.setHasChanged(!0),qa.each(a,function(a,e){if(e=c._findRow(e)){var g=c.getRowId(e),h=c.changes[g],i=c.record(g);h||(c.changes[g]={},h=c.changes[g]),i.markForDeletion(),i.isNew()||c.originals[g]||(c.originals[g]={},c.originals[g]),g in c.registeredItemsByRow&&qa.each(c.registeredItemsByRow[g],function(){b&&b.initiatorId&&this._GUID===b.initiatorId||this.handleMarkRowForDeletion&&this.handleMarkRowForDeletion(e)}),f&&(d[g]={},d[g].__deleted=!0,d[g].__notdeleted=!1)}}),f&&(c.notifyEditorsOfChange({hadPriorChanges:e,changes:d}),qa.each(d,function(a){var d={event:"row.deleted",model:c,modelId:c.id,rowId:a,row:c.getRowById(a),initiatorId:b?b.initiatorId:null,modelHadPriorChanges:e};c.publish("row.deleted",d),sa("row.deleted",[d])}))),c},deleteRow:function(a,b){return this.deleteRows([a],b),this},undeleteRows:function(a,b){b||(b={});var c=this,d={},e=c.hasChanged,f=!1!==b.notify;a||(a=c.data),a.length&&(c.setHasChanged(!0),qa.each(a,function(a,e){if(e=c._findRow(e)){var g=c.getRowId(e);c.record(g).unmarkForDeletion(),g in c.registeredItemsByRow&&qa.each(c.registeredItemsByRow[g],function(){b.initiatorId&&this._GUID===b.initiatorId||this.handleUnmarkRowForDeletion&&this.handleUnmarkRowForDeletion(e)}),f&&(d[g]={},d[g].__deleted=!1,d[g].__notdeleted=!0)}}),f&&(c.notifyEditorsOfChange({hadPriorChanges:e,changes:d}),qa.each(d,function(a){var d={event:"row.undeleted",modelId:c.id,model:c,rowId:a,row:c.getRowById(a),initiatorId:b?b.initiatorId:null,modelHadPriorChanges:e};c.publish("row.undeleted",d),sa("row.undeleted",[d])})))},undeleteRow:function(a,b){return this.undeleteRows([a],b)},removeRowById:function(a){if(a||0===a)return this.abandonRow(this.getRowById(a))},validateRequiredFields:function(){var a=[];return qa.each(this.registeredLists,function(){a=a.concat(this.validateRequiredFields())}),a},getNewId:function(){var a=this.getDataSource();return a&&a.getNewId?a.getNewId():z()},save:function(a){return O([this],a)},cancel:function(a){return P([this],a),this},notifyEditorsOfChange:function(a){this.registeredEditors&&qa.each(this.registeredEditors,function(){
this.handleChange&&this.handleChange(a)})},getConditionCookieName:function(a){return g(this,a)},setCondition:function(a,b,c){if(a){var f=!1,g=this,i="condition.valueChanged",j="",k={event:i,conditionName:a.name,modelId:g.id,model:g,newValue:"",newValues:[],oldValue:"",oldValues:[]};a.inactive=!1,"modelmerge"===a.type&&(a.type="fieldvalue"),h(a.operator)&&(d(b)||(qa.isArray(b)?(f=!0,a.values=b):e(b)&&-1!=b.indexOf(";")?a.values=b.split(";"):a.values=[b]),k.newValues=a.values),f||(a.value=b,k.newValue=b),j=a.originalValue,j instanceof Array?(k.oldValue="",k.oldValues=j):(k.oldValue=j,k.oldValues=[]),c&&a.name&&g.getPersonalizationService().setCondition({name:a.name,value:b}),g.publish(i,k),sa(i,[k])}},deactivateCondition:function(a,b){if(a){var c,d="condition.deactivated";return a.inactive=!0,a.value=a.originalValue,h(a.operator)&&(a.originalValue?-1!=a.originalValue.indexOf(";")?a.values=a.originalValue.split(";"):a.values=[a.originalValue]:a.values&&a.values.length||(a.values=[])),b&&a.name&&this.getPersonalizationService().setCondition({name:a.name,value:"-off-"}),c={event:d,conditionName:a.name,modelId:this.id,model:this},this.publish(d,c),sa(d,[c]),this}},deactivateFilterableConditions:function(a){var b=this;b&&b.conditions&&b.conditions.length&&qa.each(b.conditions,function(c,d){b.isFilterableCondition(d)&&b.deactivateCondition(d,a)})},isFilterableCondition:function(a){return a.state&&-1!==a.state.indexOf("filter")},activateCondition:function(a,b){if(a){var c,d="condition.activated";return a.inactive=!1,b&&a.name&&this.getPersonalizationService().setCondition({name:a.name,value:"-on-"}),c={event:d,conditionName:a.name,modelId:this.id,model:this},this.publish(d,c),sa(d,[c]),this}},resetCondition:function(a,b){if(a){var c="",d={event:"condition.reset",conditionName:a.name,modelId:this.id,model:this,newValue:"",newValues:[],oldValue:"",oldValues:[],isActive:!a.inactive,wasActive:!a.originalInactive};return a.inactive=a.originalInactive,a.value=a.originalValue,h(a.operator)&&(a.originalValue?-1!=a.originalValue.indexOf(";")?a.values=a.originalValue.split(";"):a.values=[a.originalValue]:a.values=[],d.newValues=a.values),c=a.originalValue,h(a.operator)?(d.oldValue="",d.oldValues=c.split(";")):(d.oldValue=c,d.oldValues=[]),b&&a.name&&this.getPersonalizationService().resetCondition({name:a.name}),this.publish("condition.reset",d),sa("condition.reset",[d]),this}},getConditionValueResult:function(c){var f,g,h,i,j,k,l=c.noValueBehavior||(-1!==qa.inArray(c.type,["param","multiple"])?"":"deactivate"),m=this,n={},o=b().startsWith(c.state,"filterable")&&c.name,p=c.value;return"userinfo"===c.type?j=b().getUserInfoPropValue(c.userInfoType):"modelmerge"===c.type?(h=K(c.model),(f=h.getFirstRow())&&(j=h.getFieldValue(f,c.mergeField,!0))):"blank"===c.type?j=null:"param"===c.type?(i=a.page.getParameters(m&&m.getParentPageId()),k=c.valueParamName,e(p)&&(p in i?(c.valueParamName=p,j=i[p]):p.toLowerCase()in i&&(c.valueParamName=p.toLowerCase(),j=i[c.valueParamName])),d(j)&&k&&k in i&&(j=i[k])):j=c.value,o&&typeof p!==Qa&&p!==j&&(j=p),g=j||!1===j||0===j||null===j,g?n.value=c.value=j:c.values&&c.values.length?n.values=c.values:"noquery"===l?(m&&(m.doQuery=!1),n.status="noquery"):"deactivate"===l?(c.originalInactive&&(c.originalInactive=c.inactive),c.inactive=!0,n.value=c.value=null,n.status="deactivate"):n.value=c.value="",n},getConditionValue:function(a){return this.getConditionValueResult(a).value},updateConditionValue:function(a){var c,d,e,f,g,i=a.type,j=a.locationSource,k=a.mergeField,l=a.latitudeField,m=a.longitudeField,n="modelmerge"===i,o="modelmerge"===j,p=a.row,q=this,r=q.getDataSource(),s=!1;if(c=n&&k&&K(a.model),d=c&&c.data,k&&d&&(h(a.operator)?(f=a.values,a.values=qa.map(d,function(a){return c.getFieldValue(a,k,!0)}),f&&f instanceof Array?f&&(f.length!==a.values.length?s=!0:f.length&&(g={},f.forEach(function(a){g[a]=1}),qa.each(a.values,function(a,b){if(!g.hasOwnProperty(b))return s=!0,!1}))):s=!0):((!p||p<0||p>=d.length)&&(a.row=0),f=c.getFieldValue(d[a.row],k,!0),a.value!==f&&(a.value=f,s=!0))),c=o&&l&&m&&K(a.locationModel),d=c&&c.data,d&&((!p||p<0||p>=d.length)&&(a.row=0),e=d&&d[a.row],f={lat:c.getFieldValue(e,l,!0),"long":c.getFieldValue(e,m,!0)},a.latitudeValue===f.lat&&a.longitudeValue===f["long"]||(a.latitudeValue=f.lat,a.longitudeValue=f["long"],s=!0)),!("userlocation"!==j||a.latitudeValue&&a.longitudeValue)){var t=a.locationDelta?parseInt(a.locationDelta,10):100,u={enableHighAccuracy:!0,timeout:15e3,maximumAge:36e5};navigator.geolocation?(qa.blockUI({message:"Determining your current location...",onOverlayClick:qa.unblockUI}),navigator.geolocation[("false"===a.locationChangeBehavior?"getCurrent":"watch")+"Position"](function(b){qa.unblockUI();var c,d,e=b.coords,f=e.latitude,g=e.longitude;c=a.latitudeValue,d=a.longitudeValue,q.isProcessing||c&&d&&!(c&&d&&E(f,g,c,d)>=t)||(a.latitudeValue=f,a.longitudeValue=g,s=f!==c||g!==d,q.updateData())},function(b){qa.blockUI({message:"Unable to determine your current location: "+b.message,timeout:2e3}),"noquery"===a.locationNoValueBehavior?q.emptyData():(a.inactive=!0,q.updateData())},u)):qa.blockUI({message:"Your browser does not support GeoLocation. Some features may not work.",timeout:2e3})}return!k||"userinfo"!==i&&"datasourceuserinfo"!==i||("userinfo"===i?a.value=b().getUserInfoPropValue(k):"datasourceuserinfo"===i&&(a.value=r.getUserInfoProperty(k))),s},getDefaultValue:function(c,f){var g,h,i,j=c.defaultValue,k=c.defaultValues,l=d(j),m=c.displaytype,n=c.mergefield,o=f.getDataSourceType(),p=K(c.model),q=p&&p.data,r=c.row,s=c.defaultvaluetype,t="fieldvalue"===s||d(s);if("modelmerge"===s&&n&&q&&q.length)"MULTIPICKLIST"===c.displaytype?(g=[],qa.each(q,function(a,b){g.push(p.getFieldValue(b,n,!0))}),i=g.join(";")):((!r||r<0||r>=q.length)&&(c.row=0),i=p.getFieldValue(q[c.row],n,!0)),null!==i&&(h=i);else if(o&&o.coerceDefaultValue){var u=o.coerceDefaultValue(c,f);u&&(h=u)}return m===Pa&&!h&&t&&l?h=b().rfc4122v4GUID():!t||!d(h)||l||e(j)&&!j?"datasourceuserinfo"!==s||d(c.userinfotype)?"userinfo"!==s||d(c.userinfotype)?"param"!==s||l?"multiple"===s&&!d(k)&&k.length&&(h=k.join(";")):h=a.page.getParameter(j,f.getParentPageId()):h=b().getUserInfoPropValue(c.userinfotype):h=f.getDataSource().getUserInfoProperty(c.userinfotype):h=j,c.evaluatedDefaultValue=h,!d(c.evaluatedDefaultValue)},registerEditor:function(a){u(a,this.registeredEditors)},unregisterEditor:function(a){v(a,this.registeredEditors)},registerList:function(a){u(a,this.registeredLists)},unregisterList:function(a){v(a,this.registeredLists)},registerItem:function(a){u(a,this.registeredItems);var b,c=this.registeredItemsByRow,d=a.row;c&&d&&(b=this.getRowId(d),b in c||(c[b]={}),c[b][a._GUID]=a)},unregisterItem:function(a){v(a,this.registeredItems);var b=this.registeredItemsByRow,c=a?a.row:0,d=c?this.getRowId(c):0,e=b[d];b&&e&&a._GUID in e&&(delete e[a._GUID],f(e)||delete b[d])},registerField:function(a,b){u(a,this.registeredFields);var c=this.registeredFieldsByRowThenField,d=b||a.id,e=a.row,f=e?this.getRowId(e):0;if(c&&e&&d&&f){f in c||(c[f]={});var g=c[f];d in g||(g[d]={}),g[d][a._GUID]=a}},unregisterField:function(a,b){if(typeof a===Sa&&(a=this.registeredFields[a]),a){v(a,this.registeredFields);var c,d,e=this.registeredFieldsByRowThenField,g=[],h=a._GUID,i=a.row,j=i?this.getRowId(i):0;e&&j&&(c=e[j])&&(b&&b.length&&qa.each(b,function(){g.push(this)}),a.id&&g.push(a.id),qa.each(g,function(a,b){(d=c[b])&&h in d&&(delete d[h],f(d)||delete c[b])}),f(c)||delete e[j])}},mergeRow:function(a,c,d){return b().merge("row",c,d,this,a)},getRowMergeResult:function(a,c,d){return b().getMergeResult("row",c,d,this,a)},mergeModel:function(a,c){return b().merge("model",a,c,this)},getMergeResult:function(a,c){return b().getMergeResult("model",a,c,this)},getOrderObject:function(a){var b=this,c="client"===a,d="server"===a,e=(b.orderByClause||"").split(","),f=(b.orderByClauseClient||"").split(","),g=[],h={},i=function(a,c){var d=qa.trim(a);if(d){var e,f,i,j,k=d.split(" "),l=k[0],m={suffix:k.length>1?k.slice(1).join(" "):"ASC NULLS LAST"};-1!==l.indexOf("(")?(j=l.split("("),i=j[0],e=j[1].split(")")[0],m.fieldId=e,i&&(m.fieldFunction=i),qa.each(b.fields,function(){if(this.name&&this.id===e&&this["function"]===i)return f=this.name,!1}),f&&(m.fieldName=f)):b.isAggregate?(e=l,qa.each(b.fields,function(){if(this.name&&this.id===e)return f=this.name,!1}),m.fieldId=e,f&&(m.fieldName=f)):(m.fieldId=l,f=l),m.onClient=c,h[f]||(g.push(m),h[f]=m)}};return d||qa.each(f,function(){i(this,!0)}),c||qa.each(e,function(){i(this,!1)}),new fa(g,h)},toggleOrdering:function(a,b,c){b=b||{};var d=this,e=b.clientSide,f=d.getOrderObject(e?"client":"server"),g="",h=ja(a,d),i=ka(a,h,d),j=f.map[i],k=b.explicitOrder||"toggle",l="toggle"===k,m=!1!==b.shouldQuery,n=!1!==b.shouldUpdatePersonalization,o=j&&-1!=j.suffix.toLowerCase().indexOf("asc"),p=j&&-1!=j.suffix.toLowerCase().indexOf("desc");if(ha(i,f)&&ia(i,f),j&&(g=ma(f)),l?j?o?g=ga(a,j,d,"DESC",g):p&&(j=!1):(g=la(a,d,"ASC"),j=na(a,d,"ASC"),j.onClient=e):j||"clear"===k?"clear"!==k?g=ga(a,j,d,k,g):j=!1:(g=la(a,d,k),j=na(a,d,k)),g=g.replace(/,+$/,""),g=g.replace(/\s*,\s*/g,","),e){var q=d.orderByClauseClient,r=[];if(q=j?h+" "+j.suffix:"",qa.each(f.list,function(a,b){b.fieldId!==h&&(q+=","+b.fieldId+" "+b.suffix)}),q){var s=q.split(",");qa.each(s,function(a,b){b=b.split(" "),r.push({name:b[0],desc:"ASC"!==b[1]})})}d.orderByClauseClient=q,d.sortData(r),n&&d.getPersonalizationService().setOrderBy({newValue:q}),c()}else d.orderByClause=g,m&&d.updateData(c,{neverCache:!0}),n&&d.getPersonalizationService().setOrderBy({newValue:g});return j},orderBy:function(a,c){var d,f=this,g=f.getOrderObject(),h=e(a),i=h?a:a.id,j=h?a:a.name?a.name:i,k=h?null:a["function"],m=f.getField(j),n="";return m.displaytype===za&&(i=b().getFieldReference(i,m),j=l(i,k)),d=g.map[j],d?-1!=d.suffix.indexOf("ASC")?(n=l(i,k)+" DESC NULLS LAST",d.suffix="DESC NULLS LAST"):d=!1:(n=l(i,k)+" ASC NULLS LAST",d={fieldId:i,fieldName:j,suffix:"ASC NULLS LAST"},k&&(d.fieldFunction=k)),n=n.replace(/,+$/,""),f.orderByClause=n,f.updateData(c,{neverCache:!0}),f.getPersonalizationService().setOrderBy({newValue:n}),d},getSearchableFields:function(){return this.fields.filter(Z)},createSearchSubConditions:function(a,c,d,e){return b().createSearchSubConditions(this,a,c,d,e)},buildSearchCondition:function(a,b,c,d){b=!!b&&qa.trim(b),d||(d={}),a||(a="__default_searchbox");var e=this,f=d.affectCookies||!1,g=b&&b.length>(d.useSOSLSearch?1:0),h=e.getConditionByName(a,!1),i=this.getDataSourceType(),j=!1!==i.prop("canFieldsBeIndividuallySearched"),k=i.prop("hasDefaultSearch");return g?((j||k)&&(h||(h=new $,h.name=a,d.useSOSLSearch?h.type="search":h.type="group",e.addCondition(h))),j?(e.activateCondition(h,f),d.useSOSLSearch?(h.fieldfunction=d.SOSLFields,d.tokenize?h.value=qa.map(b.split(d.delemiter||" "),function(a){return'"'+a+'*"'}).join(" AND "):h.value='"'+b+'*"'):e.createSearchSubConditions(h,b,c,d)):h&&e.setCondition(h,b,f),h&&"group"===h.type&&(h.value=b)):h&&(e.deactivateCondition(h,f),h.subConditions=[],h.subConditionLogic="",h.value=""),h},prepareSearchConditions:function(a,b,c,d){this.buildSearchCondition(null,b,a.searchFields,d)},_invalidateDataIndices:function(){return this.dataMap={},this.recordsMap={},this},isRowMarkedForDeletion:function(a){var b,c=this._findRow(a);return!!c&&((b=this.getRecordForRow(c))&&b.isMoribund())},getRowId:function(a){var b=this.getRecordForRow(a);return b?b.id():this.dataSource.getRowId(a,this)},getRowName:function(a){var b=this.getRecordForRow(a);return b?b.name():this.dataSource.getRowName(a,this)},getValueKeyPrefix:function(a){return this.dataSource.getValueKeyPrefix(a,this.objectName||"",this)},rowHasId:function(a){return!!this.getRowId(a)},getIdField:function(){return this.dataSource.getIdField(this)},getIdFieldForChildRelationship:function(a){return this.dataSource.getIdFieldForChildRelationship(this,a)},getKeyPrefix:function(){return this.dataSource.getKeyPrefix(this.objectName||"",this)},getDataSourceForReferenceField:function(b){var c=this.getField(b),d=this.dataSource;return c&&c.displaytype===za&&c.overrideMetadata&&c.dataSourceName!==d.name?a.dataSource.get(c.dataSourceName):d},getReferenceFieldNameFromRelationshipField:function(a){var b=this.getDataSourceType();return b&&b.getReferenceFieldNameFromRelationshipField?b.getReferenceFieldNameFromRelationshipField(a,this):a&&a.split(".")[0]},getReferenceFieldRelationshipName:function(a){return this.getDataSourceForReferenceField(a).getReferenceFieldRelationshipName(a,this)},getChildIdFromRow:function(a,b){var c=this.getDataSourceType();return c&&c.getChildIdFromRow?c.getChildIdFromRow(this,a,b):null},isRelationshipField:function(a){var b=this.getDataSourceType();return!(!b||!b.isRelationshipField)&&b.isRelationshipField(a)},getRowChanges:function(a){a=this._findRow(a);var b;return a&&(b=this.changes?this.changes[this.getRowId(a)]:null),b},getRowOriginals:function(a){a=this._findRow(a);var b;return a&&(b=this.originals?this.originals[this.getRowId(a)]:null),b},isRowChanged:function(a){a=this._findRow(a);var b;return!!a&&(b=this.getRowId(a),this.getRowById(b)&&b in this.changes)},doesRowHaveUnsavedChanges:function(a){return this.isRowChanged(a)},isRowNew:function(a){var b,c=this._findRow(a);return!!c&&((b=this.getRecordForRow(c))&&b.isNew())},isNewRow:function(a){return this.isRowNew(a)},isRowUnsavedClone:function(a){return a=this._findRow(a),A(a,this)},cancelRowChanges:function(a,b,c){if(c||(c={}),!a)throw"Row is required.";var d=this,g=d.getRowId(a),h=d.originals[g],i=d.changes[g],j={};return i&&(!b&&i?b=Object.keys(i):b&&e(b)&&(b=[b]),b.forEach(function(b){h&&b in h?j[b]=h[b]:d.isNewRow(a)&&(j[b]=undefined)}),f(j)&&(d.updateRow(a,j,{initiatorId:c.initiatorId}),f(i)||delete d.changes[g],f(h)||delete d.originals[g],f(d.changes)||d.setHasChanged(!1))),d},getPersonalizationService:function(){var b="_personalizationService",c=this[b];return c||(c=this[b]=a.personalization.createModelService(this)),c},notifyEditorsOfDataRefresh:function(a){Y([this],a)},exportData:function(a){a||(a={});var c=this,d=new Date,e=(a.fileName||c.id+"-export-"+d.getTime())+".csv",f=c.makeCSVFromModelData(a);return b().downloadStringAsFile(f,e,"text/csv")},makeCSVFromModelData:function(a){var c=this,d=c.getIdField(),e=c.isAggregate,f=a.additionalConditions||!1,g=a.rows||c.data,h=(a.fields||c.fields).slice(0),i=g.length,j=h.length,k=a.useAPINamesForHeaders||!1,l=a.doNotAppendRowIdColumn||!1,m=!e&&!l,n="";if(j>0&&i>0){var o={},p=[];qa.each(h,function(a,b){b.name?o[b.name]=b:b.id&&(o[b.id]=b)}),m&&d&&d in o&&(m=!1),m&&d&&(m=(qa.isArray(d)?d:[d]).filter(function(a){return!(a in o)}).length>0),qa.each(h,function(a,d){if(d.displaytype&&d.displaytype===za){var e=d.name?d.name:d.id,f=b().getFieldReference(e,d);if(!(f in o)&&f in c.fieldsMap){var g=c.getField(f);k||(g.label=b().mergeAsTextInContext(d.label+": "+g.label,{model:c})),p.push({atIndex:a+1,id:f,field:g})}}}),p.length&&qa.each(p,function(a,b){h.splice(b.atIndex,0,b.field),j++}),m&&d&&qa.each(qa.isArray(d)?d:[d],function(a,b){if(b in o)return!0;c.getField(b)?h.push(c.getField(b)):h.push({id:b,name:b,label:b}),j++}),h.forEach(function(a,d){var e=k?a.name?a.name:a.id:b().mergeAsTextInContext(a.label,{model:c});n+=b().escapeCSVCell(e)+(d<j-1?",":"\r\n")}),g.forEach(function(a){var d=!0;f&&f.length&&(d=b().doesRowMeetConditions(a,f)),d&&h.forEach(function(d,e){var f,g=d.name?d.name:d.id,h=d.template,i=d.type===Xa;i&&h&&(h="{{#"+g+".records}}"+d.template+",{{/"+g+".records}}"),f=c.getFieldValue(a,g,!0),i||!f&&0!==f&&!1!==f?c.getField(g)&&!i||!h?f="":(f=c.mergeRow(a,h).text(),i&&f&&(f=f.substring(0,f.length-1))):f=""+f,n+=""===f?f:b().escapeCSVCell(f),n+=e<j-1?",":"\r\n"})})}return n},getSOQL:function(){return this.getQuery()},getQuery:function(){return this.lastQueryString||this.soql},getLastQueryDuration:function(){return this.lastQueryDuration},getConditionsWithDependencies:function(a){var b=[],c=this,d=c.conditions;return d&&d.length&&d.forEach(function(c){var d=c.subConditions;("modelmerge"!==c.type||a&&c.model!==a.id)&&("modelmerge"!==c.locationSource||a&&c.locationModel!==a.id)?"join"===c.type&&d&&d.length&&d.forEach(function(c){"modelmerge"!==c.type||a&&c.model!==a.id?"modelmerge"!==c.locationSource||a&&c.locationModel!==a.id||b.push(c):b.push(c)}):b.push(c)}),b},getDependentConditions:function(){var a=this,b={};return qa.each(pa.list(),function(c,d){if(a!==d){var e=d.getConditionsWithDependencies(a);e&&e.length&&(b[d.id]=e)}}),b},updateDataSourceUserInfoConditions:function(){function a(c){var d=c.subConditions;"datasourceuserinfo"===c.type?b.updateConditionValue(c):d&&d.length&&d.forEach(a)}var b=this;return[b.conditions,b.havings,b.uiOnlyConditions].forEach(function(b){b&&b.length&&b.forEach(a)}),b},getConditionByName:function(a,b){var c,d,e,f,g=this,h=[],i=Array.prototype.push;if(qa.each([g.conditions,g.havings,g.uiOnlyConditions],function(a,b){b&&b.length&&i.apply(h,b)}),h.length)for(e=0;e<h.length;e++){if(c=h[e],c.name===a)return c;if(b&&c.subConditions&&c.subConditions.length)for(f=0;f<c.subConditions.length;f++)if(d=c.subConditions[f],d.name===a)return d}return!1},hasCondition:function(a){return!1!==this.getConditionByName(a,!0)},addCondition:function(a,b){var c,d,e=this;return!a||a instanceof $||(a=new $(a)),e.conditions.push(a),!1===e.getDataSourceType().prop("initializeConditionLogic")?a:(b&&"or"==b.toLowerCase()||(b="AND"),c="("+e.conditions.length+")",e.conditionLogic&&""!==e.conditionLogic?(d="and"===b.toLowerCase()&&-1===e.conditionLogic.toLowerCase().indexOf("or"),e.conditionLogic=(d?"":"(")+e.conditionLogic+(d?"":")")+b+c):e.conditionLogic=c,a)},initialize:function(a){return x(this,a),this},register:function(a){var b=this;return db[a||b.id]=b,b.registerKeyPrefix(),b},registerKeyPrefix:function(){var a,b=this,c=b.keyPrefix;c&&(a=eb[c],a||(a=eb[c]=[]),-1===qa.inArray(a,b)&&a.push(b))},unregister:function(){var a,b=this,c=eb[b.keyPrefix];return[Za,_a].forEach(function(a){var c=b[a];c&&c.length&&(c.forEach(function(a){a.unsubscribe()}),b[a].length=0)}),delete db[b.id],c&&-1!==(a=qa.inArray(b,c))&&(c.splice(a,1),c.length||delete eb[b.keyPrefix]),b},evaluateFormulaField:function(b,c){e(c)&&(c=this.getField(c));var d,f,g=c.__compiledFormula,h={model:this,row:b},i={outputType:c.displaytype};return g||(g=c.__compiledFormula=new a.formula.CompiledFormula(c.formula||""),(d=g.__error)&&(f=d.location.start,this.getParentPage().addProblem('Syntax error in formula field "'+c.id+'" at line '+f.line+", column "+f.column+": "+d.message+"."))),g.evaluate(h,i)},evaluateFormulaFields:function(a){a||(a={});var c,d,e=this,g={},h=a.updatedRows||e.getRows(),i=a.preventTrackChanges;return h.length&&(c={_ignoreMetadata:!0},i&&(c.notify=!1),d={},e.fields&&qa.each(e.fields,function(a,c){c.calculated&&c.uiOnly&&(g[c.id]=c,qa.each(h,function(a,f){var g=e.getRowId(f),h=d[g],i=e.getFieldValue(f,c.id,!0),j=e.evaluateFormulaField(f,c);(b().isDate(i)&&b().isDate(j)?i.getTime()!==j.getTime():i!==j)&&(h||(h=d[g]={}),h[c.id]=j)}))}),f(d)&&(c.preventTrackChangesSecondTime=i,e.updateRows(d,c),i&&(qa.each(d,function(a){var b=e.changes[a],c=e.originals[a];b&&(qa.each(b,function(a){a in g&&delete b[a]}),f(b)||delete e.changes[a]),c&&(qa.each(c,function(a){a in g&&delete c[a]}),f(c)||delete e.originals[a])}),f(e.changes)||e.setHasChanged(!1)))),e},_cloneRowsIfNeeded:function(b){var c,e,f,g=this,h=!1;if(!g.isAggregate&&(d(b)&&(b=g.getParentPage()||a.component.getByType("skuidpage")[0]),!0===g.doClone?h=!0:!1!==g.doClone&&(e=a.page.getParameters(b),f=e.id,!d(e.clone)&&f&&g.conditions.length&&qa.each(g.conditions,function(a,b){if(("param"===b.type||"fieldvalue"===b.type)&&b.value===f)return g.doClone=h=!0,!1;if("modelmerge"===b.type&&b.model){var c=K(b.model),d=c&&c.getFirstRow(),e=d?c.getRowId(d):null,i=c?c.realToFakeIdMap:null;if(d&&(e===f||i&&i[f]===e))return g.doClone=h=!0,!1}})),h&&g.data&&g.data.length)){g._invalidateDataIndices(),g.realToFakeIdMap||(g.realToFakeIdMap={}),g.data.forEach(function(a){var b=g.getRowId(a),c=g.realToFakeIdMap[b]="clone_"+cb++,d=g.getRecordForRow(a);d?d.setId(c):d=new ba(g,a,c),d.markNew().markCloned(),g.getDataSourceType().name===wa&&(a.Id=c)}),g._generateDataIndices();var i={};g.conditions&&qa.each(g.conditions,function(a,b){var c=b.field,d=b.value,e=g.getField(c);if(e&&e.createable&&(-1!==c.indexOf(".")||!d&&!1!==d&&0!==d||qa.each(g.data,function(a,b){c in b||(b[c]=d)}),e.displaytype===za&&"modelmerge"===b.type&&b.model)){var f=K(b.model);f&&f.realToFakeIdMap&&(i[c]=f)}}),g.fields&&qa.each(g.fields,function(a,b){if(b.displaytype===za){var c=[];i[b.id]?c.push(i[b.id].realToFakeIdMap):qa.each(b.referenceTo,function(a,b){var d=eb[b.keyPrefix];d&&d.length&&qa.each(d,function(a,b){b.realToFakeIdMap&&c.push(b.realToFakeIdMap)})}),c.length&&qa.each(g.data,function(a,d){qa.each(c,function(a,c){if(d[b.id]in c)return d[b.id]=c[d[b.id]],!1})})}}),c=function(){var a={},b=g.fields,c=g.data;c&&c.length&&b&&b.length&&qa.each(c,function(c,d){var e={};qa.each(b,function(a,b){e[b.id]=g.getFieldValue(d,b.id,!0)}),a[g.getRowId(d)]=e}),g.updateRows(a,{alwaysAddChanges:!0,notifyFields:!1})},!0===b.isRendered?c():b.element.one("pageload",function(){c()})}},_checkIfNeedDefaultRow:function(){var a=this;if(a.data&&a.data.length<1&&!0===a.createRowIfNoneFound&&(!a.doQuery||a.doQuery&&a.lastLoadTime))return!0},_createDefaultRowIfNeeded:function(){var a=this;if(a._checkIfNeedDefaultRow())return delete a.createRowIfNoneFound,a.createRow()},_createDefaultRowIfNeededAsync:function(){var a=this;return a._checkIfNeedDefaultRow()?(delete a.createRowIfNoneFound,a.createRowAsync()):qa.Deferred().resolve().promise()},_checkIfDefaultRowCreationNeedsToBeAsync:function(){var a=this,b=a.getDataSourceType();return!!a._checkIfNeedDefaultRow()&&(!(!b||!b.determineIfCreateRowNeedsMetadata)&&b.determineIfCreateRowNeedsMetadata(a))},getRecordForRow:function(a){if(!a)throw"No row provided";return a[bb]},_generateDataIndices:function(){var a=this,c=a.dataMap,d=a.recordsMap,e=a.data;return c||(a.dataMap=c={}),d||(a.recordsMap=d={}),e&&e.length&&e.forEach(function(e){var f,g,h;f=b().isString(e)?{value:e}:e,g=a.getRecordForRow(f),g||(g=new ba(a,f)),h=g.id(),c[h]=f,d[h]=g}),a},storeSubscription:function(a){return this[_a].push(a),this},publish:function(a,c,e){var f,g,h=e&&e.channel,i="model."+a,j=this.getParentPage(),k=this[Va],l=b().rfc4122v4GUID(),m={scope:Ua.MODEL,uniqueId:l},n={scope:Ua.PAGE,uniqueId:l},o={uniqueId:l};return d(c)&&(c={model:this,modelId:this.id}),f=qa.isArray(c)?c:[c],g=e&&e.scope?e.scope:Ua.PAGE,o.scope=g,h&&[m,n,o].forEach(function(a){a.channel=h}),b().setObjectProperty(this[$a],a,c),k.publish(a,f,m),g!==Ua.MODEL&&(j&&j.publish(i,f,m),g!==Ua.SKUID&&g!==Ua.GLOBAL||sa(i,f,o)),this},subscribe:function(a,b,c){var d,e={scope:Ua.MODEL};return c&&c.channel&&(e.channel=c.channel),d=this[Va].subscribe(a,b,e),this.storeSubscription(d),d},countEventSubscribers:function(a){return this[Va].count(a)},once:function(a,c,d){var e,f=qa.Deferred(),g=this,h=g[$a],i=!(d&&!1===d.cache),j=b().getObjectProperty(h,a),k=this[Va],l=function(a){c&&c(g,a),f.resolve(g,a)};return i&&j?l(j):(e=k.subscribeOnce(a,function(c){b().setObjectProperty(h,a,c),l(c)}),this.storeSubscription(e)),f.promise()},subscribeOnce:function(a,b){return this.once(a,b,{cache:!1})},setHasChanged:function(a){this.hasChanged=a},fieldIsSearchableServerSide:Z},qa.extend(ca,{cancel:P,getMoreData:U,initialize:x,load:R,register:B,save:O,sync:T,unregister:C,update:S}),qa.extend(pa,{Condition:$,Field:_,Method:aa,Model:ca,Record:ba,getModel:K,getModelsByKeyPrefix:L,getModelsByName:J,getModelsByDataSource:M,getModelList:I,list:I,map:J,getConditionCookieName:g,getModelsList:I,getNewId:z,isNewId:y,cancel:ca.cancel,getMoreData:ca.getMoreData,initializeModel:ca.initialize,load:ca.load,registerModel:ca.register,save:ca.save,sync:ca.sync,unregisterModel:ca.unregister,updateData:ca.update}),a.$M=K}(skuid),function(a){function b(a,b){var c=d(a),f=e(c);b._customProperties=f}function c(a,b){return a._customProperties&&a._customProperties[b]}function d(a){return a.children(h)}function e(a){var b={};return a.length&&m.each(a.children(i),function(a,c){c=m(c),b[c.attr(j)]=f(c)}),b}function f(a){var b=a.attr(l).toUpperCase(),c=a.attr(k);return c?g(b,c):c}function g(a,b){return"BOOLEAN"===a?"TRUE"===b.toUpperCase():"NUMBER"===a?1*b?1*b:0:b}var h="custom-props",i="custom-prop",j="id",k="value",l="type",m=a.$;m.extend(a.model,{initializeCustomProperties:b,getCustomPropertyValue:c})}(skuid),function(a){function b(){return a.jss}function c(a){return n.extend(!0,{},a)}function d(){return l||(l=a.$("#"+p),l.length||(l=n('<section id="'+p+'">'),n(document.body).append(l))),l}function e(b,c){var d=a.themeSettings.getAll();return n.map(b.styleSettingsVariants,function(a,c){return{variantName:c,variantSettings:a,componentName:b.type}}).concat(d&&d.styleSettingsVariants&&d.styleSettingsVariants[b.type]?n.map(d.styleSettingsVariants[b.type],function(a,c){return{variantName:c,variantSettings:a,componentName:b.type}}):[]).filter(function(a){return!c||a.variantName===c.get("styleSettingsVariant")})}function f(a){return a&&a.styleSettings?a.styleSettings:a&&a.styleSettingsVariants?a.styleSettingsVariants["default"]||{}:{}}function g(a){for(var b in a){var c=a[b];"object"==typeof c&&(c.value?a[b]=c.value:a[b]=g(c))}return a}function h(b){a.$(".sk-style-"+b).remove(),delete o[b]}function i(b){if(b.get("styles")){var c=q(a.componentType.get(b.getType()),b)[0];return b.set("styleNode",c.styleNode),c.classes}var d=b.get("styleSettingsVariant")||"default",e=o[b.getType()+("default"!==d?"--"+d:"")];if(!e)throw'Invalid style variant "'+d+'"';return e}function j(a,b){if(!a)return"";if("string"==typeof a){if(!b[a])throw"no such class "+a;return b[a]}if(Array.isArray(a))return a.reduce(function(a,c){if(!b[c])throw"no such class "+c;return a+(a?" ":"")+b[c]},"");var c={};return n.each(a,function(a,d){c[b[a]]=d}),c}function k(a){this.shades=a._shades||[],this.tints=a._tints||[],this.color="string"==typeof a?a:a.color||"#000"}var l,m=a.themes={},n=a.$,o={},p="sk-component-type-styles",q=function(h,i){var j=[],k=i&&i.get("styles"),l=e(h,i);h.getStyleSettingsVariantsChildren&&n.each(l,function(){var a=this;n.each(h.getStyleSettingsVariantsChildren(a.variantSettings),function(b,c){n.each(c,function(c,d){l.push({variantName:h.type+"--"+a.variantName+"__"+b+"--"+c,variantSettings:d,componentName:b})})})});for(var m=0;m<l.length;m++){var p,q,r,s=l[m].componentName,t=l[m].variantSettings,u=l[m].variantName,v=c(t),w="default"===u,x=s+(w?"":"--"+u)+(i?"--"+i.get("uniqueId"):"");if(w||(v=s===h.type?n.extend(!0,{},f(h),v):n.extend(!0,{},f(a.componentType.get(s)),v)),k&&k.tokens&&n.extend(!0,v,k.tokens),!(r=o[x])||k){p=n("<style>").addClass("sk-style sk-style-"+h.type).appendTo(d());var y,z;y=s===h.type?h:a.componentType.get(s),v=g(v),z=y.getStyles(v),q=b().createStyleSheet(z,{element:p[0]}),r=q.attach().classes,o[x]=r,k&&(p.id+="-"+a.utils.generateUniqueId()),j.push({styleNode:p[0],classes:r})}}return j};k.prototype.getTone=function(a){return a?a>0?this.tints[Math.min(a-1,this.tints.length-1)]:this.shades[Math.max(this.shades.length+a,0)]:this.color},n.extend(m,{Color:k,getClasses:j,getStylesElement:d,getThemedClassMapForComponent:i,unregisterComponentTypeStyles:h,registerComponentTypeStyles:q})}(skuid),function(a){function b(){return"ontouchstart"in window||navigator.maxTouchPoints}function c(){a.mobile||!b()||u.hammerJSLoaded||v.loadJS(v.getStaticResourceUrl("HammerJS","skuid",null,v.getCacheTimestamp())).done(function(){u.hammerJSLoaded=!0,a.events.publish("skuid.resources.hammerjsloaded")})}function d(a){if(a&&a.length){var b=[];return a.children().each(function(){var a=s(this),c="false"!==a.attr("enclosevalueinquotes"),d={field:a.attr("field"),type:a.attr("type"),operator:a.attr("operator"),value:a.attr("value"),depfield:a.attr("depfield"),sourceParam:a.attr("sourceparam"),model:a.attr("model"),mergeField:a.attr("mergefield"),encloseValueInQuotes:c};if("multiple"==d.type){d.values=[];var e=a.children("values");e.length&&e.first().children("value").each(function(){var a=v.getXML(this);a.length>8?(a=v.decodeXML(a.substring(7,a.length-8)),d.values.push(v.adjustValueBasedOnQuotedness(a,c))):d.values.push("")})}else"userinfo"==d.type?d.mergeField=a.attr("userinfotype"):"param"===d.type?d.mergeField=a.attr("value"):"modelmerge"===d.type&&t(d,{mergeField:a.attr("mergefield"),mergeModel:a.attr("model"),noValueBehavior:a.attr("novaluebehavior")});b.push(d)}),b}}function e(a,b){b||(b={});var c=b.mode||"edit",d=s("<div>").addClass("nx-editor-contents nx-basicfieldeditor-section-body");return s.each(a,function(a,e){var f=s("<div>").addClass("nx-basicfieldeditor-item"),g=s("<div>").addClass("nx-basicfieldeditor-item-label").text(e.metadata.label).appendTo(f);e.mode=c,e.editable=e.metadata.editable,e.editor=b.editor,e.wrapperElement=f,e.labelElement=g,e.render(),f.append(e.element),d.append(f)}),d}function f(b,c){var e,f,g,h,i=c.model,j=b.attr("id"),k=b.attr("name"),l=b.attr("type"),m=b.attr("valuehalign"),n=b.attr("placeholder"),o={additionalClass:c.layoutClass,allowHTML:"true"===b.attr("allowhtml"),editable:"true"!==b.attr("readonly"),fieldId:j,fieldName:k,maxDisplayCharacters:b.attr("maxdisplaycharacters"),displayRows:b.attr("displayrows"),mode:c.mode||"read",pageSize:b.attr("pagesize")||5,register:!0,renderAs:b.attr("renderAs"),showLengthCounter:"true"===b.attr("showlengthcounter"),type:l,fieldXML:b},p=i.getField(k||j);if(j&&!p)return!1;if(p&&(e=p.displaytype),"CUSTOM"===l?o.snippet=b.attr("snippet"):"IMAGE"===l&&(o.editable=!1,o.url=b.children("url").first().text(),o.alt=b.children("alt").first().text(),o.height=b.attr("height"),o.fill="true"===b.attr("fill")),m&&(o.valueHorizontalAlignment="right"),"MULTIPICKLIST"===e?(o.maxSelected=b.attr("maxselected"),(f=b.attr("selectedlist"))&&(o.selectedList=parseInt(f,10))):-1!==s.inArray(e,["PICKLIST","REFERENCE"])?(o.addNoneOption="true"===b.attr("addnoneoption"),b.attr("nonelabel")&&(o.noneLabel=b.attr("nonelabel"))):-1!==s.inArray(e,["DOUBLE","CURRENCY","PERCENT"])?o.decimalPlaces=b.attr("decimalplaces"):v.startsWith(e,"DATE")&&(g=b.attr("monthpicker"),void 0!==g&&g&&(o.showMonthPicker="true"===g),h=b.attr("yearpicker"),void 0!==h&&h&&(o.showYearPicker="true"===h),o.showYearPicker&&(o.yearPickerRange=(b.attr("yearpickermin")||"c-10")+":"+(b.attr("yearpickermax")||"c+10")),e===y&&(o.minuteIncrement=parseInt(b.attr("minuteincrement")||"5",10))),"REFERENCE"===e){o.optionsource=b.attr("optionsource"),o.optionmodel=b.attr("optionmodel"),o.template=b.attr("displaytemplate"),o.searchTemplate=b.attr("searchtemplate"),o.tokenizeSearch=b.attr("tokenizesearch"),o.delimiter=b.attr("delimiter");var q=[],r=d(b.children("filters")),t=b.children("searchfields").first(),u=t.children(),w=o.defaultOrdering="true"===t.attr("defaultordering"),x=t.attr("orderby");r&&r.length&&(o.filters=r,s.each(r,function(){"dependent"===this.type&&q.push(this.depfield)}),q.length&&(o.controllingFields=q)),o.useSOSLSearch="true"===t.attr("usesosl"),o.SOSLFields=t.attr("soslfields"),!w&&x&&(o.order=x),u.length&&(o.searchFields=[],o.returnFields=[],u.each(function(){var b,c,d=s(this),e=d.attr("return"),f=d.attr("show"),g=d.attr("query"),h=d.attr("field"),i=!1,j=!1;"true"===g&&o.searchFields.push({id:h,searchOperator:d.attr("operator")}),void 0!==e?"true"===e&&(i=!0,"true"===f&&(j=!0)):"true"===f&&(i=!0,j=!0),i&&(b={id:h,showInSearchDialog:j},c=d.children("label").first(),c&&c.length&&(b.label=a.utils.getXML(c[0])),o.returnFields.push(b))}))}return b.children("enableconditions")&&(o.enableConditionsXML=b.children("enableconditions")),"true"===b.attr("required")&&(o.required=!0),n&&(c.row?o.placeholder=v.mergeAsText("row",n,{createFields:!0,registerFields:!1},i,c.row):o.placeholder=n),o}function g(a,b,c){a&&(a.css("opacity",1).show(),b.text(c))}function h(a,b,c,d){a&&(b.text(c),0===d?a.hide():a.animate({opacity:"0"},d||500,function(){a.hide()}))}function i(a){
return a.indexOf("sk-webicon")>-1}function j(b,c){c=c||{};var d=c.webIconClass||"",e=d+" "+(c.additionalClass||"");r||(r=a.themeSettings.getAll());var f=r&&r.iconMappings;if("PageBuilder"===a.page.name&&a.component.getByType("pagebuilder")[0]&&(f=a.component.getByType("pagebuilder")[0].get("iconMappings")||{}),b=r&&f&&f[b]||b,c.isWebIcon||i(b)){b=b.split("sk-webicon-").join("");var g=(b.split(":")[1]||b).split(/[_-]/).join(" "),h=b.split(":")[0];return'<i class="sk-webicon '+e+'" aria-label="'+g+'" role="img"><svg viewBox="0 0 24 24"><use xlink:href="'+a.platform.getIconsUrl()+h+"/"+h+".min.svg#"+b.split(":")[1]+'"></use></svg></i>'}return'<i class="sk-icon '+b+" "+e+'" aria-label="'+(c.ariaLabel||b.split("sk-icon-").join(""))+'" role="img"></i>'}function k(a,b,c){function d(){sforce.console.openPrimaryTab(null,a,!0,x(b))}function e(a,b,d){var g={tabsProcessed:0};a&&(g.numTabs=a.length,g.numTabs?s.each(a,function(a,h){sforce.console.getPageInfo(h,function(a){if("resolved"!==d.state())if(a.success){var i=JSON.parse(a.pageInfo);i&&c&&c(i)?(f={id:h},b&&(f.parentTabId=b),d.resolve()):b?sforce.console.getSubtabIds(h,function(a){if(a.success&&a.ids&&a.ids.length){var b=s.Deferred();e(a.ids,!1,b),s.when(b).then(function(){++g.tabsProcessed===g.numTabs&&d.resolve()})}else++g.tabsProcessed===g.numTabs&&d.resolve()}):++g.tabsProcessed===g.numTabs&&d.resolve()}else++g.tabsProcessed===g.numTabs&&d.resolve()})}):d.resolve())}if(a){var f,g=s.Deferred();sforce.console.getPrimaryTabIds(function(a){e(a.ids,null,g)}),s.when(g).then(function(){if(f){var a=f.parentTabId?f.parentTabId:f.id;sforce.console.focusPrimaryTabById(a,function(a){a.success?f.parentTabId&&sforce.console.focusSubtabById(f.id,function(){}):d()})}else d()})}}function l(a,b){k(a,b,function(b){return b&&v.endsWith(b.url,a)})}function m(a,b){k("/"+a,b,function(b){return b&&(b.objectId===a||a&&18===a.length&&b.objectId===a.substring(0,15))})}function n(b,c){var d=a.$M(x(c));m(b,d.getNameFieldValueForRow(d.getRowById(b)))}function o(b,c,d){var e=a.$M(x(c)),f=e?e.registeredFields[x(b)]:null;f&&"REFERENCE"===f.metadata.displaytype&&m(d,d||0===d?w(f.calculateReferenceText()):"")}function p(b,c,d,e,f){var g=b&&b.getDataSourceType(),h=g&&g.getReferenceHandler&&g.getReferenceHandler(),i=h&&h.coerceObjectName,j=b.getNameField(d);e||(e=[]),i&&(d=i(d,b));var k=new a.model.Model({dataSource:b,id:"_TempModel_"+(new Date).getTime(),objectName:d,fields:e.slice(),doQuery:!0,doClone:!1,recordsLimit:50,orderByClause:j});return h&&h.processReferenceLookupModel(k,c,d),f&&!k.fields.find(function(a){return a.id===f})&&(k.idFields=[f],k.fields.push({id:f})),j&&!k.fields.find(function(a){return a.id===j})&&(k.fields.push({id:j}),k.nameField=j),k.initialize(),k}function q(a){return a.querySelectorAll("button, [href], input, select, textarea, [tabindex]")}var r,s=a.$,t=s.extend,u=a.ui={},v=a.utils,w=v.encodeHTML,x=v.decodeHTML,y="DATETIME",z={ID:1,STRING:1,TEXT:1,EMAIL:1,PICKLIST:1,MULTIPICKLIST:1,COMBOBOX:1,PHONE:1,URL:1,REFERENCE:1,TEXTAREA:1};t(u,{createFieldSet:e,createIcon:j,getFieldOptionsFromXML:f,getFocusableElements:q,setStatus:g,hideStatus:h,isWebIcon:i,searchableDisplayTypes:z,openConsoleTabForField:o,openConsoleTabForNameField:n,openConsoleTabForUrl:l,openConsoleTabForRow:m,getReferenceLookupModel:p,isTouchDevice:b,_createLookupFiltersFromXML:d,_loadHammer:c})}(skuid),function(a){function b(b,d,e,h){var i,j,k=this;if(k._GUID=f.generateGUID(),k.row=b,k.model=d,k.editor=e,k.options=h||{},k.doNotRender=k.options.doNotRender,k.subComponents=[],k.id=h.fieldId,k.name=h.fieldName,k.context=h.fieldContext,k.messages=[],k.id&&(k.metadata=d.getField(k.name?k.name:k.id,k.context)),i=k.metadata,k.options.labelText?k.label=k.options.labelText:k.options.label?k.label=k.options.label:i&&(k.label=i.label),k.options.required||i&&i.required?k.required=!0:k.required=!1,k.mode=h.mode||"read",k.element=c("<div>").addClass("nx-field").attr("data-uid",k._GUID),h.additionalClass&&k.element.addClass(h.additionalClass),k.element.data("object",k),k.editable=(!i||d.isRowNew(b)&&i.createable||i.editable)&&!1!==k.options.editable&&"readonly"!==k.mode,k.loading=h.loading,k.options.register&&d.registerField(k),j=h.controllingFields,i&&-1!==c.inArray(i.displaytype,["PICKLIST","MULTIPICKLIST","COMBOBOX"])){var l,m=i.controllingField,n=d.getField("RecordTypeId"),o=i.picklistSourceModel;j||(h.controllingFields=j=[]),n&&j.push(n.id),m&&j.push(m),"rowsinmodel"===i.picklistSource&&a.$M(o)&&["row.updated","row.created","row.deleted","row.undeleted","models.cancelled","models.loaded","models.saved"].forEach(function(a){k.subscribeToEvent(a,function(a){l!==a&&(l=a,a.modelId===o?k.render():a.models&&c.each(a.models,function(b,d){if(d.id===o)return a.insertResults&&c.each(a.insertResults,function(a,b){if(k.row[k.id]===b.oldId){var c={};c[k.id]=b.id,d.updateRow(k.row,c)}}),k.render(),!1}))})})}if(j&&j.length&&c.each(j,function(){var a=this;-1!==a.indexOf(".")&&(a=a.split(".")[0]),d.registerField(k,a)}),k.editable&&d.isRelationshipField(k.id)){var p=d.getReferenceFieldNameFromRelationshipField(k.id);d.fieldsMap.hasOwnProperty(p)&&d.registerField(k,p)}i&&i.displaytype===g&&k.subscribeToEvent("ui.timeZoneChanged",function(){k.render()})}var c=a.$,d=c.extend,e=a.ui,f=a.utils,g="DATETIME";d(b.prototype,{uid:function(){return this._GUID},register:function(a){return this.model&&this.model.registerField(this,a),this},subscribeToEvent:function(b,c){var d,e=this,f=e._eventSubscriptions;return f||(f=e._eventSubscriptions=[]),d=a.events.subscribe(b,c),f.push(d),d},unregister:function(){var b=this,c=b.options,d=b._renderer;d&&(d.destroy&&d.destroy(b),delete b._renderer),b.model&&b.model.unregisterField(b,!!c&&c.controllingFields),["_eventSubscriptions","_ce_eventSubscriptions"].forEach(function(c){var d=b[c];d&&d.length&&d.forEach(function(b){a.events.unsubscribe(b)})})},calculateReferenceText:function(){return f.calculateReferenceText({model:this.model,row:this.row,template:this.options.template,fieldMetadata:this.metadata})},calculateReferenceMerges:function(a){return a||(a={}),f.calculateReferenceMerges(d(a,{model:this.model,row:this.row,template:this.options.template,fieldMetadata:this.metadata}))},getValidPicklistEntries:function(){var a=this,b=a.model.getDataSourceType(),d=a.metadata,e=d&&d.picklistEntries;return d?(b&&b.getValidPicklistEntriesSync&&(e=b.getValidPicklistEntriesSync(a)),d.deDupLabel&&c.each(a.row,function(b,d){a.metadata.id===b&&c.each(e,function(c,e){e.label===d&&(a.row[b]=e.value)})}),e):[]},getValidPicklistEntriesAccountingForDataSource:function(){var a=this,b=a.model.getDataSourceType();return b&&b.getValidPicklistEntries?b.getValidPicklistEntries(a):c.when().then(function(){return a.getValidPicklistEntries()})},addOrReplaceConditionsForLookupFiltersToModel:function(b){var d=this,e=[],g=!(!d.options||!d.options.filters)&&d.options.filters;return b||(b=d.model),g&&g.length&&c.each(g,function(g,h){var i,j,k=d.id+"_"+h.field+"_"+g,l=b.getConditionByName(k);if(l||(l=new a.model.Condition,l.name=k,b.addCondition(l)),l.field=h.field,l.operator=h.operator||"=",l.encloseValueInQuotes=h.encloseValueInQuotes,h.sourceParam&&(l.sourceParam=h.sourceParam),i=f.isMultiValueOperator(l.operator),"dependent"===h.type)j=d.model.getFieldValue(d.row,h.depfield,!0),void 0!==j&&(i?l.values=j&&-1!=j.indexOf(";")?j.split(";"):[j]:l.value=j),null===j||f.isUndefined(j)?(l.type="blank",l.value="null",l.encloseValueInQuotes=!1):l.type="fieldvalue";else if("userinfo"===h.type)delete l.type,l.value=f.getUserInfoPropValue(h.mergeField);else if("param"===h.type)j=a.page.params[h.mergeField],void 0!==j&&(i?l.values=j&&-1!=j.indexOf(";")?j.split(";"):[j]:l.value=j),l.type="fieldvalue";else if("modelmerge"===h.type){var m=a.model.getModel(h.mergeModel);if(m){i?(l.values=[],c.each(m.data,function(){l.values.push(m.getFieldValue(this,h.mergeField,!0))})):l.value=m.getFieldValue(m.getFirstRow(),h.mergeField,!0),delete l.type,l.model=h.mergeModel;var n=!(l.value!==undefined&&null!==l.value||l.values&&l.values.length);n&&"noquery"===h.noValueBehavior&&b&&(b.doQuery=!1),l.noValueBehavior=h.noValueBehavior}}else l.type=h.type,h.values?l.values=h.values:l.value=h.value,h.mergeField&&(l.mergeField=h.mergeField,l.originalValue=null);e.push(l)}),e},_getUpdateRowOptions:function(){return"edit"===this.mode?{initiatorId:this._GUID}:{}},_toggleModified:function(){var a=this,b=a.element,c=a.model,d=a.row,e=c.getRowId(d),f=a.name?a.name:a.id,g=f?c.getFieldValue(d,f,!0):null,h=c.originals[e];return b.removeClass("nx-modified"),(h&&f&&f in h&&h[f]!==g||c.isRowNew(d)&&!c.isAggregate)&&b.addClass("nx-modified"),a},render:function(b){function d(){m.removeClass("disabled").find(":input").prop("disabled",!1).end().find("[sk-contenteditabledisabled=true]").attr("contenteditable","true").removeAttr("sk-contenteditabledisabled").end().find(".ui-button").button("enable").end().find(".ui-multiselect").animate({opacity:"1.0"},function(){c(this).css("opacity","")}).siblings("select").multiselect("enable"),m.attr("sk-ckeditorname")&&(a.CKEDITOR.instances[m.attr("sk-ckeditorname")].setReadOnly(!1),m.find(".sk-cke-hide").remove()),l._toggleModified(),l.labelElement&&l.labelElement.animate({color:"rgba(0,0,0,1)"}),v&&(u=m.data(w),u&&"function"!=typeof u&&u!==v?(m.skootip(u),m.removeData(w)):m.tooltip("instance")&&m.tooltip("destroy")),h(!1),l.disabled=!1}function g(){if(m.removeClass("nx-modified").addClass("disabled").find(":input").prop("disabled",!0).end().find(".ui-button").button("disable").end().find("[contenteditable=true]").attr("sk-contenteditabledisabled","true").removeAttr("contenteditable").end().find(".ui-multiselect").animate({opacity:"0.4"}).siblings("select").multiselect("disable"),m.attr("sk-ckeditorname")){var b=m.attr("sk-ckeditorname");a.CKEDITOR.instances[m.attr("sk-ckeditorname")].setReadOnly(!0),0===m.find(".sk-cke-hide").length&&m.append('<style class="sk-cke-hide">#cke_'+b+"{display:none!important;}</style>")}if(l.labelElement&&l.labelElement.animate({color:"rgba(0,0,0,0.3)"}),v){if(m.tooltip("instance")){var d=m.tooltip("option","content");d&&"function"!=typeof d&&d!==v&&m.data(w,d)}m.skootip(v,{position:{my:x+" bottom",at:x+" top-10"},open:function(a,b){var d=c("<div>").addClass("sk-hastooltip").css(x,"0px");b.tooltip.append(d)}})}h(!0),l.disabled=!0}function h(a){l.editor&&l.editor.element._columnSettingsByUID&&c.each(l.editor.element._columnSettingsByUID,function(){this.fieldId==l.id&&(this.disabled=a)})}if(!this.doNotRender){var i,j,k,l=this,m=l.element,n=l.options,o=l.model,p=o.getDataSource().getFieldRenderers()||{},q=l.row,r=l.name?l.name:l.id,s=r?o.getFieldValue(q,r,!0):null,t=n.enableConditionsXML;if(m.empty(),l._toggleModified(),l.editable||(l.mode="readonly"),"edit"===l.mode&&l.required?m.addClass("required"):m.removeClass("required"),l.loading&&(l.mode="loading"),n&&"right"===n.valueHorizontalAlignment&&m.addClass("halignright"),l.metadata&&(k=l.metadata.displaytype),n.type&&(n.type in e.fieldRenderers||n.type in p)?i=e.getFieldRenderer(n.type,o.dataSource):k&&(k in e.fieldRenderers||k in p)&&(i=e.getFieldRenderer(k,o.dataSource)),j=l.mode,i||(i=e.getFieldRenderer("TEXT",o.dataSource)),!i||j in i||(j="read")in i||(i=e.getFieldRenderer("TEXT",o.dataSource)),l._renderer=i,i[j](l,s,b),t&&t.length&&t.children().length){var u,v=t.attr("message"),w="skuid__originalTooltip",x=n.valueHorizontalAlignment||"left",y=l._ce_eventSubscriptions;y?y.forEach(function(b){a.events.unsubscribe(b)}):y=l._ce_eventSubscriptions=[],l.editor&&l.editor.element._columnsByGUID&&c.each(l.editor.element._columnsByGUID,function(){this.fieldId==l.id&&(this.disabled=!1)}),"edit"===l.mode&&f.conditionallyDo(d,g,t,null,{row:q,model:o,eventSubscriptions:y,renderOverride:n.renderOverride})}l.messages.length&&l.editor&&l.editor.options&&l.editor.options.showErrorsInline&&c.each(this.messages,function(a,b){l.renderMessage(b)})}},destroy:function(a){var b=this.element,d=this.options,e=d&&d.subscriptionElement,g=!a||!1!==a.removeDOM;b&&!b.jquery&&(b=c(b)),e&&f.removeEventSubscriptions(e),this.unregister(),b&&g&&b.remove()},handleUpdate:function(a,b){this.handleChange(a,b)},handleChange:function(a,b){var d=this,e=d.model,f=d.row,g=e.getDataSourceType(),h=d.id,i=d.options,j=i.controllingFields;if(j&&j.length&&b&&-1!==c.inArray(b,j)){var k,l=!1,m=d.metadata&&-1!==c.inArray(d.metadata.displaytype,["PICKLIST","MULTIPICKLIST","COMBOBOX"]),n=e.getFieldValue(f,h,!0),o=function(a){a&&c.each(a,function(a,b){if(n===b.value)return l=!0,!1}),l||e.updateRow(f,h,"",{initiatorId:d.uid()})};if(m&&g.getValidPicklistEntries)return g.getValidPicklistEntries(d).then(function(a){o(a),d.render()});m&&(k=d.getValidPicklistEntries()),o(k)}d.render()},handleMessage:function(a){if(this.messages.push(a),this.doNotRender)return void(a.message=a.message?f.decodeHTML(a.message):"");this.editor&&this.editor.options&&this.editor.options.showErrorsInline&&this.renderMessage(a)},renderMessage:function(b){if(!this.doNotRender){this.errorElement||(this.errorElement=c("<div>"));var d=b.message;"REQUIRED_FIELD_MISSING"===b.status&&(d="This Field is Required"),this.editor.options.showErrorsOnHover?(this.element.children("input").addClass("input-with-error"),this.errorElement.skootip(a.utils.decodeHTML(d)),this.errorElement.addClass("sk-icon sk-icon-error sk-icon-inline-error nx-field-error-icon"),this.element.append(this.errorElement)):(this.errorElement.addClass("nx-error-inline").text(a.utils.decodeHTML(d)),this.element.prepend(this.errorElement),this.element.addClass("nx-field-error"))}},getParentPage:function(){return a.component.getById(this.getParentPageId())},getParentPageId:function(){for(var b=this,c=b.editor,d=b.element||[];!c&&d.length;)d=d.parent(),c=d.data("component");return c?c.getParentPageId():a.component.getByType("skuidpage")[0].id()},getReferenceOptions:function(b,d){if(d=d||{},!this.metadata||"REFERENCE"!==this.metadata.displaytype)throw'Can not retrieve reference options of a non "REFERENCE" type field';var f,g=this,h=c.Deferred(),i=d.referencedObject,j=g.metadata.dataSourceName?a.dataSource.getDataSource(g.metadata.dataSourceName):g.model.getDataSource(),k=j.getNameField(i),l=d.relMetadata||{},m=d.returnFields||g.options.returnFields||[],n=d.searchFields||g.options.searchFields||[{id:k,displaytype:"STRING",filterable:!0}],o=function(a){var b,c,d=j.dataSourceType.searchableDisplayTypes;for((!d||Object.keys(d).length<1)&&(d=e.searchableDisplayTypes),b=a.length-1;b>=0;b--)c=a[b],!g.metadata.uiOnly&&Object.keys(d).indexOf(c.displaytype)<0&&a.splice(b,1)},p=g.options,q=0,r=0;if(p.optionsource){if("model"===p.optionsource){if(!(f=a.$M(p.optionmodel)))return;c.each(n,function(a,b){var d=l.fields,e=b.id,f=d&&d.filter(function(a){return a.id===e})[0]||g.model.getField(u+e);f?(c.extend(b,f),b.id=e):b.displaytype="STRING"}),o(n);var s=g.addOrReplaceConditionsForLookupFiltersToModel(f),t=s&&s.length;f.conditions&&f.conditions.length&&f.conditions.forEach(function(a){"modelmerge"===a.type?f.updateConditionValue(a)&&(t=!0):"join"===a.type&&a.subConditions&&c.each(a.subConditions,function(a,b){"modelmerge"===b.type&&f.updateConditionValue(b)&&(t=!0)})}),"REFPICK"===p.type?t?f.updateData(function(){h.resolve(f)}):h.resolve(f):(f.buildSearchCondition("__default_searchbox",b,n,{tokenize:"true"===p.tokenizeSearch,useSOSLSearch:p.useSOSLSearch,SOSLFields:p.SOSLFields,delimiter:p.delimiter,searchOperator:"contains"}),f.updateData(function(){h.resolve(f)}))}}else{if(g.model){var u;u=g.metadata&&g.metadata.rel?g.metadata.rel+".":"",c.each(n,function(a,b){var d=l.fields,e=b.id,f=d&&d.filter(function(a){return a.id===e})[0]||g.model.getField(u+e);f?(c.extend(b,f),b.id=e):b.displaytype="STRING"})}o(n),f=a.ui.getReferenceLookupModel(j,g,i,m),q++,p.defaultOrdering?f.orderByClause="":p.order&&(f.orderByClause=p.order),g.addOrReplaceConditionsForLookupFiltersToModel(f),b&&f.buildSearchCondition("__default_searchbox",b,n,{tokenize:"true"===p.tokenizeSearch,useSOSLSearch:p.useSOSLSearch,SOSLFields:p.SOSLFields,delimiter:p.delimiter,searchOperator:"contains"});var v=q;f.load(function(){var a={};v>r?(r=v,a.isStale=!1):a.isStale=!0,a.isFinal=v===q,h.resolve(f,a)})}return h.promise()}}),d(e,{Field:b})}(skuid),function(a){function b(a,b,c){var e=this;d(e,{_GUID:f.generateGUID(),list:a,row:b,defaultMode:a.mode||"read",deleted:!1,selected:c.selected||!1,element:!1,fields:[],fieldsByGUID:[]}),e.mode=c.mode||e.defaultMode,a&&a.model&&a.model.registerItem(e)}var c=a.$,d=c.extend,e=a.ui,f=a.utils;d(b.prototype,{id:function(){return this._GUID},render:function(){var a,b=this,d=b.list,e=!!d&&d.views,f=d.currentView;return d&&e&&f&&(a=e[f],b.element&&b.element.remove(),b.element=c("<"+(a.itemNodeType||"div")+">").addClass("nx-item").data("object",b),a.render(b)),b},refreshFields:function(a){var b=this;return c.each(b.fields,function(){(b.mode!==this.mode||!a||this.id in a)&&(this.mode=b.mode,this.render())}),b},resetMode:function(){return this.mode!==this.defaultMode&&(this.mode=this.defaultMode),this},toggleEdit:function(){return"readonly"!==this.mode&&(this.mode="read"==this.mode?"edit":"read",this.refreshFields()),this},toggleDelete:function(a){var b=this;return b.deleted?b.unMarkForDelete(a):b.markForDelete(a),b},handleUnmarkRowForDeletion:function(a){var b=this,c=b.list.model,d=b.row,e=!!d&&c.getRowId(d),f=!!a&&c.getRowId(a);return!d||d!==a&&e!=f||b.unMarkForDelete(!1),b},handleMarkRowForDeletion:function(a){var b=this,c=b.list.model,d=b.row,e=!!d&&c.getRowId(d),f=!!a&&c.getRowId(a);return!d||d!==a&&e!=f||b.markForDelete(!1),b},unMarkForDelete:function(a){var b=this;return b.element.removeClass("deleted"),b.deleted=!1,a&&b.list.model.undeleteRow(this.row),b},markForDelete:function(a){var b=this;return b.element.addClass("deleted"),b.deleted=!0,a&&b.list.model.deleteRow(b.row),b},getFieldById:function(a){for(var b,c=0;c<this.fields.length;c++)if(b=this.fields[c],b.id===a)return b},registerField:function(a){this.fields.push(a),this.fieldsByGUID[a._GUID]=a},unregister:function(a){var b=this,d=b.fields,e=b.list;return e&&e.model&&e.model.unregisterItem(b),d&&d.length&&c.each(d,function(){this.destroy(a)}),b},destroy:function(){this.unregister({removeDOM:!1}),this.element&&this.element.remove()}}),d(e,{Item:b})}(skuid),function(a){function b(b,c,e){var j,k,l,m=this;if(m._GUID=g.generateGUID(),m.editor=b,m.model=c,m.options=e||{},m.views=e.views,m.mode=e.mode,m.showFooter=e.showFooter,m.filterCssClass=e.filterCssClass,m.personalizationService=e.personalizationService||e.component&&e.component.getPersonalizationService(),m.filtersPosition=e.filtersPosition||"top",m.filtersWidth=e.filtersWidth,m.component=e.component,j=m.personalizationService&&m.personalizationService.getSettings()._List||{},m.conditions=e.conditions,m.context=e.context,m.visibleItems=[],m.currentView=!1,m.views&&(k=Object.keys(m.views)),k&&(m.currentView=k[0]),k&&k.length>1){var n=j.lastViewId;d.each(m.views,function(a){if(a===n)return m.currentView=a,!1}),m.editor.header.append(m.makeViewSwitcher())}if(m.element=!1,m.contents=!1,m.conditionsBar=d("<div>").addClass("left"===m.editor.options.buttonPosition?"nx-conditioncontainer-left":"nx-conditioncontainer"),m.searchBox=!1,m.searchFields=e.searchFields||[],m.searchSubFields=e.searchSubFields||{},m.searchFieldsMap={},m.searchSubFieldsMap={},m.setupConfigPopup=e.setupConfigPopup,m.filters=[],m.searchFields&&m.searchFields.length){var o=m.searchFields;m.searchFields=[],d.each(o,function(a,b){m.addSearchField(b)})}if(m.searchSubFields&&a.utils.size(m.searchSubFields)>=1){var p=m.searchSubFields;m.searchSubFields={},d.each(p,function(a,b){d.each(b,function(b,c){m.addSearchSubField(a,c)})})}m.customFilter=e.customFilter||!1,m.customFilterValue=e.customFilterValue||"",m.searchMethod=e.searchMethod||i,m.searchConditionName=e.searchConditionName,m.searchPlaceholderText=e.searchPlaceholderText||null;var q=e.requiredFields;if(m.requiredFields=q&&g.size(q)?q:{},m.showFooter){m.footer=d("<div>").addClass("nx-list-footer"),m.footerleft=d("<div>").addClass("nx-list-footer-left").appendTo(m.footer),m.footercenter=d("<div>").addClass("nx-list-footer-center").appendTo(m.footer),m.footerright=d("<div>").addClass("nx-list-footer-right").appendTo(m.footer),m.currentPage=0;var r=e.pageSize;r&&("all"!=r?(e.pageSize=parseInt(e.pageSize,10),m.currentPageSize=j.pageSize||e.pageSize):m.currentPageSize="all")}m.editor.registerList(m),m.makeConditionsBar(),m.editor&&m.editor.header&&("left"===m.editor.options.buttonPosition?m.editor.headerLeft.append(m.conditionsBar):(m.editor.headerRight.prepend(m.conditionsBar),m.conditionsBar.addClass("nx-conditioncontainer-right")),m.options.showSearchBox&&!1===m.searchBox&&(m.searchBox=m.makeSearchBox(),m.searchBox&&m.editor.submitwrapper.append(m.searchBox)),m.options.showConfigIcon&&(m.listConfigButton=d("<button>"),m.listConfigButton.addClass("nx-button-list-config").skootip(m.options.configIconTip||""),d(f.createIcon(m.options.configIcon||"sk-icon-configure")).addClass("inline").appendTo(m.listConfigButton),m.listConfigButton&&m.editor.submitwrapper.append(m.listConfigButton),l=m.setupConfigPopup(m),m.listConfigButton.on("click",function(a){a.stopPropagation(),l()})),m.options.delayFilterExecution&&(m.applyFiltersBtn=d("<div>").addClass("sk-button-applyfilter").text(h("apply")).skooButton({icon:"sk-icon-search-go",disabled:!1,hoverText:h("apply")}).hide().on("click",function(){m.applyFiltersAndSearch()}),m.cancelFiltersBtn=d("<div>").addClass("sk-button-cancelfilter").text(h("cancel")).skooButton({icon:"sk-icon-cancel",disabled:!1,hoverText:h("cancel")}).hide().on("click",function(){m.cancelFiltersAndSearch()}),m.editor.submitwrapper.append(m.applyFiltersBtn,m.cancelFiltersBtn))),m.renderedItems={}}function c(a,b){var c=a.footerleft;return c&&c.find(".nx-list-loadmore").toggleClass("unavailable",b),a}var d=a.$,e=d.extend,f=a.ui,g=a.utils,h=a.$L,i="server";e(b.prototype,{id:function(){return this._GUID},unregister:function(){var a=this;return a.model&&a.model.unregisterList(a),a.removeModelListeners(),a.renderedItems&&d.each(a.renderedItems,function(){this.unregister&&this.unregister()}),a},getSelectedItems:function(){var a=[];return d.each(this.renderedItems,function(b,c){c.selected&&a.push(c)}),a},unSelectAll:function(){d.each(this.renderedItems,function(a,b){b.selected&&(b.selected=!1)})},isFieldSearchable:function(a){if(!a)return!1;var b,c=this.model.dataSource;return c&&(b=c.dataSourceType.searchableDisplayTypes),(!b||Object.keys(b).length<1)&&(b=f.searchableDisplayTypes),a.displaytype in b&&(a.filterable||"client"===this.searchMethod)},addSearchField:function(a,b){var c=this;if(a){var d,f=c.model.getField(a.id);c.isFieldSearchable(f)&&(f.id in c.searchFieldsMap||(d=e({},f),b&&(d.searchOperator=b),c.searchFields.push(d),c.searchFieldsMap[f.id]=d))}},addSearchSubField:function(a,b){var c=this;if("object"==typeof b&&(b=b.id),a&&b){var d=c.model.getField(b,a);if(c.isFieldSearchable(d)){var e=c.searchSubFieldsMap[a],f=c.searchSubFields[a];e||(e=c.searchSubFieldsMap[a]={},f=c.searchSubFields[a]=[]),d.id in e||(e[d.id]=1,f.push(d))}}},addRequiredField:function(a){var b=a._id||a.id;this.requiredFields[b]=a},removeRequiredField:function(a){var b=a._id||a.id;delete this.requiredFields[b]},validateRequiredFields:function(){var a=this,b=[],c=a.model,e=a.requiredFields;return d.each(c.changes,function(f){var i=c.getRowById(f);if(!c.isRowMarkedForDeletion(i)){var j={severity:"ERROR",status:"REQUIRED_FIELD_MISSING",fields:[],model:c},k="",l=!1;i&&f in a.renderedItems&&d.each(e,function(a,b){var d=b.id,e=b.label,h=c.getFieldValue(i,d,!0);(""===h||null===h||g.isUndefined(h))&&"BOOLEAN"!==b.displaytype&&(k&&(k+=", "),k+="["+e+"]",j.fields.push({id:d,label:e}),j.rowId=f,l=!0)}),l&&(j.message=h("required_fields_have_no_value")+" "+k,b.push(j))}}),b},getView:function(a){return a||(a=this.currentView),this.views[a]},callViewOperation:function(a,b){b||(b=this.getView()),b&&a&&a in b&&b[a](this)},setUp:function(a){this.callViewOperation("setUp",a)},beforeRender:function(a){this.callViewOperation("beforeRender",a)},renderComplete:function(a){this.callViewOperation("renderComplete",a)},tearDown:function(a){this.callViewOperation("tearDown",a)},getAllRows:function(){var a=this,b=a.model,c=b&&b._clientData||b.getRows(a.conditions,a.context),d=a.customFilter,e=a.customFilterValue;return d&&(e||"0"===e)&&(c=c.filter(function(a){return d(e,a)})),c},getRenderedItemByRowId:function(a){return this.renderedItems[a]},render:function(b){function c(a,b){V[b]||(V[b]=1,q&&a.resetMode(),r&&(o&&o[b]?a.refreshFields(o[b]):a.refreshFields()))}b=b||{};var e,f=this,g=f.model,i=f.options,j=[],k=b.previousView||!1,l=k&&k!==f.currentView,m=f.getView(),n=!f.element||b.doNotCache||m.alwaysFullRender,o=b.changedRows,p=!1!==this.options.showLoadMore,q=!0===b.resetItemModes,r=!1!==b.refreshFields,s=g.getConditionByName(f.searchConditionName||"__default_searchbox");if(f.searchbox&&s&&("group"===s.type||"search"===s.type))if(b.initiatorId&&b.initiatorId===f._GUID);else{var t;if(s.value&&"search"===s.type)if(f.options.tokenizeSearch){t="";var u=s.value.split(" AND ");d.each(u,function(a,b){t+=b.substring(1,b.length-2)+" "}),t.substring(0,t.length-1)}else t=s.value.substring(1,s.value.length-2);else t=s.value;t&&!s.inactive?(f.searchbox.val(t),f.searchbox.data("curval",t)):(f.searchbox.val(""),f.searchbox.data("curval",""))}m.alwaysFullRender&&(b.doNotCache=!0),l&&(k=f.getView(k))&&f.tearDown(k),b.resetPagination&&(f.currentPage=0),e=f.getAllRows();var v=e.length,w=f.currentPageSize,x=0,y=v;f.footer&&f.showFooter&&(f.footerleft.empty(),f.footercenter.empty(),f.footerright.empty()),f.element&&!l||(f.element&&f.element.remove(),f.element=d("<"+(m.nodeType||"div")+">").addClass("nx-list"),f.contents=d("<"+(m.contentsNodeType||"div")+">").addClass("nx-list-contents").appendTo(f.element),i.labeledBy&&f.element.attr("aria-labeledby",i.labeledBy),f.setUp(m));var z=a.utils.makeXMLDoc,A=f.filtersPosition;if("left"!==A&&"right"!==A||!f.component)"bottom"===A&&f.element.append(f.conditionsBar.css({display:"block","float":"none"}).addClass("nx-conditioncontainer-bottom"));else{if(!f.panelSet){var B=z("<panelset/>").attr("type","standard").append(z("<panels/>").append(z("<panel/>"),z("<panel/>").attr({type:A,width:f.filtersWidth})));f.panelSet=a.$("<div>").panelSet(B,f.component)}f.conditionsBar.css({"float":A,"text-align":A})}if(f.showFooter&&w&&"all"!=w&&v>w){f.currentPage<0&&(f.currentPage=0);var C=Math.ceil(v/w);f.currentPage>C-1&&(f.currentPage=C-1),x=w*f.currentPage,y=w*(f.currentPage-0+1),f.currentPage==C-1&&(y=v),e=e.slice(x,y);var D=d("<div>").addClass("nx-buttonset"),E=d("<div>").addClass("first").text(h("first")).button(),F=d("<div>").addClass("prev").text(h("previous")).button(),G=d("<div>").addClass("next").text(h("next")).button(),H=d("<div>").addClass("last").text(h("last")).button(),I=f.currentPage<C-3?f.currentPage-2:C-5,J=f.currentPage>2?f.currentPage+2:4;D.append(E,F);for(var K=I;K<=J;K++)if(K>=0&&K<C){var L=d("<div>").text(K-0+1).attr("data-pn",K).button();K===f.currentPage&&L.addClass("nx-button-selected"),D.append(L)}D.append(G,H).buttonset(),D.children().filter('[data-pn="'+f.currentPage+'"]').button("disable"),0===f.currentPage?(E.button("disable"),F.button("disable")):f.currentPage==C-1&&(H.button("disable"),G.button("disable")),this.footerright.append(D),D.on("click",".ui-button",function(a){a.stopPropagation();var b=d(this);b.is(".first")?f.goToPage(0):b.is(".prev")?f.prevPage():b.is(".next")?f.nextPage():b.is(".last")?f.goToPage(C-1):f.goToPage(parseInt(b.data("pn"),10))})}if(f.showFooter&&w&&"all"!=w&&v){var M=[5,10,25,50];-1==M.indexOf(i.pageSize)&&M.push(i.pageSize),-1==M.indexOf(f.currentPageSize)&&M.push(f.currentPageSize);var N=function(a,b){return a-b};M.sort(N);var O=d("<select>");O.on("click",function(a){a.stopPropagation()}),O.append(d.map(M,function(a){return d('<option value="'+a+'">'+a+"</option>")})),O.children().filter('[value="'+w+'"]').attr("selected","selected"),O.change(function(){var a=parseInt(d(this).val(),10);f.personalizationService&&f.personalizationService.updateSettings({_List:{pageSize:a}}),f.currentPageSize=a,f.render()});var P=d("<span>");P.append("<span>"+h("show")+" </span>",O,"<span> "+a.label.merge(h("objects_per_page"),g.labelPlural)+"</span>"),this.footerleft.append(P)}var Q=h("pagination_limit_reached"),R=g.debug===Q,S=!0===g.canRetrieveMoreRows;if(f.showFooter){if(v){var T=v+"";S&&(T+="+"),this.footercenter.append("<span>"+a.label.merge(h("showing_rows"),x+1,y,T)+(R?" ("+Q+")":"")+"</span>")}if(S&&!R&&p){var U=d('<div class="nx-list-loadmore" role="button">').text(h("load_more")).on("click.skuid",function(){d(this).is(".unavailable")||(f.blockUI({message:h("loading")}),g.loadNextOffsetPage(function(){f.unblockUI()}))});this.footerleft.append(U)}v||(g.needsMetadataLoad&&g.loadAsync&&!g.doQuery?this.footercenter.append("<span>Loading Metadata for: "+g.label+"</span>").css("line-height","25px"):g.needsMetadataLoad&&g.loadAsync?this.footercenter.append("<span>Loading: "+g.label+"</span>").css("line-height","25px"):this.footercenter.append("<span>"+a.label.merge(h("no_objects_to_display"),g.labelPlural)+"</span>").css("line-height","25px"))}b.doNotCache&&(d.each(f.renderedItems,function(a,b){b&&b.destroy()}),f.renderedItems={},f.makeConditionsBar()),f.beforeRender(m),f.visibleItems=[],!0===b.destroyDeletedRows&&d.each(f.renderedItems,function(a,b){var c=g.record(a);!b||c&&!c.isMoribund()||(b.destroy(),delete f.renderedItems[a])});var V={};d.each(e,function(){var a=this,d=g.getRowId(a),e=g.record(d),h=f.renderedItems[d];h&&!b.doNotCache?c(h,d):h=f.newItem(this,b),h&&(h.element[(e.isMoribund()?"add":"remove")+"Class"]("deleted"),j.push(h.element),f.visibleItems.push(h))}),!b.doNotCache&&q&&f.getAllRows().forEach(function(a){var b=g.getRowId(a),d=f.renderedItems[b];d&&c(d,b)}),m.noAutoAppend||(f.contents.children().detach(),f.contents.append(j)),n&&f.attach(),f.renderComplete(m)},showRow:function(a){var b=this,c=!0;return b.conditions&&b.conditions.length&&(c=g.doesRowMeetConditions(a,b.conditions)),c},handleNewRow:function(a,b){var c=this,d={},f=c.model.getRowId(a);if(b&&e(d,b),!g.isUndefined(f)&&!(f in c.renderedItems)&&c.showRow(a)){var h=c.newItem(a,d);if(c.contents.prepend(h.element),c.render({resetPagination:!0,refreshFields:!1}),h&&"edit"===h.mode){var i=h.element.find(".nx-field > :input:visible:not(.nx-skootable-rowselect):not(.hasDatepicker):not(select)").first();i&&i.focus()}}},handleRowDeletion:function(a){a&&a in this.renderedItems&&this.renderedItems[a].destroy()},newItem:function(a,b){var c,d=this,e=d.model.getRowId(a);if(e)return c=new f.Item(d,a,{mode:b&&b.editModeForNewItems?"edit":d.mode,selected:b&&b.selected}),c.render(),d.renderedItems[e]=c,c},attach:function(){var a=this;"right"===a.filtersPosition||"left"===a.filtersPosition?(a.panelSet.find(".nx-panel-fluid .nx-panel").append(a.element,a.footer),a.panelSet.find(".nx-panel-left-inner, .nx-panel-right-inner").append(a.conditionsBar),a.editor.contents.append(a.panelSet)):this.editor.contents.append(this.element,this.footer)},makeViewSwitcher:function(){var b=this,c=[];return d.each(b.views,function(a,d){c.push({value:a,label:d.label||a,icon:d.icon,isSelected:b.currentView===a})}),d("<div>").actionSelect({items:c,onItemSelect:function(c){var e=b.currentView;b.currentView=c.value,b.render({doNotCache:!0,previousView:e}),d.cookie("nx-list-view-"+a.page.name+"-"+b.model.id,c.value),b.personalizationService&&b.personalizationService.updateSettings({_List:{lastViewId:c.value}})}}).addClass("nx-viewswitcher")},makeSearchBox:function(){var a=this;if("client"===a.searchMethod&&(a.customFilter=function(b,c){var e=!1,f=b.toLowerCase(),h=function(b,c){var d,h=b.searchOperator,i=a.model.getFieldValue(c,b.id,!0)+"";null!==i&&(d=i.toLowerCase(),e="="===h?d===f:"starts with"===h?g.startsWith(d,f):g.contains(d,f))};return d.each(a.searchFields,function(a,b){return h(b,c),!e}),
!e&&a.searchSubFields&&d.each(a.searchSubFields,function(a,b){var f=c[a];f&&f.totalSize&&b.length&&d.each(f.records,function(a,c){return d.each(b,function(a,b){return h(b,c),!e}),!e})}),e}),a.searchFields||"custom"===a.searchMethod){var b="placeholder"in document.createElement("input"),c=d('<input type="text" class="searchbox" />'),e=a.searchPlaceholderText?g.mergeAsText("model",a.searchPlaceholderText,{createFields:!0,registerFields:!1},a.model):h("search")+" "+a.model.labelPlural;return a.customFilterValue&&c.val(a.customFilterValue),a.searchbox=c,b?c.attr("placeholder",e):(c.addClass("unchanged").val(e),c.focus(function(){c.hasClass("unchanged")&&c.val("").removeClass("unchanged")}).blur(function(){""===c.val()&&c.val(e).addClass("unchanged")})),a.options.delayFilterExecution&&c.on("keyup",function(b){13===b.which&&a.applyFiltersAndSearch()}),g.delayInputCallback(c,function(b,d){a.options.delayFilterExecution&&void 0===c.data("originalValue")&&c.data("originalValue",d),"client"===a.searchMethod||"custom"===a.searchMethod?(a.customFilterValue=b,a.render()):a.options.delayFilterExecution?a.showFilterActions():(a.setSearchCondition(b),"remove"!==a.options.emptySearchBehavior||b?a.updateData({message:h("searching"),failmessage:h("error_performing_requested_search"),showerror:!0}):a.model.emptyData())},{dataPropertyName:"curval"}),c.on("click",function(a){a.stopPropagation()}),c}return!1},setSearchCondition:function(a){var b=this;b.model.buildSearchCondition(b.searchConditionName,a,b.searchFields,{tokenize:b.options.tokenizeSearch,useSOSLSearch:b.options.useSOSLSearch,SOSLFields:b.options.SOSLFields})},showFilterActions:function(){var a=function(a){a.show("fast").css({display:"inline-block"})};a(this.applyFiltersBtn),a(this.cancelFiltersBtn),this.editor.options.showSaveCancel&&this.editor.submitbuttons.hide("fast");var b=d(".sk-pagepanel.filters-panel");return b.length&&(a(b.find(".sk-button-applyfilter")),a(b.find(".sk-button-cancelfilter"))),this},hideFilterActions:function(){this.applyFiltersBtn.hide("fast"),this.cancelFiltersBtn.hide("fast"),this.editor.options.showSaveCancel&&this.editor.submitbuttons.show("fast").css("display","inline-block");var a=d(".sk-pagepanel.filters-panel");return a.length&&(a.find(".sk-button-applyfilter").hide("fast"),a.find(".sk-button-cancelfilter").hide("fast"),this.editor.submitbuttons.css("display","inline-block")),this},applyFiltersAndSearch:function(){var a,b=this,c=b.searchBox;return c&&(a=c.is(".unchanged")?"":c.val(),c.data("originalValue",a),b.setSearchCondition(a)),b.filters&&d.each(b.filters,function(){var a=this.activateFilter;a&&a()}),"remove"!==b.options.emptySearchBehavior||a?b.updateData({message:h("searching"),failmessage:h("error_performing_requested_search"),showerror:!0,successcallback:function(){b.hideFilterActions()}}):(b.model.emptyData(),b.hideFilterActions()),b},cancelFiltersAndSearch:function(){var a=this,b=a.searchBox;return b&&b.val(b.data("originalValue")),a.filters&&d.each(a.filters,function(){this.restoreOriginalValue()}),a.hideFilterActions(),a},updateData:function(a){var b=this;return b.blockUI({message:a.message}),b.model.updateData(!1,{initiatorId:b._GUID}).always(function(){b.unblockUI()}).done(function(){b.editor.clearMessages(),a.successcallback&&a.successcallback()}).fail(function(c){b.editor.clearMessages(),b.editor.handleMessages([{message:a.failmessage+(a.showerror&&c?" "+c:""),severity:"ERROR"}])}),b},makeConditionsBar:function(){this.makeFiltersBar()},enableFiltersAndSearch:function(){var a=this;return a.conditionsBar&&a.conditionsBar.find(".nx-conditiontoken").removeClass("unavailable").children(".ui-multiselect").siblings("select").multiselect("enable").end().children("input").prop("disabled",!1),a.searchMethod===i&&a.searchBox&&a.searchBox.prop("disabled",!1),a},disableFiltersAndSearch:function(){var a=this;return a.conditionsBar&&a.conditionsBar.find(".nx-conditiontoken").addClass("unavailable").children(".ui-multiselect").siblings("select").multiselect("disable").end().children("input").prop("disabled",!0),a.searchMethod===i&&a.searchBox&&a.searchBox.prop("disabled",!0),a},enableLoadMore:function(){return c(this,!1)},disableLoadMore:function(){return c(this,!0)},blockUI:function(a){var b=this;a=a||{};var c={message:a.message};b.options.blockUICSS&&(c.css=b.options.blockUICSS),b.options.blockOverlayCSS&&(c.overlayCSS=b.options.blockOverlayCSS),b.editor.element.block(c)},unblockUI:function(a){var b=this;a=a||{};var c={};a.failmessage?(b.options.blockUICSS&&(c.css=b.options.blockUICSS),b.options.blockOverlayCSS&&(c.overlayCSS=b.options.blockOverlayCSS),c.timeout=a.timeout||4e3,c.message=a.failmessage,b.editor.element.block(c)):b.editor.element.unblock()},addModelListeners:function(){var a=this,b=a.modelListeners,c={},d=g.debounce(function(){a.makeFiltersBar()},1);return b||(b=a.modelListeners=[]),a.filters.forEach(function(a){a.sources&&a.sources.forEach(function(a){var e=a.model;e&&!c[e.id]&&(c[e.id]=1,["cancelled","loaded","saved","row.updated","row.created"].forEach(function(a){b.push(e.subscribe(a,d))}))})}),a},removeModelListeners:function(){var a=this.modelListeners;return a&&(a.forEach(function(a){a.unsubscribe()}),a.length=0),this},makeFiltersBar:function(){var a,b=this,c=b.options.listFilters,e=c&&c.closest("filterset"),g="right"===b.filtersPosition||"left"===b.filtersPosition;return b.removeModelListeners(),b.filters&&b.filters.length?(b.filters.forEach(function(a){a.unregister()}),b.filters.length=0):b.filters=[],!!c&&(a=b.conditionsBar,a.empty(),d.each(c.children(),function(c){var h=new f.Filter({xml:d(this),list:b,selectedList:e.length&&"vertical"===e.attr("layout")?2:3,cssClass:b.filterCssClass});h&&h.element&&(g&&0!==c&&a.append("<br>"),a.append(h.element),h.multiSelectMaxWidth&&h.multiSelectMaxWidth()),b.filters.push(h)}),b.addModelListeners(),g&&a.addClass("nx-conditioncontainer-vertical nx-conditioncontainer-vertical-"+b.filtersPosition),a)},nextPage:function(){this.currentPage++,this.render({refreshFields:!1})},prevPage:function(){this.currentPage--,this.render({refreshFields:!1})},goToPage:function(a){this.currentPage=a,this.render({refreshFields:!1})}}),e(f,{List:b})}(skuid),function(a){function b(a,b){var e=this,g=[];b=e.options=d({showHeader:!0,showFooter:!1,showMessages:!0,showErrorsInline:!0,showErrorsOnHover:!1},b),e._GUID=f.generateGUID(),e.models=[],e.modelsById={},e.lists=[],a&&(e.element=a.addClass("nx-editor"),b.showHeader&&(e.header=c("<div>").addClass("nx-editor-header"),e.headerLeft=c("<div>").addClass("nx-header-left").appendTo(e.header),e.headerRight=c("<div>").addClass("nx-header-right").appendTo(e.header),e.submitwrapper=c("<div>").addClass("nx-editor-header-submitwrapper"),["block","center"].indexOf(b.buttonPosition)>-1?(e.submitwrapper.appendTo(e.header),"center"===b.buttonPosition&&e.header.addClass("nx-header-center")):e.submitwrapper.appendTo("left"===b.buttonPosition?e.headerLeft:e.headerRight),e.status=c('<div class="nx-status">').appendTo(e.header).hide(),e.statustext=c('<div class="nx-status-text"></div>').appendTo(e.status),g.push(e.header),b.heading&&(e.headingElement=c("<h2>").attr("id",f.generateUniqueId()).addClass("nx-editor-header-heading").append(b.heading),e.headerLeft.prepend(e.headingElement))),b.showMessages&&(e.messages=c('<div class="nx-messages">'),g.push(e.messages)),e.contents=c("<div>").addClass(b.customContentClass?b.customContentClass:"nx-editor-contents"),g.push(e.contents),b.showFooter&&(e.footer=c("<div>").addClass("nx-editor-footer"),e.footerSubmitWrapper=c("<div>").addClass("nx-footer-"+(b.buttonPosition||"right")).appendTo(e.footer),e.footerStatus=c('<div class="nx-status">').appendTo(e.footer).hide(),e.footerStatusText=c('<div class="nx-status-text"></div>').appendTo(e.footerStatus),g.push(e.footer)),e.element.append(g),e.element.data("editor",e))}var c=a.$,d=c.extend,e=a.ui,f=a.utils,g=a.$L,h=a.$.ui.keyCode,i=f.decodeHTML;b.prototype={id:function(){return this._GUID},registerModel:function(a){if(!a)return this;var b=this,d=b.modelsById,e=!a.hasChanged;return d[a.id]||(b.models.push(a),d[a.id]=a,a.registerEditor(b),b.options.showSaveCancel&&!b.submitbuttons&&(b.savebutton=c("<div>").addClass("sk-button-save").text(g("save")).skooButton({icon:b.options.saveIcon||"sk-icon-save",disabled:e}),b.cancelbutton=c("<div>").addClass("nx-button-secondary sk-button-cancel").text(g("cancel")).skooButton({icon:b.options.cancelIcon||"sk-icon-cancel",disabled:e}),e?(b.savebutton.attr("tabindex",-1),b.cancelbutton.attr("tabindex",-1)):(b.savebutton.attr("tabindex",0),b.cancelbutton.attr("tabindex",0)),b.savebutton.on("click.skuid keydown.action.skuid",function(a){"click"===a.type&&a.stopPropagation(),"click"!==a.type&&a.which!==h.ENTER&&a.which!==h.SPACE||(c(this).removeClass("ui-state-hover"),b.submitbuttons&&b.submitbuttons.filter(".ui-button").button("disable").removeAttr("tabindex"),b.save())}),b.cancelbutton.on("click.skuid keydown.action.skuid",function(a){"click"===a.type&&a.stopPropagation(),"click"!==a.type&&a.which!==h.ENTER&&a.which!==h.SPACE||(c(this).removeClass("ui-state-hover"),b.submitbuttons&&b.submitbuttons.filter(".ui-button").button("disable").removeAttr("tabindex"),b.cancel())}),b.options.showHeader&&(b.submitbuttons=b.savebutton.add(b.cancelbutton),b.submitwrapper.append(b.savebutton,b.cancelbutton)))),b},registerList:function(a){this.lists.push(a),this.registerModel(a.model)},unregister:function(){var a=this;return a.lists&&a.lists.length&&c.each(a.lists,function(){this.unregister&&this.unregister()}),a.models&&a.models.length&&c.each(a.models,function(){this.unregisterEditor(a)}),a},getParentPage:function(){return a.component.getById(this.getParentPageId())},getParentPageId:function(){for(var b=this,c=b.options,d=c.parentComponent,e=b.element||[];!d&&e.length;)e=e.parent(),d=e.data("component");return d?(c.parentComponent||(c.parentComponent=d),d.getParentPageId()):a.component.getByType("skuidpage")[0].id()},hasModelWithChanges:function(){var a=this,b=!1;return c.each(a.models,function(){if(this.hasChanged)return b=!0,!0}),b},handleChange:function(){var a=this;a.submitbuttons&&a.submitbuttons.filter(".ui-button").button("enable").attr("tabindex",0),a.lists.length&&c.each(a.lists,function(a,b){b.disableFiltersAndSearch().disableLoadMore()})},clearMessages:function(){this.messages&&this.messages.empty(),this._uniqueMessages={}},clearInlineErrors:function(){var a=this;a.element&&a.element.find(".nx-error-inline").remove().end().find(".nx-field-error").removeClass("nx-field-error nx-field-error-icon")},handleMessages:function(a,b){var d=this,e=d._uniqueMessages;return e||(e=d._uniqueMessages={}),!!d.messages&&((!b||!b.initiatorId||d._GUID===b.initiatorId)&&void c.each(a,function(a,b){var f,g,h,j,k="nx-message",l=b.message;"ERROR"===b.severity||"FATAL"===b.severity?k="nx-error":"WARNING"===b.severity&&(k="nx-warning"),f=e[k],f||(f=e[k]={}),g=f[l],g?g.count++:g=f[l]={count:1},g.element?j=g.element:(j=g.element=c("<div>").addClass(k),"DUPLICATE_VALUE"===b.status?j.append(l):j.append(c("<div>").text(i(l))),j.on("click.skuid",function(){c(this).remove()}),d.messages.append(j)),g.count>1&&(h=j.children(".nx-dupcounter"),h.length?h.text(g.count):j.prepend('<div class="nx-dupcounter" style="">'+g.count+"</div>"))}))},handleCancel:function(){var a=this,b=!1,d={};c.each(a.models,function(a,c){c.hasChanged&&(b=!0,d[c.id]=!0)}),!1===b&&(a.clearMessages(),a.submitbuttons&&a.submitbuttons.filter(".ui-button").button("disable")),a.lists.length&&c.each(a.lists,function(a,b){!b.model||b.model.id in d||b.enableFiltersAndSearch().enableLoadMore()})},handleSave:function(a){var b=!1,d={},e=this;c.each(e.models,function(a,c){c.hasChanged&&(b=!0,d[c.id]=!0)}),a?e.hideStatus(g("saved")):e.hideStatus("",0),e.clearMessages(),a&&!b&&e.submitbuttons&&e.submitbuttons.filter(".ui-button").button("disable"),!a&&b&&e.submitbuttons&&e.submitbuttons.filter(".ui-button").button("enable"),e.lists.length&&c.each(e.lists,function(a,b){!b.model||b.model.id in d||b.enableFiltersAndSearch().enableLoadMore()})},cancel:function(){a.model.cancel(this.models,{initiatorId:this._GUID})},save:function(b){b=b||{};var c="rollbackOnAnyError";!(c in b)&&c in this.options&&(b[c]=this.options[c]),this.setStatus(g("saving")),b.initiatorId=this._GUID,a.model.save(this.models,b)},setStatus:function(b){a.ui.setStatus(this.status,this.statustext,b)},hideStatus:function(b,c){a.ui.hideStatus(this.status,this.statustext,b,c)},createConditionsFromXml:function(b,c){if(b){var d,e=this.conditions,f=0;if(e||(e=this.conditions=[]),(d=c?c.createConditionsFromXml(b):a.component.Component.prototype.call(this,b))&&d.length)for(;f<d.length;f++)e.push(d[f]);else d=[];return d}},addConditions:function(a){var b=this;a&&a.length&&(b.conditions||(b.conditions=[]),c.each(a,function(a,c){b.conditions.push(c)}))},getConditions:function(){return this.conditions}},d(e,{Editor:b})}(skuid),function(a){function b(a,b){var c=a.options&&a.options.addfocusbox;a.element.html('<div class="nx-fieldtext">'+b+(c?'<div class="focusbox" tabindex="0"/>':"")+"</div>")}function c(a){var b,c=a.model,d=a.row,e=c.getFieldValue(d,a.id),f=c.objectName,g=c.getNameFieldValueForRow(d);window.sforce&&sforce.interaction&&window.sendCTIMessage&&(b=window.sendCTIMessage),b&&b("/CLICK_TO_DIAL?DN="+encodeURIComponent(e)+(d.Id?"&ID="+d.Id:"")+"&ENTITY_NAME="+f+"&OBJECT_NAME="+encodeURIComponent(g))}function d(a,b){var c=a.metadata;return c&&c.displaytype&&-1!=o.inArray(c.displaytype,ea)?b:A(b)}function e(a){var b=a.options;return b&&b[C]||a.metadata[C]}function f(a,b){return r.mergeAsTextInContext(a||z("select_option_none"),b||{})}function g(b,c,d){function e(b,c,e){var f=o("<div>").addClass("nx-radiowrapper"),g=a.utils.generateGUID(),h=o('<input type="radio" name="'+d.buttonSetName+'">').addClass("nx-radio").prop("id",g).prop("checked",e).prop("disabled","read"===d.mode||"readonly"===d.mode).val(b),i=o("<label>").prop("for",g).addClass("nx-radiolabel").html(A(c)).appendTo(f);return f.append(h,i),f}var g=!1,h=[];if(d.makeNoneOption&&h.push(e("",f(d.noneLabel),!b)),o.each(c,function(a,c){if(c.value){var d=c.value==b&&""!==c.label;d&&!g&&(g=!0),h.push(e(c.value,c.label,d))}}),!g&&(b||"0"===b||"false"===b)){var i=e(b,b,!0);d.makeNoneOption?h.splice(1,0,i):h.unshift(i)}return h}function h(a){a||(a={});var b,c=a.value,d=r.userLocale,e=a.decimalPlaces||0,f=a.decimalsSeparator||d.decimalsSeparator,g=a.thousandsSeparator||d.thousandsSeparator,h=a.prefix||"",i=a.suffix||"";return c||0===c||(c=""),b=""!==c&&o.isNumeric(c)?isFinite(c)?h+o.number(c,e,f,g)+i:"-":c,a.wrapInElement?o("<div>").text(b):b}function i(a){var b={},c=function(c,d){var e=a[c];void 0!==e&&(b[d]=e)};return c("showYearPicker","changeYear"),c("showMonthPicker","changeMonth"),c("yearPickerRange","yearRange"),b}function j(a,b){var c,d;return c=o('<div class="nx-field-lengthcounter"></div>'),d=function(a){c.text(+a+"/"+b.length),a>b.length?c.addClass("nx-field-lengthcounter-error"):c.removeClass("nx-field-lengthcounter-error")},d(b.value?b.value.length:0),a.append(c),d}function k(b){b||(b={});var c,d=a.platform;c=r.isString(b)?b:b.displayType;var e=d.getRenderers&&d.getRenderers();return e&&c in e?e[c]:c in m?m[c]:void 0}function l(a,b){a||(a={});var c,d,e;r.isString(a)?(c=a,d=b):a instanceof q.Field||r.isString(b)?(e=a,c=b):a.displayType&&(c=a.displayType,d=a.dataSource,e=a.field),!d&&e&&(d=e.model.getDataSource()),!c&&e&&(c=e.metadata.displaytype);var f=d&&d.getFieldRenderers();return f&&c in f?f[c]:c in n?n[c]:(r.log('Unable to find an appropriate renderer for "'+c+'"',p.LOG_LEVELS.WARNING),n[Z])}var m,n,o=a.$,p=a.constants,q=a.ui,r=a.utils,s=a.time,t=p.DISPLAY_TYPES,u=p.FIELD_TYPES,v=s.parseSFDate,w=s.parseSFDateTime,x=s.getSFDate,y=s.getSFDateTime,z=a.$L,A=r.encodeHTML,B=r.startsWith,C="placeholder",D=a.$.ui.keyCode,E=t.ANYTYPE,F=t.ARRAY,G=t.BOOLEAN,H=t.COMBOBOX,I=t.CURRENCY,J=t.CUSTOM,K=t.DATE,L=t.DATETIME,M=t.DOUBLE,N=t.EMAIL,O=t.ID,P=t.INTEGER,Q=t.LOCATION,R=t.MULTIPICKLIST,S=t.NUMBER,T=t.PERCENT,U=t.PHONE,V=t.PICKLIST,W=t.REFERENCE,X=t.RICHTEXT,Y=t.STRING,Z=t.TEXT,$=t.TEXTAREA,_=t.URL,aa=u.CHILDREL,ba=u.COMBO,ca=u.FILE,da=u.IMAGE,ea=[G,I,K,L,M,O,P,T,t.TIME];m={AUTOCOMPLETE:{edit:function(a){a=a||{},a.minLength||0===a.minLength||(a.minLength=2);var b,c=o("<input>"),d=function(){b&&(b.removeClass("ui-icon ui-icon-search"),b.addClass("nx-spinner-small"))},e=function(){b&&(b.removeClass("nx-spinner-small"),b.addClass("ui-icon ui-icon-search"))};return c.autocomplete({minLength:a.minLength,source:function(){return"function"==typeof a.source?function(b,c){a.source(b,c,d,e)}:a.source}(),select:a.onChange,focus:a.onFocus,close:a.onClose,appendTo:a.appendTo}).val(a.value),a.menuRenderer&&(c.data("ui-autocomplete")._renderMenu=a.menuRenderer),a.optionRenderer&&(c.data("ui-autocomplete")._renderItem=a.optionRenderer),c.on("keyup",function(b){""===o(this).val()&&9!==b.keyCode&&a.onClear&&a.onClear()}),c.focus(function(){c.autocomplete("widget").css("z-index",parseInt(c.closest(".ui-front").css("z-index"),10)+1)}),c.blur(function(){a.onBlur&&a.onBlur()}),a.parentElem&&(b=o("<div>").addClass("ui-icon ui-icon-search nx-field-reference-search").css({cursor:"pointer"}),a.parentElem.append(b),a.parentElem.is(c)&&c.css("padding-right","22px")),c}},BOOLEAN:{edit:function(a){var b=o('<input type="checkbox">').prop("checked",a.value).change(function(){a.onChange&&a.onChange(o(this).is(":checked")),b.focus()});return b}},COMBOBOX:{edit:function(b){b=b||{};var c,d=function(a){var c=b.entries;return r.isFunction(c)&&(c=c(a)),r.isPromise(c)?c:o.Deferred().resolve(c).promise()},e=function(a){return{value:f(a),label:g(a)}},f=function(a){return r.isString(a)?a:a.value},g=function(a){return r.isString(a)?a:a.label?a.label:a.value},h=b.getErrorContainer,i=b.invalidEntryMessage||"Only entries in this list are allowed.",j=function(b,c){t(),d(b.term).then(function(d){u(),c(d.filter(function(a){var c=b.term?b.term.toLowerCase():"",d=function(a){return a.toString().toLowerCase().indexOf(c)>-1};return r.isObject(a)?o.map(a,function(a){if(d(a))return a}).length>0:d(a)}).map(function(a){return e(this||a)})),r.runningTests()&&a.events.publish("combobox.entries.ready")})["catch"](function(a){h().show().text(a),u(),c([])})},k=b.onChange,l=b.parentElem,m=b.showLabelInTextInput,n=b.originalValue,p=b.restrictToEntries,q=o("<div>").addClass("ui-icon ui-icon-search nx-field-reference-search").css({cursor:"pointer"}),s=o("<select/>"),t=function(){var a=l.find(".nx-combobox-renderer-button");q&&(a.css("display","none"),q.removeClass("ui-icon ui-icon-search").addClass("nx-spinner-small").css({top:"5px"}))},u=function(){var a=l.find(".nx-combobox-renderer-button");q&&(q.removeClass("nx-spinner-small").addClass("ui-icon ui-icon-search"),a.css("display","block"))},v=b.label,w=b.value,x=m&&v?v:w,y={appendDropdown:b.appendDropdown,originalValue:b.originalValue,showLabelInTextInput:m,parentElem:l,required:b.required,searchicon:q,source:j,value:x,onBlur:function(b){var c=h(),g=o(b.target),j=g.data("value"),l=b.target.value;m&&j&&j!==l&&v&&l==v&&(l=j),l||(l=this.getInputValue&&this.getInputValue()),(l||w)&&d(l).then(function(b){var d=b.filter(function(a){return l===f(a)}),h=d.length>0,j=h?e(d[0]):{value:l,label:l};if(p&&!h)c.show().text(i),r.runningTests()&&a.events.publish("combobox.entry.error");else{if(c.hide(),w===l)return;n=w,w=j.value,v=j.label,m&&h&&v&&(g.data("value",w),g.val()!==v&&g.val(v)),k&&k(w,n,{item:j})}})["catch"](function(a){c.show("Error fetching entries: "+a)})},onChange:function(a,b){var c=o(this);n=w,v=b.item.label,w=b.item.value,h().hide(),k&&k(w,n,{item:b.item}),m&&v&&(c.data("value",w),b.item.value=v)},onFocus:function(a){a.target.select()}};return!m||!w||m&&b.label?(c=s.combobox(y),x!==w&&l.find("input").data("value",w),c):d(w).then(function(a){var b,d,e=a.filter(function(a){return r.isObject(a)?o.map(a,function(a){if(w===a)return a}).length>0:w===a})[0];return r.isObject(e)?(d=f(e),b=g(e)):d=e,d&&(w=d),b&&(v=b),x=m&&v?v:w,c=s.combobox(o.extend(y,{value:x,getInputValue:function(){return w}})),x!==w&&l.find("input").data("value",w),c})}},CURRENCY:{read:function(b){b||(b={});var c,d,e=r.userLocale,f=r.userInfo.defaultCurrency,g=b.value,h=b.decimalPlaces||0,i=b.decimalsSeparator,j=b.thousandsSeparator,k=b.valueCurrencyCode;return void 0===i&&(i=e.decimalsSeparator),void 0===j&&(j=e.thousandsSeparator),g||0===g||(g=""),d=""!==g&&o.isNumeric(g)?o.number(g,h,i,j):g,""!==g&&o.isNumeric(g)&&(r.isMultiCurrencyOrganization?(d=k+" "+d,k&&k!=f&&(c=r.convertCurrency(g,k,f))&&c!=g&&(d+=" ("+f+" "+o.number(c,h,i,j)+")")):d=a.currency.getSymbol(f)+d),b.wrapInElement?o("<div>").text(d):d}},DOUBLE:{read:h},DATE:{edit:function(a){a=a||{};var b,c,d=!1,e=a.value&&v(a.value);return b=o("<input>").datepicker(o.extend(i(a),{onSelect:function(e,f){var g,h=f.selectedMonth-0+1+"",i=f.selectedDay+"";1===h.length&&(h="0"+h),1===i.length&&(i="0"+i),g=f.selectedYear+"-"+h+"-"+i,c=b.val(),a.onChange&&a.onChange(g),d=!0,b.focus(),setTimeout(function(){d=!1},200)},beforeShow:function(){if(setTimeout(function(){o(".ui-datepicker").css("z-index",parseInt(b.closest(".ui-front, .sk-pagepanel").css("z-index")||0,10)+1)},0),d)return!1}})).on("click",function(){b.datepicker("show")}),b.datepicker("widget").click(function(a){a.stopPropagation()}),e&&b.datepicker("setDate",e),c=b.val(),b.bind("change keyup",function(){var d=o(this).val();if(d!=c){c=d;var e;e=""!==d?x(b.datepicker("getDate")):"",a.onChange&&a.onChange(e)}}),b}},DATETIME:{edit:function(a){var b,c=o("<div>"),d=o("<input>"),e=!1;a.value&&(b=w(a.value),c.data("usedate",b)),d.datepicker(o.extend(i(a),{onSelect:function(b,f){var g,h,i,j=new Date,k=c.data("usedate");k?g=s.getLocalDateTime(k):(g=s.getLocalDateTime(j),g.setHours(0,0,0,0)),g.setFullYear(f.selectedYear,f.selectedMonth,f.selectedDay),h=s.getRealJSDateTimeFromLocal(g),i=y(h),a.onChange&&a.onChange(i),c.data("usedate",h),e=!0,d.focus(),setTimeout(function(){e=!1},200)},beforeShow:function(){if(setTimeout(function(){o(".ui-datepicker").css("z-index",parseInt(d.closest(".ui-front, .sk-pagepanel").css("z-index")||0,10)+1)},0),e)return!1}})).click(function(){d.datepicker("show")}),a.value&&b&&d.datepicker("setDate",s.getLocalDateTime(b)),d.datepicker("widget").click(function(a){a.stopPropagation()});var f,g,h,j,k,l=d.val(),m=o("<div>").addClass("nx-dt-timewrapper");d.bind("change keyup",function(){if(o(this).val()!=l){l=o(this).val();var b;if(""!==o(this).val()){var e,f,g=d.datepicker("getDate")||new Date;g.setHours(0,0,0,0),e=s.getLocalDateTime(c.data("usedate")||g),e.setFullYear(g.getFullYear(),g.getMonth(),g.getDate()),f=s.getRealJSDateTimeFromLocal(e),b=y(f),c.data("usedate",f)}else b="",c.data("usedate",null);a.onChange&&a.onChange(b)}}).addClass("nx-dt-dateinput"),f=new Date,b?g=s.getLocalDateTime(b):(g=s.getLocalDateTime(f),g.setHours(0,0,0,0));var n,p,q=r.userLocale,t=q.timeFormat,u=s.amPm,v=function(a){var b=n+1<t.length&&t.charAt(n+1)===a;return b&&n++,b},x=!1,z=function(){var b,d=s.getLocalDateTime(c.data("usedate")||new Date);d.setHours((parseInt(h.val(),10)+(k&&"pm"===k.val()?12:0))%24),d.setMinutes(j.val()),b=s.getRealJSDateTimeFromLocal(d),c.data("usedate",b),a.onChange&&a.onChange(y(b))},A=function(a){m.append(o("<span>"+a+"</span>"))},B=function(a,b,c,d){a.append(o("<option "+(c?"selected ":"")+'value="'+b+'">'+(d&&b<10?"0"+b:b)+"</option>"))};for(n=0;n<t.length;n++)if(p=t.charAt(n),x)"'"!==p||v("'")?A(p):x=!1;else{var C,D;switch(p){case"a":if(!k){var E=g&&g.getHours()>=12;k=o("<select>").html("<option "+(E?"":"selected ")+'value="am">'+u[0]+"</option><option "+(E?"selected ":"")+'value="pm">'+u[1]+"</option>").appendTo(m).on("change",z)}break;case"h":case"K":case"k":case"H":if(!h){h=o("<select>"),D=v(p);for(var F,G="h"===p||"K"===p?12:24,H=0;H<G;H++)F="h"===p&&0===H?12:"k"===p?H-0+1:H,C=!1,g?C=H===(G>12?g.getHours():g.getHours()%12):8===H&&(C=!0),h.append(o("<option "+(C?"selected ":"")+'value="'+H+'">'+(D&&F<10?"0"+F:F)+"</option>"));h.appendTo(m).on("change",z)}break;case"m":if(!j){j=o("<select>"),D=v("m");var I,J=a.minuteIncrement||5,K=g?g.getMinutes():0,L=g&&K%J==0;for(I=0;I<60;I+=J)C=I===K,!L&&I>K&&(B(j,K,!0,D),L=!0),B(j,I,C,D);j.appendTo(m).on("change",z)}break;case"'":v("'")?A("'"):x=!0;break;default:A(t.charAt(n))}}return q&&q.showTimeBeforeDate?c.append(m,d):c.append(d,m),c}},ENTITY:{edit:function(b){b||(b={});var c,d,e,f,g=o('<div style="position: relative;">'),h=b.value,i=b.readOnly,j=function(){var c=b.dataSource;return r.isFunction(c)?c():c||a.dataSource.get(a.platform.getDefaultDataSourceName())},l=function(a){var c=b.filter;return r.isFunction(c)?c(a):j().getEntityList()},m=b.getErrorContainer||function(){var a=g.parent(),b=a.find(".nx-property-error");return b.length||(b=o("<div>").addClass("nx-property-error").css("margin-top","8px").insertAfter(g),a.css("display","block")),b},n=b.invalidEntryMessage||"Please select a valid entity.",p=function(a,c){j().getEntityMetadata({entities:{objectName:a},ignoreMetadataOverrides:!0}).then(function(){h=a,b.onChange&&b.onChange(a,c)})["catch"](function(a){m().show().text(a)})};return i?(d=j(),c=h,d&&d.dataSourceType&&(d.dataSourceType.prop&&r.size(d.dataSourceType.prop("x-metadata"))?(e=d.dataSourceType.prop("x-metadata")[h])&&e.label&&(c=e.label):d.dataSourceType.getEntityLabel&&(f=d.dataSourceType.getEntityLabel(h,d))&&(c=f)),g.addClass("nx-fieldtext").css("margin-top","6px").text(c||"")):g.append(k(H).edit({appendDropdown:!0,entries:l,getErrorContainer:m,invalidEntryMessage:n,onChange:p,parentElem:g,restrictToEntries:!0,showLabelInTextInput:b.showLabelInTextInput,value:h})),g}},INTEGER:{read:function(a){return a||(a={}),o.extend(a,{decimalPlaces:0}),h(a)}},MULTIPICKLIST:{edit:function(a){a.valueDelimiter||(a.valueDelimiter=";");var b,c=a.value,d=a.checkboxSetName,e=a.entries,f=a.maxSelected,g=a.valueDelimiter,h=a.selectedList||0===a.selectedList?a.selectedList:3,i=a.selectedText||z("number_selected"),j=a.noneSelectedText||z("none_selected"),k=!1,l=a.required||!1;c||(c="");var m,n=c.length?c.split(g):[],p=f&&n.length>=f,q=a.element||o("<div>"),s=c;if("CHECKBOXES"===a.renderas)q.addClass("nx-fieldtext").css("padding","0px"),b=function(){if(!k){k=!0;var b,c=q.find('input[type="checkbox"]'),d=c.filter(function(){return o(this).prop("checked")}).map(function(){return this.value}).get();if(f)if(d.length>=f){b=[];var e=0;c.each(function(){var a=o(this);if(a.prop("checked")){if(e++<f)return b.push(a.val()),!0;a.prop("checked",!1)}a.prop("disabled",!0)})}else c.each(function(){o(this).prop("disabled")&&o(this).prop("disabled",!1)});m=(f&&b?b:d).join(g),a.onChange&&a.onChange(m,s),s=m,k=!1}},o.each(e,function(a,b){if(b.value){var c="";-1!==o.inArray(b.value,n)&&""!==b.value&&(c='checked="yes"');var e=o("<div>").addClass("nx-checkboxwrapper"),f=o("<input "+c+' type="checkbox">').val(b.value).prop("id","mscb_"+d+"_"+b.value).addClass("nx-checkbox").appendTo(e),g=o("<div>").addClass("nx-checkboxlabel").appendTo(e);p&&!c&&f.prop("disabled",!0),g.append(o("<label>").html(A(b.label)).prop("for","mscb_"+d+"_"+b.value)),q.append(e)}}),q.off(),q.on("change","input",function(){b()});else{var t=o('<select multiple="multiple">').appendTo(q);o.each(e,function(a,b){var c,d="";-1!==o.inArray(b.value,n)&&""!==b.label&&(d='selected="selected"'),c=o("<option "+d+">").attr("value",b.value).text(b.label),t.append(c)}),b=function(){if(!k){k=!0;var b,c,d,e={},h=t.multiselect("getChecked").map(function(){return e[this.value]=1,this.value}).get();f&&(c=t.multiselect("widget").find('input[type="checkbox"]'),h.length>=f?(b=[],d=0,c.each(function(){var a=o(this),c=a.val();if(a.prop("checked")){if(d++<f)return b.push(c),e[c]=1,!0;delete e[c],this.click()}a.prop("disabled",!0).closest("label").addClass("ui-state-disabled")}),t.children().each(function(){var a=o(this);e[a.val()]?a.attr("aria-selected","true"):a.prop("disabled",!0).removeAttr("aria-selected")})):(t.children().each(function(){var a=o(this);a.prop("disabled",!1).attr("aria-selected",e[a.val()]?"true":"false")}),c.each(function(){o(this).prop("disabled",!1).closest("label").removeClass("ui-state-disabled")}))),m=(f&&b?b:h).join(g),a.onChange&&a.onChange(m,s),s=m,k=!1}},t.multiselect({selectedText:i,noneSelectedText:j,checkAllText:z("check_all"),uncheckAllText:z("uncheck_all"),selectedList:h,position:a.position,autoOpen:!1,classes:l?"required":"",close:function(){o(this).parent().find("button.ui-multiselect").removeAttr("tabindex").focus(),r._ie&&o(this).multiselect("disable")&&o(this).multiselect("enable"),a.onClose&&a.onClose.call(this)},click:function(a,c){b(a,c)},open:function(){o(this).parent().find("button.ui-multiselect").attr("tabindex","-1"),t.multiselect("widget").find("li").on("keydown.action.skuid",function(a){a.which===D.TAB&&a.stopPropagation()})},create:function(){t.val()&&t.val().length>=f&&t.children().each(function(){var a=o(this);a.prop("selected")||a.prop("disabled",!0).removeAttr("aria-selected")}),a.onCreate&&a.onCreate.call(this)}}).on("multiselectcheckall multiselectuncheckall",function(a,c){b(a,c)});var u=t.data("echMultiselect")||t.data("ech-multiselect");u&&u.menu&&u.menu.on("focusin",function(a){a.stopPropagation()}),t.multiselect("getButton").attr({role:"button",tabindex:0}).on("keydown.action.skuid",function(a){if(a.which===D.ENTER||a.which===D.SPACE){var b=t.multiselect("isOpen")?"close":"open";t.multiselect(b)}}),e.length>5&&t.multiselectfilter({label:"",placeholder:z("enter_keywords")})}return q}},PERCENT:{read:function(a){return a||(a={}),o.extend(a,{suffix:"%"}),h(a)}},PICKLIST:{edit:function(a){var b,c,d,e,h=a.entries,i=a.onChange;if(r.isFunction(h)&&(h=h()),"RADIO_BUTTONS"===a.renderas)b=o("<div>").addClass("nx-fieldtext").css("padding","0px"),d=function(){return b.find("input:checked").first().val()},c=g(a.value,h,{makeNoneOption:!a.required||a.addNoneOption,mode:a.mode,buttonSetName:a.buttonSetName,noneLabel:a.noneLabel}),o.each(c,function(){b.append(this)}),i&&(e=d(),b.off("change.skuid").on("change.skuid","input",function(){i(d(),e),e=d()}));else{b=o("<select>");var j=!1,k=a.value||""===a.value||0===a.value,l={},m=a.defaultValue,n=!1,p=[],q=k?a.value:"",s=r.isString(q)?q.replace(/\"/g,'\\"'):q,t=r.isString(m)?m.replace(/\"/g,'\\"'):m;h&&o.each(h,function(a,b){var c=b.value,d=o("<option>").attr("value",c).text(b.label);!0===b.disabled&&d.prop("disabled",!0),l[c]=d,p.push(d)}),q&&r.isUndefined(l[q])&&(l[q]=o("<option>").attr("value",q).text(a.label?a.label:q),p.unshift(l[q])),a.required&&!a.addNoneOption||p.unshift(o("<option>").attr("value","").text(f(a.noneLabel))),p.length&&b.append(p),k&&q in l&&(j=!0),k&&j?(b.val(q),b.children('[value="'+s+'"]').attr("selected",!0)):void 0!==m&&m in l&&(b.val(m),b.children('[value="'+t+'"]').attr("selected",!0),n=!0),i&&(e=b.val(),b.off("change.skuid").on("change.skuid",function(){i(b.val(),e),e=b.val()})),!a.required||k&&j||(n=!0),n&&i&&b.val()&&i(b.val())}return b}},TEXT:{edit:function(a){var b=a.inputType,c=a.onChange,d={},e=o("<input "+(b?' type="'+b+'"':"")+">").val(a.value),f=o("<div>");if(["inputMode","maxLength",C].forEach(function(b){a[b]&&(d[b.toLowerCase()]=a[b])}),r.size(d)&&e.attr(d),c&&r.delayInputCallback(e,function(a,b){c(a,b)},{dataPropertyName:a.dataPropertyName}),f.append(e),a.length!==undefined){var g=j(f,a);e.on("input",function(){g(e.val().length)})}return f}},TEXTAREA:{edit:function(a){var b=a.onChange,c=a.displayRows,d=a[C],e=o("<div>"),f=o("<textarea>").val(a.value).appendTo(e);if(c?f.attr("rows",c).css({height:"100%"}):f.flexText(),d&&f.attr(C,d),r.delayInputCallback(f,function(a,c){b&&b(a,c)}),a.length!==undefined){var g=j(e,a);f.on("input",function(){g(f.val().length)})}return e}},RICHTEXT:{edit:function(b){function c(){function c(){function c(){var a=o(".cke"),b=o(a[a.length-1]);b.insertAfter(o(g[0])),b&&(b.removeClass("cke-sf1-fix"),b.addClass("cke-sf1-fix"))}if(!e.parent().hasClass("disabled")&&!d){g.off("click.sk-richtext focus.sk-richtext"),f.removePlugins="ckeditor-gwf-plugin",d=a.CKEDITOR.inline(g[0],f),
e.parent().attr("sk-ckeditorname",d.name),d.config.customConfig=r.getStaticResourceUrl("CKEditor","skuid","config.js",r.getCacheTimestamp()),d.config.uiColor="#DDDDDD",a.utils._oniOS()&&a.utils._inIframe()&&(d.on("contentDom",c),o(g[0]).on("click",c));var h=2,i=function(a){b.onChange&&b.onChange(a,h)};d.on("change",function(){i(d.getData())}),d.on("mode",function(){h=2!==h&&!h}),d.on("key",function(){h&&i(d.getData())}),b.onCreated&&b.onCreated(d),b.afterInit&&b.afterInit({ckInstance:d})}}var f,g,h=b.config||{},i=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);h instanceof Array&&(h=o.extend.apply(this,o.map(h,function(a){return"function"==typeof a&&(a=a()),a}))),f={allowedContent:!0,disallowedContent:"style script iframe",toolbar:i?"Mobile":"FieldEditor"},"function"==typeof h?h(f):f=o.extend(f,h),g=o('<div class="nx-richtext-input" id="'+r.generateUniqueId()+'">').on("click.sk-richtext focus.sk-richtext",c),b.value&&g.html(b.value),e.parent().hasClass("disabled")?g.attr("sk-contenteditabledisabled","true"):g.attr("contenteditable","true"),e.empty().append(g),!0===b.initialize._initializeWhenReady?(c(),b.initialize=function(){}):b.initialize=c}b||(b={});var d,e=o("<div>").append(o('<div class="nx-spinner">'));return b.initialize=function(){b.initialize._initializeWhenReady=!0},a.utils.loadRichTextApi(c),e}},COLOR:{read:function(a){a||(a={});var b=a.color||a.value;return o('<div class="sk-colorpicker"><div class="sk-colorpicker-wrapper"><div class="nx-field">'+b+'</div><div><div class="sk-colorpicker-preview-wrapper sk-transparency-background"><div class="sk-colorpicker-preview" style="background-color:'+b+'; cursor:default"></div></div></div></div></div>')},edit:function(a){function b(a){f.trigger("sk-colorselected",[a])}function c(a){void 0===a&&(a=d),f.trigger("sk-colorpreview",[a])}a||(a={});var d=a.color||a.value;d===undefined&&(d="#000000");var e=a.onChange,f=o('<div class="sk-colorpicker"><div class="sk-colorpicker-wrapper"><div class="nx-field"><input placeholder="'+(a.placeholder?a.placeholder:"")+'"></div><div><div class="sk-colorpicker-preview-wrapper sk-transparency-background"><div class="sk-colorpicker-preview"></div></div></div></div></div>'),g=f.find("input").val(d),h=f.find(".sk-colorpicker-preview").css({"background-color":d}),i={black:"#000000",white:"#ffffff",red:"#ff0000",orange:"#ffa500",yellow:"#ffff00",green:"#008000",blue:"#0000ff",purple:"#800080",violet:"#ee82ee",rebeccapurple:"#663399"},j=a.colorSwatches||["transparent","rgba(0%,0%,0%,0.5)","\t","red","orange","yellow","green","blue","purple","violet","#663399","\n","\n","white","black","\t","#c0504d","#f79646","#eeece1","#9bbb59","#1f497d","#4f81bd","#4bacc6","#8064a2","\n","#f2f2f2","#7f7f7f","\t","#f2dcdb","#fdeada","#ddd9c3","#ebf1dd","#c6d9f0","#dbe5f1","#dbeef3","#e5e0ec","\n","#d8d8d8","#595959","\t","#e5b9b7","#fbd5b5","#c4bd97","#d7e3bc","#8db3e2","#b8cce4","#b7dde8","#ccc1d9","\n","#bfbfbf","#3f3f3f","\t","#d99694","#fac08f","#938953","#c3d69b","#548dd4","#95b3d7","#92cddc","#b2a2c7","\n","#a5a5a5","#262626","\t","#953734","#e36c09","#494429","#76923c","#17365d","#366092","#31859b","#5f497a","\n","#7f7f7f","#0c0c0c","\t","#632423","#974806","#1d1b10","#4f6128","#0f243e","#244061","#205867","#3f3151"];r.delayInputCallback(g,function(a){b(a)}),f.on("sk-colorpreview",function(a,b){h.css({"background-color":b||d})}).on("sk-colorselected",function(a,b){if(b!==d){var c=d;d=b,g.val()!==d&&g.val(d),h.css({"background-color":d}),e&&e(d,c)}});var k=a.popup=function(){function a(){u||(u=h().appendTo(document.body),k(),o(window).on("resize.sk-colorpicker scroll.sk-colorpicker",k),o(document.body).on("mousedown.sk-colorpicker",function(a){var b=a.clientX,c=a.clientY,d=u.offset(),f=d.left-o(window).scrollLeft(),g=d.top-o(window).scrollTop(),h=f+u.outerWidth(),i=g+u.outerHeight();(b<f||b>h||c<g||c>i)&&e()}).on("keyup.sk-colorpicker",function(a){27===a.keyCode&&e()}))}function e(){u&&(f.trigger("sk-popup-hide"),o(window).off("resize.sk-colorpicker scroll.sk-colorpicker"),o(document.body).off("mousedown.sk-colorpicker keyup.sk-colorpicker"),u.fadeOut(function(){u.remove(),u=null,c()}))}function h(){var a=o('<div class="sk-colorpicker-popup ui-widget ui-widget-content ui-corner-all"><div class="sk-colorpicker-popup-contents"><div class="sk-colorpicker-popup-panel sk-swatch-panel"></div><div class="sk-colorpicker-popup-panel sk-gradient-panel"></div></div></div>').on("click",function(a){a.stopPropagation()}),b=a.find(".sk-swatch-panel"),c=a.find(".sk-gradient-panel");return l({colors:j,panel:b}),m({panel:c}),a}function k(){u&&u.position({my:"left top",at:"left bottom",of:g,collision:"fit flip"})}function l(a){for(var d,f,g,h=a.colors.slice(0),i=a.panel,j=o("<div>").addClass("sk-colorpicker-table").appendTo(i),k=0;h.length>0;){for(f=o("<div>").addClass("sk-colorpicker-row sk-row-"+k).appendTo(j),d=0;h.length>0;d++){var l,m=h.shift();if("\n"===m)break;g=o("<div>").addClass("sk-colorpicker-cell sk-cell-"+d).appendTo(f),"\t"!==m&&(g.addClass("sk-transparency-background"),l=m,o("<div>").css({"background-color":l}).addClass("sk-colorpicker-swatch").on("mouseover",function(a){return function(){c(a)}}(l)).on("mouseout",function(){return function(){c()}}()).on("click",function(a){return function(){b(a)}}(l)).on("dblclick",function(a){return function(){b(a),e()}}(l)).appendTo(g))}k++}}function m(a){function g(a){var b="hsl("+a.hue+",100%,50%)",c={"background-color":b};m.css(c),x.find(".layer1").css(c),y.find(".layer1").css(c),z.find(".layer2").css({"background-image":"linear-gradient(to bottom, "+b+", rgba(204, 154, 129, 0))"})}function h(a){l=!0,w.slider("value")!==k.hue&&w.slider("value",360-k.hue),x.slider("value")!==k.sat&&x.slider("value",k.sat),y.slider("value")!==k.lum&&y.slider("value",k.lum),z.slider("value")!==k.alpha&&z.slider("value",k.alpha),l=!1,i({supressEventNotification:a})}function i(a){if(!l){var c=Math.round(360-w.slider("value")),d=Math.round(x.slider("value")),e=Math.round(y.slider("value")),f=z.slider("value");k.hue!==c&&(k.hue=c),k.sat!==d&&(k.sat=d),k.lum!==e&&(k.lum=e),k.alpha!==f&&(k.alpha=f),g(k),!0!==a.supressEventNotification&&b(s(q(k.hue/360,k.sat/100,k.lum/100),{alpha:k.alpha}))}}var j=a.panel,k=p(r(t(d))),l=!1,m=o('<div class="sk-colorpicker-gradient"><div class="sk-colorpicker-gradient-layer1"><div class="sk-colorpicker-gradient-layer2"></div></div></div>').appendTo(j).on("mousemove",function(a){c(n(k,a.offsetX,a.offsetY))}).on("mouseout",function(){c()}).on("click",function(a){b(n(k,a.offsetX,a.offsetY)),h()}).on("dblclick",function(a){b(n(k,a.offsetX,a.offsetY)),e()}),u=o('<div class="sk-colorpicker-hsl"><div class="sk-hsl-preview"></div><div class="sk-colorpicker-slider sk-hsl-h"></div><div class="sk-colorpicker-slider sk-hsl-s"></div><div class="sk-colorpicker-slider sk-hsl-l"></div><div class="sk-colorpicker-slider sk-alpha"></div></div>').appendTo(j),v=u.find(".sk-hsl-preview").css("background-color",d),w=u.find(".sk-hsl-h").slider({orientation:"vertical",min:0,max:360,step:1,slide:i,change:i}),x=u.find(".sk-hsl-s").slider({orientation:"vertical",min:0,max:100,step:1,slide:i,change:i}).append(o('<div class="layer1"><div class="layer2"></div></div>')),y=u.find(".sk-hsl-l").slider({orientation:"vertical",min:0,max:100,step:1,slide:i,change:i}).append(o('<div class="layer1"><div class="layer2_1"></div><div class="layer2_2"></div></div>')),z=u.find(".sk-alpha").slider({orientation:"vertical",min:0,max:1,step:.01,slide:i,change:i}).append(o('<div class="layer1 sk-transparency-background"><div class="layer2"></div></div>'));o.each(new Array(6),function(a){w.append(o('<div class="layer1_'+(a+1)+'">'))}),h(!0),f.on("sk-colorselected.gradientbox",function(a,b){v.css("background-color",b),k=p(r(t(b),k)),h(!0)}).on("sk-popup-hide",function(){f.off("sk-colorselected.gradientbox")})}function n(a,b,c){var d=a.hue/360,e=b/150,f=(150-c)/150*(1-b/150*.5),g=s(q(d,e,f),{alpha:a.aplha});return a.sat=Math.round(100*e),a.lum=Math.round(100*f),g}function p(a){return{hue:Math.round(360*a[0]),sat:Math.round(100*a[1]),lum:Math.round(100*a[2]),alpha:o.isNumeric(a[3])?a[3]:1}}function q(a,b,c){function d(a,b,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+6*(b-a)*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(0===b)e=f=g=c;else{var h=c<.5?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return[Math.min(255,Math.max(0,Math.round(255*e))),Math.min(255,Math.max(0,Math.round(255*f))),Math.min(255,Math.max(0,Math.round(255*g)))]}function r(a,b,c,d){var e=1;a instanceof Array&&(d=b,e=a[3],c=a[2],b=a[1],a=a[0]),d||(d={hue:0,sat:0}),a/=255,b/=255,c/=255;var f,g,h=Math.max(a,b,c),i=Math.min(a,b,c),j=(h+i)/2;if(h==i)f=g=0;else{var k=h-i;switch(g=j>.5?k/(2-h-i):k/(h+i),h){case a:f=(b-c)/k+(b<c?6:0);break;case b:f=(c-a)/k+2;break;case c:f=(a-b)/k+4}f/=6}return 0===g&&(f=d.hue/360),0!==j&&1!==j||(g=d.sat/100),[f,g,j,e]}function s(a,b){var c=a[0],d=a[1],e=a[2],f=a[3];return o.isNumeric(f)||(f=o.isNumeric(b.alpha)?b.alpha:1),f<1||!0===b.ignoreAlpha?"rgba("+c+","+d+","+e+","+f+")":"#"+("0"+c.toString(16)).slice(-2)+("0"+d.toString(16)).slice(-2)+("0"+e.toString(16)).slice(-2)}function t(a){var b,c,d,e;if(a in i&&(a=i[a]),/^\s*#/.test(a))return a=(/[a-f0-9]{6}/.exec(a)||[""])[0],b=parseInt(a.slice(0,2),16)||0,c=parseInt(a.slice(2,4),16)||0,d=parseInt(a.slice(4,6),16)||0,[b,c,d,1];if(/^\s*rgb/i.test(a)){for(var f,g=[],h=/(\d*\.)?\d+%?/g;f=(h.exec(a)||[""])[0];)g.push(-1===f.indexOf("%")?parseFloat(f):parseFloat(2.55*f.replace("%","")));return b=Math.round(g[0]),c=Math.round(g[1]),d=Math.round(g[2]),e=o.isNumeric(g[3])?g[3]:1,[b,c,d,e]}return[0,0,0,1]}var u=null;return{show:a,hide:e}}();return h.on("click",k.show),f}}},n={TEXT:{read:function(a,c){c||0===c||(c=""),a.options&&"PASSWORD"===a.options.type&&(c=Array(c.length+1).join("*")),r.isString(c)||(c=""+c);var d,e,f,g=a.options.maxDisplayCharacters,h=a.metadata,i=h&&h.displaytype===_,j=a.model.getDataSourceType(),k=!1;if(i&&(!c||r.contains(c,"//")||B(c,"/")||(c="http://"+c),g||(g=40)),e=c,g&&(g-=0),!isNaN(g)&&g>0&&g<c.length&&(c=c.substring(0,g)+"..."),j&&j.getNameFieldURLForTextField){var l=j.getNameFieldURLForTextField(a,e,c);l&&(k=!0,c=l)}i&&!l&&(f=A(e),c='<a href="'+f+'">'+A(c)+"</a>"),d=h&&h.htmlFormatted?r.removeScriptTags(c):r.nl2br(k?c:A(c)),b(a,d)},readonly:function(a,b){l(Z).read(a,b)},edit:function(a,b,c){var d,f=a.options,g=e(a);b||0===b||(b=""),d={inputType:c,value:b,onChange:function(b){a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())}},f&&"PASSWORD"===f.type&&(d.inputType="password"),g&&(d[C]=g),a.options.showLengthCounter&&a.metadata.length&&(d.length=a.metadata.length),a.element.append(k(Z).edit(d),o("<div>").addClass("sk-focusbar"))}},TEXTAREA:{read:function(a,b){a._ckInstance&&(a._ckInstance.destroy(),delete a._ckInstance),l(a,Z).read(a,b)},readonly:function(a,b){l($).read(a,b)},edit:function(a,b){var c=a.options||{},d=e(a);if(b||0===b||(b=""),a.metadata.htmlFormatted)a.disableBlur=!0,a.element.append(k(X).edit({field:a,afterInit:function(b){a._ckInstance=b.ckInstance},config:[{uiColor:"#DDDDDD"},c.ckEditorConfig||{}],onChange:function(b){a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())},value:b,length:a.options.showLengthCounter?a.metadata.length:undefined}));else{var f=c.displayRows;a.element.append(k($).edit({displayRows:f,onChange:function(b){a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())},placeholder:d,value:b,length:a.options.showLengthCounter?a.metadata.length:undefined}))}},destroy:function(a){var b;a.metadata.htmlFormatted&&(b=k(X),b.destroy&&b.destroy({field:a}))}},RICHTEXT:{read:function(a,b){return a.metadata.htmlFormatted=!0,l(a,$).read(a,b)},readonly:function(a,b){return l(X).read(a,b)},edit:function(a,b){return a.metadata.htmlFormatted=!0,l(a,$).edit(a,b)}},DOUBLE:{read:function(a,c,d,e){var f,g=a.metadata,h=a.options.decimalPlaces;h||"0"===h?f=parseInt(h,10):g&&g.scale&&(f=g.scale),f&&r.isNumber(f)||(f=0),b(a,k(M).read({value:c,decimalPlaces:f,prefix:d,suffix:e}))},readonly:function(a,b){l(M).read(a,b)},edit:function(a,b){b||0===b||(b="");var c=r.userLocale,d=o('<input inputmode="numeric">').val(""!==b&&o.isNumeric(b)?o.number(b,a.metadata&&a.metadata.scale?a.metadata.scale:0,c.decimalsSeparator,c.thousandsSeparator):b);r.delayInputCallback(d,function(b){var e,f,g=a.metadata.displaytype,h=!1,i=c.thousandsSeparator,j=c.decimalsSeparator,k=b.indexOf(j),l=b.split(j),m=l[0],n=parseInt(l[1],10),o=l[1]?l[1].length:0,p=n.toString().length,q=d.val(),s={k:3,m:6,b:9,t:12},t=q.toLowerCase().charAt(q.length-1),u=Math.pow(10,s[t]),v=u/10,w=null===new RegExp("[^\\dbkm"+("."===j?"\\"+j:j)+("."===i?"\\"+i:i)+"-]|[bkm"+j+"]{2,}","ig").exec(q);if("."===i&&(i="\\."),b=b.toString().replace(new RegExp(i,"g"),"").replace(j,"."),e=parseInt(b,10),""===m?m=0:"-"===m&&(m=-0),w&&0==isNaN(u))if(-1!==k){for(p;p>1;p--)v/=10;for(f=0;f<o&&"0"===l[1][f];f++)v/=10;v=m>=0&&1/m>0?n*v:-n*v,b=m*u+v}else b=e*u;b&&(h=g===P?parseInt(b,10):parseFloat(b)),!1===h||r.isExactlyNaN(h)||(b=h),a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())}),a.element.append(d)}},INTEGER:{read:function(a,c){b(a,k(P).read({value:c}))},readonly:function(a,b){l(P).read(a,b)},edit:function(a,b){l(a,M).edit(a,b)}},PERCENT:{read:function(a,b){l(a,M).read(a,b,"","%")},readonly:function(a,b){l(T).read(a,b)},edit:function(a,b){l(a,M).edit(a,b)}},CURRENCY:{read:function(a,c){var d,e,f=a.metadata,g=a.options?a.options.decimalPlaces:null,h=a.row;g||"0"===g||0===g?d=parseInt(g,10):f&&f.scale&&(d=f.scale),d&&r.isNumber(d)||(d=0),""!==c&&h&&r.isMultiCurrencyOrganization&&(e=r.getRowCurrency({row:h,model:a.model,field:a.id})),b(a,k(I).read({value:c,decimalPlaces:d,valueCurrencyCode:e}))},readonly:function(a,b){l(I).read(a,b)},edit:function(a,b){l(a,M).edit(a,b)}},BOOLEAN:{read:function(a,b){var c=o("<div>").addClass("nx-fieldtext").css("padding","0px"),d=o('<input type="checkbox">').prop({checked:b,disabled:"true"});c.append(d),a.editable&&"readonly"!==a.mode&&c.append('<div class="focusbox" tabindex="0"/>'),a.element.append(c)},readonly:function(a,b){l(G).read(a,b)},edit:function(a,b){"true"===b&&(b=!0),a.element.append(k(G).edit({value:b,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})}}))}},DATE:{read:function(a,c){b(a,s.makeFormattedDate(c))},readonly:function(a,b){l(K).read(a,b)},edit:function(a,b){var c=a.options;a.element.append(k(K).edit({value:b,renderas:c.type,showMonthPicker:c.showMonthPicker,showYearPicker:c.showYearPicker,yearPickerRange:c.yearPickerRange,onChange:function(b){a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())}}))}},DATETIME:{read:function(a,c){b(a,s.makeFormattedLongDateTime(c))},readonly:function(a,b){l(L).read(a,b)},edit:function(a,b){var c=a.options;a.element.append(k(L).edit({value:b,showMonthPicker:c.showMonthPicker,showYearPicker:c.showYearPicker,yearPickerRange:c.yearPickerRange,minuteIncrement:c.minuteIncrement,onChange:function(b){a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())}}))}},EMAIL:{read:function(a,c){c||0===c||(c=""),""!==c&&(c=A(c),c='<a href="mailto:'+c+'">'+c+"</a>"),b(a,c)},edit:function(a,b){l(a,Z).edit(a,b,"email")},readonly:function(a,b){l(N).read(a,b)}},LOCATION:{read:function(a,c){var d,e,f,g,h="",i=a.options.type||a.metadata.type||"DECIMAL";c&&(e=c.latitude,f=c.longitude,"DECIMAL"===i?(g=function(a){var b=(a+"").split(".");return o.number(a,b.length>1?b[1].length:1,".","")+""},e=g(e),f=g(f),e&&(h+=e),h+=" ",f&&(h+=f)):(d="&#39;",g=function(a,b){var c=a<0,e=Math.abs(a),f=Math.floor(e),g=60*(e-f),h=Math.floor(g),i=Math.round(60*(g-h));return f+"&deg;"+h+d+i+d+d+(b?c?"S":"N":c?"W":"E")},e=g(e,!0),f=g(f),e&&(h+=e),h+=" ",f&&(h+=f))),b(a,h)},edit:function(b){var c=b.row,d=b.model,e=b.id,f=e.substring(0,e.length-1),g=f+"Latitude__s",h=f+"Longitude__s",i=new a.ui.Field(c,d,null,{fieldId:g}),j=new a.ui.Field(c,d,null,{fieldId:h});i.render(),j.render(),b.element.append(i.element,j.element)},readonly:function(a,b){l(Q).read(a,b)}},PHONE:{read:function(a,d){if(window.sforce&&d&&q.showClick2Dial){l(a,Z).read(a,d);var e=q.click2Dial;e||(e=c),a.element.css("white-space","nowrap").append(o('<div class="sk-click2dial-wrapper">').append(o('<span class="ui-icon sk-icon sk-icon-phone inline">').attr("title","Click to dial")).on("click.skuid",function(){e(a)}).css("cursor","pointer")),a.element.children().css({display:"inline-block"})}else{var f;d||"0"===d?f=d.replace(/\D+/g,""):(d="",f=!1),""!==d&&(d=A(d),(f||"0"===f)&&(d='<a href="tel:'+f+'">'+d+"</a>")),b(a,d)}},edit:function(a,b){l(a,Z).edit(a,b,"tel")},readonly:function(a,b){l(U).read(a,b)}},PICKLIST:{read:function(a,c,d){var e,f,h,i,j=o.extend({},a.options,d),k=a.metadata&&a.metadata.nameField,l=k?a.model.getDataSourceType():null,m=c,n=d&&d.picklistEntries||j.entries||j.picklistEntries;!0!==c&&!1!==c||(c+="",m=c),n&&0!=n.length||(n=a.getValidPicklistEntries()),"RADIO_BUTTONS"===j.type?(h=o("<div>").addClass("nx-fieldtext").css("padding","0px"),i=g(c,n,{makeNoneOption:!a.required||j.addNoneOption,mode:a.mode,buttonSetName:a.id+"_"+a._GUID}),o.each(i,function(){h.append(this)}),a.editable&&"readonly"!==a.mode&&h.append('<div class="focusbox" tabindex="0"/>'),a.element.append(h)):(n&&n.length&&o.each(n,function(){if(this.value==c)return this.label&&(m=this.label),!1}),k&&l&&l.getNameFieldURLForTextField&&(f=l.getNameFieldURLForTextField(a,c,m))&&(e=!0,m=f),b(a,m?e?m:A(m):""))},readonly:function(a,b,c){l(V).read(a,b,c)},edit:function(a,b,c){var d=o.extend({},a.options,c);!0!==b&&!1!==b||(b+=""),a.element.append(k(V).edit({addNoneOption:a.options.addNoneOption,buttonSetName:a.id+"_"+a._GUID,entries:d.picklistEntries||a.getValidPicklistEntries(),mode:a.mode,noneLabel:a.options.noneLabel,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})},renderas:a.options.type,required:a.required,value:b}))}},MULTIPICKLIST:{read:function(a,b,c){c||(c=";");var d=o("<div>").addClass("nx-fieldtext"),e=a.getValidPicklistEntries(),f=b||"",g=f.split(c);if("CHECKBOXES"===a.options.type)d.css("padding","0px"),o.each(e,function(a,b){if(b.value){var c="";-1!==o.inArray(b.value,g)&&""!==b.value&&(c='checked="yes"');var e=o("<div>").addClass("nx-checkboxwrapper");e.append(o("<input "+c+' type="checkbox" value="'+b.value+'">').addClass("nx-checkbox").prop("disabled",!0)),e.append(o("<div>"+A(b.label)+"</div>").addClass("nx-checkboxlabel")),d.append(e)}});else if(f){var h={},i=[];o.each(e,function(a,b){h[b.value]=b.label}),o.each(g,function(){i.push(h[this]||this)}),d.html(A(i.join(", ")))}else d.html("");a.editable&&"readonly"!==a.mode&&d.append('<div class="focusbox" tabindex="0"/>'),a.element.append(d)},readonly:function(a,b,c){l(R).read(a,b,c)},edit:function(a,b,c){var d=";";c=c||{},r.isString(c)?(d=c,c={}):d=c.valueDelimiter||d;var e=a.options;"CHECKBOXES"!==e.type&&(a.disableBlur=!0),a.element.append(k(R).edit({value:b,defaultValue:a.metadata.defaultValue,entries:c.picklistEntries||a.getValidPicklistEntries(),renderas:e.type,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})},valueDelimiter:d,checkboxSetName:a.id+"_"+a._GUID,maxSelected:e.maxSelected,required:a.required,selectedList:e.selectedList}))}},COMBOBOX:{read:function(a,b){l(a,V).read(a,b)},readonly:function(a,b){l(H).read(a,b)},edit:function(b,c){function d(){var a=b.element.find(".nx-error-inline");return a.length||(a=o("<div>").addClass("nx-error-inline").appendTo(b.element)),a}function e(d,e){!(c=d)&&b.required&&(c=e);var f=b.model.updateRow(b.row,b.id,c,{initiatorId:b._GUID});return r.runningTests()&&a.events.publish("combobox.onchange"),f}b.element.append(k(H).edit({entries:function(){return b.getValidPicklistEntriesAccountingForDataSource()},getErrorContainer:d,onChange:e,parentElem:o("<div>").appendTo(b.element),restrictToEntries:b.metadata.limitEntries||!1,showLabelInTextInput:!0,value:c}))}},ARRAY:{read:function(a,b,c){c||(c={});var d,e,f=o("<div>").addClass("nx-fieldtext").appendTo(a.element),g=a.row,h=a.model.getFieldValue(a.row,a.id,!0),i=a.options.delimiter,j=c.dataPath||a.metadata.dataPath;i||(i=""),h&&(d=h,j&&(d=r.getObjectProperty(d,j)),e=d.length,o.each(d,function(b,c){var d=a.model.mergeRow(c,a.options.template,{parentRow:g,childRelName:a.id,allowHTML:a.options&&a.options.allowHTML,registerFields:!1});d.css("display","inline"),f.append(d),b+1!==e&&f.append("<span>"+i+"</span>")})),a.element.append(f)},readonly:function(a,b){l(F).read(a,b)}},CHILDREL:{read:function(a,b){l(a,F).read(a,b,{dataPath:a.metadata.dataPath||"records"})},readonly:function(a,b){l(aa).read(a,b)}},COMBO:{read:function(a){var b=o("<div>").addClass("nx-fieldtext").appendTo(a.element),c=a.options;b.append(a.model.mergeRow(a.row,c.template,{allowHTML:c&&c.allowHTML,registerFields:!1})),a.editable&&"readonly"!==a.mode&&b.append('<div class="focusbox" tabindex="0"/>'),a.element.append(b).off("dblclick.skuid mouseenter.skuid mouseleave.skuid").css("cursor","auto")},readonly:function(a,b){l(ba).read(a,b)},edit:function(a,b){l(ba).read(a,b);var c,d=a.options,e=a.element,f=e.find(".focusbox").prop("tabindex","-1"),g=o('<input type="text">').addClass("nx-visuallyhidden");f.before(g),c=function(){function b(){o(this).click().find(":input").first().focus()}function c(){var a=e.find("input"),b=e.find(".focusbox");a.length&&a[0]===g[0]&&a.attr("preventaction","true"),b.length&&b[0]===f[0]&&b.attr("preventaction","true")}function h(){var a=e.find("input"),b=e.find(".focusbox");a.length?a[0]!==g[0]&&a.attr("preventaction","true").focus():b[0]!==f[0]&&b.attr("preventaction","true").focus(),setTimeout(function(){a.removeAttr("preventaction"),b.removeAttr("preventaction")},100)}var i,j,k,l="custompopup"===d.editModeBehavior,m=[{text:z("done"),icons:{primary:"sk-icon-save sk-icon"},click:function(){o(this).dialog("close")}}];l?k=r.createPopupFromPopupXML(d.editModePopupXML,a,{open:b,close:h,beforeClose:c,buttons:m,modal:!0,resizable:!0}):(i=a.model.getRowMergeResult(a.row,d.template),j=i.fields,k=o('<div title="'+d.label+'" class="nx-editor"/>'),k.append(q.createFieldSet(j,{editor:a.editor})),k.dialog({resizable:!0,modal:!0,width:450,open:b,beforeClose:c,close:function(){h(),k.dialog("destroy").remove()},buttons:m})),a.editor.editModePopup=k},g.on("focus.skuid",function(){var a=o(this);a.attr("preventaction")?a.removeAttr("preventaction"):c()}),e.on("mouseenter.skuid mouseleave.skuid","> .nx-fieldtext",function(a){"mouseenter"===a.type?o(this).append(o("<div>").addClass("nx-edithover sk-icon-edit sk-icon inline").click(function(a){c(),a.stopPropagation()})):o(this).find("div.nx-edithover").remove()}).css("cursor","pointer")}},CUSTOM:{read:function(b,c){var e=a.snippet.get(b.options.snippet);e&&e(b,d(b,c))},readonly:function(a,b){l(J).read(a,b)},edit:function(a,b){l(J).read(a,b)}},FILE:{read:function(a){var b=o("<div>").addClass("nx-fieldtext").css({padding:"0px","min-height":"26px"}).appendTo(a.element);new r.FileComponent(b,{model:a.model,row:a.row,displayAs:"filename",storeAs:"field",idField:a.id,deleteable:!1,editable:!1,_GUID:a._GUID})},readonly:function(a,b){l(ca).read(a,b)},edit:function(b,c){if(a.offline.networkDown())return l(ca).read(b,c),!1;var d=o("<div>").addClass("nx-fieldtext").appendTo(b.element);b.model.isRowNew(b.row)?(d.css({"font-size":"8pt",color:"#aaa"}),d.text("Save record before uploading files.")):(d.attr("id",r.generateGUID()).css("padding","0px"),new r.FileComponent(d,{model:b.model,row:b.row,displayAs:"filename",storeAs:"field",idField:b.id,deleteable:!0,editable:!0,_GUID:b._GUID}))}},REFERENCE:{read:function(a,c){var d,e=c||0===c?A(a.calculateReferenceText()):"",f=a.model.getDataSourceType();if("skuid__Image__c"===a.metadata.ref)return l(a,ca).read(a,c),!1;e=r.nl2br(e),f&&f.getNameFieldURLForReferenceField&&(d=f.getNameFieldURLForReferenceField(a,c,e)),b(a,d||e)},readonly:function(a,b){l(W).read(a,b)},edit:function(b,c){if(a.offline.networkDown())return l(W).read(b,c),!1;if("skuid__Image__c"===b.metadata.ref)return l(b,ca).edit(b,c),!1;c||0===c||(c="");var d,e,g,h=b.element,i=b.options,j=o("<input>").val(c),k=b.metadata.ref,m=b.metadata.referenceTo,n=k&&-1!=k.indexOf(","),p=b.metadata.dataSourceName?a.dataSource.getDataSource(b.metadata.dataSourceName):b.model.getDataSource(),q=p.getDataSourceType(),s=q&&q.getReferenceHandler&&q.getReferenceHandler(),t=o('<div class="ui-autocomplete-container"></div>');if(!s)return l(W).read(b,c),!1;var u=function(a){var c=r.extractFieldsFromTemplate(i.searchTemplate||i.template),d=b.calculateReferenceMerges({targetObject:a});e=o("<div>").append(d.merges).text(),g=[],o.each(c,function(a,c){g.push({id:b.metadata.rel&&0===c.indexOf(b.metadata.rel+".")?c.slice(b.metadata.rel.length+1):c})})};if(h.data("recordId",c),n){var v;b.element.addClass("nx-polymorphic"),d=o("<select>").on("change",function(){v=d.val(),h.data("selectedSObject",d.find('option[value="'+v+'"]').attr("data-sobject")),h.data("selectedSObjectPrefix",v),h.data("recordId",""),h.data("recordLabel",""),u(v),b.model.updateRow(b.row,b.id,null,{initiatorId:b._GUID});var a=d.next();a.val(""),h.data("recordId",""),h.data("recordLabel",""),"REFPICK"===i.type&&b.getReferenceOptions("",{searchFields:E(),returnFields:D(),referencedObject:h.data("selectedSObject")}).then(G),a.focus()});var w={},x=[];if(o.each(m,function(a,b){w[b.label+"_"+b.objectName]=b}),o.each(Object.keys(w).sort(),function(a,b){x.push(w[b])}),o.each(x,function(a,c){d["User"===c.objectName&&r.endsWith(b.id,"OwnerId")?"prepend":"append"](o("<option>").attr({value:c.keyPrefix,"data-sobject":c.objectName}).text(c.label))}),h.data("recordId")&&"undefined"!=h.data("recordId")){var y=b.model.getValueKeyPrefix(h.data("recordId"));y&&3===y.length&&h.data("selectedSObjectPrefix",y)}h.data("selectedSObjectPrefix")&&d.val(h.data("selectedSObjectPrefix"));var C=d.find('option[value="'+d.val()+'"]');0===C.length&&(C=d.find("option").first()),h.data("selectedSObject",C.attr("data-sobject"))}else h.data("selectedSObject",k);u(h.data("selectedSObject")),h.data("recordLabel",""===h.data("recordId")?"":e);var D=function(){var a=b.options.returnFields;return a&&a.length||(a=[],o.each(g,function(b,c){c.showInSearchDialog=!0,a.push(c)})),a},E=function(){var a=b.options.searchFields;return a&&a.length||(g&&g.length?(a=[],o.each(g,function(b,c){a.push(c)})):a=[{id:p.getNameField(h.data("selectedSObject")),displaytype:Y,filterable:!0}]),a},F=function(a,c,d){if(a||0===a||""===a){h.data("recordId",a);var e=p.getNameField&&p.getNameField(h.data("selectedSObject")),f=d||s&&s.getRowFromReferenceValue(c,a,b.metadata)||c.getRowById(a);if(f){var g=c.getRowMergeResult(f,i.searchTemplate||i.template||"{{"+e+"}}",{registerFields:!1}),j=g.merges.text();h.data("recordLabel",j)}f&&e&&"Name"!==e&&"Id"!==e&&!("Name"in f)&&e in f&&(f.Name=f[e]);var k={},l=a;b.metadata&&f&&-1===o.inArray(b.metadata.displaytype,[W,O])&&f.__templabel&&(l=f.__templabel),k[b.id]=l,(l||0===l)&&(k[b.metadata.rel]=f),b.model.updateRow(b.row,k,{initiatorId:b._GUID})}},G=function(a){j.empty(),b.element.hasClass("disabled")||j.prop("disabled",!1);var d=!1;b.required&&a.data.length&&!i.addNoneOption||(d=!c,j.append(o("<option>").val("").text(f(i.noneLabel,{model:b.model})).prop("selected",!c)));var e=p.getNameField(h.data("selectedSObject")),g=b.metadata.originalDisplayType,k=g===S||g===P||g===M,l=i.searchTemplate||i.template||"{{"+e+"}}";o.each(a.data,function(e,f){var g=s?s.getReferenceValue(f,b.metadata):f.Id;d||(d=c+""==g+"");var h=a.mergeRow(f,l,{registerFields:!1}).text();j.append(o("<option>").val(g).text(h).prop("selected",c===g))}),d||!c&&0!==c||j.append(o("<option>").val(c).text(h.data("recordLabel")).prop("selected",!0)),b.required&&!c&&0!==c&&F(k?parseInt(j.val(),10):j.val(),a,null),j.off("change.skuid").on("change.skuid",function(){var b=o(this).val();k&&(b=parseInt(b,10)),F(b,a,null)})};if("REFPICK"===i.type)j=o("<select>").prop("disabled",!0).append(o('<option value="">').text(c?e:f(i.noneLabel,{model:b.model}))),b.getReferenceOptions("",{searchFields:E(),returnFields:D(),referencedObject:h.data("selectedSObject")}).then(G);else{j=a.ui.getRenderer("AUTOCOMPLETE").edit({minLength:b.metadata.minInputLength||2,source:function(a,c,d,e){d();var f,g=m&&m[0]&&m[0].objectName,j=function(){b.getReferenceOptions(a.term,{searchFields:E(),returnFields:D(),relMetadata:f,referencedObject:h.data("selectedSObject")}).then(function(a,b){if(b&&b.isStale)return void c([]);h.data("tempmodel",a);var d=p.getNameField&&p.getNameField(h.data("selectedSObject")),f=i.searchTemplate||i.template||"{{"+d+"}}",g=-1!==f.indexOf("Name}}");o.each(a.data,function(){g&&!this.Name&&d in this&&(this.Name=this[d]),this.__templabel=h.data("tempmodel").mergeRow(this,f,{registerFields:!1}).text()}),c(a.data),(!b||b&&b.isFinal)&&e()})};b.options.searchFields&&g?p.getEntityMetadata({entities:[g]}).then(function(a){f=a._unwrap(),j()}):(f={},j())},onFocus:function(a,b){return j.val(b.item.__templabel),!1},onChange:function(a,c){var d=s?s.getReferenceValue(c.item,b.metadata):c.item.Id;F(d,h.data("tempmodel"),c.item);var e=b.element.find(".nx-error-inline");return b.render(),j=b.element.find("input"),e&&b.element.prepend(e),j.focus(),!1},onClose:function(){j.focus()},onBlur:function(){setTimeout(function(){j.val(h.data("recordLabel"))},200)},onClear:function(){var a=b.model.getFieldValue(b.row,b.id,!0);null!==a&&a!==undefined&&(b.model.updateRow(b.row,b.id,null,{initiatorId:b._GUID}),h.data("recordId",""),h.data("recordLabel",""))},optionRenderer:function(a,b){return o("<li></li>").data("ui-autocomplete-item",b).html("<a>"+A(b.__templabel)+"</a>").appendTo(a)},appendTo:a.mobile?t:undefined,value:h.data("recordLabel")||c,parentElem:h}),a.mobile&&t.insertAfter(h.children().last());h.find(".ui-icon-search").on("click.skuid",function(c){if(c.stopPropagation(),!b.element.hasClass("disabled")){var d,e,f,g,k,l,m,n,p=function(){a.mobile?a.mobile.hidePopupPanel():d.dialog("close").remove(),l.unregister&&l.unregister(),B(m.id,"_TempModel_")&&m.unregister()};a.snippet.registerSnippet("skuid.__referencepopupselect",function(a){var c,d;a.row?c=a.row:a.component&&a.component.row?c=a.component.row:a.item&&(c=a.item.row),a.model?d=a.model:a.component&&a.component.list&&(d=a.component.list.model);var e=s?s.getReferenceValue(c,b.metadata):c.Id;F(e,d,c),b.render(),j=b.element.find("input"),p(),j.focus()}),g=h.data("selectedSObject"),b.options&&"model"===b.options.optionsource?(n=a.$M(b.options.optionmodel))&&n.objectName===g&&n.label&&(g=n.label):b.metadata&&b.metadata.referenceTo&&b.metadata.referenceTo.length&&o.each(b.metadata.referenceTo,function(){if(this.objectName===g)return this.label?g=this.label:o.each(a.model.list(),function(){if(this.objectName===g&&this.label)return g=this.label,!1}),!1}),!g&&b.metadata&&b.metadata.label&&(g=b.metadata.label),k=z("select")+" "+r.encodeHTML(g+""),d=o("<div>").attr("title",z("select")+" "+g),f=o("<div>").css("min-height","300px"),d.append(f),b.getReferenceOptions(j.data("uiAutocomplete").term,{searchFields:E(),returnFields:D(),referencedObject:h.data("selectedSObject")}).then(function(c){a.$M(c.id)||c.register(),m=c,o.each(m.fields,function(){this.nameField&&(this.nameField=!1)});var d,e=i.tokenizeSearch?' tokenizesearch="true"':"",h=c.getNameField(),j=D(h),n=[],p=E(h),q="";j&&j.length?o.each(j,function(a,b){b.showInSearchDialog&&n.push(b)}):n.push({id:h}),p&&p.length||i.useSOSLSearch?(q+="<searchfields"+(i.useSOSLSearch?' usesosl="true"':"")+(i.SOSLFields?' soslfields="'+i.SOSLFields+'"':"")+">",p&&p.length&&o.each(p,function(){q+='<searchfield field="'+this.id+'"/>'}),q+="</searchfields>"):q="",a.mobile?(d='<mobiledeck model="'+c.id+'"'+e+' pagesize="'+(b.options.pageSize||5)+'" mode="readonly" searchbox="true" showsavecancel="false" createrecords="false" precision="1" minwidth="300"><components>',o.each(n,function(a,b){d+='<mobilefield id="'+b.id+'"',b.label?d+=">"+b.label+"</mobilefield>":d+="/>"}),
d+='</components><cardinteractions><interaction type="tap"><actions><action type="custom" snippet="skuid.__referencepopupselect"/></actions></interaction></cardinteractions>'+q+"</mobiledeck>"):(d='<skootable model="'+c.id+'"'+e+' pagesize="'+(b.options.pageSize||5)+'" mode="readonly" searchbox="true" showsavecancel="false" createrecords="false"><fields>',o.each(n,function(a,b){d+='<field id="'+b.id+'" allowordering="true"',b.label?d+=">"+b.label+"</field>":d+="/>"}),d+='</fields><rowactions><action type="custom" label="'+k+'" icon="sk-icon-add-reference" snippet="skuid.__referencepopupselect"/></rowactions>'+q+"</skootable>"),l=a.component.factory({xmlDefinition:d}),f.append(l.element),a.mobile?a.mobile.setPopupPanel(l.element,{title:z("select")+" "+g}):(f.append(l.element),f.find(".searchbox").focus().select())}),a.mobile||(e=[{icons:{primary:"ui-button-icon-primary ui-icon sk-icon-remove-reference sk-icon inline"},text:"Clear Value",click:function(){b.model.updateRow(b.row,b.id,null,{initiatorId:b._GUID}),h.data("recordId",""),h.data("recordLabel",""),p(),j.val("")}},{icons:{primary:"ui-button-icon-primary ui-icon sk-icon-cancel sk-icon inline"},text:z("cancel"),click:function(){p()}}],d.dialog({close:function(){p()},modal:!0,resizable:!0,width:"90%",buttons:e}),d.parent(".ui-dialog").addClass("sk-dialog-autocomplete"),o(".ui-widget-overlay").addClass("sk-overlay-autocomplete"))}})}if(h.addClass("editable"),d){var H=o("<label>").addClass("nx-basicfieldeditor-item-select-label");H.append(d),h.append(H,j)}else h.append(j)}},ID:{read:function(a,b){l(a,Z).read(a,b)},readonly:function(a,b){l(O).read(a,b)},edit:function(a,b){a.model.isRowNew(a.row)&&(b=null),a.metadata.ref=a.model.objectName,l(a,W).edit(a,b)}},STRING:{read:function(a,b){l(a,Z).read(a,b)},readonly:function(a,b){l(Y).read(a,b)},edit:function(a,b){l(a,Z).edit(a,b)}},IMAGE:{read:function(b){var c,d=b.options,e=a.component.factory({element:b.element,xmlDefinition:a.utils.makeXMLDoc("<image/>").attr({alt:b.model.getRowMergeResult(b.row,d.alt||"",{asText:!0}),url:b.row[b.id]||b.model.getRowMergeResult(b.row,d.url||"",{asText:!0}),model:b.model.id,dataSource:b.model.dataSourceName,source:"url"}),state:{_parentComponentId:d.parentComponentId}});d.height&&(e.element.css({height:d.height,overflow:"hidden"}),c=e.element.children().first(),d.fill&&c.addClass("nx-field-image-fill"),c.addClass("nx-field-image-withheight").attr("tabindex",0)),b.subComponents.push(e)},readonly:function(a,b){l(da).read(a,b)},edit:function(a,b){l(da).read(a,b)}},ANYTYPE:{read:function(a,b){l(a,r.getDisplayTypeOfEntity(b))[a.mode](a,b)},readonly:function(a,b){l(E).read(a,b)},edit:function(a,b){l(E).read(a,b)}}},o.each(n,function(b,c){c.loading=function(b){l(b,Z).read(b,a.$L("loading"))}}),q.renderers=m,q.getRenderer=k,q.fieldRenderers=n,q.getFieldRenderer=l,q.click2Dial=c}(skuid),function(a){function b(d){function r(a){var b=K.filterCondition;return!(!b||b.inactive)&&(K.isMultiselect?c.inArray(a,b.values)>-1:a===b.value)}d||(d={});var y,z,A,B,C,D,E,F=d.xml,G=d.list,H=G.model,I=H.getDataSource(),J=H.getDataSourceName(),K=this,L=K.element=d.element||c("<div>"),M=F.attr("condition"),N=K.type=F.attr("type"),O=!1,P=K.items=[],Q=!!G&&G.options.delayFilterExecution,R=F.attr("labelmode"),S=F.attr("filtermethod")||w,T=F.attr("filteroffoptionlabel"),U=d.cssClass||"";R||"daterange"!==N&&"numericrange"!==N||(R="auto"),"New Filter"===T&&F.attr("filteroffoptionlabel",""),K.affectCookies="false"!==F.attr("affectcookies"),K.isReferenceFilter=!1,L.addClass("nx-conditiontoken"),K.list=G,K.model=G.model,K.sources=[],U&&K.element.addClass(U),K.affectedConditions={},M&&(K.filterCondition=H.getConditionByName(M,!0),!y&&K.filterCondition&&(y=H.getField(K.filterCondition.field))),K.filterCondition&&(K.affectedConditions[M]=K.filterCondition),F.find("effect").each(function(){var a=c(this),b=a.attr("condition"),d=H.getConditionByName(b,!0);d&&(K.affectedConditions[b]=d)});var V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na=function(a,b){if(!a)return"";var c=a;return b===s&&(c="$"+a),b===t&&(c=a+"%"),c},oa=function(a){var b=a.keyCode?a.keyCode:a.which;-1!==[8,9,13,27,46,110,190].indexOf(b)||65==b&&(a.ctrlKey||a.metaKey)||b>=35&&b<=40||b>=48&&b<=57&&!a.shiftKey&&!a.altKey||b>=96&&b<=105||a.preventDefault()},pa=function(a,b,c){var d,e,f,g;return a.length>1?(d=c.getValueKeyPrefix(b),g=a.find(function(a){return a.keyPrefix===d}),e=g.objectName,f=g.keyField||"Id"):(g=a[0],e=g.objectName,d=c.getValueKeyPrefix(b,e),f=g.keyField||c.getIdField(H)),{keyPrefix:d,targetObjName:e,keyField:f}};if("select"===N||"multiselect"===N){K.isMultiselect="multiselect"===N;var qa,ra,sa="auto"===F.attr("conditionsource");if(sa){if(!(qa=F.attr("conditionfield")))return;if(y=H.getField(qa),K.isReferenceFilter=!1,"REFERENCE"!==y.displaytype||f.endsWith(y.id,"RecordTypeId")||(K.isReferenceFilter=!0),M="__autofilter__"+qa,K.filterCondition=ra=H.getConditionByName(M,!0),ra){if(ra&&K.isReferenceFilter&&!0!==ra.inactive){var ta=[],ua=K.isMultiselect&&ra.values,va={};ua?c.each(ra.values,function(a,b){ta.push(b)}):ra.value&&ta.push(ra.value);var wa=H.getField(ra.field),xa=wa.referenceTo;if(ta.length){c.each(ta,function(a,b){var c=pa(xa,b,I),d=va[c.keyPrefix];d||(d=va[c.keyPrefix]={objectType:c.targetObjName,dataSourceName:J,idField:c.keyField,fields:[I.getNameField(c.targetObjName)],records:[]}),d.records.push(b)});var ya=a.data.getSync(va);ya?(c.each(ta,function(a,b){var c=pa(xa,b,I),d=ya[c.keyPrefix],e=!!d&&d[b],f=va[c.keyPrefix].fields[0];P.push({label:e?e.record[f]:"Invalid record",value:b,isSelected:!0})}),ua||(O=!0)):(c.each(ta,function(b,c){P.push({label:a.$L("loading"),value:c,isSelected:!0})}),ua||(O=!0),a.data.get(va).then(function(){L.empty(),new b({element:L,xml:F,list:G})}))}}}else{K.filterCondition=ra=new o;var za=F.attr("conditionoperator");za||(za=K.isMultiselect?"MULTIPICKLIST"===y.displaytype?"includes":"in":"="),K.isMultiselect&&"fieldvalue"===ra.type&&(ra.type="multiple",delete ra.sourceType),ra.operator=za,ra.field=qa,ra.inactive=!0,ra.name=M,ra.encloseValueInQuotes=!0,S===x&&(ra.processOnClient=!0),ra.originalValue="",ra.value="",ra.originalInactive=!0,H.addCondition(ra)}K.affectedConditions[M]=ra}S===x&&(K.filterCondition.processOnClient=!0);var Aa;("true"===F.attr("createfilteroffoption")||sa)&&(Aa=f.mergeAsText("global",F.attr("filteroffoptionlabel")||"",{createFields:!0,registerFields:!1}),K.isMultiselect||K.isReferenceFilter||(this.filterCondition&&this.filterCondition.value===this.filterCondition.originalValue&&(O=!0),this.filterCondition||(O=!0),P.push({label:Aa,value:"__reset",affectDefaultCondition:!0,isSelected:O})));var Ba=F.children("sources").first();if(!sa||Ba.length&&Ba.children().length||(Ba.length||(Ba=n("<sources/>")),Ba.append(n('<source type="metadata"/>'))),Ba.children().each(function(){var b,d=c(this),e=d.attr("effectsbehavior"),g={};if(K.sources.push(g),"defaultandothers"!==e&&"justothers"!==e||(b=d.children("effects").children(),b.length&&(g.effects=b)),"manual"===d.attr("type"))d.children("options").children().each(function(){var a,b,d=c(this);if("simple"===d.attr("type")&&K.filterCondition){var e=d.attr("value");void 0===e?e="":f.isString(e)&&(e=f.mergeAsDataInContext(e,{model:K.model})),b=r(e),a={label:f.mergeAsText("global",d.attr("label")||e||"",{createFields:!0,registerFields:!1}),value:e,isSelected:b,affectDefaultCondition:!0,source:g},b&&(O=!0)}else if("complex"===d.attr("type")){var h=d.children("effects").children(),i=f.mergeAsText("global",d.attr("label")||"",{createFields:!0,registerFields:!1});b=K.isSelectedFromEffects(h),a={label:i,effects:h,value:i,isSelected:b,source:g},b&&(O=!0)}a&&P.push(a)});else{var h="justothers"!==d.attr("effectsbehavior");if("model"===d.attr("type")){var i=a.$M(d.attr("model")),j=d.children("labeltemplate").text(),k=d.children("valuetemplate").text();i&&(g.model=i,c.each(i.data,function(a,b){var c=f.mergeAsText("row",j||"{{{"+f.getNameField(i.objectName)+"}}}",{createFields:!0,registerFields:!1},i,b),d=f.mergeAsText("row",k||"{{{Id}}}",{createFields:!1,registerFields:!1},i,b),e=r(d);P.push({label:c,value:d,isSelected:e,affectDefaultCondition:h,source:g,row:b}),e&&(O=!0)}))}else if("metadata"===d.attr("type")){if(K.filterCondition){var l=y,m=f.mergeAsText("model",d.attr("prefix")||"",{createFields:!0,registerFields:!1},H),n=f.mergeAsText("model",d.attr("suffix")||"",{createFields:!0,registerFields:!1},H),o={};if(c.each(P,function(a,b){o[b.value]=b}),l){var p=H.recordTypeInfos;l.picklistEntries&&l.picklistEntries.length?c.each(l.picklistEntries,function(a,b){var c=b.value,d=r(c),e=b.label?b.label:c;o[c]||P.push({label:m+e+n,value:c,isSelected:d,affectDefaultCondition:h,source:g}),d&&(O=!0)}):p&&p.length&&f.endsWith(l.id,"RecordTypeId")&&c.each(p,function(a,b){var c=b.recordTypeId;if(b.isAvailable&&(1===p.length||!b.isMaster)){var d=r(c);o[c]||P.push({label:m+b.name+n,value:c,isSelected:d,affectDefaultCondition:h,source:g}),d&&(O=!0)}})}}}else if("custom"===d.attr("type")){var q=d.attr("snippet");if(q){var s=a.snippet.get(q);s&&c.each(s({list:K,model:H}),function(a,b){var d=c("<div>").append(b.label?H.mergeModel(b.label):""),e=r(b.value);P.push({label:d.text(),value:b.value,isSelected:e,affectDefaultCondition:h,source:g}),e&&(O=!0)})}}}}),O||K.isMultiselect||K.isReferenceFilter||P.push({label:" - - - - ",value:"",isSelected:!0}),K.activateFilter=function(){K.isMultiselect||K.isReferenceFilter?(K.resetAffectedConditions(),K.isReferenceFilter?(P.length=0,Array.prototype.push.apply(P,c.map(L.actionAutocomplete("getSelectedItems"),function(a){return a.isSelected=!0,a.affectDefaultCondition=!0,a}))):K.setOriginalValue(L.val()),P.length&&(K.hasSelected=!1,c.each(P,function(){this.isSelected?(K.hasSelected=!0,K.applyFilterForItem(this,{fireSourceEffects:!1})):K.unApplyFilterForItem(this,{fireSourceEffects:!1})})),K.hasSelected||(K.filterCondition.inactive=!0),K.handleSourceEffects(P)):K.selectedItem&&(K.resetAffectedConditions(),K.applyFilterForItem(K.selectedItem),K.setOriginalValue(K.selectedItem))},K.isMultiselect&&!K.isReferenceFilter){var Ca=!1,Da=c.map(P,function(a){if(a.isSelected)return Ca=!0,a.value}).join(";"),Ea=function(){var a=L.data("multiselect-newvalues"),b=L.data("multiselect-oldvalues");if(!1===H.hasChanged){var d={};h(a)||c.each(a.split(";"),function(){d[this]=1}),c.each(P,function(a,b){b.isSelected=b.value in d}),Q?(h(b)&&(b="__reset"),K.setOriginalValue(b),K.list.showFilterActions()):(K.activateFilter(),K.executeFilter())}},Fa=function(){K.restoreOriginalValue()};K.setOriginalValue(Ca?Da:"__reset"),e(u).edit({position:{my:"right top",at:"right bottom"},element:L.addClass("nx-actionselect"),entries:P,value:Da,selectedText:y?y.label+": "+m("number_selected"):null,selectedList:d.selectedList||3,noneSelectedText:Aa,onChange:function(a,b){L.data({"multiselect-newvalues":a,"multiselect-oldvalues":b}),Q&&Ea()},onClose:function(){0!==H.isProcessing||Q||Fa()},onCreate:function(){var a=c(this),b=a.multiselect("widget");Q||b.append(c("<div>").addClass("ui-widget-footer ui-multiselect-footer ui-helper-clearfix").append(c("<div>").attr({role:"button",tabindex:0}).text(m("apply")).addClass("sk-timefilter-button").css("cursor","pointer").on("click "+p,function(b){"click"!==b.type&&b.which!==q.ENTER&&b.which!==q.SPACE||(Ea(),a.multiselect("close"))}),c("<div>").attr({role:"button",tabindex:0}).text(m("cancel")).addClass("sk-timefilter-button-grey").css("cursor","pointer").on("click "+p,function(b){"click"!==b.type&&b.which!==q.ENTER&&b.which!==q.SPACE||(Fa(),a.multiselect("close"))})))}}),K._reflowEventSubscription=a.events.subscribe("ui.reflow",K.multiSelectMaxWidth=function(){var a=L.find("div[type=button]").find("span").not(".ui-icon"),b=a.closest(".ui-multiselect"),c=L.find("div[type=button]").find(".nx-actionselect-arrow"),d=function(){var a=L.closest(".nx-panel-left");if(a.length||(a=L.closest(".nx-panel-right")),a.length>0)return a.width()}();d&&(b.css({"max-width":d-10+"px"}),a.css({"max-width":d-c.width()-10+"px","text-wrap":"none",overflow:"hidden","box-sizing":"border-box"}),L.css({"max-width":d+"px"}))}),L.find(".ui-multiselect").append('<div class="nx-actionselect-arrow"><div class="ui-icon ui-icon-triangle-1-s"/></div>')}else{var Ga=function(a){if(!1===H.hasChanged){var b=K.selectedItem;K.selectedItem=a,Q?(K.isReferenceFilter?(c.each(K.affectedConditions,function(){this.values=[]}),K.setOriginalValue(c.map(P,function(a){return a.value}).join(";")),P.length=0,Array.prototype.push.apply(P,c.map(L.list.items,function(a){return a.isSelected=!0,a.affectDefaultCondition=!0,a}))):K.setOriginalValue(b),K.list.showFilterActions()):(K.activateFilter(),K.executeFilter())}},Ha=parseInt(F.attr("autocompthreshold"),10);if(y&&K.isReferenceFilter){var Ia=F.children("conditions").children("condition").map(function(a,b){return new o(c(b))}).toArray();L.actionAutocomplete({refField:y,model:H,items:P,onItemSelect:Ga,isMultiselect:K.isMultiselect,defaultOptionLabel:Aa,additionalConditions:Ia})}else if(P.length<(Ha||25)){var Ja=F.attr("maxheight");L.actionSelect({items:P,onItemSelect:Ga,maxHeight:Ja})}else L.actionAutocomplete({model:H,items:P,onItemSelect:Ga})}}else if("toggle"===N){var Ka=F.children("effects").children(),La=K.isSelectedFromEffects(Ka);La||L.addClass("disabled"),K.activateFilter=function(){if(!1===H.hasChanged&&K.selectedItem){var a=L.is(".disabled");K.resetAffectedConditions(),a?K.unApplyFilterForItem(K.selectedItem):K.applyFilterForItem(K.selectedItem),K.setOriginalValue(a)}},L.actionSelect({items:[{label:f.mergeAsText("model",F.attr("label")||"",{createFields:!0,registerFields:!1},H),effects:Ka,value:"",isSelected:La}],onItemSelect:function(a){var b=L.is(".disabled");L.toggleClass("disabled"),K.selectedItem=a,Q?(K.setOriginalValue(b),K.list.showFilterActions()):(K.activateFilter(),K.executeFilter())}})}else if("daterange"===N){if(V=F.attr("startcondition"),W=F.attr("endcondition"),V&&W&&"auto"!==F.attr("conditionsource"))X=H.getConditionByName(V,!0),Y=H.getConditionByName(W,!0);else if(Z=F.attr("conditionfield"),V="__autofilter__start__"+Z,W="__autofilter__end__"+Z,X=H.getConditionByName(V,!0),Y=H.getConditionByName(W,!0),!X||!Y){if(!Z)return!1;X=new o,X.operator="gte",X.field=Z,X.inactive=!0,X.name=V,X.encloseValueInQuotes=!1,Y=new o,Y.operator="lte",Y.field=Z,Y.inactive=!0,Y.name=W,Y.encloseValueInQuotes=!1,H.addCondition(X),H.addCondition(Y)}if(S===x&&(X.processOnClient=!0,Y.processOnClient=!0),z=H.getField(X.field),A=H.getField(Y.field),!z||!A){if("param"!==X.sourceType||"param"!==Y.sourceType)return!1;z=A={}}$=z.displaytype,_=A.displaytype,X.inactive?aa="":"DATETIME"===$?(D=j(X.value),D=a.time.getLocalDateTime(D),aa=k(D)):(D=i(X.value),aa=X.value),Y.inactive?ba="":"DATETIME"===_?(E=j(Y.value),E.setDate(E.getDate()-1),E=a.time.getLocalDateTime(E),ba=k(E)):(E=i(Y.value),ba=Y.value),ma=function(){Ma.datepicker("getDate")||Na.datepicker("getDate")?ja.css("display","block"):ja.css("display","none")};var Ma=e(v).edit({value:aa,onChange:ma}).addClass("sk-timefilter-input"),Na=e(v).edit({value:ba,onChange:ma}).addClass("sk-timefilter-input");L.addClass("nx-actionselect nx-conditiontoken"),ca=c("<div>"),da=c("<div>").addClass("nx-actionselect-text").append(ca),ea=c("<div>").addClass("nx-actionselect-arrow").append(c("<div>").addClass("ui-icon ui-icon-triangle-1-s")),fa=c("<div>").addClass("nx-actionselect-dropdown sk-timefilter-body").hide(),ga=c("<div>").text(m("start_date")).addClass("sk-timefilter-label"),ha=c("<div>").text(m("end_date")).addClass("sk-timefilter-label"),ia=c("<div>"),ja=c("<div>").addClass("sk-timefilter-clearfilter-button").text("Clear Filter"),ja.click(function(){Ma.datepicker("setDate",null),Na.datepicker("setDate",null),ma()}),Q?(la=c("<div>").text(m("done")).addClass("sk-timefilter-button").attr({role:"button",tabindex:0}),ia.append(la)):(ka=c("<div>").text(m("cancel")).addClass("sk-timefilter-button-grey").attr({role:"button",tabindex:0}),la=c("<div>").text(m("apply")).addClass("sk-timefilter-button").attr({role:"button",tabindex:0}),ia.append(la,ka)),K.updateDisplayValue=function(b,c){var d,e=g.makeFormattedDateFromLocal,h=a.label.merge;return d=b&&c?e(b)+" - "+e(c):b&&!c?h(m("after_this"),e(b)):!b&&c?h(m("before_this"),e(c)):f.mergeAsText("global",F.attr("filteroffoptionlabel")||m("all_time")),ca.text(d),b instanceof Date&&Ma.datepicker("setDate",b),c instanceof Date&&Na.datepicker("setDate",c),ma(),K},K.updateDisplayValue(D,E),ka&&ka.click(function(){fa.hide("fast")}),K.activateFilter=function(){var b,c,d=Ma.datepicker("getDate"),e=Na.datepicker("getDate");if(d&&(b=k(d)),e&&(c=k(e)),b?("DATETIME"===$&&(b=l(a.time.getRealJSDateTimeFromLocal(i(b)))),H.setCondition(X,b,K.affectCookies)):H.deactivateCondition(X,K.affectCookies),c){if("DATETIME"===_){var f=a.time.getRealJSDateTimeFromLocal(i(c));f.setDate(f.getDate()-0+1),c=l(f)}H.setCondition(Y,c,K.affectCookies)}else H.deactivateCondition(Y,K.affectCookies);K.setOriginalValue({start:d,end:e})},la.on("click "+p,function(a){if("click"===a.type||a.which===q.ENTER||a.which===q.SPACE){var b=Ma.datepicker("getDate"),c=Na.datepicker("getDate");Q?K.list.showFilterActions():(K.activateFilter(),K.executeFilter()),K.updateDisplayValue(b,c),fa.hide("fast")}}),fa.append(ga,Ma,ha,Na,ja,ia),L.addClass("nx-actionselect-haslabel").append(da,ea,fa),da.attr("tabindex",0),ea.attr("tabindex",0),da.add(ea).on("click "+p,function(a){"click"!==a.type&&a.which!==q.ENTER&&a.which!==q.SPACE||L.hasClass("unavailable")||(fa.is(":visible")?fa.toggle("fast"):(fa.css("min-width",Math.max(L.width(),180)+"px"),fa.show("fast")))}),fa.on(p+" focusout",function(a){a.which===q.ESCAPE&&(fa.toggle("fast"),da.trigger("focus"))})}else if("numericrange"===N){var Oa,Pa=function(){var a,b,c,d,e;if(a=F.attr("startcondition"),c=F.attr("endcondition"),a&&c&&"auto"!==F.attr("conditionsource"))b=H.getConditionByName(a,!0),d=H.getConditionByName(c,!0);else if(e=F.attr("conditionfield"),a="__autofilter__nstart__"+e,c="__autofilter__nend__"+e,b=H.getConditionByName(a,!0),d=H.getConditionByName(c,!0),!b||!d){if(!e)return!1;b=new o({operator:"gte",field:e,inactive:!0,name:a,encloseValueInQuotes:!1}),d=new o({operator:"lte",field:e,inactive:!0,name:c,encloseValueInQuotes:!1}),H.addCondition(b),H.addCondition(d)}return S===x&&(b.processOnClient=!0,d.processOnClient=!0),[b,d]}();if(X=Pa[0],Y=Pa[1],z=H.getField(X.field),A=H.getField(Y.field),!z||!A)return!1;Oa=z.displaytype,aa=X.inactive?"":X.value,ba=Y.inactive?"":Y.value;var Qa=c("<input>").val(aa).addClass("sk-timefilter-input"),Ra=c("<input>").val(ba).addClass("sk-timefilter-input");Qa.on(p,oa),Ra.on(p,oa),ma=function(){Qa.val()||Ra.val()?ja.css("display","block"):ja.css("display","none")},L.addClass("nx-actionselect nx-conditiontoken"),ca=c("<div>"),da=c("<div>").addClass("nx-actionselect-text").append(ca),ea=c("<div>").addClass("nx-actionselect-arrow").append(c("<div>").addClass("ui-icon ui-icon-triangle-1-s")),fa=c("<div>").addClass("nx-actionselect-dropdown sk-timefilter-body").hide(),ga=c("<div>").text("Min. Value").addClass("sk-timefilter-label"),ha=c("<div>").text("Max. Value").addClass("sk-timefilter-label"),ia=c("<div>"),ja=c("<div>").addClass("sk-timefilter-clearfilter-button").text("Clear Filter"),ja.click(function(){Qa.val(""),Ra.val(""),ma()}),Q?(la=c("<div>").text(m("done")).addClass("sk-timefilter-button").attr({role:"button",tabindex:0}),ia.append(la)):(ka=c("<div>").text(m("cancel")).addClass("sk-timefilter-button-grey").attr({role:"button",tabindex:0}),la=c("<div>").text(m("apply")).addClass("sk-timefilter-button").attr({role:"button",tabindex:0}),ia.append(la,ka)),K.updateDisplayValue=function(b,c){var d,e=a.label.merge;return b=na(b,Oa),c=na(c,Oa),d=b&&c?b+" - "+c:b&&!c?e(m("greater_than"),b):!b&&c?e(m("less_than"),c):f.mergeAsText("global",F.attr("filteroffoptionlabel")||m("all_values")),ca.text(d),ma(),K},K.updateDisplayValue(aa,ba),ka&&ka.click(function(){fa.hide("fast")}),K.activateFilter=function(){var a=Qa.val(),b=Ra.val();a?H.setCondition(X,a,K.affectCookies):H.deactivateCondition(X,K.affectCookies),b?H.setCondition(Y,b,K.affectCookies):H.deactivateCondition(Y,K.affectCookies),K.setOriginalValue({start:a,end:b})},la.on("click "+p,function(a){if("click"===a.type||a.which===q.ENTER||a.which===q.SPACE){var b=Qa.val(),c=Ra.val();Q?K.list.showFilterActions():(K.activateFilter(),K.executeFilter()),K.updateDisplayValue(b,c),fa.hide("fast")}}),fa.append(ga,Qa,ha,Ra,ja,ia),L.addClass("nx-actionselect-haslabel").append(da,ea,fa),da.attr("tabindex",0),ea.attr("tabindex",0),da.add(ea).on("click "+p,function(a){if(("click"===a.type||a.which===q.ENTER||a.which===q.SPACE)&&!L.hasClass("unavailable"))if(fa.is(":visible"))fa.toggle("fast");else{var b=Math.max(L.width(),180);fa.css("min-width",b+"px").show("fast")}}),fa.on(p+" focusout",function(a){a.which===q.ESCAPE&&(fa.toggle("fast"),da.trigger("focus"))})}"toggle"===N||"auto"!==R&&"manual"!==R||(C=c("<div>").addClass("nx-actionselect-label"),"auto"===R?"daterange"===N?B=z.label:"numericrange"===N?B=z.label:y&&(B=y.label):"manual"===R&&(B=F.attr("label"))&&(B=f.mergeAsTextInContext(B,{model:H})),B&&(C.text(B),L.addClass("nx-actionselect-haslabel").prepend(C))),K.selectedItem||K.isMultiselect||(y&&K.isReferenceFilter?K.selectedItem=L.actionAutocomplete("getSelectedItem"):"daterange"===N?K.setOriginalValue({start:D,end:E}):"numericrange"===N?K.setOriginalValue({start:aa,end:ba}):K.selectedItem=L.actionSelect("getSelectedItem")),a.events.publish("_skuid.filter.rendered",[{event:"_skuid.filter.rendered",filter:K}])}var c=a.$,d=a.ui,e=d.getRenderer,f=a.utils,g=a.time,h=f.isUndefined,i=g.parseSFDate,j=g.parseSFDateTime,k=g.getSFDate,l=g.getSFDateTime,m=a.label.read,n=f.makeXMLDoc,o=a.model.Condition,p="keydown.action.skuid",q=a.$.ui.keyCode,r=a.constants.DISPLAY_TYPES,s=r.CURRENCY,t=r.PERCENT,u=r.MULTIPICKLIST,v=r.DATE,w="server",x="client";c.extend(b.prototype,{setOriginalValue:function(a){void 0===this.element.data("originalValue")&&this.element.data("originalValue",a)},restoreOriginalValue:function(){var a=this,b=a.element,d=b.data("originalValue");if(a.isMultiselect&&!a.isReferenceFilter){if(b=b.find("select"),"__reset"===d)b.val("");else if(d){var e=d.split(";");c.each(b.children("option"),function(a,b){c(b).prop("selected",c.inArray(b.value,e)>-1)})}b.data("echMultiselect")&&b.multiselect("refresh")}else void 0!==d&&("toggle"===a.type?b.toggleClass("disabled",d):"daterange"===a.type?a.updateDisplayValue(d.start,d.end):a.isReferenceFilter?b.actionAutocomplete("resetItem",d):d&&"undefined"!=typeof d.value&&(a.element.is(".nx-actionautocomplete")?b.actionAutocomplete("resetItem",d.value):b.actionSelect("selectItem",d,{triggerHandlers:!1})))},isSelectedFromEffects:function(a){var b=this,d=!1;return a.each(function(){var a=c(this),e=b.affectedConditions[a.attr("condition")];if(e)if("deactivate"===a.attr("action")){if(!e.inactive)return d=!1,!1}else if("set"===a.attr("action")){var g=f.mergeAsText("global",a.attr("value")||"",{createFields:!0,registerFields:!1});if(g!==e.value||e.inactive)return d=!1,!1}else if("activate"===a.attr("action")&&e.inactive)return d=!1,!1;d=!0}),d},resetAffectedConditions:function(){var a=this;c.each(a.affectedConditions,function(){a.model.resetCondition(this,a.affectCookies)})},handleSourceEffects:function(a){var b=this,d=[],e=[],f=[];c.each(a,function(a,b){-1===f.indexOf(b.source)&&f.push(b.source),b.isSelected&&-1===d.indexOf(b.source)&&d.push(b.source)}),e=f.filter(function(a){return-1===d.indexOf(a)}),c.each(d,function(a,d){d.effects&&d.effects.length&&c.each(d.effects,function(a,e){b.applyEffect(c(e),d)})}),c.each(e,function(a,d){d.effects&&d.effects.length&&c.each(d.effects,function(a,d){b.unApplyEffect(c(d))})})},applyEffect:function(a,b,c){var d=this,e=d.model,g=d.affectedConditions[a.attr("condition")];if(g)if("deactivate"===a.attr("action"))e.deactivateCondition(g,d.affectCookies);else if("set"===a.attr("action")){var h,i={};c&&c.row&&(i.row=c.row),b&&b.model&&(i.model=b.model),a.attr("value")?h=a.attr("value"):c.value&&(h=c.value),h=f.mergeAsTextInContext(h,i,{createFields:!1,registerFields:!1}),e.setCondition(g,h,d.affectCookies)}else"activate"===a.attr("action")&&e.activateCondition(g,d.affectCookies)},unApplyEffect:function(a){var b=this,c=b.model,d=b.affectedConditions[a.attr("condition")];d&&("deactivate"===a.attr("action")?c.activateCondition(d,b.affectCookies):c.deactivateCondition(d,b.affectCookies))},applyFilterForItem:function(a,b){b=b||{};var d,e=this,g=e.model,i=!1!==b.fireSourceEffects,j=[],k=a.effects,l=a.source,m=l&&l.effects,n=a.affectDefaultCondition;if(k&&k.length&&c.each(k,function(){j.push(this)}),i&&m&&m.length&&c.each(m,function(){j.push(this)}),d=j&&j.length,d&&c.each(j,function(){e.applyEffect(c(this),l,a)}),n&&!h(a.value)&&e.filterCondition)if("__reset"===a.value)g.resetCondition(e.filterCondition,e.affectCookies);else{var o,p=f.mergeAsText("global",a.value||"",{createFields:!1,registerFields:!1}),q=e.filterCondition.operator;e.isMultiselect?(o=e.filterCondition.values,o?(f.isString(o)&&(o=o.split(";")),-1===c.inArray(p,o)&&o.push(p)):o||(o=[p]),f.isMultiValueOperator(q)||("="===q?q="in":"!="===q&&(q="not in"),e.filterCondition.operator=q)):o=p,g.setCondition(e.filterCondition,o,e.affectCookies)}},unApplyFilterForItem:function(a,b){b=b||{};var d,e=this,g=e.model,h=!1!==b.fireSourceEffects,i=[],j=a.effects,k=a.source,l=k&&k.effects,m=a.affectDefaultCondition;if(j&&j.length&&c.each(j,function(){i.push(this)}),h&&l&&l.length&&c.each(l,function(){i.push(this)}),d=i&&i.length,d&&c.each(i,function(){e.unApplyEffect(c(this))}),m&&"undefined"!=typeof a.value&&e.filterCondition)if("__reset"===a.value){var n=f.mergeAsText("global",a.value||"",{createFields:!1,registerFields:!1});g.setCondition(e.filterCondition,n,e.affectCookies)}else if(e.isMultiselect){var o=e.filterCondition.values,p=c.inArray(a.value,o);p>-1&&(o.splice(p,1),g.setCondition(e.filterCondition,o,e.affectCookies))}else g.resetCondition(e.filterCondition,e.affectCookies)},executeFilter:function(){var b,c=this,d=c.list,e=d.searchBox;e&&(b=e.val()),"remove"!==d.options.emptySearchBehavior||b?d.updateData({message:m("applying_filter"),failmessage:m("filter_could_not_be_applied"),showerror:!0,successcallback:function(){a.events.publish("filter.executed")}}):d.model.abandonAllRows()},getItems:function(){return this.items.map(function(a){return a})},unregister:function(){var a=this._reflowEventSubscription;return a&&a.unsubscribe(),this}}),d.Filter=b}(skuid),function(a){function b(b,e,f){var g=b.closest("skuidpage"),h=k(g),j=c(b),l=d(g);return a.loader.service.loadDataSourceAndDependencies(h).then(function(){var c,d,g,i,k=a.dataSource.getDataSource(h),m=k&&k.getDataSourceType(),o={conversationKillSwitch:m.voiceCommands.methods.conversationKillSwitch,examples:l},p=e&&e.getParentPage&&e.getParentPage(),q={};if(j.match(/^skuid__/)||(o=n(o)),p&&(q._parentPageId=p.id()),d=a.component.factory({type:j,definition:o,state:q}),g=d._getCPI(),i={listeningHandler:g.listeningHandler||function(){},processingHandler:g.processingHandler||function(){},textSubmissionHandler:g.textSubmissionHandler||function(){},responseHandler:g.responseHandler||function(){},endOfConversationHandler:g.endOfConversationHandler||function(){}},p&&(p.getContentElement().append(d.element),p.childComponents.push(d)),!m||!m.supportsVoiceCommands())throw"Data source does not support voice iteraction";if(!p)throw"No page component available";return c=m.getPageParametersForVoiceCommands(p.definition),m.voiceCommands.methods.beginConversation(k,b,c,i,f)}).then(function(a){var c=a.inputs,d=a.actionSequence;if(!d)throw"No Action Sequence configured for voice command";return i(c,d),d.run(e,f,b,c)})}function c(b){var c=b.attr("ui")||"chatbotFullOverlay",d=a.themeSettings.getAll(),e=!(!d||!d.palette),f=c.match(/^skuid__/);return e?f?c:"skuid__"+c:f?c.substr(7).toLowerCase():c.toLowerCase()}function d(a,b){var c=a.find("example-command"),d=n.map(c,function(a){return n(a).attr("value")});return b=b||5,e(d,b)}function e(a,b){if(p(a,"length")<=b)return a;for(var c=[];b>0;){var d=f(0,a.length);c.push(a[d]),a.splice(d,1),b--}return c}function f(a,b){return a=Math.ceil(a),b=Math.floor(b),Math.floor(Math.random()*(b-a))+a}function g(a){if(a)return a.replace(/\s/g,"").toLowerCase()}function h(a,b){var c={};return a&&b?(n.each(b,function(b,d){n.each(a,function(a,b){var e=g(b[d]);e&&(c[e]||(c[e]=b))})}),c):{}}function i(b,c){var d=c,e=d.getInputs("model"),f=d.getInputs("model-field"),i=d.getInputs("model-condition"),j=a.model.map(),k=h(j,["id","label","labelPlural"]);n.each(e,function(a,c){var d,e=c.attr("name"),f=b[e];f=g(f),(d=k[f])&&(b[e]=d.id)}),n.each(f,function(a,c){var d=c.attr("name"),e=c.attr("model-source"),f=b[e],i=j[f],k=i&&i.fields,l=b[d],m=h(k,["id","label"]);l=g(l),(m=m[l])&&(b[d]=m.id)}),n.each(i,function(a,c){var d,e=c.attr("name"),f=c.attr("model-source"),i=b[f],k=j[i],l=k&&k.conditions,m=b[e],n=h(l,["name","field"]);m=g(m),(d=n[m])&&(b[e]=n.name)})}function j(a){return!!a&&"true"===a.attr("voice-enabled")}function k(a){if(a)return a.attr("voice-datasource")}function l(b){var c=j(b),d=k(b);if(m()&&c&&d)return a.dataSource.getDataSource(d)}function m(){return o.inPlatform(q.NATIVE)}var n=a.$,o=a.utils,p=o.grab,q=a.constants;a.voiceCommands={globalVoiceAction:b,getExampleVoiceCommands:d,getUIComponentType:c,voiceIsConfigurableForOrg:m,getDataSourceConfiguredForVoiceOnPage:l,getVoiceDataSourceName:k,pageIsVoiceEnabled:j}}(skuid),function(a){function b(a,b){this._id=a.attr("id"),this._name=a.attr("label"),this._type=a.attr("type")||u.REUSABLE,this._description=a.children("description").text(),this._actionNodes=a.children("actions"),this._pageComponent=b,this._inputs=a.children("inputs").children(),this._voiceCommand=a.attr("voice-command"),this._type===u.EVENT_TRIGGERED&&b&&g(this,a),t[this._id]=this}function c(a){return a&&a.$Input||{}}function d(){return h().filter(function(a){if(a.getVoiceCommandId())return a})}function e(a,b){var c={};s.each(a,function(d){var e=a.eq(d);c[e.attr("name")]=r.mergeAsDataInContext(e.attr("value"),b)}),f(c,b)}function f(a,b){var d=c(b);b.$Input=s.extend({},d,a)}function g(b,c){function d(a){var d,f=arguments[arguments.length-1],g=f.uniqueId;a&&s.isPlainObject(a)&&r.size(a)&&(d={},s.each(a,function(a,b){d[a]=b})),k[g]||(k[g]=1,setTimeout(function(){delete k[g]},5),b.run(e,{},c,d))}var e=b.getPageComponent(),f=c.attr("event-name"),g=c.attr("event-channel"),h=c.attr("event-scope")||v.PAGE,i={scope:v.PAGE},j={scope:h},k={};f&&(g&&(j.channel=i.channel=g),e.subscribe(f,d,i),h!==v.SKUID&&h!==v.GLOBAL||e.storeSubscription(a.events.subscribe(f,d,j)))}function h(){return s.map(t,function(a){return a})}function i(a){a=a||"id";var b="id"===a?"getId":"getName",c={};return s.map(t,function(a){c[a[b]()]=a}),c}function j(a){var b=i("id");return a?b[a]:b}function k(a){var b=i("name");return a?b[a]:b}function l(a){if(a)return a.find("resources > actionsequences > actionsequence")}function m(a){return s.map(a,function(a){var b;if(a)return b=a.definition&&a.getType&&"skuidpage"===a.getType()?a.definition:a,s.map(l(b),function(a){return s(a)})})}function n(){return s.map(a.component.getByType("skuidpage"),function(a){return a.definition})}function o(a,b){a=r.escapeSelector(a),b=b||n();for(var c,d=0;d<b.length;d++)if(c=b[d].find("actionsequence#"+a).first(),c.length)return c}function p(a){return m(a?[a]:n()).map(function(c){return new b(c,a)})}function q(a,b,c){var d=a.attr("action-sequence-id"),e=j(d);if(!e)throw"Invalid Action Sequence specified.";return e.run(b,c,a)}var r=a.utils,s=a.$,t={},u=a.constants.ACTION_SEQUENCE_TYPES,v=a.constants.EVENT_SCOPES;b.prototype={getId:function(){return this._id},getName:function(){return this._name},getVoiceCommandId:function(){return this._voiceCommand},getDescription:function(){return this._description},getPageComponent:function(){return this._pageComponent},getType:function(){return this._type},getInputs:function(a){var b=this._inputs;if(!a)return b;var c=[]
;return s.each(b,function(a,b){b=s(b),b.attr("type")&&c.push(b)}),c},run:function(b,d,g,h){d=d||{};var i=this,j=g&&g.children("inputs").children(),k=c(d);return j&&j.length&&e(j,d),h&&f(h,d),a.actions.runActionsNode(i.getActions(),b,d).then(function(a){return d.$Input=k,a})["catch"](function(a){throw d.$Input=k,a})},getActions:function(){return this._actionNodes},unregister:function(){delete t[this._id]}},a.actionSequences={ActionSequence:b,getAll:h,getAllActionSequencesFromPages:m,getAllVoiceCommandListeners:d,getById:j,getByName:k,getSequenceXMLFromId:o,initializeActionSequences:p,map:i,runActionSequenceAction:q}}(skuid),function(a){var b=a.$,c=a.constants,d=a.utils,e=d.mergeAsDataInContext,f=d.makeXMLDoc,g=function(b,c){return c?a.$M(e(b,c)):a.$M(b)},h=function(a,b,c,d){if(a&&b)return c?a.getConditionByName(e(b,c),d):a.getConditionByName(b,d)},i=a.actions={},j=a.interactions={},k={},l={},m={swipe:"drag",swipeleft:"dragleft",swiperight:"dragright",swipeup:"dragup",swipedown:"dragdown"},n=c.DISPLAY_TYPES,o=n.BOOLEAN,p=n.DATE,q=n.DATETIME,r=c.EVENT_SCOPES,s=i.register=function(a){b.extend(k,a)},t=d.getContextToUse,u=function(a,c,d,e){var f=this,g=f.getModel(),h="all"===c.attr("affectedrows")?"model":"row",i=f.getContextToUse(h),j=i.row,k=i.list,l=!!k&&b.map(k.getSelectedItems(),function(a){return a.row});!l&&e.rows&&(l=e.rows),j&&g&&g.getRowById(g.getRowId(j))?g[a]([j]):l&&l.length&&g&&k&&k.model===g?g[a](l):l&&l.length&&e.model&&!k?e.model[a](l):g&&g.data.length&&g[a](g.data)},v=function(a){var b=d.isPromise;return a&&(a.deferred&&b(a.deferred)||b(a))};j.register=function(a){b.each(a,function(){l[this]=1})},j.processInteractionsNode=function(a,c,d){a.children().each(function(){j.processInteractionNode(b(this),c,d)})},j.processInteractionNode=function(a,c,d){if(!a||!a.children)return!1;var e=a.attr("type"),f=a.children("actions").first();if(e in l==!1)return!1;d&&d.selector?c.element.on(e,d.selector,function(a){var d=b(this),e=d&&d.data?d.data("component"):null;e||(e=c),i.runActionsNode(f,e),a&&a.gesture&&a.gesture.preventDefault()}):(c.element.on(e,function(a){i.runActionsNode(f,c),a&&a.gesture&&a.gesture.preventDefault()}),m[e]&&c.element.on(m[e],function(a){a.gesture.stopPropagation(),a.gesture.preventDefault()}))},j.runInteractionsNode=function(c,d,e,g){var h=f("<actions></actions>");return e=e.length?e:[e],c.clone().children("interaction").each(function(a,c){c=b(c);var d=c.attr("type")+("swipe"==c.attr("type")?c.attr("direction"):"");e.indexOf(d)>-1&&h.append(c.children())}),a.actions.runActionsNode(h,d,{model:g.model,item:g.item,row:g.row,list:g.list,initiatorId:g.initiatorId})},j.enableInteractions=function(b,c){function d(d,h){function i(b){if(!(b.target!==b.currentTarget&&["INPUT","BUTTON","SELECT","TEXTAREA"].indexOf(b.target.tagName)>-1||"button"===b.target.getAttribute("role"))){var g;return e?(c.validGestures=h,c.eventName=d,c.event=b,c.item=this,g=e(c)):g=a.interactions.runInteractionsNode(c.interactionsDef,c.component,h,f),b.stopPropagation(),v(g)?g:void 0}}function j(){b.off("click.skuid"),b.hammer({}),b.on(d,i)}if(("tap"==h||h.indexOf("tap")>-1)&&b.on("click.skuid",i),a.ui.hammerJSLoaded)j();else{var k=a.events.subscribeOnce("skuid.resources.hammerjsloaded",j);g&&g.storeSubscription(k)}}var e=c.customInteractionsEvaluator,f=c.context||{},g=c.component;d("tap.skuid","tap"),d("swipeleft.skuid",["swipeleft","swipeeither"]),d("swiperight.skuid",["swiperight","swipeeither"]),d("press.skuid","press")},j.disableInteractions=function(a){a.off("tap.skuid click.skuid swipeleft.skuid swiperight.skuid press.skuid")},i.runActionsNode=function(c,e,f){var g="true"===c.attr("continuesequenceonerror"),h=c.children(),j=[],k=function(a,c){c&&(j.length=0),Array.prototype.push.apply(j,a.get().reverse().map(function(a){return b(a)}))},l=function(c){var f,h=j.pop(),m=c&&c.$Output||{};return h?i.runActionNode(h,e,c).then(function(a,e){var g=h.children("iftrueactions").children();return g.length?(!0===a&&(f=h.attr("whenfinished"),k(g,"continue"!==f)),l(b.extend(c,a))):!1===a?d.reject():l(b.extend(c,a,{$Output:b.extend(m,e)}))})["catch"](function(d,e){if(!0===e)return b.Deferred().reject(d,e);var f=h.children("onerroractions").children();if(f.length)k(f,!0);else if(!g)return a.mobile&&a.mobile.processResponsiveElements(),b.Deferred().reject(b.extend(c,d),!0);return l(b.extend(c,d))}):(a.mobile&&a.mobile.processResponsiveElements(),b.when(c))};return e&&e.xmlDefinition&&e.xmlDefinition.attr&&e.xmlDefinition.attr("buttonset")&&(b(".sm-buttonset-"+e.xmlDefinition.attr("buttonset")).removeClass("sm-active"),e.element.addClass("sm-active")),h.length?(k(h),l(f)):b.when()},i.runActionNode=function(a,b,c){var d=a&&a.attr("type");return i.runAction(d,a,b,c)},i.runAction=function(c,f,g,h){if(c){var j,l,m,n={};c in k?j=k[c]:g&&g.type()&&(l=a.componentType.get(g.type()),(m=l.actions)&&c in m&&(j=m[c]));var o={getContextToUse:function(a){var b={};return a&&(b.mode=a),t(g,h,b)},getModelId:function(a){a||(a={});var b=a.attributeName||"model",c=a.modelId||f&&f.attr(b),d=this.getContextToUse();return d?e(c,d):c},getModel:function(b){return a.$M(this.getModelId(b))},runAction:function(a,b){return b||(b={}),i.runAction(a,b.actionDef||f,b.component||g,b.context||h)},recordOutput:function(b,c){var e=Array.prototype.reduce.call(f.find("> outputs > output"),function(b,c){var d=a.$(c);return b[d.attr("id")]=d.attr("name"),b},{}),g={};d.isString(b)?g[b]=c:g=b,Object.getOwnPropertyNames(g).forEach(function(a){var b=e[a];b&&(n[b]=g[a])})}};return b.when(j&&j.call(o,f,g,h)).then(function(a){return v(a)?a.deferred||a:a}).then(function(a){return b.when(a,n)})}},i.registerEditorWithModelsForActionsNode=function(c,d){var e=c.find("action"),f=function(a,c){var d=a.find('action[type="save"], action[type="requeryModel"], action[type="requeryModels"]');d.length&&d.each(function(){var a=b(this);"requeryModel"===a.attr("type")?c.registerModel(g(a.attr("model"))):a.children("models").children().each(function(){c.registerModel(g(b(this).text()))})})};if("action-sequence"===e.attr("type")){var h=e.attr("action-sequence-id");f(a.actionSequences.getById(h).getActions(),d)}else f(c,d)},s({branch:function(a){var b=this,c=b.getModel(),e=b.getContextToUse();return c&&(e.model=c,e.model===c&&-1===c.data.indexOf(e.row)&&(e.row=c.getFirstRow())),d.mergeInContext(a.children("formula").text(),e,{evaluateFormulas:!0,outputType:o,asData:!0,createFields:!1})},blockUI:function(a){var c={},e=this,f=a.attr("message"),g=a.attr("timeout");f&&(c.message=d.mergeInContext(f,e.getContextToUse(),{createFields:!0,registerFields:!1,nl2br:!0})),g&&(c.timeout=parseInt(g,10)),b.blockUI(c)},unblockUI:function(){b.unblockUI()},deactivateFilterableConditions:function(a){var c=this,d=a.children("models").first();b.each(d.children("model"),function(){c.getModel({modelId:b(this).text()}).deactivateFilterableConditions()})},save:function(c,d,e){var f,g=this,h=[],i=c.children("models").first(),j="true"===c.attr("rollbackonanyerror"),k=b.Deferred(),l=e?e.initiatorId:null,m={rollbackOnAnyError:j};return l&&(m.initiatorId=l),i.length?b.each(i.children("model"),function(){(f=g.getModel({modelId:b(this).text()}))&&h.push(f)}):(f=g.getModel())&&h.push(f),d&&d.button&&d.button.startProcessing(),b.when(a.model.save(h,m)).then(function(a){a.totalsuccess?k.resolve(a):k.reject(a),d&&d.button&&d.button.stopProcessing()},function(a){k.reject(a),d&&d.button&&d.button.stopProcessing()}),k.promise()},cancel:function(c){var d,e=this,f=[],g=c.children("models").first();g.length?b.each(g.children("model"),function(){(d=e.getModel({modelId:b(this).text()}))&&f.push(d)}):(d=e.getModel())&&f.push(d),a.model.cancel(f)},markRowsForDeletion:function(a,b,c){u.call(this,"deleteRows",a,b,c)},unmarkRowsForDeletion:function(a,b,c){u.call(this,"undeleteRows",a,b,c)},unmarkAllRowsForDeletion:function(a){var c=this,d=a.children("models").first();d.length&&b.each(d.children("model"),function(){var a=c.getModel({modelId:b(this).text()});a&&a.undeleteRows()})},createRow:function(a){var c=this,d=c.getModel();if(d){var f="all"===a.attr("affectedrows")?"model":"row",g=c.getContextToUse(f),h=g.model,i=g.row,j=g.list,k=g.editor,l=g.rows,m="append"===a.attr("appendorprepend"),n="edit"===a.attr("defaultmodefornewitems"),o=a.children("defaults").first().children(),p=[],q=function(a,c){var f=[],h={createFields:!1,registerFields:!1},i={row:a,model:c},l=j?j.conditions:null,q=k?k.conditions:null;return b.extend(i,g),k&&q&&q.length&&k.models&&b.inArray(c,k.models)>-1?b.each(q,function(){f.push(this)}):j&&l&&l.length&&j.model===d&&b.each(l,function(){f.push(this)}),o&&o.length&&o.each(function(){var a=b(this),c=e(a.attr("field"),g),d=a.attr("value"),j=e(d,i,h);f.push({field:c,value:j})}),d.createRowAsync({additionalConditions:f,doAppend:m,editModeForNewItems:n}).then(function(a){p.push(a)})},r=[];return i?r.push(q(i,h)):l&&l.length?b.each(l,function(a,b){r.push(q(b,h))}):r.push(q(null,h)),b.when.all(r).then(function(){var a={};return p.length&&(1===p.length?a.row=p[0]:a.rows=p),c.recordOutput("rows",p),a})}},adoptRows:function(a){var b=this,c=b.getModel({attributeName:"sourcemodel"}),d=b.getModel({attributeName:"targetmodel"}),e="all"===a.attr("affectedrows")?"model":"row",f=b.getContextToUse(e),g=f.list,h=f.rows,i=f.row,j=[];c&&d&&c.data&&c.data.length&&(j=i&&c.getRowById(c.getRowId(i))?d.adoptRows([i]):h&&h.length&&g&&g.model===c?d.adoptRows(h):d.adoptRows(c.data)),b.recordOutput("rows",j)},"voice-command":function(b,c,e){return a.platform.hasFeature("Voice")?a.voiceCommands.globalVoiceAction(b,c,e):d.reject("Voice feature flag is not active")},updateRow:function(a){var c,f,g,h=this,i=a.attr("field"),j=a.attr("value"),k=h.getModel({attributeName:"fieldmodel"}),l="all"===a.attr("affectedrows")?"model":"row",m=h.getContextToUse(l),n=m.list,r=m.rows,s=m.model,t=m.row;i=e(i,m),!s&&n&&(s=n.model),k&&(c=k.getField(i))&&(f=c.displaytype);var u=function(a,c){var g,k,l,n={};if("REFERENCE"===f){k=c.getReferenceFieldRelationshipName(i);var r,s,t=d.extractFieldsFromTemplate(j);if(t&&1===t.length)if(r=t[0],d.startsWith(r,"$Model.")&&d.contains(r,".data.")){s=r.split(".");var u,v=h.getModel({modelId:s[1]}),w=parseInt(s[3],10),x=r.indexOf("."+s[3]+".")+2+s[3].length,y=r.substring(x,r.length);v&&(u=v.data[w])&&(l=y===v.getIdField()?u:v.getFieldValue(u,v.getReferenceFieldRelationshipName(y),!0))}else l=r===c.getIdField()?a:c.getFieldValue(a,c.getReferenceFieldRelationshipName(r),!0)}return j?(g=e(j,b.extend(m,{model:c,row:a}),{createFields:!1,registerFields:!1}),f===o&&("false"===g?g=!1:"true"===g&&(g=!0))):f&&-1!==b.inArray(f,[o,p,q])?f===o&&(g=!1):g="",n[i]=g,k&&l&&(n[k]=l),n};k&&(t&&k.getRowById(k.getRowId(t))?k.updateRow(t,u(t,s)):r&&r.length&&n&&n.model===k?(g={},b.each(r,function(a,b){g[n.model.getRowId(b)]=u(b,n.model)}),d.size(g)&&k.updateRows(g)):(g={},b.each(k.data,function(a,b){g[k.getRowId(b)]=t?u(t,s):u(b,k)}),d.size(g)&&k.updateRows(g)))},requeryModel:function(a,c,e){var f=this,g=f.getModel(),h=b.Deferred();if(!g)return d.reject('The model "'+f.getModelId()+'" could not be resolved.');c&&c.button&&c.button.startProcessing(),g.hasChanged&&g.cancel();var i="loadmore"!==a.attr("behavior")?"updateData":"getMoreData";return b.when(g[i](undefined,e)).then(function(a){f.recordOutput("rows",a.updatedRows[g.id]),h.resolve(a),c&&c.button&&c.button.stopProcessing()},function(a){h.reject(a),c&&c.button&&c.button.stopProcessing()}),h.promise()},requeryModels:function(c,d,e){var f=this,g=[],h=c.children("models").first(),i=b.Deferred();h.length&&b.each(h.children("model"),function(){var a=f.getModel({modelId:b(this).text()});a&&g.push(a)}),d&&d.button&&d.button.startProcessing(),b.each(g,function(){this.hasChanged&&this.cancel()});var j="loadmore"!==c.attr("behavior")?"updateData":"getMoreData";return b.when(a.model[j](g,undefined,e)).then(function(a){f.recordOutput("idxrows",a.updatedRows),i.resolve(a),d&&d.button&&d.button.stopProcessing()},function(a){i.reject(a),d&&d.button&&d.button.stopProcessing()}),i.promise()},sortModel:function(a,c,d){var f=this,g=f.getModel(),h=e(a.attr("field"),d),i=b.Deferred(),j="true"===a.attr("client-side"),k="false"!==a.attr("should-query");return g?(g.toggleOrdering(h,{explicitOrder:a.attr("method")||"toggle",clientSide:j,shouldQuery:k,shouldUpdatePersonalization:!1},function(){i.resolve()}),i.promise()):i.reject("Invalid model provided for Sort Model action.").promise()},searchModel:function(a,c,d){function f(a){return b.Deferred().promise().reject(a)}var g,h=this,i=h.getModel();if(!i){var j=h.getModelId();return f(j?"Invalid Model: "+j+" does not exist, so it cannot be searched.":"No Model specified to Search.")}return(g=i.getDataSourceType())&&g.modelsCanSearch()?(i.buildSearchCondition(!1,e(a.attr("search"),d),i.getSearchableFields()),h.runAction("requeryModel")):f("The selected Model's Data Source does not support search.")},emptyModelData:function(a){var c=this,d=a.children("models").first(),e={};d.length&&(b.each(d.children("model"),function(){var a=b(this).text(),d=c.getModel({modelId:a});e[a]=d?d.emptyData():[]}),c.recordOutput("idxrows",e))},abandonRows:function(a){var b=this,c=b.getModel(),d="all"===a.attr("affectedrows")?"model":"row",e=b.getContextToUse(d),f=e.list,g=e.rows,h=e.row;c&&c.data&&c.data.length&&(h&&c.getRowById(c.getRowId(h))?b.recordOutput("rows",c.abandonRows([h])):g&&g.length&&f&&f.model===c?b.recordOutput("rows",c.abandonRows(g)):b.recordOutput("rows",c.emptyData()))},redirect:function(a){var c=this;d.redirect(b.extend(c.getContextToUse(),{url:a.attr("url"),window:a.attr("window")}))},pageredirect:function(c,e,f){var g={},h=c.attr("page"),i=a.platform.isNative()?"":c.attr("route"),j=c.attr("module");b.each(c.children("params").children(),function(a,c){var e=b(c);g[e.attr("key")]=d.mergeAsTextInContext(e.attr("value"),f,{createFields:!1,registerFields:!1})}),(h||i)&&a.loader.load({isReplace:!0,pageName:h,pageModule:j,parameters:g,routeName:i})},custom:function(c,d,e){var f,g,h=a.snippet.get(c.attr("snippet")),i=this;if(h){if(f=i.getContextToUse(),b.extend(f,{component:d,context:e}),!1===(g=h(f)))return!1;if(g&&"object"==typeof g)return g}},"sfdc-custom-apex":function(a){var b=this;return a.attr("actionname","apex"),b.runAction("datasource-action")},"action-sequence":function(b,c,d){return a.actionSequences.runActionSequenceAction(b,c,d)},"datasource-action":function(c,d,e){var f=c.attr("datasource"),g=c.attr("actionname"),h=a.dataSource.get(f);return h&&h.getDataSourceType()?h.runAction(g,c,d,e):a.loader.service.loadDataSourceAndDependencies(f).then(function(){return h=a.dataSource.get(f),h?h.runAction(g,c,d,e):b.Deferred().reject("Invalid Data Source Name for action: "+g).promise()})},"offline-syncing":function(b,c,d){return a.offline.runAction("offline-syncing",b,c,d)},publish:function(c,e){var f=this,g=c.attr("event"),h=c.attr("scope")||r.SKUID,i=c.children("params").children(),j=c.attr("channel"),k={scope:h,qualifyEventName:!1},l={},m=e&&e.getParentPage&&e.getParentPage();i.length&&b.each(i,function(a,c){var e=b(c),g=e.attr("name"),h=e.attr("value");l[g]=d.mergeAsDataInContext(h,f.getContextToUse())}),j&&(k.channel=j),m&&m.publish?m.publish(g,l,k):a.events.publish(g,l?[l]:undefined,k)},setCondition:function(a,c){var f,g,i,j=this,k=j.getContextToUse(),l=j.getModel(),m=k.model,n=k.row,o=k.rows,p=a.attr("value");return!!l&&(!!(f=h(l,a.attr("condition"),k,!0))&&(!m&&c&&c.model&&(m=c.model),m||(m=l),!n&&o&&o.length&&(n=o[0]),n||(c&&c.row&&!d.isFunction(n)&&(n=c.row),!n&&m&&(n=m.getFirstRow())),i=b.extend({},k,{row:n,model:m}),g=e(p,i,{createFields:!1,registerFields:!1}),void l.setCondition(f,g)))},deactivateCondition:function(a,b,c){var d=this,e=d.getModel();if(!e)return!1;var f=h(e,a.attr("condition"),c);f&&e.deactivateCondition(f)},activateCondition:function(a,b,c){var d,e=this,f=e.getModel();if(!f)return!1;(d=h(f,a.attr("condition"),c))&&f.activateCondition(d)},updateIncludePanel:function(c,d,e){var f=a.component.getById(c.attr("panelid")),g=c.attr("pagename"),h=c.attr("querystring"),i=c.attr("module"),j=e.model,k=e.row,l=b.Deferred();return f?(f.pagename=a.utils.mergeAsText("row",g,{createFields:!1,registerFields:!1},j,k),f.includeType="skuid",i&&(f.modulename=i),f.querystring=h?"?"+a.utils.mergeAsText("row",h,{createFields:!1,registerFields:!1},j,k):"?"+c.attr("parameter")+"="+k.Id,f.load(l.resolve)):l.resolve(),l.promise()}})}(skuid),function(a){function b(a,b,g,h){h=e.extend({countBlanks:!1,rows:b.getRows()},h);var i=b.getField(g);if(!i)return null;var j=d.isMultiCurrencyOrganization,k=d.userInfo.defaultCurrency,l=h.rows,m=!1,n=!0,o=[];return l.forEach(function(a){var c,e=b.getFieldValue(a,g,!0);if(!e&&0!==e){if(!h.countBlanks)return!0;e=0}if(i&&(c=i.displaytype,j&&c===f&&e)){var l,p=d.getRowCurrency({model:b,row:a,field:g});p&&p!==k&&(l=d.convertCurrency(e,p,k))&&l!==e&&(e=l),n&&(p||(p=k),m?m!==p&&(n=!1):m=p)}o.push(e)}),c(a,o)}function c(a,b){switch(a){case g.SUM:return b.reduce(function(a,b){return a+b},0);case g.AVERAGE:return b.reduce(function(a,b){return a+b},0)/b.length;case g.MAXIMUM:return b.reduce(function(a,b){return b>a?b:a},-Infinity);case g.MINIMUM:return b.reduce(function(a,b){return b<a?b:a},Infinity);case g.MEDIAN:if(b.length%2==0){var c=b.sort();return(c[Math.floor(b.length/2)]+c[Math.floor(b.length/2)-1])/2}return b.sort()[Math.floor(b.length/2)];case g.COUNT:return b.length}}var d=a.utils,e=a.$,f="CURRENCY",g=a.constants.AGGREGATION_TYPES;a.aggregations={aggregate:b,aggregateValues:c}}(skuid),function(a){function b(){return j||(j=l(document.body)),j}function c(a){var b=a.bindString;(k[b]||(k[b]={}))[a.componentId]=a}function d(a){l.each(k,function(b,c){c&&a in c&&delete c[a]})}function e(a){return k[a]}function f(a,d,e,f,g){var h;a&&a.children?(h=[],l.each(a.children(),function(){var a=l(this);h.push({key:a.attr("key"),ignoreTextInputs:"true"===a.attr("ignoretextinputs"),modifiers:a.attr("modifiers")})})):h=l.isArray(a)?a:[a],h&&h.length&&(g||(g=b()),h.forEach(function(a){var b,h,i,j,n;m.isString(a)?(h=!1,i=a):(b=a.modifiers,h=!0===a.ignoreTextInputs,i=(b?b.replace(",","+")+"+":"")+a.key),j={componentId:d,bindString:i,visibleElement:f,actionFunction:e},c(j),n="keydown.skuid"+(d?"."+d:""),g.on(n,null,{keys:i,filterTextInputs:h},function(a){if((!h||"true"!==l(a.target).attr("contenteditable"))&&f&&f.is(":visible")&&e){var b,c=k[i],d=j;c&&m.size(c)>1&&(b=function(a){var b,c=a.visibleElement,d=-1;return c&&c.length?(b=c&&c.closest&&c.closest(".ui-dialog-content"),b.length?d=b.zIndex():c.closest("body").length||(d=-2)):d=-2,a.zIndex=d,d},b(j),l.each(c,function(a,c){d.componentId!==a&&c!==d&&c.actionFunction&&b(c)>d.zIndex&&(d=c)})),a.preventDefault(),a.stopImmediatePropagation(),d.actionFunction()}})}))}function g(a,b,c,d,e){f(b,c,d,e,a)}function h(){var a,c;2===arguments.length?(a=arguments[0],c=arguments[1]):(c=arguments[0],a=b()),a.off("keydown.skuid"+(c?"."+c:"")),d(c)}function i(a){h(a)}var j,k={},l=a.$,m=a.utils;a.hotkeys={bind:f,getFromCache:e,off:h,on:g,unbind:i}}(skuid),function(){function a(a,b,c){c=c||{};var d=b.list,f=d.model,g=d.editor,i=c.postSelectFunction;if(g.header&&a&&a.length){var j=[],k=2,l={numMassDeletes:0,numMassUpdates:0,numMassEdits:0};a.children().each(function(){var a,c,m=e(this),n=m.attr("type"),o=m.attr("label"),p=m.attr("icon"),q=g._GUID+"_ma_"+k++,r=m.children("renderconditions");o||(o=h("massupdate"===n?"mass_update_selected_rows":"massedit"===n?"toggle_edit_mode_on_selected_rows":"massdelete"===n?"toggle_selected_rows_for_deletion":"action")),p||(p="massupdate"===n?"sk-icon-table-edit":"massedit"===n?"sk-icon-edit":"massdelete"===n?"sk-icon-delete":"sk-icon-magic"),o=m._label=e("<div>").append(f.mergeModel(o)),c={label:o.text(),value:q,icon:p},a=skuid.actions._actionFunctions.getMassFunction(m,b,{label:o,tracker:l}),a&&skuid.hotkeys.bind(m.children("hotkeys").first(),q,function(){d.getSelectedItems().length&&a()},g.element),c.onSelect=function(){a&&a(),i&&i()},r.length&&r.children().length&&(c.renderConditionsXML=r),j.push(c)});var m=g.header.find(".nx-editor-header-actions");m.length||(m=e('<div class="nx-editor-header-actions">').appendTo(g.header.find(".nx-header-left"))),m.prepend(e("<div>").actionSelect({items:j,type:"button",uniqueId:a.attr("uniqueid")}).addClass("nx-actionbutton nx-massactions").css("display","none"))}}function b(a,b,c){var d,i=a.attr("type"),j=b.list,k=c.label,l=c.tracker||{},m=j.mode,n=j.model,o=[],p=!1;switch(i){case"massupdate":n.updateable&&"readonly"!==m&&l.numMassUpdates++<1&&(d=function(){var a,c=e("<div>").addClass("nx-basicfieldeditor nx-editor-contents"),d="MassUpdateForTable_"+b._GUID+"_"+(new Date).getTime(),i=new skuid.model.Model({dataSource:n.dataSource,data:[],fields:n.fields,conditions:n.conditions,objectName:n.objectName,createRowIfNoneFound:!1,id:d,doClone:!1}),k=i.getDataSourceType(),l=[],m={},q=0,r=0,s=!1,t=!1,u=e.map(j.getSelectedItems(),function(a){return a.row}),v={},w=n.recordTypeInfos;if(k.coerceMassUpdate&&k.coerceMassUpdate(i),e.each(u,function(a,b){!b.RecordTypeId||b.RecordTypeId in v||(v[b.RecordTypeId]=1),n.isRowNew(b)?q++:r++}),!g.size(v)&&w&&w.length){var x=e.map(w,function(a){return{RecordTypeId:a.recordTypeId,RecordType:{Name:a.name}}}),y=[];e.each(n.conditions,function(a,b){!1===b.inactive&&e.inArray(b.field,["RecordTypeId","RecordType.Name"])>-1&&y.push(b)}),y.length&&e.each(g.filterRowsByConditions(x,y),function(){this.RecordTypeId in v||(v[this.RecordTypeId]=1)})}m.ValidRecordTypeIds=e.map(Object.keys(v),function(a){return a}),q>0&&(s=!0),r>0&&(t=!0),i.initialize(),a=i.createRow({ignoreDefaults:!0}),i.updateRow=function(a,b,c,d){return!1===g.isString(b)?skuid.model.Model.prototype.updateRow.call(i,a,b,e.extend(c,{_ignoreMetadata:!0})):skuid.model.Model.prototype.updateRow.call(i,a,b,c,e.extend(d,{_ignoreMetadata:!0}))};var z=[];e.each(i.fields,function(a,b){b.needsEditor&&z.push(b.id)}),z.length&&(p=new skuid.ui.Editor(e("<div>"),{showHeader:!1,showMessages:!1}),i.registerEditor(p),p.handleChange=function(){e.each(o,function(a,b){b.render()})});var A,B,C=j.editor.element,D=e.map(j.renderedItems,function(a){if(a.selected)return a}),E=[];e.each(D,function(a,b){e.each(b.fields,function(a,b){var c=b.options.enableConditionsXML,d=[];if(c.length&&c.children().length){c.children().each(function(){d.push(new skuid.model.Condition(e(this)))});g.areConditionsMet(d,{row:b.row,model:b.model,logicType:c.attr("logictype")})||(b.disabled=!0)}!0===b.disabled&&-1===e.inArray(b.id,E)&&E.push(b.id)})});for(var F=0;F<C._fieldsDefs.length;F++){A=e(C._fieldsDefs[F]),B=C._columnSettingsByUID[A.attr("uniqueid")];var G=-1===E.indexOf(B.fieldId);B.disabled&&G?(B.disabled=!1,A.renderOverride={override:!0,doRender:!0}):!1===B.disabled&&G?A.renderOverride={override:!0,doRender:!0}:B.disabled||G||(B.disabled=!0),!1!==B.hidden||B.userHidden||B.disabled||function(b){var d,h,j,k,q,r,u=b.attr("id"),v=n.getField(u),w=!!t&&v.editable,x=!!s&&v.createable,y=u&&v&&(w||x)&&"true"!==b.attr("readonly"),B=b.attr("type");if("COMBO"!==B&&"CHILDREL"!==B||(y=!1),!y)return!0;d=b.children("label").first(),h=d.length?d.text():v&&v.label||"",j=e("<div>").addClass("nx-basicfieldeditor-item nx-pagebuilder-property-item"),k=e("<div>").addClass("nx-basicfieldeditor-item-label").text(g.mergeAsText("model",h,{createFields:!1},n)),j.append(k),q=e.extend(f.getFieldOptionsFromXML(b,{mode:"edit",model:n}),{label:h,register:!1,editable:!0}),A.renderOverride&&(q.renderOverride=A.renderOverride),r=new f.Field(a,i,p,q),r.required=!1,r.item=m,r.render(),l.push(r),j.append(r.element),e.inArray(r.id,z)>-1&&o.push(r),c.append(j)}(A)}c.dialog({autoOpen:!0,title:h("mass_update_selected_rows"),resizable:!0,width:550,modal:!0,buttons:[{text:h("apply"),click:function(){var b=j.getSelectedItems(),c={};if(e.each(a,function(a,b){"Id"!==a&&"Id15"!==a&&(c[a]=b)}),g.size(c)>0){var f={},h={};e.each(b,function(){f[n.getRowId(this.row)]={}}),e.each(c,function(c,d){var g=n.getField(c);if(e.each(b,function(a,b){var e=n.getRowId(b.row);g&&(n.isNewRow(b.row)?g.createable:g.editable)&&(f[e][c]=d)}),h[c]=1,g&&g.displaytype&&"REFERENCE"===g.displaytype){h[g.rel]=1;var j=i.getFieldValue(a,g.rel,!0);e.each(b,function(a,b){var c=b.row,d=n.getRowId(c);(n.isRowNew(c)?g.createable:g.editable)&&(f[d][g.rel]=j)})}}),n.updateRows(f,{initiatorId:d})}e(this).dialog("destroy")}},{text:h("cancel"),click:function(){e(this).dialog("destroy")}}]})});break;case"massedit":n.updateable&&"readonly"!==m&&l.numMassEdits++<1&&(d=function(){e.each(j.getSelectedItems(),function(){this.toggleEdit()})});break;case"massdelete":n.deleteable&&"readonly"!==m&&l.numMassDeletes++<1&&(d=function(){var a=j.getSelectedItems(),b=[],c=0,d="deleteRows";a.length&&(e.each(a,function(a,d){d.deleted&&c++,b.push(d.row)}),c===a.length&&(d="un"+d),n[d](b,{initiatorId:j._GUID}))});break;case"redirect":d=function(){g.redirect({list:j,model:n,url:a.attr("url"),window:a.attr("window"),title:k.text()})};break;case"custom":d=function(){var b=skuid.snippet.getSnippet(a.attr("snippet"));b&&b({model:n,list:j,action:a})};break;case"popup":d=function(){g.createPopupFromAction(a,{model:n,list:j,selectedItems:j.getSelectedItems(),component:b,rows:e.map(j.getSelectedItems(),function(a){return a.row})})};break;case"multi":d=function(){var c={model:n,list:j,initiatorId:j.editor._GUID},d=e.map(j.getSelectedItems(),function(a){return a.row});d.length&&(c.rows=d),skuid.actions.runActionsNode(a.children("actions").first(),b,c)}}return d}function c(a,b,c){c=c||{};var d=b.list,f=d.model,g=d.editor,i=c.itemClass;if(g.header&&a&&a.length&&a.children().length){var l=[],m=2,n=k(a,f);n&&l.push(n),a.children().each(function(){var a,c=e(this),d=c.attr("type"),k=j(c.attr("label")||("createrow"==d?skuid.label.merge(h("add_new"),f.label):""),{model:f}),n=g._GUID+"_"+m++,o={label:k,value:n,icon:j(c.attr("icon")||("createrow"==d?"sk-icon-add":""),{model:f},{createFields:!1})},p=c.children("renderconditions");a=skuid.actions._actionFunctions.getGlobalFunction(this,b,{component:b,itemClass:i}),o.onSelect=function(){a&&a()},p.length&&p.children().length&&(o.renderConditionsXML=p),a&&skuid.hotkeys.bind(c.children("hotkeys").first(),n,a,g.element),l.push(o)});var o=g.header.find(".nx-editor-header-actions");o.length||(o=e('<div class="nx-editor-header-actions">').appendTo(g.header.find(".nx-header-left"))),o.append(e("<div>").actionSelect({items:l,type:"button",uniqueId:a.attr("uniqueid")}).addClass("nx-actionbutton"))}}function d(a,b,c){var d,f=c.itemClass||"",i=b.list,k=i.model,l=i.editor,m=e(a),n=m.attr("type"),o=j(m.attr("label")||("createrow"==n?skuid.label.merge(h("add_new"),k.label):""),{model:k});switch(n){case"redirect":d=function(){g.redirect({model:k,url:m.attr("url"),window:m.attr("window"),title:o})};break;case"createrow":d=function(){var a=i.newItem(k.createRow({initiatorId:i._GUID,doAppend:"append"==m.attr("appendorprepend"),additionalConditions:i.conditions}),{editModeForNewItems:!0});i.render({resetPagination:!0,refreshFields:!1});var b=a.element.find(":input:not(."+f+")").first();b&&b.focus()};break;case"custom":d=function(){var a=skuid.snippet.getSnippet(m.attr("snippet"));a&&a({model:k,list:i,component:b})};break;case"popup":d=function(){g.createPopupFromAction(m,{model:k,list:i,component:b})};break;case"multi":d=function(){skuid.actions.runActionsNode(m.children("actions").first(),b,{model:k,list:i,initiatorId:l._GUID})}}return d}var e=skuid.$,f=skuid.ui,g=skuid.utils,h=skuid.label.read,i=skuid.actions._actionFunctions={},j=g.mergeAsTextInContext,k=function(a,b){if("false"===a.attr("usefirstitemasdefault")){var c=a.attr("defaultlabel"),d=a.attr("defaulticon");return c&&(c=e("<div>").append(b.mergeModel(c))),{label:c?c.text():h("actions"),value:"__default",icon:d||"sk-icon-config",isSelected:!0}}return!1};e.extend(i,{getMassFunction:b,getGlobalFunction:d,initiateMassActions:a,initiateGlobalActions:c})}(skuid),function(a){function b(b){function c(){return t}function g(a){a||(a={});var b=a.itemId,c=h({namespace:a.namespace,type:a.type,id:b});return{getSetting:function(a){var b=i({key:c})||{};return d(a?f.getObjectProperty(b,a):b)},getSettings:function(){return d(i({key:c})||{})},updateSettings:function(a,b){return n(e.extend(b,{key:c,settings:a}))},deleteSetting:function(a){if("string"==typeof a){var b={};b[a]=null,n({key:c,settings:b,removeNulls:!0,createNodes:!1})}}}}function h(a){a||(a={});var b=[];return a.id&&(a.namespace&&b.push(a.namespace),a.type&&b.push(a.type),b.push(a.id)),b}function i(a){var b=a&&a.key;if(!e.isArray(b)||0===b.length)return null;var c,d,f=p;for(c=0;c<b.length;c++){if(d=b[c],!f[d]){if(!0!==a.createNodes)return null;f[d]={}}f=f[d]}return f}function j(a,b){var c={};return k(b,c,"personalMerge-"),e.extend(!0,a,b),l(a,c),a}function k(b,c,d){var e=Object.keys(b);if(e.length>0)for(var f=e.length-1;f>=0;f--){var g=e[f],h=Object.prototype.toString.call(b[g]);if("[object Array]"===h){var i=d+a.utils.generateGUID();c[i]=b[g],b[g]=i}else"[object Object]"===h&&k(b[g],c)}}function l(a,b){var c=Object.keys(a);if(c.length>0)for(var d=c.length-1;d>=0;d--){var e=c[d],f=Object.prototype.toString.call(a[e]);"[object Object]"===f?l(a[e],b):b[a[e]]&&(a[e]=b[a[e]])}}function m(a){var b,c;c=[];for(b in a)c.push(b);e.each(c,function(b,c){"undefined"==typeof a[c]||null===a[c]?delete a[c]:"object"==typeof a[c]&&m(a[c])})}function n(a){var b=a.settings,c=e.isEmptyObject(b),f=a&&a.hasOwnProperty("createNodes")?a.createNodes:!c,g=i(e.extend(a,{createNodes:f})),h=a&&a.deferUpdate;return g?"object"!=typeof b?(new e.Deferred).resolve():(b=d(b),!1!==a.deepMerge?g=j(g,b):e.extend(g,b),!0===a.removeNulls&&m(g),!0===h?(new e.Deferred).resolve():o()):(new e.Deferred).resolve()}function o(){if(q&&"pending"===q.state())return r||(r=new e.Deferred),s=!0,r.promise();q=r||new e.Deferred,r=null,p.m===undefined&&(p.m={}),"client"===t&&(p.m.lastModifiedDate=Date.now());var b=JSON.stringify(p);if("server"===t)a.remote().updatePersonalizationSettings(u,b,function(b,c){if(c.status){var d={personalization:p},e={personalization:{pageId:u,mode:t}};a.loader.cache.memory.add.meta(d,e),a.loader.cache.persistent.add.meta(d,e),q.resolve()}else q.reject(c);!0===s&&(s=!1,o())});else{var c=JSON.stringify({m:p.m}),d=JSON.stringify({c:p.c,z:p.z});e.cookie(v,c,{secure:!0,path:"/"}),f.sessionStorage(w,d),q.resolve()}return q.promise()}var p,q,r,s,t,u=b.pageId,v="apex__sk-pf-"+u,w="sk-pf-"+u;return function(a){var b,c;t=a.mode||"server","client"===t?(!0===a.isModelCookieObsolete?(e.removeCookie(v),b={}):b=JSON.parse(e.cookie(v)||"{}"),c=JSON.parse(f.sessionStorage(w)||"{}"),p=e.extend({},b,c)):p=e.extend({},a.pageSettings||{})}(b),{_createService:g,_savePageSettings:o,_getMode:c,_getPageSettings:function(){return d(p)}}}function c(c){c||(c={});var d=c.getParentPage&&c.getParentPage(),e=d&&d._pageRecord,h=e&&e.Id,j=c.pageId||h||a.page.id;return i[j]?i[j]:(j&&!c.pageId&&(c.pageId=j),c.mode||f.log('Warning: Skuid Personalization Page Context for "'+j+'" was intialized without a "mode" property.',g),i[j]=b(c))}function d(a){return a===undefined?undefined:JSON.parse(JSON.stringify(a))}var e=a.$,f=a.utils,g=a.constants.LOG_LEVELS.WARNING,h=a.personalization={},i={};e.extend(h,{getPageSettings:function(a){return c(a)._getPageSettings()},createService:function(b){return c({pageId:b.pageId||a.page.id})._createService({namespace:"x",type:b.type,itemId:b.id})},createComponentService:function(a){var b,d=c(a);return a&&a.xmlDefinition&&a.xmlDefinition.attr?b=a.xmlDefinition.attr("uniqueid"):a&&a.definition&&(b=a.definition.uniqueId),b?d._createService({namespace:"c",type:a._componentType,itemId:b}):d._createService({})},createModelService:function(a){var b=c(a),d=b._createService({namespace:"m",type:"sf",itemId:a&&a.id});return d=e.extend(d,{getCondition:function(a){return d.getSetting("conditions."+a)},setCondition:function(a){var b,c=a&&a.name,f=a&&a.value;return c?(b={conditions:{}},b.conditions[c]=f,d.updateSettings(b)):(new e.Deferred).reject()},resetCondition:function(a){var b,c=a&&a.name;return c?(b={conditions:{}},b.conditions[c]=null,
d.updateSettings(b,{removeNulls:!0})):(new e.Deferred).reject()},getOrderBy:function(){return d.getSetting("orderBy")},setOrderBy:function(a){var b=a.newValue,c={orderBy:b};return d.updateSettings(c)},resetOrderBy:function(){var a={orderBy:null};return d.updateSettings(a,{removeNulls:!0})}})},initializeSettings:function(a){a||(a={}),c(a)}})}(skuid||(window.skuid={})),function(a){function b(b,c,d,e){var g,h,i=f(c,d),j=b.children("panel").first().attr("uniqueid"),k=c||d&&d.component,l=k?k.getParentPage():a.component.getByType("skuidpage")[0],m=l.panel.getById(j);m?(e&&!m.isOpen()||!e)&&(g=m.context.row,h=m.context.model,h&&g&&i.row&&i.model&&h.getRowId(g)!==i.model.getRowId(i.row)&&m.updateContext(i),m.toggle(e)):l.panel.createFromAction(b,c,i)}var c=a.$,d=a.utils,e=a.actions,f=d.getContextToUse,g=["tap","hold","doubletap","pinch","pinchin","pinchout","swipeleft","swiperight","swipedown","swipeup","swipe","drag"];a.interactions.register(g),e.register({closeTopmostPopup:function(){var b=a.component.getByType("skuid__modal");b.length&&b[b.length-1]._getCPI().close(),c(c(".ui-dialog-content").get().reverse()).each(function(){try{return c(this).dialog("close"),!1}catch(a){}})},closeAllPopups:function(){c.each(a.component.getByType("skuid__modal"),function(){this._getCPI().close()}),c(c(".ui-dialog-content").get()).each(function(){try{c(this).dialog("close")}catch(a){}})},showPopup:function(a,b,c){d.createPopupFromAction(a,f(b,c))},showModal:function(a,b,c){d.ink.createModalFromAction(a,c)},showToast:function(a,b,c){if(!a)return null;var e=a.attr();e.context=c,delete e.type,delete e.scope,d.ink.createToast(e.message,e)},openSlidingPanel:function(a,c,d){"open"===a.attr("openbehavior")?b(a,c,d,!0):b(a,c,d)},toggleSlidingPanel:function(a,c,d){b(a,c,d)},closeSlidingPanel:function(b,d,e){var f=d||e&&e.component;"topmost"===b.attr("closebehavior")?c(c(".sk-pagepanel-open").get().reverse()).each(function(){try{var b=c(this).attr("id");return a.component.getById(b).close(),!1}catch(d){}}):f?f.getParentPage().panel.closeAll():c.each(a.component.getByType("skuidpage"),function(a,b){b.panel.closeAll()})},toggleRenderComponent:function(b){var c=b.attr("componentid"),e=b.attr("behavior"),f=d._getRenderOverride(c),g=a.$C(c),h={componentId:c,component:g},i={scope:a.constants.EVENT_SCOPES.SKUID,qualifyEventName:!1};f&&(f.override=!0,f.doRender="toggle"===e?!f.doRender:"hide"!==e,g?g.publish("actions.conditionaloverride",h,i):a.events.publish("actions.conditionaloverride",[h],i))}})}(skuid),function(a){function b(b,c,d,f){c&&c.off("click.skuid").empty();var j=f.actionSelect,l=f.selectItem,m=f.itemDefinition;c.addClass(f.baseClass+"-dropdown-item").attr("tabindex",-1).on(h,function(a){"button"!==j.type&&j.list.getSelected()===l||(j.hasClass("unavailable")||(j.actionSelect("selectItem",l),j.selectBox&&j.selectBox.hide("fast")),a.stopPropagation())}).data("rendered",!0),c.off(i).on(i,function(a){var b=e(this),c=l===j.actionSelect("getSelectedItem");if(!c||a.which!==k.ENTER&&a.which!==k.SPACE)if(a.which!==k.ESCAPE||c){if(a.which===k.ENTER||a.which===k.SPACE)a.stopPropagation(),j.actionSelect("selectItem",l,{event:a});else if(a.which===k.UP||a.which===k.DOWN){var d,f=b.parent().children(),g=b.index();g=(a.which===k.UP?g-1:g+1)%f.length,d=f.eq(g),d.trigger("focus.skuid")}}else j.selectBox&&j.selectBox.hide("fast"),"button"===j.type?j.actionArrow.attr("aria-expanded",!1).trigger("focus"):j.actionText.children().first().attr("aria-expanded",!1).trigger("focus");else b.trigger(h,!0),a.stopPropagation()}),c.off(g).on(g,function(a){a.stopPropagation(),l.onFocus&&"function"==typeof l.onFocus&&l.onFocus.apply(this,arguments)}),l.content?c.append(l.content):c.text(l.label),m.icon&&c.prepend(a.ui.createIcon(m.icon,{additionalClass:f.baseClass+"-icon inline"})),j.list.getSelected()||j.actionSelect("selectItem",l,{triggerHandlers:!1}),f.isInitialDraw||j.actionSelect("redraw")}function c(a,b,c,d){var e=d.actionSelect,f=d.selectItem;b.empty().removeClass(d.baseClass+"-dropdown-item").data("rendered",!1),e.list.unselectItem(f),d.isInitialDraw||e.actionSelect("redraw")}var d,e=a.$,f=a.utils,g="focus.skuid",h="click.skuid",i="keydown.navigation.skuid",j=h+" "+i,k=a.$.ui.keyCode;d={init:function(b){var c=this;c.data("component",c),c.config=b||{},c.config.baseClass=c.config.baseClass||"nx-actionselect",c._GUID=c.config.uniqueId||f.generateGUID(),c.type=c.config.type?c.config.type:"state-selector",c.addClass(c.config.baseClass).prop("id",c._GUID),c.list=new a.utils.SelectList,c.onItemSelect=b.onItemSelect||!1,c.selectOptionsById={};var d={isInitialDraw:!0};return b.items&&e.each(b.items,function(a,b){c.actionSelect("addItem",b,d)}),c.actionSelect("draw"),c},getSelectedItem:function(){return this.list.getSelected()},addItem:function(d,g){g||(g={});var h=new a.utils.SelectItem(d),i=this,j=g.prependInsteadOfAppend||!1,k=g.redrawAfterAdd||!1,l=d.renderConditionsXML,m=e("<div>"),n={selectItem:h,actionSelect:i,itemDefinition:d,renderConditions:l,isInitialDraw:g.isInitialDraw,baseClass:this.config.baseClass};return i.list.addItem(h,j),h.onSelect=d.onSelect||!1,h.onFocus=d.onFocus||!1,l?(f.conditionallyRender(b,c,null,m,h.id(),n),!0!==m.data("rendered")&&i.list.unselectItem(h)):b(null,m,h.id(),n),delete n.isInitialDraw,d.hotkeysXML&&(a.hotkeys.unbind(h.id()),a.hotkeys.bind(d.hotkeysXML,h.id(),function(){m.trigger("click.skuid")},i)),i.selectOptionsById[h.id()]=m,k?i.actionSelect("draw"):i},prepend:function(a){return this.actionSelect("addItem",a,{prependInsteadOfAppend:!0,redrawAfterAdd:!0})},append:function(a){return this.actionSelect("addItem",a,{prependInsteadOfAppend:!1,redrawAfterAdd:!0})},selectItem:function(a,b){var c,d=this,f=d.list,g=f.size(),h=!1,i=f.selectedIndex,j=f.items[i];if(void 0===a)throw"No Item provided.";if(c="undefined"!=typeof a.value?f.indexOf(a):a,g>1){var k;if(j&&(k=e(d.selectOptionsById[j.id()])),f.selectItem(c),f.selectedIndex!==i&&(h=f.items[f.selectedIndex],"button"!==d.type&&!d.config.preventLabelChangeOnSelect)){if(j){var l=i-1;-1!==l?k.insertAfter(d.selectBox.children().eq(l)):k.prependTo(d.selectBox)}e(d.selectOptionsById[h.id()]).appendTo(d.actionText)}}else 1===g&&f.selectItem(c);h||(h=j),"button"!==d.type&&f.selectedIndex===i&&1!=g||b&&!1===b.triggerHandlers||(h&&h.onSelect&&h.onSelect(h,b),d.onItemSelect&&d.onItemSelect(h))},safeEmpty:function(){var a=this;a.actionText&&a.actionText.children().detach(),a.selectBox&&a.selectBox.children().detach(),a.empty()},redraw:function(){var a=this;return a.needsRedraw||(a.needsRedraw=!0,a.actionSelect("safeEmpty"),setTimeout(function(){a.needsRedraw&&(a.needsRedraw=!1,a.actionSelect("draw"))},1)),a},draw:function(){var b,c=this,d=c.list,h=0,i=c.selectOptionsById;c.actionSelect("safeEmpty"),f.size(i)&&e.each(i,function(a,b){b.data("rendered")&&h++});var l=function(){return e(window).innerHeight()/2+"px"};if(h){if(b=d.getSelected(),b||e.each(d.items,function(a,e){var f=e.id();if(i[f].data("rendered"))return c.actionSelect("selectItem",a,{triggerHandlers:!1}),b=d.getSelected(),!1}),!b)return c;if(c.actionText=e('<div class="'+c.config.baseClass+'-text">'),"button"===c.type?c.actionText.append(i[b.id()].clone(!0,!0)):c.actionText.append(i[b.id()]),c.append(c.actionText),h>1){var m=c.config.baseClass.indexOf("dropnav")>-1?"":"ui-icon ui-icon-triangle-1-s";c.actionArrow=e('<div class="'+c.config.baseClass+'-arrow">').append(e("<div>").addClass(m)),c.append(c.actionArrow);var n=[];"button"===c.type?(n.push(c.actionArrow),c.actionText.on(j,function(a){if("click"===a.type||a.which===k.ENTER||a.which===k.SPACE){a.stopPropagation(),c.list.selectItem(c.actionText.index());var b=d.getSelected();b.onSelect&&b.onSelect(b),c.onItemSelect&&c.onItemSelect(b)}}),c.actionText.attr("tabindex",0)):n.push(c);var o="button"===c.type?c.actionArrow:c.actionText.children("."+c.config.baseClass+"-dropdown-item");o.attr({tabindex:0,"aria-haspopup":!0,"aria-expanded":!1}),e.each(n,function(){e(this).on(j,function(a,b){if("click"===a.type||a.which===k.ENTER||a.which===k.SPACE){var f=this,h=e("<div>").addClass("sk-subnavigation-inner");if(b=b||!1,o.attr("aria-expanded",!0),a.which!==k.ENTER&&a.which!==k.SPACE||(b=!0),a.stopPropagation(),!c.hasClass("unavailable")){if(c.selectBox&&c.selectBox.children().length)c.selectBox.parent().length||c.append(c.selectBox),c.selectBox.toggle("fast");else{c.selectBox=e('<div class="'+c.config.baseClass+'-dropdown">').css("min-width","100%"),c.config.maxHeight&&(c.selectBox.find(".sk-subnavigation-inner").length||(c.selectBox.css({"max-height":l}),c.selectBox.wrapInner(h.css({"max-height":l}))),c.selectBox.hasClass("nx-actionselect-dropdown")&&(c.selectBox.css({"max-height":c.config.maxHeight,"overflow-y":"auto"}),c.selectBox.find(".sk-subnavigation-inner").css("max-height",""))),e.each(d.items,function(a,b){if(!0!==b.isSelected){var d=i[b.id()];d&&d.data("rendered")&&(c.config.maxHeight?(d.children().css({position:"static"}),h.append(d)):c.selectBox.append(d))}}),c.selectBox.appendTo(c),c.trigger("actionselect.populate");var j=e(window).width();c.selectBox.offset().left+c.selectBox.width()+8>j&&c.selectBox.css("right","0px"),c.selectBox.css("display","none").show("fast");var m;c.mouseleave(function(){m=setTimeout(function(){c.selectBox.hide("fast"),e(f).attr("aria-expanded",!1)},1e3)}).mouseenter(function(){clearTimeout(m)})}b&&c.selectBox.children().length>0&&c.selectBox.children().first().trigger(g)}}})})}else c.actionText.attr("tabindex",0),c.actionText.on(j,function(a){"click"!==a.type&&a.which!==k.ENTER&&a.which!==k.SPACE||(b.onSelect&&b.onSelect(b),c.onItemSelect&&c.onItemSelect(b))})}return c.config.maxHeight&&a.events.subscribe("ui.reflow",function(){e(".sk-subnavigation-inner").css({"max-height":l})}),c}},f.registerPlugin("actionSelect",d)}(skuid),function(a){var b=a.$,c=a.utils,d=a.$.ui.keyCode,e=function(a,c,e,f){c&&c.off("click.skuid").empty();var g=f.actionDropdown,h=f.selectItem,i=f.itemDefinition;c.addClass(f.baseClass+"-dropdown-item").attr("tabindex",-1).on("click.skuid",function(a){h.onSelect&&h.onSelect(),g.selectBox&&g.selectBox.hide("fast"),a.stopPropagation()}).data("rendered",!0).on("blur.skuid",function(){g.actionDropdown("hideDropdown")}).on("focus.skuid",function(){g.actionDropdown("cancelHideDropdown")}),c.off("keydown.navigation.skuid").on("keydown.navigation.skuid",function(a){var c=b(this);if(a.which===d.ESCAPE)g.selectBox&&g.selectBox.hide("fast"),g.config.useFirstItemAsDefault?g.actionArrow.trigger("focus.skuid"):g.actionButton.trigger("focus.skuid");else if(a.which===d.ENTER||a.which===d.SPACE)a.stopPropagation(),c.trigger("click.skuid",!0);else if(a.which===d.UP||a.which===d.DOWN){var e,f=c.parent().children(),h=c.index();h=(a.which===d.UP?h-1:h+1)%f.length,e=f.eq(h),e.trigger("focus.skuid")}}),c.off("focus.skuid.custom"),h.onFocus&&"function"==typeof h.onFocus&&c.on("focus.skuid.custom",function(){h.onFocus.apply(this,arguments)}),h.content?c.append(h.content):c.text(h.label),b("<div>").addClass(f.baseClass+"-icon sk-icon inline "+(i.icon||"icon-spacer")).prependTo(c),f.isInitialDraw||g.actionDropdown("redraw")},f=function(a,b,c,d){var e=d.actionDropdown;b.empty().removeClass(d.baseClass+"-dropdown-item").data("rendered",!1),d.isInitialDraw||e.actionDropdown("redraw")},g={init:function(d){var e=this;e.data("component",e),e.config=d||{},e.config.baseClass=e.config.baseClass||"nx-actiondropdown",e._GUID=e.config.uniqueId||c.generateGUID(),e.prop("id",e._GUID),e.addClass(e.config.baseClass),e.list=new a.utils.SelectList,e.selectOptionsById={};var f={isInitialDraw:!0};return d.items&&b.each(d.items,function(a,b){e.actionDropdown("addItem",b,f)}),e.actionDropdown("draw"),e},addItem:function(d,g){g||(g={});var h=new a.utils.SelectItem(d),i=this,j=g.prependInsteadOfAppend||!1,k=g.redrawAfterAdd||!1,l=d.renderConditionsXML,m=d.hotkeysXML,n=b("<div>"),o={selectItem:h,actionDropdown:i,itemDefinition:d,renderConditions:l,isInitialDraw:g.isInitialDraw,baseClass:this.config.baseClass};return i.list.addItem(h,j),h.onSelect=d.onSelect||!1,h.onFocus=d.onFocus||!1,l?c.conditionallyRender(e,f,null,n,h.id(),o):e(0,n,h.id(),o),delete o.isInitialDraw,m&&(a.hotkeys.unbind(h.id()),a.hotkeys.bind(m,h.id(),function(){n.trigger("click.skuid")},i)),i.selectOptionsById[h.id()]=n,k?i.actionDropdown("draw"):i},prepend:function(a){return this.actionDropdown("addItem",a,{prependInsteadOfAppend:!0,redrawAfterAdd:!0})},append:function(a){return this.actionDropdown("addItem",a,{prependInsteadOfAppend:!1,redrawAfterAdd:!0})},safeEmpty:function(){var a=this,d=a.selectOptionsById;a.actionButton&&a.actionButton.hasClass("ui-button")&&a.actionButton.skooButton("destroy"),a.actionArrow&&a.actionArrow.hasClass("ui-button")&&a.actionArrow.skooButton("destroy"),c.size(d)&&b.each(d,function(a,b){b.detach()}),a.empty()},redraw:function(){var a=this;return a.needsRedraw=!1,a.actionDropdown("draw"),a},draw:function(){var a,e=this,f=e.config,g=!0===f.openOnHover,h=e.useFirstItemAsDefault=!0===f.useFirstItemAsDefault,i=e.list,j=0,k=e.selectOptionsById,l=e.actionButton||(e.actionButton=b("<div>")),m=e.actionArrow||(e.actionArrow=b("<div>")),n=e.selectBox||(e.selectBox=b("<div>"));if(e.actionDropdown("safeEmpty"),e.on("mouseout.skuid",function(a){e.is(a.target)||b.contains(e[0],a.relatedTarget)||e.actionDropdown("hideDropdown")}).on("mouseover.skuid",function(){e.actionDropdown("cancelHideDropdown")}),l.skooButton().off("click.skuid").on("click.skuid",function(b,c){h&&a&&"function"==typeof a.onSelect?a.onSelect():e.actionDropdown("toggleDropdown",{isKeyboardInitiated:c})}).off("keydown.navigation.skuid").on("keydown.navigation.skuid",function(a){if(l.is(":focus"))if(a.which===d.ENTER||a.which===d.SPACE)l.trigger("click.skuid",!0),a.stopPropagation();else if(a.which===d.UP||a.which===d.DOWN){var b,c,f=n.children();e.actionDropdown("showDropdown"),b=(a.which===d.UP?f.length-1:0)%f.length,c=f.eq(b),c.trigger("focus.skuid"),a.stopPropagation()}}).off("blur.skuid").on("blur.skuid",function(){e.actionDropdown("hideDropdown")}).off("focus.skuid").on("focus.skuid",function(){e.actionDropdown("cancelHideDropdown")}).appendTo(e),g&&!h&&l.off("mouseover.skuid").on("mouseover.skuid",function(a){e.actionDropdown("isDropdownOpen")||(e.actionDropdown("showDropdown",{isHoverInitiated:!0}),a.stopPropagation())}),c.size(k)&&b.each(k,function(a,b){b.data("rendered")&&j++}),j&&(h||1===j?(a=i&&i.items&&i.items[0],l.skooButton("option","label",a.label),a.icon&&l.skooButton("option","icon",a.icon)):(l.skooButton("option",{label:f.label,secondaryIcon:"fa-caret-down"}),f.icon&&l.skooButton("option","icon",f.icon)),!h||j>1)){h?(e.addClass("ui-buttonset"),m.skooButton({notext:!0,icon:"fa-angle-down"}).addClass(e.config.baseClass+"-expand-button").off("click.skuid").on("click.skuid",function(a,b){e.actionDropdown("toggleDropdown",{isKeyboardInitiated:b})}).off("keydown.navigation.skuid").on("keydown.navigation.skuid",function(a){a.which!==d.ENTER&&a.which!==d.SPACE||(m.trigger("click.skuid",!0),a.stopPropagation())}).off("blur.skuid").on("blur.skuid",function(){e.actionDropdown("hideDropdown")}).off("focus.skuid").on("focus.skuid",function(){e.actionDropdown("cancelHideDropdown")}).attr("aria-haspopup",!0).attr("aria-expanded",!1).appendTo(e),g&&m.off("mouseover.skuid").on("mouseover.skuid",function(a){e.actionDropdown("showDropdown",{isHoverInitiated:!0}),a.stopPropagation()})):l.attr("aria-haspopup",!0).attr("aria-expanded",!1),n.addClass(e.config.baseClass+"-dropdown").css("min-width","100%").hide().appendTo(e),e.config.maxHeight&&n.css({"max-height":e.config.maxHeight,"overflow-y":"auto"});var o=h;b.each(i.getItems(),function(b,c){if(o&&c===a)return!0;var d=k[c.id()];d&&n.append(d)})}return e},isDropdownOpen:function(){var a=this,b=a.selectBox;return b&&b.is(":visible")},toggleDropdown:function(a){var b=this,c=a.isKeyboardInitiated,d=b.actionDropdown("isDropdownOpen")?"hideDropdown":"showDropdown";b.actionDropdown(d,{focusFirstItem:c,focusActionArrow:c,immediate:!0}),b.actionDropdown("cancelHideDropdown")},showDropdown:function(a){a||(a={});var b=this,c=b.selectBox,d=b.useFirstItemAsDefault,e=b.actionArrow,f=b.actionButton,g=d?e:f;return!0===a.isHoverInitiated&&c.data("skuid.isHoverInitiated",!0),c.show("fast").position({my:"left top",at:"left bottom",of:f}),g.attr("aria-expanded",!0),a.focusFirstItem&&c.children().first().trigger("focus.skuid"),b},hideDropdown:function(a){a||(a={});var b=this,c=b.selectBox,d=b.useFirstItemAsDefault,e=b.actionArrow,f=b.actionButton,g=d?e:f,h=a.focusActionArrow,i=a.immediate||!0===c.data("skuid.isHoverInitiated"),j=function(){b.hideDropdownTimeout=null,c.data("skuid.isHoverInitiated",!1),c.hide("fast"),g.attr("aria-expanded",!1),h&&g.trigger("focus.skuid")};return i?j():b.actionDropdown("isDropdownOpen")&&!b.hideDropdownTimeout&&(b.hideDropdownTimeout=setTimeout(j,1e3)),b},cancelHideDropdown:function(){var a=this;return a.hideDropdownTimeout&&(clearTimeout(a.hideDropdownTimeout),a.hideDropdownTimeout=null),a}};c.registerPlugin("actionDropdown",g)}(skuid),function(a){var b=a.$,c=a.utils,d={init:function(d){d||(d={});var e,f,g,h,i,j=this.addClass("nx-actionselect nx-actionautocomplete"),k=d.refField,l=d.model.dataSource;return j.config=d,j.onItemSelect=d.onItemSelect||!1,j.list=new c.SelectList,k&&k.accessible&&(h=k.referenceTo,i=h.length&&h[0],f=i&&i.objectName,e=i&&i.keyField||l.getIdField(d.model),g=b.map(k.referenceTo,function(a){var b=l.getNameField(a.objectName),c=["Id"];return b&&c.push(b),a.searchable?{objectName:a.objectName,fields:c,recordsLimit:50,model:{objectMapKey:l.name+"__"+j.config.model.objectName},orderBy:b,conditions:d.additionalConditions}:null}),j.sourceFunction=function(c,i){if(c.term.length<2)return!1;if(g.length&&l.getDataSourceType().name===a.constants.SALESFORCE)l.search({query:c.term,includeMetadata:!0,searching:"NAME FIELDS",returning:g}).done(function(c){var d=[];b.each(c.results,function(c,f){var g=f.objectName,h=a.ui.getReferenceLookupModel(l,{metadata:k},g,null,e);b.each(f.records,function(b,c){a.data.add(c,"Id"),c.__templabel=h.getRowName(c),d.push(c)})}),i(d)});else if(h.length){var j=a.ui.getReferenceLookupModel(l,{metadata:k},f,null,e),m=j.getNameField();j.buildSearchCondition("_autocomplete_search",c.term,[{id:m}],{useSOSLSearch:!1,searchOperator:"contains"}),b.each(d.additionalConditions,function(a,b){j.addCondition(b)}),j.load(function(){var c=[];b.each(j.getRows(),function(b,d){a.data.add(d,e),d.__templabel=j.getRowName(d),c.push(d)}),i(c)})}},j.optionRenderer=function(a,d){return b("<li>").data("ui-autocomplete-item",d).html("<a>"+c.encodeHTML(d.__templabel)+"</a>").appendTo(a)},j.onChangeFunc=function(a,b){var c=b.item[e];return j.list.contains(c)||j.actionAutocomplete("addItem",{value:c,label:b.item.__templabel,affectDefaultCondition:!0}),j.actionAutocomplete("selectItem",c),!1}),d.items&&b.each(d.items,function(){j.actionAutocomplete("addItem",this)}),j.actionAutocomplete("draw"),j},addItem:function(a,b){b||(b={});var d=new c.SelectItem(a),e=b.prependInsteadOfAppend||!1;return this.list.addItem(d,e),d.onSelect=a.onSelect||!1,this},getSelectedItem:function(){return this.list.getSelected()},resetItem:function(a){var c=this;c.config.refField?(b.each(c.actionAutocomplete("getSelectedItems"),function(){this.inactive=!0}),a&&b.map(a.split(";"),function(a){c.actionAutocomplete("selectItem",a,{triggerHandlers:!1})}),c.actionAutocomplete("buildResetMenu"),c.input.val(c.actionAutocomplete("getLabel"))):c.actionAutocomplete("selectItem",a)},selectItem:function(a,b){var c=this,d=c.list.selectedIndex,e=c.list.getSelected(),f=c.list.itemsMap[a],g=!1;c.list.selectItem(f),f.inactive=!1,c.input.val(c.actionAutocomplete("getLabel")),g=!c.isMultiselect||c.list.selectedIndex!==d,c.config.refField&&!c.config.isMultiselect&&e!==f&&c.actionAutocomplete("unselectItem",e,{triggerHandlers:!1}),g&&(b&&!1===b.triggerHandlers||(f&&f.onSelect&&f.onSelect(f),c.onItemSelect&&c.onItemSelect(f),c.actionAutocomplete("buildResetMenu")))},unselectItem:function(a,b){var c=this;a.inactive=!0,c.input.val(c.actionAutocomplete("getLabel")),b&&!1===b.triggerHandlers||(a&&a.onSelect&&a.onSelect(a),c.onItemSelect&&c.onItemSelect(a),c.actionAutocomplete("buildResetMenu"))},getLabel:function(){var a=this,c=a.actionAutocomplete("getSelectedItems");return(c.length>2?c.length+" Items":b.map(c,function(a){return a.label}).join(", "))||a.config.defaultOptionLabel},getSelectedItems:function(){var a=this;if(a.config.refField)return b.map(a.list.items,function(a){return!0===a.inactive?null:a});var c=a.list.getSelected();return c?[c]:[]},draw:function(){var c=this,d=a.ui.getRenderer("AUTOCOMPLETE").edit({minLength:1,value:c.actionAutocomplete("getLabel"),source:c.sourceFunction||b.map(c.list.items,function(a){return{value:a.value,label:a.label}}),onChange:c.onChangeFunc||function(a,b){c.actionAutocomplete("selectItem",b.item.value)},onFocus:function(a,b){return c.config.refField?d.val(b.item.__templabel):d.val(b.item.label),!1},optionRenderer:c.optionRenderer}).on("click",function(){d.select()}).appendTo(c);return c.input=d,c.resetMenu=b("<div>"),c.resetMenu.insertAfter(d),c.resetMenuItemsWrapper=null,c.actionAutocomplete("buildResetMenu"),c},buildResetMenu:function(){var a=this;if(a.resetMenu.empty().removeClass("clearfilter-btn nx-actionselect-arrow"),a.config.refField){a.resetMenuItemsWrapper||(a.resetMenuItemsWrapper=b("<div>").addClass("nx-actionselect-dropdown nx-actionautocomplete-resetitemswrapper").hide(),a.append(a.resetMenuItemsWrapper));var c=a.actionAutocomplete("getSelectedItems");0===c.length?(a.resetMenuItemsWrapper.empty().hide(),a.removeClass("nx-actionautocomplete-has-menu-action"),a.resetMenu.css("display","none")):1===c.length?(a.resetMenuItemsWrapper.empty().hide(),a.addClass("nx-actionautocomplete-has-menu-action"),a.resetMenu.addClass("clearfilter-btn").text("x").off().on("click",function(){a.hasClass("unavailable")||a.actionAutocomplete("unselectItem",c[0])}),a.resetMenu.css("display","inline-block")):c.length>1&&(a.addClass("nx-actionautocomplete-has-menu-action"),a.resetMenuItemsWrapper.empty(),b.each(c,function(c,d){var e=b("<div>").addClass("nx-actionselect-dropdown-item"),f=b("<div>").addClass("nx-actionautocomplete-resetitembutton").text("x"),g=b("<div>").addClass("nx-actionautocomplete-resetitemlabel").text(d.label);e.append(f,g),a.resetMenuItemsWrapper.append(e),e.off().on("click",function(){a.actionAutocomplete("unselectItem",d)})}),a.resetMenu.addClass("nx-actionselect-arrow").append(b("<div>").addClass("ui-icon ui-icon-triangle-1-s")).off().on("click",function(){a.resetMenuItemsWrapper.is(":visible")?a.resetMenuItemsWrapper.hide():a.resetMenuItemsWrapper.show()}),a.resetMenu.css("display","inline-block"))}else a.list&&0===a.list.selectedIndex?(a.resetMenu.css("display","none"),a.removeClass("nx-actionautocomplete-has-menu-action")):(a.addClass("nx-actionautocomplete-has-menu-action"),a.resetMenu.css("display","inline-block").addClass("clearfilter-btn").text("x").off().on("click",function(){a.hasClass("unavailable")||a.actionAutocomplete("selectItem",a.list.items[0].value)}))}};c.registerPlugin("actionAutocomplete",d)}(skuid),function(a){function b(b,c,d){function s(){if(Z&&"function"==typeof Z.render)return void Z.render(c,d,$);if(W="function"==typeof L.row?L.row():L.row||M.row,X=W&&V&&V.isRowNew(W),b&&b.off(m).empty(),b.css("display","inline-block"),void 0===E&&(E=y(c,L,M)),void 0===F&&(F=z(c,L,M)),P===l)return void b.actionDropdown({uniqueId:T,items:D,type:"button",onSelect:ba,openOnHover:S,useFirstItemAsDefault:R,label:E,icon:F});b.skooButton({icon:F,label:E,disabled:Y}),Y&&b.attr("tabindex",-1),b.off(m).on(m,ba),b.off(n).on(n,function(a){a.which!==o.ENTER&&a.which!==o.SPACE||(ba(),a.preventDefault())}),Q&&b.addClass(Q),U&&b.addClass("nx-button-secondary"),T&&b.attr("id")!==T&&b.attr("id",T);var e=function(){a.page.disableHotkeys||(f(),r.bind(c.children("hotkeys").first(),T,ba,b))},f=function(){r.unbind(T)};if(_.length&&_.children().length){var g=_.attr("message");q.conditionallyDo(function(){b.hasClass("ui-button")&&(b.button("enable"),b.attr("tabindex",0),g&&(A(b),b.css("cursor",""),b.attr("title")===g&&b.removeAttr("title")),e())},function(){b.hasClass("ui-button")&&(b.button("disable"),b.attr("tabindex",-1),g&&(A(b,g),b.css("cursor","not-allowed"))),f()},_,b,{row:W,model:V})}else e()}function t(){T&&(V&&V.unregisterField(T),a.hotkeys.unbind(T)),P===l||(b.off("click.skuid"),b.hasClass("ui-button")&&b.skooButton("destroy")),b.css("display","none"),Z&&"function"==typeof Z.unrender&&Z.unrender(c,d,$)}var u,w,D,E,F,G,H,I,J,K,L=d.options||{},M=d.context||{},N=L.editor,O=L.buttonEditors||[],P=c.attr("type")||L.type,Q=c.attr("cssclass")||L.cssClass,R=c.attr("usefirstitemasdefault")?"true"===c.attr("usefirstitemasdefault"):L.useFirstItemAsDefault,S=c.attr("openonhover")?"true"===c.attr("openonhover"):L.openOnHover,T=d.id(),U="true"===c.attr("secondary")||L.isSecondary,V=L.model||M.model,W="function"==typeof L.row?L.row():L.row||M.row,X=W&&V&&!V.isRowNew(W),Y=!1,Z=(L.customTypes||{})[P],$={doMerge:x},_=c.children("enableconditions"),aa=C(P,function(){return{actionDef:c,component:d,element:b,label:E,isOnClickJS:K,weblink:J,context:M,model:V,row:W,editor:N,buttonEditor:w}}),ba=function(a){aa.apply(this,arguments),a&&a.stopPropagation&&a.stopPropagation()},ca=c.attr("weblinkname"),da=c.attr("weblinkobject"),ea=function(){return L.component.addProblem("Invalid Salesforce Custom Button/Link requested"+(da&&ca?" on "+da+": "+ca:" on Page Title on Model "+V.id)),d.unrender(),!1},fa=function(){return a.sfdc?a.sfdc.weblink:null},ga=!1,ha=!1;switch(d.afterUnrender=t,P){case f:u=c.children("models").first(),w=B(b),O.push(w),V&&w.registerModel(V),u&&p.each(u.children("model"),function(){var b=a.$M(p(this).text());b&&w.registerModel(b)}),Y=!w.hasModelWithChanges();break;case g:u=c.children("models").first(),w=B(b),O.push(w),V&&w.registerModel(V),u&&p.each(u.children("model"),function(){var b=a.$M(p(this).text());w.registerModel(b)}),Y=!w.hasModelWithChanges();break;case e:N&&v.registerEditorWithModelsForActionsNode(c.children("actions").first(),N);break;case h:case j:V&&V.deleteable?W&&X||(ga=!0,ha=!0):ga=!0;break;case i:V&&V.createable?W&&X||(ga=!0,ha=!0):ga=!0;break;case k:if(!ca||!da)return void ea();if(V?W&&X||(ga=!0,ha=!0):ga=!0,ga)break;G=ca.split("__"),2===G.length?(I=G[0],H=G[1]):H=G[0],fa().get({weblinkName:H,objectName:da,namespacePrefix:I,callback:function(a){if(!(J=a))return void ea();K="javascript"===J.LinkType,E=fa().getLabel(J),s()}});break;case l:D=[],p.each(c.children("actions").first().children("action"),function(){var a=p(this),c=a.attr("type"),e=y(a,L,M),f=z(a,L,M),g=C(c,function(){return{actionDef:a,component:d,element:b,label:e,isOnClickJS:K,weblink:J,context:M,model:V,row:W,editor:N,buttonEditor:w}});D.push({label:e,value:a,icon:f,renderConditionsXML:a.children("renderconditions").first(),hotkeysXML:a.children("hotkeys").first(),onSelect:function(a){g.apply(this,arguments),a&&a.stopPropagation&&a.stopPropagation()}})})}ga||s();var ia;if(ha&&V&&W){var ja=V.getRowId(W);ia=a.events.subscribe("models.saved",function(a){var b,c=a.insertResults;a.totalsuccess&&a.models.hasOwnProperty(V.id)&&c&&c.length&&p.each(c,function(a,c){c.oldId===ja&&c.success&&c.hasOwnProperty("id")&&(ia.unsubscribe(),b=p.extend({},d.context,{row:V.getRowById(c.id)}),d.unrender().conditionallyRender({context:b}))})})}d.unregisterChildComponents=function(){return p.each(O,function(){this.unregister()}),a.component.Component.prototype.unregisterChildComponents.call(d)},d.unregister=function(){return ia&&ia.unsubscribe(),a.component.Component.prototype.unregister.call(d)}}var c=a.$(document.body),d={init:function(b){b||(b={});var c,d={text:!0!==b.notext,label:b.label,disabled:b.disabled};return b.icon&&((c=b.icon.indexOf("sk-webicon")>-1)||(d.icons||(d.icons={}),d.icons.primary=b.icon)),b.secondaryIcon&&(d.icons||(d.icons={}),d.icons.secondary=b.secondaryIcon),this.button(d),c&&this.prepend(a.ui.createIcon(b.icon,{isWebIcon:!0})),this.attr({role:"button",tabindex:0}),this.find(".ui-icon").addClass("sk-icon inline"),b.hoverText&&this.skootip(b.hoverText),this.data("object",this),this},option:function(){var a,b,c,d;if(0===arguments.length)return a=this.button("option"),{icon:a.icons&&a.icons.primary,secondaryIcon:a.icons&&a.icons.secondary,disabled:a.disabled,notext:!a.text};a=this.button("option"),1===arguments.length?(b=arguments[0],p.extend(a,{text:!0!==b.notext,label:b.label,disabled:b.disabled}),b.icon&&(a.icons.primary=b.icon),b.secondaryIcon&&(a.icons.secondary=b.secondaryIcon)):(c=arguments[0],d=arguments[1],"icon"===c?a.icons.primary=d:"secondaryIcon"===c?a.icons.secondary=d:a[c]=d),a.icons.primary||delete a.icons.primary,a.icons.secondary||delete a.icons.secondary,a.icons.primary||a.icons.secondary||delete a.icons,this.button("option",a),this.find(".ui-icon").addClass("sk-icon inline");var e=b&&b.hoverText||"hoverText"===c&&d;e&&this.skootip(e)},destroy:function(){return this.button("destroy"),this.removeData("object"),this.removeAttr("tabindex"),this}};a.utils.registerPlugin("skooButton",d);var e="multi",f="save",g="cancel",h="delete",i="clone",j="share",k="sfdcweblink",l="group",m="click.skuid",n="keydown.action.skuid",o=a.$.ui.keyCode,p=a.$,q=a.utils,r=a.hotkeys,s=a.componentType,t=q.mergeAsText,u=a.label.read,v=a.actions,w={createFields:!0,registerFields:!1},x=function(a,b){var c=b.model,d=b.row,e=c?d?"row":"model":"global";return void 0!==a?"row"==e?t("row",a,w,c,d):"model"==e?t("model",a,w,c):t("global",a,w):""},y=function(a,b,c){var d=a.attr("type"),e=a.attr("label")||b.label||u(d);return x(e,c)},z=function(a,b,c){var d=a.attr("type"),e=a.attr("icon")||b.icon;return e||-1===p.inArray(d,[f,g,h,i,j])||(e="sk-icon-"+d),x(e,c)},A=function(a,b){var c=a.children(".ui-button-text");return c.length&&(b?c.skootip(b):c.tooltip("instance")&&c.tooltip("destroy").removeAttr("title")),a},B=function(b){var c=new a.ui.Editor(b,{showSaveCancel:!1});return c.handleCancel=function(){a.ui.Editor.prototype.handleCancel.call(this),b.button("disable"),b.attr("tabindex",-1)},c.handleSave=function(c){a.ui.Editor.prototype.handleSave.call(this,c),c&&(!0===this.hasModelWithChanges()?(b.button("enable"),b.attr("tabindex",0)):(b.button("disable"),b.attr("tabindex",-1)))},c.handleChange=function(c){a.ui.Editor.prototype.handleChange.call(this,c),!0===this.hasModelWithChanges()?(b.button("enable"),b.attr("tabindex",0)):(b.button("disable"),b.attr("tabindex",-1))},c},C=function(b,d){switch(b){case e:return function(){var a=d(),b=a.actionDef,c=a.element,e=a.component,f=a.model,g=a.row,h=a.editor;v.runActionsNode(b.children("actions").first(),e,{button:c,model:f,row:g,editor:h,initiatorId:h&&h.id(),component:a.context.component}).always(function(){e.publish("actionComplete")})};case"custom":return function(){var b=d(),c=b.actionDef,e=b.element,f=b.component,g=b.context,h=b.model,i=b.row,j=b.editor,k=a.snippet.get(x(c.attr("snippet"),g));k&&k({button:e,model:g.model||h,row:g.row||i,editor:j,initiatorId:j&&j.id(),component:g.component||f})};case f:return function(){var b=d(),c=b.actionDef,e=b.model,f=b.row,g=b.editor,h=b.buttonEditor,i=b.component,j="true"===c.attr("rollbackonanyerror");h.models&&h.models.length&&(g&&g.setStatus(u("saving")),a.model.save(h.models,{callback:function(a){a.totalsuccess&&c.attr("afterSave")&&q.redirect({row:f,model:e,url:c.attr("afterSave"),window:c.attr("window")}),i.publish("actionComplete")},initiatorId:g&&g.id(),rollbackOnAnyError:j}))};case g:return function(){var b=d(),c=b.actionDef,e=b.model,f=b.row,g=b.editor,h=b.buttonEditor,i=c.attr("afterCancel");h.models&&h.models.length&&(a.model.cancel(h.models,{initiatorId:g&&g.id()}),i&&q.redirect({row:f,model:e,url:i,window:c.attr("window")}))};case h:return function(){var b,e,f,g=d(),h=g.component,i=g.model,j=g.row,k=g.editor,l=(i.getNameFieldValueForRow(j)+"").trim(),m=g.actionDef.attr("afterDelete");!m&&q.inPlatform([a.constants.VISUALFORCE,a.constants.LIGHTNING])&&(m="/{{Model.keyPrefix}}/o"),
b=u("delete")+" "+(l||i.label)+"?",e=p("<div>").attr("title",b).html(a.label.merge(u("confirm_delete"),i.label,l?"<b>'"+l+"'</b>":"")),f=[{icons:{primary:"ui-button-icon-primary ui-icon sk-icon-cancel sk-icon inline"},text:u("no_dont_delete_anything"),click:function(){e.dialog("close")}}];var n=a.model.list();p.each(n,function(b,d){if(d.hasChanged&&d.deleteable){var g=!0;if(p.each(d.changes,function(a,b){if(q.size(b))return g=!1,!1}),g){var i=a.utils.size(d.changes),j=1===i?d.label:d.labelPlural;f.push({text:a.label.merge(u("no_but_i_would_like_to_delete"),i,j),icons:{primary:"ui-button-icon-primary ui-icon sk-icon-save sk-icon inline"},click:function(){e.dialog("close"),c.block({message:u("deleting")+" "+i+" "+j+"..."}),d.save({callback:function(){h.publish("actionComplete"),c.unblock()},initiatorId:k&&k.id()})}})}}}),f.push({text:u("yes")+", "+u("delete")+" "+i.label+(l?" '"+l+"'":""),icons:{primary:"ui-button-icon-primary ui-icon sk-icon-save sk-icon inline"},click:function(){i.deleteRow(j),c.block({message:u("deleting")+" "+i.label+(l?" '"+l+"'":"")+"..."}),a.model.save([i],{callback:function(a){a.totalsuccess?window.sforce&&sforce.console?(c.unblock(),sforce.console.getEnclosingTabId(function(a){sforce.console.closeTab(a.id)})):q.redirect({url:m,model:i,row:j}):c.unblock(),h.publish("actionComplete")}}),e.dialog("close")}}),e.dialog({close:function(){p(this).remove()},modal:!0,resizable:!1,width:"500px",buttons:f})};case i:return function(){var a=d();q.redirect({url:"/"+a.model.getRowId(a.row)+"/e?clone=1"})};case j:return function(){var a=d(),b=a.model,c={"001":"Acc","003":"Con","006":"Opp","00Q":"Lead",500:"Case",701:"Campaign"},e=b.keyPrefix in c?c[b.keyPrefix]:"CustomObject";q.redirect({url:"/p/share/"+e+"SharingDetail?parentId="+b.getRowId(a.row)})};case"redirect":return function(){var a=d(),b=a.actionDef,c=a.model,e=a.row,f=a.label;q.redirect({row:e,model:c,url:b.attr("url"),window:b.attr("window"),title:f})};case"popup":return function(){var a=d(),b=a.actionDef,c=a.element,e=a.component,f=a.model,g=a.row;q.createPopupFromAction(b,{button:c,model:f,row:g,component:e})};case k:return function(){var a=d(),b=a.model,c=a.row,e=a.label,f=a.weblink,g=a.isOnClickJS;g||q.redirect({row:c,model:b,url:"/servlet/servlet.Integration?lid="+f.Id+"&eid="+b.getRowId(c)+"&ic=1&retURL="+window.location,title:e,window:"newWindow"===f.OpenType||!g&&q.startsWith(f.Url,"http://",!0)?"blank":"parent"})}}};s.register("button",{render:b})}(skuid),function(a){function b(b,c,d){d||(d=["datasource"]),d.forEach(function(d){var e=b.attr(d)||b.attr("service")||a.platform.getDefaultDataSourceName();c.hasOwnProperty(e)||(c[e]={})})}function c(a,c,d){var e,f=c.pathsToDataSourceAttributes;f&&(e=d.dataSourceDependencies,f.forEach(function(c){var d=c.split(":"),f=d[0],g=d[1];(f?a.find(f):a).each(function(a,c){b(Q(c),e,[g])})}))}function d(c,e,f,g){var h=c.attr("type");if("popup"===h||"showPopup"===h)Q.each(c.children("popup").first().children("components").first().children(),function(){i(Q(this),e,f,g)});else if("drawer"===h)Q.each(c.children("drawer").first().children("components").first().children(),function(){i(Q(this),e,f,g)});else if("toggleSlidingPanel"===h||"openSlidingPanel"===h)Q.each(c.children("panel").first().children("components").first().children(),function(){i(Q(this),e,f,g)});else if("multi"===h)Q.each(c.children("actions").first().children(),function(){d(Q(this),e,f,g)});else if("voice-command"===h){var j=a.voiceCommands.getUIComponentType(c);i(S("<"+j+"/>"),e,f,g)}else"datasource-action"===h&&c.attr("datasource")&&b(c,f.dataSourceDependencies)}function e(a,b,c,d){var e=f(a,c,d);e&&!b.includes(e)&&b.push(e)}function f(b,c,d){var e;return("skuid"===b.namespace||!b.namespace&&"skuid"===d)&&(e="skuid"),a.utils.isString(b)?b:b.url?b.url:b.resource?a.platform.getSiteResourceUrl({name:b.resource,namespace:e,path:b.path,modstamp:b.modstamp}):b.path?a.platform.getSiteResourceUrl({name:c,namespace:e,path:b.path,modstamp:b.modstamp}):void 0}function g(a,b){return b?b+"__"+a:a}function h(a,b,c){var d=b.jsLoads,f=b.cssLoads,h=c.file,i=h&&h.resource,j=c.namespace||h&&h.namespace,k=c.customLabelNamespace;a.js&&a.js.forEach(function(a){e(a,d,i,j)}),a.css&&a.css.forEach(function(a){e(a,f,i,j)}),a.labels&&a.labels.length&&(a.customLabelDependencies||(a.customLabelDependencies=[]),Array.prototype.push.apply(a.customLabelDependencies,a.labels)),a.customLabelDependencies&&Q.each(a.customLabelDependencies,function(a,c){b.labelDependencies[g(c,k)]=!0})}function i(a,b,e,f,g){var j=a.prop("tagName"),l=m(j,e,f);b.hasOwnProperty(j)||(b[j]={}),l&&(c(a,l,e),g||(g=k(j,f)),h(l,e,g),l.pathsToChildComponents&&Q.each(l.pathsToChildComponents,function(){var c=this.split(">"),d=a;Q.each(c,function(a,b){d=d.children(b)}),Q.each(d.children(),function(){i(Q(this),b,e,f)})}),l.pathsToActions&&Q.each(l.pathsToActions,function(){var c=this.split(">"),g=a;Q.each(c,function(a,b){g=g.children(b)}),Q.each(g.children(),function(){d(Q(this),b,e,f)})}))}function j(a,b){var c,d,e=a.split("__");return 1===e.length?(c=a,d="Mobile"===b?"skuidmobilecore":"skuidcore"):(c=e[1],d=e[0]),[d,c]}function k(b,c){return a.componentPacks[j(b,c)[0]]}function l(b){return a.componentPacks[b]}function m(a,b,c){var d=j(a,c),e=d[0],f=d[1],g=null,h=l(e);return h&&Q.each(h.components,function(){if(this.id===f)return Z(h,b),g=this,!1}),g}function n(b,c){var d=b.themeinfo,e=b.themeurl;d&&d.loadResourcesOnClient&&(e=f({resource:d.fileName,namespace:d.fileNamespace,modstamp:d.fileModstamp,path:"skuidtheme.css"})),e&&c.push({href:e,attrs:{id:"themeLink"}}),a.webfonts.load(d),!a.themeSettings.getAll()&&d&&d.themeSettings&&a.themeSettings.load(d.themeSettings)}function o(b){a.label&&a.label.add(b)}function p(b){var c=b.site;if(c&&(a.utils.siteInfo=c,c.hasOwnProperty("runningOnForceSite"))){var d=c.baseUrl;R(a.page,{runningOnForceSite:c.runningOnForceSite,sitePrefix:c.prefix,baseUrl:d}),N._setAttachmentBaseUrl(N.combineUrls(d||"","/servlet/servlet.FileDownload?file=blah"))}}function q(){!K&&a.utils.inPlatform([a.constants.NATIVE])&&(K=!0,Q(window).off(P).on(P,function(b){var c=b.originalEvent;c.state&&(c.state.pageName||c.state.routeName)&&a.loader.load({isPopState:!0,isReplace:!0,pageName:c.state.pageName,namespace:c.state.pageModule,parameters:c.state.parameters,routeName:c.state.routeName})}))}function r(c){function d(a){a&&Q.inArray(a,["server","default","client"])>-1&&(ja=a)}function f(){if(!k.hasOwnProperty(H))return U("Load terminated")}function g(a){return w&&w[a]||ha}function h(){na.push(ma.settings(g("settingsService")).then(a.settings.init),ma.componentPack(B,g("componentPackService")).then(Y)),la||ka||na.push(ma.events().then(a.events.register))}Q.holdReady(!0),q(),c=c||{},a.NProgress.start(),c.pageName||(c.pageName=a.page.params.page),c.pageModule||(c.pageModule=a.page.params.module),c.namespace||(c.namespace=a.page.params.namespace);var j,k,l,m,s,t,u,v,w,x,y,z=c.pageId,A=c.pageName,B=c.pageType||"Desktop",E=c.routeName,F=c.pageModule||c.namespace,G=c.parameters||{},H=N.generateUniqueId(),J=c.previousPageComponent,K=c.wrapper,O=c.wrapper?c.wrapper.prop("id"):null,P=c.element,_={"Ui-Only":{}},aa={},ba={},ca=[],da=[],ea={jsLoads:ca,cssLoads:da,labelDependencies:ba,dataSourceDependencies:_},fa="",ga="",ha=(new Date).getTime(),ia=[],ja="default",ka=!!c.isInclude,la=!!c.isReplace,ma=a.loader.service,na=[];return K||(K=Q(document.body),O="body"),k=L[O],k&&N.size(k)&&la&&Q.each(k,function(a,b){b&&b.publish&&b.publish("stop.loading"),delete k[a]}),k||(k=L[O]={}),k[H]=0,a.ui._loadHammer(),ma.serviceModstamps(c.serviceModstamps).then(function(a){return w=a,h(),ma.page(A,F,E,g("pageService"))}).then(function(b){var c,e,h=f(),i=b.xml,k=b.metadata;return h||(v=N.makeXMLDoc(i),A=k.pageName,z=k.pageId,t=new Date(k.pageLastModifiedDate).getTime(),c=k.masterPageName,e=k.masterPageNamespace,u=v.attr("theme"),d(v.attr("personalizationmode")),R(a.page,{id:z,name:A}),c?(j=v,ma.page(c,e,null,g("pageService")).then(function(a){function b(a,b){return function(c){var d,e,f=a.children(c).first();f.length&&(d=f.children(),d.length&&(e=b.children(c).first(),e.length||(e=S("<"+c+"/>").appendTo(b)),e.append(d)))}}var c,e,g=f(),h=j.children("resources").first(),i=a.xml;if(g)return g;v=N.makeXMLDoc(i),l=v.attr("theme"),c=v.attr("personalizationmode");var k="true"===v.attr("disableoffline");M.disable(k),!c||""!==ja&&"default"!==ja||d(c),["interactions","models","pageregioncontents"].forEach(b(j,v)),h.length&&(e=v.children("resources").first(),e.length||(e=S("<resources/>").appendTo(v)),["actionsequences","css","javascript","labels"].forEach(b(h,e)))})):void 0)}).then(function(){return Q.when.all(na)}).then(function(){var c=f();if(c)return c;var d="skuid"===F;a.page.params.usetheme?y=a.page.params.usetheme:u?y=u:l&&(y=l),y||(y=d&&!y?a.settings.theme&&a.settings.theme("Mobile"===B?"mobileBuilderDefault":"builderDefault"):a.settings.theme&&a.settings.theme("Mobile"===B?"mobileDefault":"default")),y||(y=d&&!y?"BuilderLight":"Mobile"===B?"MobileClassic":"Modern"),x=a.platform.get("themeServiceDFD"),x||(x=ma.theme(y,g("themeService")).then(function(a){n(a,da)}),a.platform.set("themeServiceDFD",x)),Q.each(v.children("models").children(),function(){b(Q(this),_)}),i(v,aa,ea,B),Q.each(v.children("resources").children(),function(){var a=X(Q(this));Q.each(a.jsLoads,function(){e(this,ca)}),Q.each(a.cssLoads,function(){e(this,da)}),fa+=a.inlineJS,ga+=a.inlineCSS,a.labels&&Q.extend(ba,a.labels)}),a.settings.globalFeedback&&a.settings.globalFeedback("enabled")&&!a.mobile&&i(S("<globalfeedback />"),aa,ea,B);var h={dataSources:_,components:aa};return la||(h.path=window.location.pathname,h.personalization={pageId:z,mode:ja},W.forEach(function(a){h[a]={}})),Q.when(ma.meta(h),ma.labels(Object.keys(ba),g("labelsService")).then(o),x)}).then(function(b){var c=f();if(c)return c;Q.isPlainObject(b)||(b=JSON.parse(b)),m=b,p(b);var d,g,h,i=b.runningUserInfo;return i&&(d=i.userLocale||{},d.monthNames?(g={},["monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","amPm"].forEach(function(a){g[a]=d[a]})):(g={monthNames:T("month_names_long").split(","),monthNamesShort:T("month_names_short").split(","),dayNames:T("day_names_long").split(","),dayNamesShort:T("day_names_short").split(","),dayNamesMin:T("day_names_min").split(","),amPm:T("am_pm_markers").split(",")},R(d,g)),a.time.setUserTimeZone(i.timeZone),N.userInfo=i,N.isMultiCurrencyOrganization=!1,N.userLocale=d,a.settings.init("userLocale",d),i.isAuthenticated||(ja="client"),R(a.time,g),Q.datepicker.setDefaults(R({},{closeText:"Done",currentText:"Today",prevText:"Prev",nextText:"Next",weekHeader:"Wk"},d)),R(a.page,{useComponentPacks:a.settings.components("useComponentPacks"),currentSiteUrl:location.protocol+"//"+location.host,editable:i&&i.canEditPages||!1}),a.page.sitePrefix||(a.page.sitePrefix="")),h="server"===ja?b.personalization:Q.cookie("sk-pf-"+(z||A)),a.personalization.initializeSettings({pageSettings:N.parseAsJSONIfString(h)||{},mode:ja,pageId:z||A}),b.apps&&(N.apps=b.apps),b.dataSourceTypes&&Q.each(b.dataSourceTypes,function(){this.js&&(Q.isArray(this.js)?Q.each(this.js,function(){e(this,ca)}):e(this.js,ca))}),b.components&&(Q.each(b.components,function(a,b){b.js&&Q.isArray(b.js)&&Q.each(b.js,function(){e(this,ca)}),b.css&&Q.isArray(b.css)&&Q.each(b.css,function(){e(this,da)}),b.packs&&Q.each(b.packs,function(a,b){Z(b,ea)})}),a.components={config:$.meta().components}),b.features&&(a.features=b.features),b.cssLoads&&(da=b.cssLoads.concat(da)),a.page._parametersByPage[H]=R({page:A},G),N.inPlatform(a.constants.LIGHTNING)?(Q.each(da,function(a,b){ia.push(function(){return N.loadCSS(b,{})})}),Q.each(ca,function(a,b){ia.push(function(){return N.loadJS(b)})}),ia.reduce(function(a,b){return a.then(function(){return b()})},V())):(Q.each(da,function(a,b){ia.push(N.loadCSS(b,{}))}),Q.each(ca,function(a,b){b&&ia.push(N.loadJS(b))}),Q.when.all(ia))}).then(function(){var b;return N.inPlatform(a.constants.LIGHTNING)?ga||fa?(b=a.platform.getResourceUrl({name:"core/pageSupportFileService.js",namespace:"skuid"}),N.loadJS(b).then(function(){var b=ga&&a.platform.getResourceUrl({name:a.pageSupport.getFileNameForPage(z,A),path:"inlineresources.css",modstamp:t}),c=b&&N.loadCSS({href:b,timeout:1e4}).then(null,function(){throw new Error(["Cannot add Inline CSS in the Lightning Runtime, ","and no Page Support File was found or there was a timeout."].join(""))}),d=fa&&a.platform.getResourceUrl({name:a.pageSupport.getFileNameForPage(z,A),path:"inlineresources.js",modstamp:t}),e=d&&N.loadJS({src:d,timeout:1e4}).then(null,function(){throw new Error(["Cannot add Inline Javascript in the Lightning Runtime, ","and no Page Support File was found or there was a timeout."].join(""))});return Q.when.all([c,e])})):void 0:(ga&&Q('<style type="text/css">'+ga+"</style>").appendTo(document.body),void(fa&&Q("<script>"+fa+"<\/script>").appendTo(document.body)))}).then(function(){m.dataSourceTypes&&Q.each(m.dataSourceTypes,function(){this.dataSources&&Q.each(this.dataSources,function(){new a.dataSource.DataSource(this)})}),la&&a.region.unregisterAll(),Q.each(v.children("pageregioncontents").first().children("pageregioncontent"),function(){var b=Q(this),c=b.attr("uniqueid");"__header"===c||"__footer"===c?a.region.register(b,A):a.region.register(b)}),ka||J||(J=P?P.data?P.data("component"):null:a.component.getByType("skuidpage")[0]);var b=f();return b||(P||(P=Q('<div class="nx-page">')),s=a.component.factory({element:P,xmlDefinition:v,options:{uniqueId:H},state:R(c.pageComponentExtensions,{_pageRecord:{Id:z||A,Name:A,LastModifiedDate:t},isInclude:ka,isReplace:la,previousPageComponent:J})}),P.appendTo(K),k[H]=s,s.subscribe("stop.loading",function(){delete k[H],s.unregister()}),s.once("rendered"))}).then(function(b){if(delete k[H],a.utils.inPlatform([a.constants.NATIVE])&&!ka&&b.get("rendered")){var d,e=la&&!c.isPopState,f={isReplace:!0,parameters:G};E?f.routeName=E:(f.pageName=A,f.pageModule=F),d=a.platform.isNative()?window.location.href:la?E||a.platform.getPageNavigateUrl(A):window.location.href,window.history[e?"pushState":"replaceState"](f,"",d),document.title||(document.title=A)}return a.utils.inPlatform(a.constants.LIGHTNING)||M.init(),M.isEnabled()&&!M.networkDown()&&M.sync(),D(),b}).always(function(){a.NProgress.done()})["catch"](function(b){if("Load terminated"!==b){if(b.stack)return void console.error(b.stack);if(b.status&&b.statusText){if((401===b.status||403===b.status)&&a.platform.getName()===a.constants.NATIVE)return a.platform.attemptLogin(0,!0);if(404===b.status){if(!ka)return void a.platform.handlePageLoaderNotFound();if(K){return void Q('<div class="nx-page">').text(T("not_found")||"No Page Found").appendTo(K)}}return void console.error(b.statusText)}I.checkNetworkStatus().then(function(){M.networkDown()?(C(),r(c)):N.log(b||"Unknown error","error")})}})}function s(b,c){a.utils.runningTests()||setTimeout(b,1e3*c)}function t(a,b){var c,d={},e={};return a?(b.forEach(function(b){var c=a[b];c?d[b]=c:e[b]=1}),c=Object.keys(e)):c=b.map(function(a){return a}),{foundAll:0===c.length,missingEntries:c,cumulativeEntries:d}}function u(b){return a.storage.tables.queries.get(b).then(function(a){return a&&a.data})}function v(b,c){return a.storage.tables.queries.add(b,{data:c})}function w(a){return function(){var b=this,c=Array.prototype.slice.call(arguments),d=M.networkDown(),e=$[a].apply(b,c);return e?V(e):d?_[a].apply(b,c).then(function(d){return d&&aa[a].apply(b,[d].concat(c)),d}):ca[a].apply(b,c).then(function(d){return d=O(d),aa[a].apply(b,[d].concat(c)),ba[a].apply(b,c),d})}}function x(a){function b(a){var b=O(a);return aa[d](b),ba[d](b),b}var c,d="serviceModstamps",e=M.networkDown();return a&&0!==N.size(a)?V(b(a)):(c=$[d](),c?V(c):e?_[d]().then(function(a){return a&&aa[d](a),a}):ca[d]().then(b))}function y(b,c){var d=$.labels(),e=t(d,b),f=e.cumulativeEntries,g=M.networkDown();return e.foundAll?V(f):g?_.labels().then(function(a){return a&&!$.labels()&&aa.labels(a),a}):a.platform.services.labels(e.missingEntries,c).then(function(a){return aa.labels(a),ba.labels(a),Q.extend(f,a)})}function z(b){var c=J.meta,d={},e=b.personalization,f=c.personalization,g=["components","dataSources"];return W.forEach(function(a){b[a]&&c[a]&&(delete b[a],d[a]=c[a])}),e&&f&&e.pageId&&f[e.pageId]&&(delete b.personalization,d.personalization=f[e.pageId]),g.forEach(function(a){var d={},e=b[a],f=c[a];e&&f&&(Q.each(e,function(a,b){f[a]||(d[a]=b)}),b[a]=d),e&&!Q.isEmptyObject(b[a])||delete b[a]}),b&&N.size(b)?1===N.size(b)&&b.path?(s(function(){a.platform.services.meta(b)},5),d):a.platform.services.meta(b).then(function(a){return aa.meta(a,b),ba.meta(a,b),Q.extend(d,a)}):V(d)}function A(a){return B([a]).then(function(a){return a[0]})}function B(b){if(!b||!b.length)return U("No data source name provided.");var c,d={},e=[],g=Q.map(b,function(b){var c=a.dataSource.get(b);if(c)return c;d[b]||(d[b]={})});return N.size(d)?z({dataSources:d}).then(function(a){return c=a,a.dataSourceTypes&&Q.each(a.dataSourceTypes,function(){this.js&&(Q.isArray(this.js)?Q.each(this.js,function(a,b){e.push(N.loadJS(f(b)))}):e.push(N.loadJS(f(this.js))))}),Q.when.all(e)}).then(function(){var d=[];return Q.each(c.dataSourceTypes,function(){this.dataSources&&Q.each(this.dataSources,function(c,e){Q.inArray(e.name,b)>-1&&d.push(new a.dataSource.DataSource(e))})}),d}):V(g)}function C(){J={componentPack:{},page:{},theme:{},meta:{}},a&&a.platform&&a.platform.set("themeServiceDFD",null)}function D(){return Q.when.all(Q.map(a.storage.tables.map,function(a){return a.clean()}))}function E(){return M.check()}function F(){return $.serviceModstamps()}function G(a){return F()[a]}var H,I,J,K=!1,L={},M=a.offline,N=a.utils,O=N.parseAsJSONIfString,P="popstate.skuid",Q=a.$,R=Q.extend,S=N.makeXMLDoc,T=a.$L,U=N.reject,V=N.resolve,W=["apps","features","runningUserInfo","site"],X=function(b){var c="",d="",e=[],f=[],g={},h=b.prop("tagName");return"labels"===h?Q.each(b.children(),function(){var a=Q(this).attr("id");a&&(g[a]=!0)}):"javascript"===h?Q.each(b.children("jsitem"),function(){var b,d,f=Q(this),g=f.attr("location"),h=f.text().trim();switch(g){case"inline":h&&(c+=h+";\n");break;case"external":b=f.attr("url"),b&&e.push(b);break;case"inlinesnippet":h&&(c+="skuid.snippet.register('"+f.attr("name")+"',function(args){"+h+"\n});\n");break;case"inlinecomponent":h&&(c+="skuid.componentType.register('"+f.attr("name")+"',function(args) {"+h+"\n});\n");break;case"staticresource":d=a.platform.getSiteResourceUrl({name:f.attr("name"),path:f.attr("filepath"),namespace:f.attr("namespace")}),d&&e.push(d)}}):"css"===h&&Q.each(b.children("cssitem"),function(){var b,c,e=Q(this),g=e.attr("location"),h=e.text().trim();switch(g){case"inline":h&&(d+=h+"\n");break;case"external":b=e.attr("url"),b&&f.push(b);break;case"staticresource":c=a.platform.getSiteResourceUrl({name:e.attr("name"),path:e.attr("filepath"),namespace:e.attr("namespace")}),c&&f.push(c)}}),{inlineJS:c,inlineCSS:d,jsLoads:e,cssLoads:f,labels:g}},Y=function(b){a.componentPacks||(a.componentPacks={}),b&&Q.each(b,function(b,c){a.componentPacks[c.id]=c})},Z=function(a,b){h(a,b,a),a.components&&a.components.length&&Q.each(a.components,function(c,d){(d.alwaysLoad||a.alwaysLoad)&&h(d,b,a)})},$={componentPack:function(a){return J.componentPack[a]},events:function(){return J.events},labels:function(){return J.labels},meta:function(){return J.meta},page:function(a,b,c){return J.page[a||c]},serviceModstamps:function(){return J.serviceModstamps},settings:function(){return J.settings},theme:function(a){return J.theme[a]}},_={componentPack:function(a){return u("componentPackService:"+a)},events:function(){return u("eventsService")},labels:function(){return u("labelsService")},meta:function(){return u("metaService")},page:function(b){return a.storage.tables.pages.get(b,"name").then(function(a){if(a)return a.data})},serviceModstamps:function(){return u("serviceModstamps")},settings:function(){return u("settingsService")},theme:function(a){return u("themeService:"+a)}},aa={componentPack:function(a,b){J.componentPack[b]=a},events:function(a){J.events=a},labels:function(a){J.labels||(J.labels={}),Q.extend(J.labels,a)},meta:function(a,b){W.forEach(function(b){var c=a[b],d=J.meta[b];c&&(d||(d=J.meta[b]={}),Q.extend(d,c))}),a.components&&(J.meta.components||(J.meta.components={}),Q.extend(J.meta.components,a.components)),a.dataSourceTypes&&Q.each(a.dataSourceTypes,function(a,b){b.dataSources&&(J.meta.dataSources||(J.meta.dataSources={}),Q.extend(J.meta.dataSources,b.dataSources))}),a.personalization&&(J.meta.personalization||(J.meta.personalization={}),J.meta.personalization[b.personalization.pageId]=a.personalization)},page:function(a,b){J.page[b]={xml:a.xml,metadata:a.metadata}},serviceModstamps:function(a){J.serviceModstamps=a},settings:function(a){J.settings=a},theme:function(a,b){J.theme[b]=a}},ba={componentPack:function(a){return v("componentPackService:"+a,J.componentPack[a])},events:function(){return v("eventsService",J.events)},labels:function(){return v("labelsService",J.labels)},meta:function(){return v("metaService",J.meta)},page:function(b){var c=J.page[b],d=c&&c.metadata;if(d&&d.pageId)return a.storage.tables.pages.add(d.pageId,{name:d.pageName,data:c})},serviceModstamps:function(){return v("serviceModstamps",J.settings)},settings:function(){return v("settingsService",J.settings)},theme:function(a){return v("themeService:"+a,J.theme[a])}},ca={componentPack:function(b,c){return a.platform.services.componentPack(b,c).then(function(a){return a&&a.length?Q.when.all(a.map(function(a){var b=a.file;return b&&b.path?Q.getJSON(N.getStaticResourceUrl(b.resource,b.namespace,b.path,b.modstamp)).then(function(a){return Q.extend(a,{file:b})}):V(a)})):[]})},events:function(){return a.platform.services.events()},page:function(b,c,d,e){return a.platform.services.page(b,c,d,e)},theme:function(b,c){return a.platform.services.theme(b,c).then(function(a){var b=a.themeinfo;return b&&b.loadResourcesOnClient?Q.getJSON(N.getStaticResourceUrl(b.fileName,b.fileNamespace,"resources.json",b.fileModstamp)).then(function(c){return R(b,c),a},function(){return a}):a})},serviceModstamps:function(){return a.platform.services.serviceModstamps()},settings:function(b){return a.platform.services.settings(b)}};I={checkNetworkStatus:E,componentPack:w("componentPack"),events:w("events"),labels:y,loadDataSourceAndDependencies:A,loadDataSourcesAndDependencies:B,meta:z,page:w("page"),serviceModstamps:x,settings:w("settings"),theme:w("theme")},C(),H={memory:{add:aa,clear:C},persistent:{add:ba,clear:D}},a.loader={cache:H,getServiceModstamps:F,getServiceModstamp:G,load:function(b){return a.storage.initialize().then(function(){return r(b)})},service:I}}(window.skuid);