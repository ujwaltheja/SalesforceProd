!function(e){var t={};function a(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},a.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=352)}({351:function(e,t,a){"use strict";!function(e){var t=e.$,a=e.utils,i=e.mobile,r=e.time,n=e.events.subscribe,l=!1,o=e.visualizations,s=o.core,d=o.chart,c=e.currency,u=e.ui.getRenderer,p=function(a){var i={plotOptions:{series:{animation:250}}},r=a.renderObj,n=d.types[r.type],l=n.hcType||r.type||"";if(l&&(i.plotOptions[l]={cursor:"pointer"},i.chart={type:l,zoomType:"xy"}),r.exporting&&(i.exporting=r.exporting),r.credits&&(i.credits=r.credits),void 0!==r.title&&void 0!==r.title.text&&t.extend(!0,i,{title:{text:r.title.text}}),void 0!==r.subtitle&&void 0!==r.subtitle.text&&t.extend(!0,i,{subtitle:{text:r.subtitle.text}}),!0===r.stacked&&t.extend(i.plotOptions.series,{stacking:"normal"}),r.legend&&("off"===r.legend.layout?i.legend={enabled:!1}:i.legend={layout:r.legend.layout,align:r.legend.halign,verticalAlign:r.legend.valign},!0!==r.legend.showLabels&&!1!==r.legend.showLabels||(i.plotOptions[l].dataLabels={enabled:r.legend.showLabels}),!0===a.metadata.hasDataLabels&&"off"!==r.legend.layout&&(r.legend.layout||r.legend.halign||r.legend.valign)&&(i.plotOptions[l].showInLegend=!0)),r.tooltip&&(i.tooltip={valuePrefix:r.tooltip.valuePrefix,valueSuffix:r.tooltip.valueSuffix}),r.colors&&(i.colors=r.colors),r.backgroundColor&&(i.chart.backgroundColor=r.backgroundColor),a.dataAxes&&a.dataAxes.length>0&&(i.yAxis=[],!0===a.metadata.hasXY&&(i.xAxis=[]),t.each(a.dataAxes,function(){var e={id:this.id};!0===this.flip&&(e.opposite=!0),this.title&&(e.title={text:this.title}),!1===this.allowDecimals&&(e.allowDecimals=!1),void 0!==this.minValue&&(e.min=this.minValue),void 0!==this.maxValue&&(e.max=this.maxValue),"xaxis"===this.type?i.xAxis.push(e):i.yAxis.push(e)})),a.categoryAxes&&(i.xAxis=[],t.each(a.categoryAxes,function(){var e={id:this.id};!0===this.flip&&(e.opposite=!0),this.title&&(e.title={text:this.title}),this.values&&(e.categories=t.map(this.values,function(e,t){return t})),i.xAxis.push(e)})),r.series){i.series=r.series;t.each(i.series,function(i,r){var n=r.actions;r.type&&(r.type=d.types[r.type].hcType||r.type),r.allSeriesActions&&r.allSeriesActions.length||n?t.extend(!0,r,function(i,r){return{events:{click:function(n){var l,o,s=n.point.actionIndex;if(i.allSeriesActions&&s>=0){var d=i.allSeriesActions[s];o=t(d.context).attr("modelId"),l=d.actions}else{if(i.allSeriesActions)return;l=r,o=t(i.actionsContext).attr("modelId")}e.actions.runActionsNode(l,a,{model:e.$M(o)||a.model,rows:n.point.sk_rows,initiatorId:a.editor._GUID,$Chart:{point:n.point}})}}}}(r,n)):r.allowPointSelect=!0})}if(n.additionalProps&&n.additionalProps(i),t.extend(i.chart,{reflow:!1}),void 0!==r.beforeRenderSnippet){var o=e.snippet.getSnippet(r.beforeRenderSnippet);void 0!==o&&o(i)}a.container.highcharts()&&a.container.highcharts().destroy(),a.container.highcharts(i),a.getHighchartsObject=function(){return a.container.highcharts()},a.getHCConfig=function(){return i}},h=function(t,i){var r=i.valueFieldMetadata;"CURRENCY"===r.displaytype?i.tooltip={valuePrefix:a.decodeHTML(e.currency.getSymbol(t)),valueSuffix:" "+t}:"PERCENT"===r.displaytype&&(i.tooltip={valueSuffix:" %"}),void 0!==r.scale&&(void 0===i.tooltip&&(i.tooltip={}),i.tooltip.valueDecimals=r.scale)},g=function(e,a){if(a&&"PICKLIST"===a.displaytype&&a.picklistEntries.length>0){var i={};return t.each(a.picklistEntries,function(){var a=this.label||this.value;t.each(e,function(t){this.splitFieldValue===a&&(i[t]=this,delete e[t])})}),t.extend(i,e),i}return e},v=function(e){var t,i,n=e||{},l=n.model,o=n.row,s=n.field,d=n.type,c=n.dategranularity,u=n.template,p=n.val,h={model:l,activeCurrency:n.activeCurrency};if(p||("field"===d&&s&&l&&o&&(t=x(s.name||s.id,o,h)),"template"===d&&u&&l&&o&&(t=a.mergeAsText("row",u,{},l,o))),("field"===d&&t||p)&&c){var g=s&&s.displaytype,v="DATETIME"===g?r.parseSFDateTime:r.parseSFDate,f=p||v(t),y=r.formatDate;if("DATETIME"!==g||p||(f=r.getLocalDateTime(f)),f)switch(c){case"day":i=r.makeFormattedDateFromJS(f);break;case"calweek":i=Math.ceil(parseInt(y("o",f),10)/7)+" ("+f.getFullYear()+")";break;case"calmonth":i=y("M yy",f);break;case"calquarter":i="Q"+Math.ceil((parseInt(f.getMonth(),10)+1)/3)+" "+f.getFullYear();break;case"calyear":i=y("yy",f)}}return void 0===i&&(i=p||t),{rawVal:p||t,displayVal:i}},f=function(e,t){var i=e.valueFieldMetadata,r=e.aggFunction?" ("+(s.AGG_FUNCTIONS[e.aggFunction]&&s.AGG_FUNCTIONS[e.aggFunction].abbreviation||e.aggFunction)+")":"",n={model:e.model,activeCurrency:e.activeCurrency};return"field"===e.splitType&&e.model&&t&&e.splitField?x(e.splitField,t,n)+r:"template"===e.splitType?a.mergeAsText("row",e.splitTemplate,{},e.model,t):a.decodeHTML(i&&(i.name||i.label)||e.model.id)+r},y=function(e){var t=c.getConversionRates();return t&&e?t[0].IsoCode:a.userInfo.defaultCurrency},x=function(e,t,i){var r=i.fieldMetadata||i.model.getField(e),n=i.activeCurrency,l=i.model,o=l.getFieldValue(t,e,!0);if("PICKLIST"===r.displaytype&&null!==o&&void 0!==o&&(o=(r.picklistEntries||[]).reduce(function(e,t){return t.value===o?t.label||t.value:a.isObject(e)?e.label||e.value:e})),"CURRENCY"===r.displaytype&&!0===a.isMultiCurrencyOrganization){var s=a.getRowCurrency({model:l,row:t,field:e});s!==n&&(o=a.convertCurrency(o,s,n))}return o},m={pie:{getSeriesData:function(e){if(!e||!e.valueField)return[];var a={},i=[],r=e.model,n=e.splitField,l=e.aggFunction,o=e.filterConditions||[],s={model:r,activeCurrency:e.activeCurrency};return t.each(r.getRows(o),function(){var t=x(e.valueField,this,s),i=x(n,this,s),r=f(e,this),o=a[r];if(o||(o=a[r]={value:null,count:0,splitFieldValue:i,dataRows:[]}),o.dataRows.push(this),l){var d=o.value;null===d?o.value=t||0:"sum"===l||"avg"===l?o.value+=t||0:"max"===l&&t>d?o.value=t:"min"===l&&t<d&&(o.value=t)}else o.value=t||0;o.count+=1}),"field"===e.splitType&&n&&(a=g(a,r.getField(n))),t.each(a,function(e,t){var a=t.value;l&&("avg"===l?a=t.value/t.count:"count"===l&&(a=t.count)),i.push({name:e,y:a,sk_rows:t.dataRows})}),i},buildSeries:function(e){var t={id:e.id||e.name,name:e.name,valueFieldMetadata:e.model.getField(e.valueField),data:m.pie.getSeriesData(e),type:e.type,actions:e.actions,actionsContext:e.actionsContext};return h(e.activeCurrency,t),t},buildSeriesArray:function(a,i,r){var n=[],l=a.renderObj.type;i.children("series").each(function(i,o){var d=t(o),c=d.attr("modelId"),u=d.attr("aggfunction"),p=s.AGG_FUNCTIONS[u],h=d.attr("splitfield")||d.attr("valuefield"),g=void 0!==p?" ("+p.abbreviation+")":"",v={model:c&&e.$M(c)||a.model,valueField:d.attr("valuefield"),splitType:d.attr("splittype")||"field",splitField:d.attr("splitfield"),splitTemplate:d.attr("splittemplate"),type:d.attr("type"),activeCurrency:r.activeCurrency},f=v.model.getField(h),y=d.children("actions").first();v.name=(void 0!==f&&(f.label||f.name))+g,v.id=v.name,v.filterConditions=r.filterConditions,v.valueFieldMetadata=v.model.getField(v.valueField),y.length&&(v.actions=y,v.actionsContext=d),u&&(v.aggFunction=u),n.push(m[l].buildSeries(v))});var o=n[0];o.allSeriesActions=[],o.actions&&(o.allSeriesActions.push({actions:o.actions,context:o.actionsContext}),t.each(o.data,function(e,t){t.actionIndex=0}));for(var d=1;d<n.length;d++){var c=n[d],u=c.data;c.actions&&o.allSeriesActions.push({actions:c.actions,context:c.actionsContext});for(var p=0;p<u.length;p++)o.data.push(u[p]),c.actions&&(u[p].actionIndex=d)}return[o]}},line:{buildDataAxes:function(e,a){var i=a.children("axis");i.length>0&&(e.dataAxes&&0===e.dataAxes.length||(e.dataAxes=[],delete e.defaultDataAxis,delete e.defaultXAxis,delete e.defaultYAxis),t.each(i,function(){var a=t(this),i=a.attr("title"),r=a.attr("type"),n=a.attr("minvalue"),l=a.attr("maxvalue"),o=e.dateGranularity||a.attr("dategranularity"),s={id:a.attr("id"),flip:"true"===a.attr("flip"),fillvals:a.attr("fillvals")};i&&i.length>0&&(s.title=i),r&&r.length>0&&(s.type=r),o&&(s.dategranularity=o),"true"===a.attr("integersonly")&&(s.allowDecimals=!1),void 0!==n&&(s.minValue=n),void 0!==l&&(s.maxValue=l),e.defaultDataAxis||(e.defaultDataAxis=s),"xaxis"!==r||e.defaultXAxis?"yaxis"!==r||e.defaultYAxis||(e.defaultYAxis=s):e.defaultXAxis=s,e.dataAxes.push(s)}))},buildCategoryAxes:function(e,a){var i=a.children("axis");i.length>0&&t.each(i,function(){var a=t(this),i=a.attr("categorytype")||"field",r=a.attr("field"),n=a.attr("template"),l=e.dateGranularity||a.attr("dategranularity"),o=a.attr("title"),s={id:a.attr("id"),flip:"true"===a.attr("flip"),fillvals:a.attr("fillvals"),values:{}};i&&(s.type=i),r&&(s.field=e.model.getField(r)),n&&(s.template=n),l&&(s.dategranularity=l),o&&(s.title=o),e.categoryAxes||(e.categoryAxes={},e.defaultCategoryAxis=s),e.categoryAxes[s.id]=s})},getSeriesData:function(e){var a=[],i=e.aggFunction;return t.each(e.categories,function(e,t){var r=t.value;i&&("avg"===i&&t.count>0?r=t.value/t.count:"count"===i&&(r=t.count)),a.push({y:r,name:e,sk_rows:t.dataRows})}),a},buildSeriesArray:function(a,i,r){var n={},l=[],o=i.attr("separated")||!1,s=0,d={},c=a.renderObj.type;return i.children("series").each(function(){var i,l,c=t(this),u={},p=c.attr("valuefield"),h=c.attr("splittype")||"field",y=c.attr("splitfield"),m=c.attr("splittemplate"),b=c.attr("type"),C=c.attr("aggfunction"),A=c.attr("modelId"),F=A&&e.$M(A)||a.model,w=c.attr("dataAxisId")||a.defaultDataAxis.id,I=c.attr("categoryAxisId")||a.defaultCategoryAxis&&a.defaultCategoryAxis.id,T=a.categoryAxes&&a.categoryAxes[I],S=c.attr("categoryField"),k=S&&F.getField(S)||a.categoryAxes&&a.categoryAxes[I]&&a.categoryAxes[I].field,D={model:F,activeCurrency:r.activeCurrency},M=c.children("actions").first(),O=r.filterConditions||[];if(d.hasOwnProperty(I)||(d[I]={}),k&&F&&(l=k.name||k.id),A&&a.editor.registerModel(F),p||y){var N=F.getField(p),R={model:F,valueFieldMetadata:N,aggFunction:C,splitType:h,splitField:y,splitTemplate:m,activeCurrency:r.activeCurrency};t.each(F.getRows(O),function(){y&&(i=x(y,this,D));var e,t,a=f(R,this),n=x(p,this,D),h=(k||T.template?v({model:F,row:this,type:T.type,field:k,template:T.template,dategranularity:T.dategranularity,activeCurrency:r.activeCurrency}):{displayVal:"Values",rawVal:"Values"}).displayVal;if(void 0!==l){var g=x(l,this,D);d[I][g]=!0}if((e=u[a])||(u[a]=e={categories:{},valueFieldMetadata:N,splitFieldValue:i},C&&(e.aggFunction=C),b&&(e.type=b),o&&(e.stack=s),w&&(e.dataAxis=w),I&&(e.categoryAxis=I),M.length&&(e.actions=M,e.actionsContext=c)),T&&!T.values[h]&&(T.values[h]=!0),(t=e.categories[h])||(e.categories[h]=t={value:null,count:0,dataRows:[]}),C){var m=t.value;null===m?t.value=n||0:"sum"===C||"avg"===C?t.value+=n||0:"max"===C&&n>m?t.value=n:"min"===C&&n<m&&(t.value=n)}else t.value=n||0;t.count+=1,t.dataRows.push(this)})}o&&(s+=1),"field"===h&&y&&(u=g(u,F.getField(y))),t.extend(n,u)}),t.each(a.categoryAxes,function(){var e=this,a={};m[c].adjustCategories(e,t.map(d[e.id],function(e,t){return t})),t.each(n,function(i,r){a[i]={},t.extend(a[i],r),a[i].categories={},t.each(e.values,function(e){var t=r.categories[e]||{value:0,count:0};a[i].categories[e]=t})}),n=a}),t.each(n,function(e,t){var a={id:e,name:e,data:m[c].getSeriesData(t),actions:t.actions,valueFieldMetadata:t.valueFieldMetadata,actionsContext:t.actionsContext};t.type&&(a.type=t.type),t.stack&&(a.stack=t.stack),t.dataAxis&&(a.yAxis=t.dataAxis),t.categoryAxis&&(a.xAxis=t.categoryAxis),h(r.activeCurrency,a),l.push(a)}),l},adjustCategories:function(e,a){if(e.fillvals&&-1!==["true","year","month","week"].indexOf(e.fillvals)&&"field"===e.type&&e.dategranularity&&s.DATE_GRANULARITIES[e.dategranularity]){var i,n,l=e.dategranularity,o=s.DATE_GRANULARITIES[l],d=e.field,c="DATETIME"===d.displaytype?r.parseSFDateTime:r.parseSFDate,u={};t.each(a,function(e,t){if(!1===c(t))return u[t]=!0,!0;(t>n||void 0===n)&&(n=t),(t<i||void 0===i)&&(i=t)});var p=c(i),h=c(n);p&&h&&("year"===e.fillvals?(p.setMonth(0),p.setDate(1),h=new Date(h.getFullYear()+1,0,0)):"month"===e.fillvals?(p.setDate(1),h=new Date(h.getFullYear(),h.getMonth()+1,0)):"week"===e.fillvals&&(p.setDate(p.getDate()-p.getDay()),h.setDate(h.getDate()-h.getDay()+6)));var g=p,f=function(t){var a=v({val:t,dategranularity:l,field:d}).displayVal;e.values[a]||(e.values[a]=!0)};if(g&&n&&(o.dayInterval||o.monthInterval||o.yearInterval))for(e.values={},f(g);g<h;)o.dayInterval&&g.setDate(g.getDate()+o.dayInterval),o.monthInterval&&g.setMonth(g.getMonth()+o.monthInterval,1),o.yearInterval&&g.setFullYear(g.getFullYear()+o.yearInterval,0,1),g>h&&(g=h),f(g);t.isEmptyObject(u)||t.extend(e.values,u)}}},bubble:{buildDataAxes:function(e,t){m.line.buildDataAxes(e,t)},buildSeries:function(i){var r=[],n={},l=i.model,o=i.xValueField,d=l.getField(o)||{},c=i.xAggFunction,u=void 0!==s.AGG_FUNCTIONS[c]&&s.AGG_FUNCTIONS[c].abbreviation,p=i.yValueField,h=l.getField(p)||{},v=i.yAggFunction,y=void 0!==s.AGG_FUNCTIONS[v]&&s.AGG_FUNCTIONS[v].abbreviation,m=i.sizeField,b=l.getField(m)||{},C=i.sizeAggFunction,A=void 0!==s.AGG_FUNCTIONS[C]&&s.AGG_FUNCTIONS[C].abbreviation,F=i.splitType,w=i.splitField,I=i.splitTemplate,T=function(e,t){var a=e.aggFunction,i=e.value;null===i?e.value=t||0:"sum"===a||"avg"===a?e.value+=t||0:"max"===a&&t>i?e.value=t:"min"===a&&t<i&&(e.value=t),e.count+=1},S=i.filterConditions||[];return t.each(l.getRows(S),function(){var e,a=f({model:l,valueFieldMetadata:d,aggFunction:c,splitType:F,splitField:w,splitTemplate:I,activeCurrency:i.activeCurrency},this)+", "+f({model:l,valueFieldMetadata:h,aggFunction:v,splitType:F,splitField:w,splitTemplate:I,activeCurrency:i.activeCurrency},this)+(m?", "+f({model:l,valueFieldMetadata:b,aggFunction:C,splitType:F,splitField:w,splitTemplate:I,activeCurrency:i.activeCurrency},this):""),r={sk_row:this},s={model:l,activeCurrency:i.activeCurrency},u=x(o,this,s)||0,g=x(p,this,s)||0;t.extend(r,{x:u,y:g}),m&&(e=x(m,this,s),r.size=e),n[a]||(n[a]={dataPoints:[]},"field"===F&&w&&(n[a].splitFieldValue=x(w,this,s)),i.yAxisId&&(n[a].yAxis=i.yAxisId),v&&(n[a].yAggFunction=v),i.xAxisId&&(n[a].xAxis=i.xAxisId),c&&(n[a].xAggFunction=c),C&&(n[a].sizeAggFunction=C),i.type&&(n[a].type=i.type)),n[a].dataPoints.push(r)}),"field"===F&&w&&(n=g(n,l.getField(w))),t.each(n,function(n,l){var o,s=[],p={id:n,name:n,data:[]};if(!0===i.isAggregate){var g={value:null,count:0,aggFunction:c},f={value:null,count:0,aggFunction:v},x={value:null,count:0,aggFunction:C},F=[];t.each(l.dataPoints,function(e,t){T(g,t.x),T(f,t.y),T(x,t.size),F.push(t.sk_row)}),o=[g,f,x],t.each(o,function(){"avg"===this.aggFunction?this.value=this.value/this.count:"count"===this.aggFunction&&(this.value=this.count)}),s.push({x:g.value,y:f.value,z:x.value,sk_rows:F})}t.each(s.length>0?s:l.dataPoints,function(e,t){var a={x:t.x,y:t.y};m&&(a.z=t.size),a.sk_rows=[t.sk_row],p.data.push(a)}),l.type&&(p.type=l.type),l.xAxis&&(p.xAxis=l.xAxis),l.yAxis&&(p.yAxis=l.yAxis);var w,I=function(t){var r={prefix:"",suffix:""};return"CURRENCY"===t.displaytype?(r.prefix=a.decodeHTML(e.currency.getSymbol(i.activeCurrency)),r.suffix=" "+i.activeCurrency):"PERCENT"===t.displaytype&&(r.suffix=" %"),r},S=I(d),k=I(h);if(w=d.label+(u?" ("+u+")":"")+": "+S.prefix+"{point.x}"+S.suffix+"<br/>",w+=h.label+(y?" ("+y+")":"")+": "+k.prefix+"{point.y}"+k.suffix+"<br/>",m){var D=I(b);w+=b.label+(A?" ("+A+")":"")+": "+D.prefix+"{point.z}"+D.suffix+"<br/>"}p.tooltip={pointFormat:w},r=r.concat(p)}),r},buildSeriesArray:function(a,i,r){var n=[],l=a.renderObj.type,o=r.filterConditions;return t.each(i.children("series"),function(){var i=t(this),s=i.attr("modelId"),d=i.attr("splittype")||"field",c=i.attr("splitfield"),u=i.attr("splittemplate"),p=i.attr("yaggfunction"),h=i.attr("xaggfunction"),g=i.attr("sizefield"),v=i.attr("sizeaggfunction"),f=i.attr("type"),y={model:s&&e.$M(s)||a.model,isAggregate:!!(p||h||v),yAxisId:i.attr("yAxisId")||a.defaultYAxis.id,yValueField:i.attr("yvaluefield"),yAggFunction:p,xAxisId:i.attr("xAxisId")||a.defaultXAxis.id,xValueField:i.attr("xvaluefield"),xAggFunction:h,activeCurrency:r.activeCurrency};f&&(y.type=f),d&&(y.splitType=d),c&&(y.splitField=c),u&&(y.splitTemplate=u),g&&(y.sizeField=g),v&&(y.sizeAggFunction=v),o&&(y.filterConditions=o),s&&a.editor.registerModel(y.model),n=n.concat(m[l].buildSeries(y))}),n}}};if(t.extend(m,{donut:m.pie,funnel:m.pie,pyramid:m.pie,spline:m.line,area:m.line,areaspline:m.line,column:m.line,bar:m.line,scatter:m.bubble,heatmap:m.bubble}),e.componentType.register("skuidvis__chartset",{render:function(e,a,i){var r=this;i.element.addClass("sk-chartset"),i.drillups=[],i.drillupButton=t("<div>").addClass("sk-chartset-drillup-button").hide().on("click.skuid",function(e){e.stopPropagation(),i.drillup()}).appendTo(i.element),i.chartArea=t("<div>").addClass("sk-chartset-chart").appendTo(i.element),i.initCharts=function(){r.initCharts(i,a)},i.initCharts(),i.renderChartByID=function(e,t){return r.renderChartByID(i,e,t)},i.renderChartByIndex=function(e,t){return r.renderChartByIndex(i,e,t)},i.drilldownByID=function(e,t){return r.drilldownByID(i,e,t)},i.drillup=function(){return r.drillup(i)},void 0===i.renderedChart&&i.renderChartByIndex(0)},initCharts:function(e,a){var i=e.charts=[],r=e.chartsMap={};a.children("charts").first().children().each(function(){var e=t(this),a=e.attr("uniqueid");i.push(e),a&&(r[a]=e)})},renderChart:function(t,a,i){if(void 0!==a){i||(i={}),i.chartSet=t;var r=e.component.factory({xmlDefinition:a,context:i,element:t.chartArea});return t.renderedChart=r,r}},renderChartByID:function(e,t,a){if(void 0!==t){var i=e.chartsMap[t];return i?this.renderChart(e,i,a):void 0}},renderChartByIndex:function(e,t,a){if(void 0!==t){var i=e.charts[t];return i?this.renderChart(e,i,a):void 0}},drilldown:function(e,a,i){if(void 0!==a){var r=i.drillupChart;e.drillups.push(r);var n={};return a.attr("backbuttontextcolor")&&t.extend(n,{color:a.attr("backbuttontextcolor")}),a.attr("backbuttonbgcolor")&&t.extend(n,{background:a.attr("backbuttonbgcolor")}),this.setDrillupButton(e,n),this.renderChart(e,a,i)}},drilldownByID:function(e,t,a){if(void 0!==t){var i=e.chartsMap[t];return i?this.drilldown(e,i,a):void 0}},setDrillupButton:function(e,t){t||(t={});var a=e.drillups,i=e.drillupButton;if(a.length){var r=a.slice(-1)[0].getBackButtonText()||"Back";i.css({color:t.color||"",background:t.background||""}).text(r).show()}else i.hide()},drillup:function(e){if(void 0!==e){var t=e.drillups.pop();if(void 0!==t){var a=t.xmlDefinition;return this.setDrillupButton(e,{color:a.attr("backbuttontextcolor"),background:a.attr("backbuttonbgcolor")}),e.renderedChart.unregister({removeElement:!1}),e.chartArea.replaceWith(t.render().element),i&&i.processResponsiveElements(),e.renderedChart=t,t}}}}),e.componentType.register("skuidvis__chart",{actions:{drilldown:function(e,t,a){t.doDrilldown(e,a)}},render:function(i,r,o){var c=o.context,h=o.chartSet=c&&c.chartSet,g=o.editor=new e.ui.Editor(i,{showSaveCancel:!1}),v=t("<div>"),f=r.attr("type")||"pie",x=o.metadata=d.types[f].metadata,b=o.model=e.$M(r.attr("model")),C=r.children("colors"),A=r.children("tooltip"),F=r.children("legend"),w=r.children("dataaxes"),I=o.categoryAxesNode=r.children("categoryaxes"),T=o.seriesListNode=r.children("serieslist"),S=r.children("allowedtypes"),k=r.attr("height")||"400px",D=r.attr("rendersnippet"),M=o.renderObj={type:f};l||(Highcharts.setOptions({lang:{decimalPoint:a.userLocale.decimalsSeparator,thousandsSep:a.userLocale.thousandsSeparator}}),l=!0),b&&(g.registerModel(b),g.handleDataRefresh=function(){o.draw()},g.handleChange=function(){e.ui.Editor.prototype.handleChange.call(this),o.rebuild()},g.handleCancel=function(){e.ui.Editor.prototype.handleCancel.call(this),o.rebuild()},g.handleSave=function(){e.ui.Editor.prototype.handleSave.call(this),o.rebuild()});var O=g.contents.addClass("sk-chart-wrapper"),N=r.attr("cssclass");function R(){var t=e.themeSettings.getAll(),a=t&&t.visualizations&&t.visualizations.chart||{};if(r.attr("backgroundcolor")?M.backgroundColor=r.attr("backgroundcolor"):void 0!==a.background?M.backgroundColor=a.background:delete M.backgroundColor,C&&C.children().length){var i=s.getColorsArray(C);i.length&&(M.colors=i)}else void 0!==a.colorPalette&&a.colorPalette.length?M.colors=a.colorPalette:delete M.colors}function E(e){e&&e.length>0&&m[f].buildCategoryAxes(o,e)}function _(e,a){if(e&&e.length>0){a||(a={});var i=a.context||o.context,r=o.createConditionsFromXml();i&&i.filterConditions&&(r=t.merge(r,i.filterConditions)),a=t.extend(!0,{filterConditions:r},a||{}),e.children("series").length&&(M.series=m[f].buildSeriesArray(o,e,a))}}function P(){var e,t,i;e=r.attr("maintitle"),t=r.attr("subtitle"),M.useOrgCurrency="true"===r.attr("useorgcurrency")||!1,M.credits={enabled:!1},M.title={text:a.mergeAsTextInContext(e,a.getContextToUse(o))},t&&(M.subtitle={text:a.mergeAsTextInContext(t,a.getContextToUse(o))}),"true"===r.attr("stacking")&&(M.stacked=!0),R(),!0===x.hasCategories&&I&&I.length>0&&E(I),!0===x.hasDataAxes&&w&&w.length>0&&(i=w)&&i.length>0&&m[f].buildDataAxes(o,i),_(T,{activeCurrency:y(M.useOrgCurrency)}),void 0!==A&&A.length>0&&(M.tooltip=function(e){var t={},i=e.attr("prefix"),r=e.attr("suffix");return void 0!==i&&(t.valuePrefix=a.mergeAsText("model",i,{},b)),void 0!==r&&(t.valueSuffix=a.mergeAsText("model",r,{},b)),t}(A)),F&&F.length>0&&function(e){M.legend={};var t=e.attr("layout"),a=e.attr("halign"),i=e.attr("valign"),r=e.attr("showlabels"),n=M.legend;t&&(n.layout=t),a&&(n.halign=a),i&&(n.valign=i),"true"===r?n.showLabels=!0:"false"===r&&(n.showLabels=!1)}(F)}if(o.container=t("<div>").addClass("sk-chart-container sk-chart-standard").appendTo(O),N&&O.addClass(N),k&&O.css({height:k}),D&&(M.beforeRenderSnippet=D),"off"===r.attr("export")?M.exporting={enabled:!1}:"string"==typeof r.attr("export")&&(M.exporting={mode:r.attr("export")}),o.draw=function(){P(),p(o)},o.refresh=function(){var e,a,i;a=(e=o).getHighchartsObject(),i={},e.categoryAxes&&t.each(e.categoryAxes,function(){var e=t.map(this.values,function(e,t){return t});a.get(this.id).setCategories(e,!1)}),t.each(e.renderObj.series,function(e,t){var r=a.get(t.id);i[t.id]=!0,r?r.setData(t.data,!1):a.addSeries(t,!1)}),t.each(a.series,function(e,t){if(!t)return!1;i[t.options.id]||a.get(t.options.id).remove(!1)}),a.redraw()},o.rebuild=function(e){e||(e={});var t=e.categoryAxesNode||o.categoryAxesNode;!0===x.hasCategories&&t&&(t.children("axis").length&&E(t));var a=e.seriesListNode||o.seriesListNode;a&&_(a,e),o.refresh()},o.reflow=function(){var e=o.container,t=e.highcharts();t&&t.chartWidth!==e.width()&&e.is(":visible")&&t.reflow()},o.doDrilldown=function(a,i){var r=a.attr("chartid");void 0===i&&(i={}),i.drillupChart=o;var n=e.component.createConditionsFromXml(t(a),i);n.length&&(i.filterConditions=n),h.drilldownByID(r,i)},o.getBackButtonText=function(){return"Back"},S&&S.length>0){var G=t('<div style="display:inline-block; padding-right:16px;">').hide().appendTo(v),L=S.children("type"),V=[];L&&L.length&&(t.each(d.types,function(){var e=this,a=e.value;a===f?V.push(e):t.each(L,function(){if(t(this).text()===a)return V.push(e),!1})}),G.html('<span style="font-weight:bold;padding-right:16px;">Chart Type</span>').append(u("PICKLIST").edit({required:!0,value:f,entries:V,onChange:function(e){var a,i={};t.each(o.getHighchartsObject().legend.getAllItems(),function(e,t){i[t.name]=t.visible}),f=e,M.type=e,p(o),a=o.getHighchartsObject().legend.getAllItems(),t.each(a,function(e,t){i.hasOwnProperty(t.name)&&(t.visible===i[t.name]&&t.setVisible(),t.setVisible())})}})).show())}if(!0===x.hasCategories&&I&&I.children("axis").length){var B=I.children("axis").first(),z=B.attr("dategranularity"),U=B.children("allowedgranularities").children("type"),j=[];U&&U.length&&(t.each(s.DATE_GRANULARITIES,function(){var e=this;e.value===z?j.push(e):t.each(U,function(){if(t(this).text()===e.value)return j.push(e),!1})}),t('<div style="display:inline-block;">').html('<span style="font-weight:bold;padding-right:16px;">Date Granularity</span>').append(u("PICKLIST").edit({required:!0,value:z,entries:j,onChange:function(e){o.dateGranularity=e,o.rebuild()}})).appendTo(v))}i.append(O,v),o.draw(),a.addResizeHandler(o.reflow,100),a.delayEventCallback({eventType:"tabshow pageload dialogopen stepchange",delay:20,callback:o.reflow}),o.unsubscribeAll(),o.storeSubscription(n("ui.reflow",o.reflow)),o.storeSubscription(n("ui.themeSettings.loaded",function(){R(),p(o)}));var Y=o.definition.closest("panel");Y.length&&o.storeSubscription(n("ui.panel.toggled",function(e){e.id==Y.attr("uniqueid")&&o.reflow()})),o.storeSubscription(n("salesforce.async.field.rendered",function(t){o.seriesListNode.children().each(function(a,i){t.id===e.$(i).attr("splitfield")&&o.rebuild()})}))}}),i){var b=i.processResponsiveElements;i.processResponsiveElements=function(){b(),t.each(e.component.getByType("skuidvis__chart"),function(e,t){t.container.is(":visible")&&t.reflow()})}}}(skuid)},352:function(e,t,a){"use strict";a(351)}});