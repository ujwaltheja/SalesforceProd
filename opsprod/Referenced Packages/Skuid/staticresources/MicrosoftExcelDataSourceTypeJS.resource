!function(e){var a={};function t(l){if(a[l])return a[l].exports;var r=a[l]={i:l,l:!1,exports:{}};return e[l].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=a,t.d=function(e,a,l){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:l})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="",t(t.s=321)}({321:function(e,a,t){"use strict";!function(e){var a=e.$,t=a.Deferred,l=e.utils,r=e.dataSource,i=r.utils,s=e.constants,o=s.DISPLAY_TYPES,n=s.MIME_TYPES,d=s.HTTP_VERBS,c=e.ui.getFieldRenderer,u=n.JSON,b=o.DATETIME,p=o.DATE,y=o.NUMBER,h=o.OBJECT,m=o.STRING,f=o.BOOLEAN,v=o.TEXT,k=d.GET,g=d.POST,w=d.PATCH,T=d.DELETE,S="https://graph.microsoft.com/v1.0",C=i.getModelMergeConditions,x={urlEncode:!1},R=function(e,t,l){a.each(e.picklistEntries,function(e,r){l===r.value&&r.args&&a.each(r.args,function(e,a){t.push(a)})})};r.getDataSourceType("MicrosoftExcel")||new r.core.RESTDataSourceTypeBase({name:"MicrosoftExcel",coerceRequest:function(e){var t=e.type;"query"===t?function(e,a){var t=e.model,l=C(t,e,x),r=a.getEntityMetadataCacheKey(t),i=l.parent;"Workbook"===r&&(i?-1!==i.indexOf(".")?(e.request.url="/me/drive/root:"+i,e.request.pathToContent=""):(e.request.url="/"===i?"/me/drive/root/children":"/me/drive/root:"+i+":/children",e.request.pathToContent="value"):(e.request.url="/me/drive/root/children",e.request.pathToContent="value"))}(e,this):"update"===t&&function(e,t){var l=e.model,r=C(l,e,x),i=t.getEntityMetadataCacheKey(l),s=r.file,o=r.worksheet,n=e.row._rowRange;if("TableRange"===i||"Range"===i){var d=e.row._formulas,c=[];a.each(e.request.data,function(e,a){d[e]=a}),a.each(d,function(e,a){c.push(a)}),e.request.data={formulas:[c]},e.request.url="/me/drive/items/"+s+"/workbook/worksheets('"+o+"')/range(address='"+n+"')"}}(e,this),e.request.headers={Accept:u,"Content-Type":u,"Content-Length":0}},parseSuccessfulLoadResponse:function(e,t,r,i,s){var o=this.parseResponseBodyAsJSON(e.body),n=C(i,{model:i},x).hasHeader,d=t.pathToContent,c=d?l.getObjectProperty(o,d):o,u=[];if("Workbook"===this.getEntityMetadataCacheKey(i))if(c.value&&a.isArray(c.value))a.each(c.value,function(e,a){if(-1===a.name.split(".").slice(-1)[0].indexOf("xlsx"))delete c[e];else{var t=a.parentReference.path,r=t?t.split(":")[1]:a.parentReference.id;a.createdByUserName=l.getObjectProperty(a,"createdBy.user.displayName"),a.lastModifiedByUserName=l.getObjectProperty(a,"lastModifiedBy.user.displayName"),a.parentDirectory=r,a.oneUp=r.substring(0,r.lastIndexOf("/")),u.push(a)}}),c=u;else{var b=c.parentReference.path,p=b?b.split(":")[1]:c.parentReference.id;c.createdByUserName=l.getObjectProperty(c,"createdBy.user.displayName"),c.lastModifiedByUserName=l.getObjectProperty(c,"lastModifiedBy.user.displayName"),c.parentDirectory=p,c.oneUp=p.substring(0,p.lastIndexOf("/")),c=[c]}else if(r.isRangeEntity){var y,h=o.formulas,m=o.values,f=o.text,v=[],k=o.address.split("!")[1],g=k.split(":"),w=[],T=[],S=0,R=0;"true"===n?(v=c[0],c.shift()):(s.sort(function(e,a){return e.column-a.column}),a.each(s,function(e,a){v.push(a.label)})),a.each(g,function(e,a){T[e]=a.replace(/[^0-9]/,""),w[e]=a.replace(/[0-9]/g,"")}),a.each(m,function(e,t){var l="true"===n?h[e+1]:h[e],r="true"===n?f[e+1]:f[e],i={},s={};0===R&&(y=parseInt(T[0],10)),"true"===n&&0===R&&(y+=1),S!==e&&(y+=1),a.each(t,function(e){i[v[e].replace(" ","").trim()]=l[e],s[v[e].replace(" ","").trim()]=r[e]});var o=-1===k.indexOf(":")?w[0]+y:w[0]+y+":"+w[1]+y;u[e]={_rowRange:o,_formulas:i,_text:s},a.each(t,function(a,t){u[e][v[a].replace(" ","")]=t}),S!=e&&(S=e),R=1}),c=u}return c},parseSuccessfulSaveResponse:function(e,t){var r=l.parseAsJSONIfString(e.body),i=t.model,s=i.fields;if(i.isRangeEntity){var o={_formulas:{},_text:{},_rowRange:r.address.split("!")[1]};return s.sort(function(e,a){return e.column-a.column}),a.each(s,function(e,a){var t=a.column;o[a.id]=r.values[0][t],o._formulas[a.id]=r.formulas[0][t],o._text[a.id]=r.text[0][t]}),o}},queryEntityMetadata:function(e){var t=this,r=a.Deferred(),i=this.getEntityMetadataCacheKey(e),s=this.prop("x-metadata")[i],o=s.methods.query,n={type:"query",method:o,model:e,request:{url:o.url,method:o.verb,contentType:o.contentType,headers:{Accept:u}}},d=e.conditions?C(e,n,x):{},c=d.hasHeader;return s.isRangeEntity&&l.size(d)?"string"==typeof e?r.resolve(s):t.makeRequest(e,n).then(function(e){var l=t.parseResponseBodyAsJSON(e.body);if("true"===c)a.each(l.values[0],function(e,a){s.fields[e]={id:a.replace(" ",""),label:a,column:e,displaytype:"FORMULA",accessible:!0,createable:!1,editable:!0,"x-alwaysinclude":!0}});else{var i,o=l.values,n=l.address.split("!")[1].split(":"),d=[],u=[],b=0;a.each(n,function(e,a){u[e]=a.replace(/[^0-9]/,""),d[e]=a.replace(/[0-9]/g,"")}),a.each(o[0],function(e){i&&0!==b||(i=d[0]),s.fields[e]={id:"Column"+i,label:"Column "+i,column:e,displaytype:"FORMULA",accessible:!0,createable:!1,editable:!0,"x-alwaysinclude":!0},i=i.substring(0,i.length-1)+String.fromCharCode(i.charCodeAt(i.length-1)+1),b++})}return r.resolve(s)}):r.resolve(s)},createActions:function(r,i,s){s=s||{};var o={label:"Number",id:"arg1",name:"number",type:"string",valueType:"number"},n={label:"Range",id:"arg1",name:"range",type:"string",valueType:"range"},d={label:"Workbook ID",id:"workbook",type:"text"},c=[{value:"abs",label:"ABS()",args:[o]},{value:"acos",label:"ACOS()",args:[o]},{value:"acosh",label:"ACOSH()",args:[o]},{value:"acot",label:"ACOT()",args:[o]},{value:"acoth",label:"ACOTH()",args:[o]},{value:"asin",label:"ASIN()",args:[o]},{value:"asinh",label:"ASINH()",args:[o]},{value:"atan",label:"ATAN()",args:[o]},{value:"atanh",label:"ATANH()",args:[o]},{value:"average",label:"AVERAGE()",args:[n]},{value:"cos",label:"COS()",args:[o]},{value:"cosh",label:"COSH()",args:[o]},{value:"cot",label:"COT()",args:[o]},{value:"coth",label:"COTH()",args:[o]},{value:"csc",label:"CSC()",args:[o]},{value:"csch",label:"CSCH()",args:[o]},{value:"max",label:"MAX()",args:[n]},{value:"median",label:"MEDIAN()",args:[n]},{value:"min",label:"MIN()",args:[n]},{value:"mode",label:"MODE()",args:[n]},{value:"pi",label:"PI()"},{value:"sin",label:"SIN()",args:[o]},{value:"sinh",label:"SINH()",args:[o]},{value:"sqrt",label:"SQRT()",args:[o]},{value:"sqrtpi",label:"SQRTPI()"},{value:"sum",label:"SUM()",args:[n]},{value:"round",label:"ROUND()",args:[o]},{value:"rounddown",label:"ROUNDDOWN()",args:[o]},{value:"roundup",label:"ROUNDUP()",args:[o]}];if(e.builder){var b=s.component,p=[d,{label:"Function Name",id:"function",type:"picklist",picklistEntries:c,onChange:function(e){p.splice(2),R(this,p,e),b.rebuildProps()}}],y=[d,{label:"Range",id:"range",name:"range",type:"string"},{label:"Has Headers",id:"headers",type:"boolean"}],h=[d,{label:"Worksheet Name or ID",id:"worksheet",type:"text"},{label:"Chart Type",id:"charttype",type:"picklist",picklistEntries:[{value:"ColumnClustered",label:"Clustered Column"},{value:"ColumnStacked",label:"Stacked Column"},{value:"ColumnStacked100",label:"100% Stacked Column"},{value:"Line",label:"Line"},{value:"LineStacked",label:"Stacked Line"},{value:"LineStacked100",label:"100% Stacked Line"},{value:"LineMarkers",label:"Line with Markers"},{value:"LineMarkersStacked",label:"Stacked Line with Markers"},{value:"LineMarkersStacked100",label:"100% Stacked Line with Markers"},{value:"PieOfPie",label:"Pie"},{value:"Doughnut",label:"Doughnut"},{value:"BarClustered",label:"Clustered Bar"},{value:"BarStacked",label:"Stacked Bar"},{value:"BarStacked100",label:"100% Stacked Bar"},{value:"Area",label:"Area"},{value:"AreaStacked",label:"Stacked Area"},{value:"AreaStacked100",label:"100% Stacked Area"},{value:"XYScatter",label:"Scatter with only Markers"},{value:"XYScatterSmooth",label:"Scatter with Smooth Lines and Markers"},{value:"XYScatterSmoothNoMarkers",label:"Scatter with Smooth Lines"},{value:"XYScatterLines",label:"Scatter with Straight Lines and Markers"},{value:"XYScatterLinesNoMarkers",label:"Scatter with Straight Lines"},{value:"Radar",label:"Radar"},{value:"RadarFilled",label:"Filled Radar"},{value:"RadarMarkers",label:"Radar with Markers"}]},{label:"Source Data",id:"sourcedata",type:"text"},{label:"Chart Series By",id:"seriesby",type:"picklist",defaultValue:"Auto",picklistEntries:[{value:"Auto",label:"Auto"},{value:"Columns",label:"Columns"},{value:"Rows",label:"Rows"}]}];R(p[1],p,i.attr("function"))}function m(a,t){var r=a.attr("workbook");return r||e.$M(l.mergeAsDataInContext(a.attr("model"),t)).getFirstRow().id}return{function:{label:"Excel Function",builderProps:p||"",runtimeExecution:function(e,l,r,i){var s=t(),o={},n=m(e,r);return a.each(c,function(t,l){l.value===e.attr("function")&&l.args&&a.each(l.args,function(t,l){var r=e.attr(l.id);"number"===l.valueType?o[l.name]=r:"range"===l.valueType&&(o.values=[],-1!==r.indexOf(",")?a.each(r.split(","),function(e,a){a.match(/[a-z]/i)?o.values.push({address:a}):o.values.push(a)}):o.values.push({address:r}))})}),a.ajax({url:S+"/me/drive/items/"+n+"/workbook/functions/"+e.attr("function"),headers:{Authorization:"Bearer "+i.authentication.responseBody.access_token,"Content-Type":"application/json",Accept:"application/json"},method:"POST",dataType:"json",data:JSON.stringify(o),success:function(e){s.resolve({$Excel:e})},error:function(e){s.reject(e)}}),s.promise()}},"create-table":{label:"Create Excel Table",builderProps:y||"",runtimeExecution:function(e,l,r,i){var s=t(),o={address:e.attr("range"),hasHeaders:"true"===e.attr("headers")},n=m(e,r);return a.ajax({url:S+"/me/drive/items/"+n+"/workbook/tables/add",headers:{Authorization:"Bearer "+i.authentication.responseBody.access_token,"Content-Type":u,Accept:u},method:g,dataType:"json",data:JSON.stringify(o),success:function(e){s.resolve({$Excel:e})},error:function(e){s.reject(e)}}),s.promise()}},"create-chart":{label:"Create Chart",builderProps:h||"",runtimeExecution:function(e,l,r,i){var s=t(),o={type:e.attr("charttype"),sourceData:e.attr("sourcedata"),seriesBy:e.attr("seriesby")},n=m(e,r);return a.ajax({url:S+"/me/drive/items/"+n+"/workbook/worksheets('"+e.attr("worksheet")+"')/charts/add",headers:{Authorization:"Bearer "+i.authentication.responseBody.access_token,"Content-Type":u,Accept:u},method:g,dataType:"json",data:JSON.stringify(o),success:function(e){s.resolve({$Excel:e})},error:function(e){s.reject(e)}}),s.promise()}}}},getActions:i.getActionsStatic,getEntityList:i.getEntityListStatic,fieldRenderers:function(){return{DATE:{read:function(e){c(p).read(e,new Date(e.row._text[e.id]))},readonly:function(e){c(p).readonly(e,new Date(e.row._text[e.id]))},edit:function(e){c(p).edit(e,new Date(e.row._text[e.id]))}},DATETIME:{read:function(e){c(b).read(e,new Date(e.row._text[e.id]))},readonly:function(e){c(b).readonly(e,new Date(e.row._text[e.id]))},edit:function(e){c(b).edit(e,e.row._text[e.id])}},FORMULA:{read:function(e,a){c(v).read(e,a)},readonly:function(e,a){c(v).readonly(e,a)},edit:function(e){c(v).edit(e,e.row._formulas[e.id])}}}},extendedProperties:{composer:{unomittableFields:!0,hasEntityOptions:!0},validConditionTypes:["fieldvalue","multiple","param","boolean"],canFieldsBeIndividuallySearched:!0,canServerSearch:!0,"x-metadata":{Workbook:{idFields:["id"],nameField:"name",label:"Workbook",labelPlural:"Workbooks",fields:[{id:"id",label:"Id",displaytype:m,inlineHelpText:"Identifier of the drive.",accessible:!0,createable:!1,editable:!1,"x-alwaysinclude":!0},{id:"name",label:"Name",displaytype:m,inlineHelpText:"Name of the drive.",accessible:!0,createable:!1,editable:!0},{id:"createdByUserName",label:"Created By",displaytype:m,accessible:!0,createable:!1,editable:!1},{id:"createdDateTime",label:"Created Date Time",displaytype:b,accessible:!0,createable:!1,editable:!1},{id:"lastModifiedByUserName",label:"Last Modified By",displaytype:m,accessible:!0,createable:!1,editable:!1},{id:"lastModifiedDateTime",label:"Last Modified",displaytype:b,accessible:!0,createable:!1,editable:!1},{id:"webUrl",label:"Web Url",displaytype:m,accessible:!0,createable:!1,editable:!1},{id:"parentReference",label:"Parent Reference",displaytype:h,accessible:!1,createable:!1,editable:!1},{id:"size",label:"Size",displaytype:y,accessible:!0,createable:!1,editable:!1},{id:"parentDirectory",label:"Parent Directory",displaytype:m,accessible:!0,createable:!1,editable:!0},{id:"oneUp",label:"Directory Up",displaytype:m,accessible:!0,createable:!1,editable:!1}],methods:{query:{url:"",verb:k,contentType:u,pathToContent:""}},defaultConditions:[{sourcetype:"param",sourceparam:"parent",name:"parent",label:"Path to Folder or File",state:"filterableon",value:""}]},Worksheet:{idFields:["id"],nameField:"name",label:"Worksheet",labelPlural:"Worksheets",fields:[{id:"id",label:"Id",displaytype:m,inlineHelpText:"Identifier of the worksheet.",accessible:!0,createable:!1,editable:!1,"x-alwaysinclude":!0},{id:"name",label:"Name",displaytype:m,inlineHelpText:"Name of the worksheet.",accessible:!0,createable:!0,editable:!0,"x-alwaysinclude":!0},{id:"position",label:"Position",displaytype:y,inlineHelpText:"Position of the worksheet in the workbook.",accessible:!0,createable:!1,editable:!0,"x-alwaysinclude":!0},{id:"visibility",label:"Visibility",displaytype:m,inlineHelpText:"Whether the worksheet is visible.",accessible:!0,createable:!1,editable:!0,"x-alwaysinclude":!0}],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets",verb:k,contentType:u,pathToContent:"value"},insert:{url:"/me/drive/items/{{file}}/workbook/worksheets/add",verb:g,contentType:u,receiveDataAs:"recordinbody",successIf:"responsefieldequals",successField:"status",successValue:"Created"},update:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{id}}')",verb:w,contentType:u,receiveDataAs:"recordinbody",successIf:"responsefieldispresent"},delete:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{id}}')",verb:T,contentType:u,successIf:"responsefieldisempty"}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:!0,value:""}]},Range:{label:"Range",labelPlural:"Ranges",isRangeEntity:!0,fields:[],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/range(address='{{range}}')",verb:k,contentType:u,pathToContent:"values"},update:{url:"",verb:w,contentType:u,pathToContent:""}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:"Worksheet Name or ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"range",name:"range",label:"Cell Range",state:"filterableon",type:"fieldvalue",value:""},{sourcetype:"param",sourceparam:"hasHeader",name:"hasHeader",label:"Has Headers",state:"fixed",type:"boolean",required:!0,value:!1}]},Table:{idFields:["id"],nameField:"name",label:"Table",labelPlural:"Tables",fields:[{id:"id",label:"Id",displaytype:m,inlineHelpText:"Identifier of the table.",accessible:!0,createable:!1,editable:!1,"x-alwaysinclude":!0},{id:"name",label:"Name",displaytype:m,inlineHelpText:"Name of the table.",accessible:!0,createable:!0,editable:!0},{id:"highlightFirstColumn",label:"Highlight First Column",displaytype:f,accessible:!0,createable:!0,editable:!0},{id:"highlightLastColumn",label:"Highlight Last Column",displaytype:f,accessible:!0,createable:!0,editable:!0},{id:"showBandedColumns",label:"Show Banded Columns",displaytype:f,accessible:!0,createable:!0,editable:!0},{id:"showBandedRows",label:"Show Banded Rows",accessible:!0,createable:!0,editable:!0},{id:"showFilterButton",label:"Show Filter Button",accessible:!0,createable:!0,editable:!0},{id:"showHeaders",label:"Show Headers",accessible:!0,createable:!0,editable:!0},{id:"showTotals",label:"Show Totals",accessible:!0,createable:!0,editable:!0},{id:"style",label:"Table Style",accessible:!0,createable:!0,editable:!0}],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/tables",verb:k,contentType:u,pathToContent:"value"},update:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/tables('{{id}}')",verb:w,contentType:u}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:"Worksheet Name or ID",state:"filterableon",type:"fieldvalue",required:!0,value:""}]},TableRange:{label:"TableRange",labelPlural:"TableRanges",isRangeEntity:!0,fields:[],methods:{query:{url:"/me/drive/items/{{file}}/workbook/tables('{{table}}')/Range",verb:k,contentType:u,pathToContent:"values"},update:{url:"",verb:w,contentType:u,pathToContent:""}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:"Worksheet Name or ID",state:"filterableon",type:"fieldvalue",value:""},{sourcetype:"param",sourceparam:"table",name:"table",label:"Table Name or ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"hasHeader",name:"hasHeader",label:"Has Headers",state:"fixed",type:"boolean",required:!0,value:!0}]},Chart:{idFields:["id"],nameField:"name",label:"Chart",labelPlural:"Charts",fields:[{id:"id",label:"Id",displaytype:m,inlineHelpText:"Identifier of the chart.",accessible:!0,createable:!1,editable:!1,"x-alwaysinclude":!0},{id:"name",label:"Name",displaytype:m,inlineHelpText:"Name of the chart.",accessible:!0,createable:!0,editable:!0},{id:"height",label:"Height",displaytype:y,accessible:!0,createable:!1,editable:!1},{id:"width",label:"Width",displaytype:y,accessible:!0,createable:!1,editable:!1},{id:"top",label:"Top",displaytype:y,accessible:!0,createable:!1,editable:!1},{id:"left",label:"Left",displaytype:y,accessible:!0,createable:!1,editable:!1}],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/charts",verb:k,contentType:u,pathToContent:"value"},update:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/charts('{{name}}')",verb:w,contentTYpe:u},delete:{url:"/me/drive/items/{{file}}/workbook/charts('{{name}}')/delete",verb:g,contentType:u,successIf:"responsebodyisempty"}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:"Worksheet Name or ID",state:"filterableon",type:"fieldvalue",value:""}]}}}})}(skuid)}});