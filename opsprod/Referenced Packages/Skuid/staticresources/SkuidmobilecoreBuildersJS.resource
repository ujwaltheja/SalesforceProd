!function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=360)}({282:function(e,t,n){"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};!function(e){var t=e.$,n=e.builder,a=n.core,o=e.utils,r=e.constants.FIELD_TYPES,l=o.makeXMLDoc,s=n.listHelper={getSection:function(e,n){n=n||{};var i=t("<div>").addClass("nx-componentsection").css("width",n.width||"25%").append(t("<div>").addClass("nx-componentsection-header").text(n.label||"").append(t("<span>").addClass("nx-componentsection-header-actionicon sk-builder-icon sk-icon sk-icon-add").css({float:"right"}).skootip(n.tip||"").click(function(e){e.stopPropagation(),n.addItemFunction&&n.addItemFunction()}))),a=t("<div>").appendTo(i);return n.parentStateSelector&&a.sortableComponent({axis:"y",component:e,parentStateSelector:n.parentStateSelector}),{section:i,container:a}},viewBuilder:function(){return new a.Builder({id:"view",name:"View",hideWrapper:!0,componentRenderer:function(e){var n=e.state,i=n.attr("icon"),a=n.attr("type"),o=n.attr("label"),r=e.body;"photo"==a?(i||(i="sk-icon-photoview"),o||(o="Photo View")):"standard"==a?(i||(i="sk-icon-listview"),o||(o="Standard List View")):(i||(i="sk-icon-config"),o||(o="Custom View")),i&&r.prepend(t("<div>").addClass("sk-icon "+i+" nx-componentsection-icon")),r.append(t("<div>").addClass("nx-componentsection-body").text(o)),e.actionbar.addClass("nx-pagebuilder-actionbar-tag"),e.addActionItem("","sk-icon-delete",function(){e.remove()})},propertiesRenderer:function(e,t){e.setTitle("Table View Properties");var n,i,o,r=t.state,l={id:"type",type:"picklist",label:"View Type",defaultValue:"standard",picklistEntries:[{label:"Standard",value:"standard"},{label:"Photo",value:"photo"},{label:"Custom",value:"custom"}],onChange:function(){r.removeAttr("photofield descriptionfield onclickurl defaultphoto"),t.save(),t.rebuildProps().refresh()}},s=r.attr("type");"photo"===s?(o=r.parent().parent().attr("model"),(i=(i=[l]).concat(a.getImageProperties({component:t,modelName:o,propViewer:e,customFieldPropId:"photofield",filter:{needsRecordContext:!0,needsFieldContext:!0},additionalOnRefresh:function(){t.refresh()},additionalOnRebuildProps:function(){t.save().refresh()},additionalOnRebuildAndRefresh:function(){t.save().refresh()}}))).push({id:"descriptionfield",type:"field",label:"Label Field",modelname:o},{id:"onclickurl",type:"template",location:"attribute",displayAs:"input",label:"On-click URL",helptext:"The URL to redirect the user to when a photo is clicked. Can include template syntax, e.g. '/{{Model.KeyPrefix}}'"},{id:"defaultphoto",type:"picklist",label:"Default Photo",picklistEntries:[{label:"Person",value:"person"},{label:"Org",value:"org"}],onChange:function(){t.refresh()}}),n=[{id:"",props:i}]):n="custom"===s?[{id:"",props:[l,{id:"label",type:"string",label:"View Label",onChange:function(){t.save().refresh()}},{id:"icon",type:"icon",label:"View Icon",defaultValue:"sk-icon-config",onChange:function(){t.save().refresh()}},{id:"viewsnippet",type:"string",label:"View Snippet",helptext:'A Snippet that returns an object that defines the View. At minimum, it must contain a "render(item)" method.'}]}]:[{id:"",props:[l]}],e.applyPropsWithCategories(n,r)},defaultStateGenerator:function(){return l('<view type="standard" />')}})},actionBuilder:function(i,r){var d=i.state,u=d.attr("model"),c=i.builder;return r=t.extend(!0,{componentLabel:c&&c.name||""},r),new a.Builder({id:"action",name:"Action",hideWrapper:!0,componentRenderer:function(n){var o=n.state,r=o.attr("label"),l=o.attr("icon"),c=o.attr("type"),p=n.body;if(!r)if("createrow"==c){var h;if(u){var f,m=a.getModelFromModelName(u),b=e.dataSource.getDataSource(m.attr("datasource")||m.attr("service")||"salesforce");m&&(f=m.attr("sobject"))&&(f=b.getCachedEntityMetadata(f))&&(h=f.getLabel())}h||(h="(Object)"),r=e.label.merge(e.$L("add_new"),h)}else r=e.$L({massupdate:"mass_update_selected_rows",massedit:"toggle_edit_mode_on_selected_rows",massdelete:"toggle_selected_rows_for_deletion",edit:"edit_rows_action",delete:"flag_for_delete_action",multi:"Run Multiple Actions"}[c]||"action");if(!l)switch(c){case"massedit":l="sk-icon-edit";break;case"edit":l="sk-icon-edit edit-action";break;case"massdelete":l="sk-icon-delete";break;case"delete":l="sk-icon-delete delete-action";break;case"massupdate":l="sk-icon-table-edit";break;case"createrow":l="sk-icon-add";break;default:l="sk-icon-magic"}l&&p.prepend(e.ui.createIcon(l,{additionalClass:"nx-componentsection-icon"})),p.append(t("<div>").addClass("nx-componentsection-body").text(r)),n.actionbar.addClass("nx-pagebuilder-actionbar-tag"),n.addActionItem("","sk-icon-delete",function(){var e=o.parent(),t=o.siblings();n.remove(),i.buildRowActionsPreview&&i.buildRowActionsPreview(),0===t.length&&(i.handleOptionChange(),e.is("massactions")?i.massActionsBtn.hide():e.is("actions")&&i.globalActionsBtn.hide())}),p.off("dblclick").on("dblclick",function(e){s.actionOnClickHandler({action:n,state:o,event:e,getModelName:function(){return d.attr("model")}})})},propertiesRenderer:function(e,s){e.setTitle(r.componentLabel+" Action Properties");var d,u=i.state.attr("model"),c=s.state,p=c.parent(),h=p.is("rowactions"),f=p.is("massactions"),m={id:"type",type:"picklist",label:"Action Type",defaultValue:"multi",picklistEntries:[{label:"Run Multiple Actions",value:"multi"},{label:"Redirect to URL",value:"redirect"}],onChange:function(e,n){var r=c.children("actions");if("multi"===e&&!r.length){var d,u=l("<actions/>");"redirect"===n?d=l('<action type="redirect"/>').attr({url:c.attr("url"),window:c.attr("window")}):"custom"===n?d=l('<action type="custom"/>').attr({snippet:c.attr("snippet")}):"popup"===n?d=l('<action type="showPopup"/>').append(c.children("popup")):"drawer"===n&&(d=l('<action type="drawer"/>').append(c.children("drawer"))),d&&(d.appendTo(u),u.appendTo(c))}if("multi"===n&&r.length&&r.remove(),"redirect"!==e&&c.removeAttr("url window"),-1!==t.inArray(e,["massedit","massupdate","massdelete","edit","delete","createrow"])&&c.removeAttr("label icon"),"popup"===e&&!c.children("popup").length&&h){c.attr({icon:"sk-icon-popup",label:"View record details"});var p=l('<popup width="80%"/>'),m=l("<components/>").appendTo(p),b=c.closest("skootable").attr("model"),v=a.getModelFromModelName(b);if(v){var g=l('<basicfieldeditor showheader="true" showsavecancel="true" mode="edit"/>'),y=l("<conditions/>").appendTo(g),C=l("<columns/>").appendTo(g),w=l('<column width="50%"/>').appendTo(C),S=l('<column width="50%"/>').appendTo(C),k=l("<sections/>").appendTo(w),P=l("<sections/>").appendTo(S),x=l('<section title="Section A"/>').appendTo(k),F=l('<section title="Section B"/>').appendTo(P),T=l("<fields/>").appendTo(x),N=l("<fields/>").appendTo(F),A=v.children("fields").first().children(":not([id*=\\.])"),E=A.length%2+2;l('<condition type="contextrow'+(f?"s":"")+'" field="Id" mergefield="Id" autocreated="true"/>').appendTo(y),g.attr({model:b}),t.each(A,function(e,n){l("<field/>").attr("id",t(n).attr("id")).appendTo(e>E?N:T)}),p.attr("title","Viewing {{Model.label}}: {{"+o.getNameField(v.attr("sobject"))+"}}"),m.append(g)}else p.attr("title","New Popup");p.appendTo(c)}s.save(),s.rebuildProps().refresh(),i.buildRowActionsPreview&&i.buildRowActionsPreview()}},b=m.picklistEntries;if(function(e,t){if("createrow"!==e.attr("type"))return;var n=l("<actions/>"),i=l("<action/>");e.attr("type","multi"),e.attr("icon")||e.attr("icon","sk-icon-add");i.attr({type:"createRow",model:t,appendorprepend:e.attr("appendorprepend"),defaultmodefornewitems:"edit"}),n.append(l("<defaults/>"),i),e.removeAttr("appendorprepend"),e.append(n)}(c,u),d=c.attr("type"),f&&(s.givesMultipleContextRows=!0),"readonly"!==i.state.attr("mode")&&(p.is("massactions")?b.push({label:"Mass Update",value:"massupdate"},{label:"Mass Edit",value:"massedit"},{label:"Mass Delete",value:"massdelete"}):h&&b.push({label:"Edit Record",value:"edit"},{label:"Delete Record",value:"delete"})),h&&b.push({label:"Drawer",value:"drawer"}),b.push({label:"Pop Up",value:"popup"},{label:"Custom",value:"custom"}),r.permittedMassActions&&r.permittedMassActions.length){var v=[];t.each(b,function(e,t){r.permittedMassActions.indexOf(t.value)>-1&&v.push(t)}),b=v,m.picklistEntries=v}var g={id:"label",type:"string",label:"Action Label",onChange:function(){s.refresh()}},y={id:"icon",type:"icon",label:"Action Icon",defaultValue:"createrow"==s.state.attr("type")?"sk-icon-add":"",onChange:function(){s.refresh(),i.buildRowActionsPreview()}},C={parentComponent:s,getContextModelName:function(){return i.state.attr("model")}},w=[{name:"Basic",props:{redirect:[m,g,y,{id:"url",type:"template",displayAs:"input",location:"attribute",label:"URL",helptext:"The URL to redirect the user to when this Action is selected. Can include template syntax, e.g. '/{{Model.KeyPrefix}}'"},{id:"window",type:"picklist",label:"Open URL in",defaultValue:"self",picklistEntries:[{label:"Current window",value:"self"},{label:"Blank window",value:"blank"},{label:"Parent window",value:"parent"}]}],createrow:[m,{id:"appendorprepend",type:"picklist",label:"Place row...",defaultValue:"prepend",picklistEntries:[{label:"At start of table",value:"prepend"},{label:"At end of table",value:"append"}]},y,g],custom:[m,g,y,{id:"snippet",type:"string",label:"Snippet Name"}],popup:[m,g,y,{type:"customaction",label:"Configure Popup",icon:"sk-bi-popup",mode:"edit",customAction:function(){n.showPopupBuilder({parentComponent:s,getContextModelName:function(){return i.state.attr("model")},useAfterCloseActions:!0})}}],drawer:[m,g,y].concat(n.getDrawerProps(C)),massupdate:[m,y],massedit:[m,y],massdelete:[m,y],edit:[m,y],delete:[m,y],multi:[m,g,y]}[d]||[m]}];if("multi"===d){var S=[];"skootable"===i.state[0].tagName&&S.push(n.getDrawerActionOption(C)),w.push(a.getActionsCategory({useModelName:u,linkedComponent:s,additionalActionOptions:S}))}h||w.push(a.getHotkeysCategory({linkedComponent:s})),w.push(a.getRenderingCategory({component:s,model:h?u:null,propViewer:e})),e.applyPropsWithCategories(w,c)},defaultStateGenerator:function(e){return l("custom"==e?'<action type="custom" label="New Custom Mass Action" icon="sk-icon-magic"/>':"multi"==e?'<action type="multi" label="Run multiple actions" icon="sk-icon-magic"/>':'<action type="redirect" label="Go to Home Page" url="/home/home.jsp" icon="sk-icon-magic"/>')}})},actionOnClickHandler:function(e){var i=e.action,o=e.event,r=e.getModelName,l="dblclick"===o.type,s=e.state||i.data("state"),d=s.attr("type"),u=a.getComponentFromState(s),c=n.desktop;if(l&&c){var p={parentComponent:u,getContextModelName:r},h=function(e){return t.extend({},e,{useAfterCloseActions:!0})};if("drawer"===d)c.showDrawerBuilder(p);else if("popup"===d)c.showPopupBuilder(h(p));else if("multi"===d){var f=s.children("actions").children();f.length&&t.each(f,function(){var e=t(this),n=e.attr("type");if("showPopup"===n||"drawer"===n)return p.parentComponent=a.getComponentFromState(e),p.parentState=e,"drawer"===n?c.showDrawerBuilder(p):c.showPopupBuilder(h(p)),!1})}}else u&&u.select();o.stopPropagation()},interactionBuilder:function(e){var i=e.state;return new a.Builder({id:"interaction",name:"Interactions",hideWrapper:!0,componentRenderer:function(n){var a=n.state,o=a.attr("type"),r=a.attr("icon"),l=n.body,d={tap:"Click",swipe:"Swipe",swiperight:"Swipe Right",swipeleft:"Swipe Left",press:"Press"}[o];switch(o){case"tap":r="sk-icon-delete delete-action";break;case"swipe":r="sk-icon-edit";break;case"swiperight":r="sk-icon-edit edit-action";break;case"swipeleft":r="sk-icon-delete";break;case"press":r="sk-icon-table-edit";break;default:r="sk-icon-magic"}r&&l.prepend(t("<div>").addClass("sk-icon "+r+" nx-componentsection-icon")),l.append(t("<div>").addClass("nx-componentsection-body").text(d)),n.addActionItem("","sk-icon-delete",function(){var t=a.parent(),i=a.siblings();n.remove(),e.buildRowActionsPreview&&e.buildRowActionsPreview(),0===i.length&&(e.handleOptionChange(),t.is("massactions")?e.massActionsBtn.hide():t.is("actions")&&e.globalActionsBtn.hide())}),l.off("dblclick").on("dblclick",function(e){s.actionOnClickHandler({action:n,state:a,event:e,getModelName:function(){return i.attr("model")}})})},propertiesRenderer:function(e,t){e.setTitle("Interactions"),e.applyPropsWithCategories([{name:"Interaction",tree:a.getInteractionTree({linkedComponent:t,isChild:!1,refreshLinkedComponent:!0,deleteable:!1,useModelName:i.attr("model")})}],t.state)},defaultStateGenerator:function(){return l('<interaction type="press" direction="either"><action type="showPopup"><models/><popup title="{{Model.label}}: {{Name}}" width="80%"><components/></popup></action></interaction>')},actionOnClickHandler:function(e){var i=e.action,o=e.event,r=e.getModelName,l="dblclick"===o.type,s=e.state||i.data("state"),d=s.attr("type"),u=a.getComponentFromState(s),c=n.desktop;if(l&&c){var p={parentComponent:u,getContextModelName:r},h=function(e){return t.extend({},e,{useAfterCloseActions:!0})};if("drawer"===d)c.showDrawerBuilder(p);else if("popup"===d)c.showPopupBuilder(h(p));else if("multi"===d){var f=s.children("actions").children();f.length&&t.each(f,function(){var e=t(this),n=e.attr("type");if("showPopup"===n||"drawer"===n)return p.parentComponent=a.getComponentFromState(e),p.parentState=e,"drawer"===n?c.showDrawerBuilder(p):c.showPopupBuilder(h(p)),!1})}}else u&&u.select();o.stopPropagation()}})},fieldBuilder:function(n,i){return i=t.extend({useUniqueId:!0,hideable:!1},i),new a.Builder({id:"field",name:"Field",icon:"sk-bi-field",personalizationSettings:{setUniqueId:!1},componentRenderer:function(i){i.element.addClass("nx-pagebuilder-field nx-table-fieldwrapper").attr("data-model",n.state.attr("model")).addClass("nx-pagebuilder-table-field");var o,l,s,d,u,c,p,h=n.state.attr("model"),f=i.state.attr("id"),m=i.state.attr("type"),b=i.state.attr("name");m===r.COMBO||m===r.IMAGE?(l=i.state.children("label").length?i.state.children("label").text():"",s=t("<div>").append(l).addClass("nx-field-label"),i.body.append(s),d=t("<div>").append(m===r.COMBO?"TEMPLATE":r.IMAGE).addClass("nx-field-displaytype"),i.body.append(d)):(u=a.getFieldInfoFromCache(h,f),b&&(o=a.getModelFromModelName(h))&&(p=o.children("fields").first().children('[name="'+e.utils.escapeSelector(b)+'"]').first())&&(c=p.attr("function")),l=i.state.children("label").length?i.state.children("label").text():c?c.toUpperCase()+"("+f+")":u?u.label:"Unknown Field",s=t("<div>").append(l).addClass("nx-field-label"),i.body.append(s),d=t("<div>").append(u&&u.displaytype?u.displaytype:f).addClass("nx-field-displaytype"),i.body.append(d)),i.addActionItem("","sk-icon-delete",function(){i.remove()})},propertiesRenderer:function(e,t){e.setTitle("Field Properties");var i=a.getFieldProperties(t,n.state.attr("model"),n.builderId);e.applyPropsWithCategories(i,t.state)},defaultStateGenerator:function(e){var t,n=l("<field/>");if(e)if(e.fieldId&&n.attr("id",e.fieldId),e.fieldName&&n.attr("name",e.fieldName),"template"===e.componentId||e.isChildRelationship){(t=a.getBuilder("template").defaultStateGenerator()).removeAttr("model multiple");var r=e.relationshipName;r&&(r=a.prettyPrintAPIName(r)),n.prepend(l("<label/>").text(r||"Template Field")),e.isChildRelationship?(n.attr("type","CHILDREL").append(t),n.attr("limit","100")):n.attr("type","COMBO").append(t)}else"image"===e.componentId&&n.prepend(l("<label/>").text("Image")).attr("type","IMAGE");return i.hideable&&n.attr("hideable",!0),i.useUniqueId&&n.attr("uniqueid",o.generateUniqueId({prefix:"fi"})),i.showLengthCounter&&"TEXTAREA"===e.fieldDisplayType&&n.attr("showlengthcounter",i.showLengthCounter),n},hideWrapper:!0,dragHandle:".nx-pagebuilder-component"})},massActionsButtonBuilder:function(e){return d(e,"mass")},globalActionsButtonBuilder:function(e){return d(e,"global")},exportPropertiesBuilder:function(){return new a.Builder({id:"exportproperties",name:"Export Properties",componentRenderer:function(e){e.body.append(t("<div>").addClass("sk-icon sk-icon-export nx-componentsection-icon"),t("<div>").addClass("nx-componentsection-body").text("Export Options"))},propertiesRenderer:function(e,t){e.setTitle("Export Properties");var n=t.state,i=n.closest("skootable").attr("model"),o="true"===n.attr("usetablecolumns"),r=[{id:"usetablecolumns",label:"Use Table Columns as Export Columns",helptext:"If this is unchecked, you can specify which fields are exported.",type:"boolean",onChange:function(){t.rebuildProps()}}],s=[{label:"Export Options",icon:"sk-icon-export",linkedComponent:t,deleteable:!1,props:r}];o&&r.push({id:"appendrowidcolumn",label:"Append Row Id Column",helptext:"By default, Skuid export will append a column containing the Id of each exported row. Uncheck to prevent this column from being added.",defaultValue:!0,type:"boolean"}),r.push({id:"loadallrecords",label:"Attempt to Load in All Records Before Export",helptext:"If this is checked, Skuid will attempt to load in the full dataset before performing the export. (Max 10,000 Records)",type:"boolean"},{id:"filename",label:"Custom File Name",helptext:"A custom name to use for the exported file. Can contain template fields. If blank, an auto-generated file name will be used.",type:"string"}),"true"!==n.attr("usetablecolumns")&&s.push({id:"columns",label:"Export Columns",icon:"sk-bi-fields",linkedComponent:t,deleteable:!1,isChild:!0,children:[{id:"column",indent:1,addtooltip:"Add New Column",labelFunction:function(e){var t,n,o,r,l=e.attr("type");if("field"===l)e.attr("field")&&(t=a.getFieldInfoFromCache(i,e.attr("field")))?(r=t.id,o="fieldlabel"===(n=e.attr("headertype"))?t.label:"apiname"===n?t.id:e.children("label").first().text()):r="[No Field Selected]";else{if("template"!==l)return"";r=e.children("template").first().text(),o=e.children("label").first().text()}return(r||"")+(o?" ("+o+")":"")},defaultStateFunction:function(){return l('<column type="field" headertype="fieldlabel"/>')},propsFunction:function(e){var t=[],n=e.state,a={id:"type",label:"Column Type",type:"picklist",picklistEntries:[{label:"Field",value:"field"},{label:"Template",value:"template"}],onChange:function(){e.refresh().rebuildProps()}};t.push(a);var o={id:"field",type:"field",label:"Field",modelname:i,addFieldToModel:!0,onChange:function(){e.refresh()}},r={id:"template",type:"template",label:"Template",displayAs:"input",onChange:function(){e.refresh()}},l={id:"headertype",label:"Header Type",type:"picklist",picklistEntries:[{label:"Use Field Label",value:"fieldlabel"},{label:"Use Field API Name",value:"apiname"},{label:"Custom Label",value:"custom"}],onChange:function(){e.refresh().rebuildProps()}},s={id:"label",type:"template",label:"Label",displayAs:"input",onChange:function(){e.refresh()}};return"field"===n.attr("type")?(t.push(o,l),"custom"===n.attr("headertype")&&t.push(s)):"template"===n.attr("type")&&t.push(r,s),t}}]});var d=[{name:"Basic",tree:s}];e.applyPropsWithCategories(d,n)},hideWrapper:!0,defaultStateGenerator:function(){return l('<exportproperties usetablecolumns="true"/>')}})},addFeatureActions:function(e,t){var n,i,o,r,d,u=e.state,c={};return(t=t||{}).views&&t.viewsContainer&&(n=s.viewBuilder(),c.addView=function(){u.children("views").length||(u.append(l("<views />")),e.save());var i,o=n.getDefaultState();u.children("views").first().append(o),i=a.componentFactory(o,n),e.save(),t.viewsContainer.append(i.element),i.select(),e.buildRowActionsPreview&&e.buildRowActionsPreview(),e.handleOptionChange&&e.handleOptionChange()}),t.massActions&&t.massActionsContainer&&(i=s.massActionsButtonBuilder(e),r=s.actionBuilder(e,t),c.addMassAction=function(){if(0===u.children("massactions").length){var n=i.defaultStateGenerator();u.append(n);var o=a.componentFactory(n,i);e.massActionsBtn=o.element,e.globalAndMassWrapper.append(o.element),e.save()}else e.massActionsBtn.is(":hidden")&&e.massActionsBtn.show();var l,s=r.getDefaultState("multi");u.children("massactions").append(s),l=a.componentFactory(s,r),e.save(),t.massActionsContainer.append(l.element),l.select()}),t.globalActions&&t.globalActionsContainer&&(o=o||s.globalActionsButtonBuilder(e),r=r||s.actionBuilder(e,t),c.addGlobalAction=function(){if(0===u.children("actions").length){var n=o.defaultStateGenerator();u.append(n);var i=a.componentFactory(n,o);e.globalActionsBtn=i.element,e.globalAndMassWrapper.append(i.element),e.save()}else e.globalActionsBtn.is(":hidden")&&e.globalActionsBtn.show();var l=r.getDefaultState("multi");u.children("actions").append(l);var s=a.componentFactory(l,r);e.save(),t.globalActionsContainer.append(s.element),s.select()}),t.rowActions&&t.rowActionsContainer&&(r=r||s.actionBuilder(e,t),c.addRowAction=function(){0===e.state.children("rowactions").length&&(e.state.append(l("<rowactions/>")),e.save());var n=r.getDefaultState("multi");e.state.children("rowactions").first().append(n);var i=a.componentFactory(n,r);e.save(),t.rowActionsContainer.append(i.element),i.select(),e.buildRowActionsPreview(),e.handleOptionChange()}),t.interactions&&t.interactionsContainer&&(d=d||s.interactionBuilder(e,t),c.addInteraction=function(){0===e.state.children("interactions").length&&(e.state.append(l("<interactions/>")),e.save());var n=d.getDefaultState();e.state.children("interactions").first().append(n);var i=a.componentFactory(n,d);e.save(),t.interactionsContainer.append(i.element),i.select(),e.handleOptionChange()}),t.filters&&(c.addFilter=function(){0===u.children("filters").length&&(u.append(l("<filters/>")),e.save());var n=a.getBuilder("filter"),i=n.getDefaultState();u.children("filters").first().append(i);var o=a.componentFactory(i,n);o.element.css("display","inline-block"),e.save(),e.filterWrapper.append(o.element),t.filterSetFocus||o.select(),e.handleOptionChange()}),c},propertiesFactory:{pageSize:function(e){return i({id:"pagesize",type:"picklist",label:"Visible Rows",defaultValue:"10",picklistEntries:[{label:"5",value:"5"},{label:"10",value:"10"},{label:"25",value:"25"},{label:"50",value:"50"},{label:"100",value:"100"},{label:"200",value:"200"},{label:"Show All",value:"all"}],onChange:function(){}},e)},alwaysResetPagination:function(e){return i({id:"alwaysresetpagination",type:"boolean",label:"Always reset pagination after save or query.",defaultValue:!1,onChange:function(){}},e)}}};function d(e,i){var o,r;return"global"===i?(o="Global Actions",r="actions"):(o="Mass Actions",r="massactions"),new a.Builder({id:"actions",name:o,hideWrapper:!0,mode:e.mode,componentRenderer:function(e){o=e.state.attr("defaultlabel")||o,e.element.css({display:"inline-block",margin:"1px 6px 8px 0px"}),e.body.css("padding","0px");var n=t("<div>").css("margin","0px").addClass("nx-actionselect nx-actionbutton"),a=e.state.attr("defaulticon");if(t("<div>").addClass("nx-actionselect-text").text(o).appendTo(n),a&&"true"===e.state.attr("usefirstitemasdefault")){var r=t("<div>").addClass("nx-actionselect-icon sk-icon inline "+a).css("margin","2px 0 0 8px");n.prepend(r)}n.appendTo(e.body),"mass"!==i&&"true"===e.state.attr("usefirstitemasdefault")&&r&&r.hide()},propertiesRenderer:function(e,t){e.setTitle(o+" Properties");var r=t.state,l={id:"usefirstitemasdefault",type:"boolean",label:"Use First Item as Default Selection",defaultValue:!0,onChange:function(){t.rebuildProps().refresh()}},s={id:"defaultlabel",type:"string",label:"Button Label",defaultValue:r.attr("defaultlabel")||o,onChange:function(){t.refresh()}},d={id:"defaulticon",type:"icon",label:"Button Icon",defaultValue:"sk-icon-magic",onChange:function(){t.refresh()}},u=[];"global"===i&&u.push(l),"false"===r.attr("usefirstitemasdefault")&&"global"===i&&u.push(s,d),u.push(a.coreProps.uniqueIdProp({component:t}),n.cssClassProp),e.applyProps(u,r,{mode:e.mode})},defaultStateGenerator:function(){return l("<"+r+"/>").attr({defaultlabel:o,defaulticon:"sk-icon-magic",usefirstitemasdefault:"true"})}})}}(skuid)},283:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.constants,i=e.utils,a=i.makeXMLDoc,o=e.actionSequences,r=i.rfc4122v4GUID,l="<div>",s=e.builder,d=s.core,u=e.platform.hasFeature("Voice"),c=u&&d.voiceCommands||{},p="newActionSequence",h=["Action Sequences allow you to create reusable, named sequences of Actions ","which can be run in response to user interactions or Model events."].join(""),f=n.EVENT_SCOPES,m=n.ACTION_SEQUENCE_TYPES,b=i.mergeArrays;function v(e){return!e||e===m.REUSABLE}function g(){s.getBuilder("actionsequences").component.refresh()}function y(e){d.getPageXML().children("resources").children("actionsequences").append(e)}function C(t){var a=t.linkedComponent,o=t.onChange,r=a.state,l=r.attr("type")||m.REUSABLE,s={type:"template",id:"description",noFieldSelector:!0,label:"Description",helptext:"A description of this Sequence's purpose, which will be used elsewhere in the Page Composer when referencing this Sequence.",state:r},p={type:"string",id:"label",label:"Sequence Name"+(v(l)?"":" (optional)"),helptext:"A friendly label for this Sequence, used by the Composer when displaying lists of Action Sequences.",onChange:function(e,t){o&&o(e,t),g()},state:r},h=[{value:m.REUSABLE,label:"Reusable Action Sequence"},{value:m.EVENT_TRIGGERED,label:"Event-triggered Sequence"}];u&&e.voiceCommands.voiceIsConfigurableForOrg()&&h.push({value:m.VOICE_COMMAND,label:"Voice-triggered sequence"});var y=[{type:"picklist",id:"type",label:"Type",defaultValue:m.REUSABLE,helptext:'Reusable Sequences can be invoked from any context using the "Run Action Sequence" Action Type. Other Sequence Types will only be invoked when a particular type of trigger occurs, such as an Event being published.',onChange:function(e,t){o&&o(e,t),a.rebuildProps(),g()},picklistEntries:h,state:r},p];l===m.EVENT_TRIGGERED?b(y,function(t,a){var o=t.state,r=e.events.get(o.attr("event-name")),l=r&&r.metadata&&r.metadata.onlyGlobal,s=[{value:f.SKUID,label:"All active pages"},{value:f.COMPONENT,label:"Only this page"}],u={value:f.GLOBAL,label:"All active pages and Lightning Components"},c=i.inPlatform([n.LIGHTNING,n.VISUALFORCE]);c&&(l?s=[u]:s.unshift(u));!c&&l&&(s=[]);var p=[{id:"event-name",type:"combobox",label:"Event Name",helptext:'The name of an Event to subscribe to, e.g. "page.rendered", "order.created". When this event is published, this Action Sequence will be run.',entries:d.getSubscribableEventEntries(),onChange:function(n,i){var o=e.events.get(n);o&&o.getScope&&o.getScope()===f.GLOBAL?t.state.attr("event-scope",f.GLOBAL):t.state.attr("event-scope",f.COMPONENT),t.save().rebuildProps(),a&&a(n,i),g()},state:o}];s.length&&p.push({id:"event-scope",type:"picklist",label:"Listen for Events published from",helptext:"By default, only events published within this Page will invoke this Action Sequence. However, you can also listen for events published within other Skuid Pages "+(c?", or external Lightning Components, ":"")+"to facilitate communication between this Page and other contexts.",defaultValue:l?f.GLOBAL:f.COMPONENT,picklistEntries:s,state:o});return p.push({id:"event-channel",type:"template",displayAs:"input",label:"Event Channel",location:"attribute",helptext:'(Optional) A channel on which to listen for this event. If specified, this Action Sequence will only be run when the given event is published on this channel. For example, if channel is "acme" and event is "order.created", this Action Sequence will NOT be run if someone publishes the "order.created" event without also specifying the "acme" channel',state:o}),p}(a,o)):u&&l===m.VOICE_COMMAND?b(y,c.getVoiceTriggeredSequenceProperties(a,o)):y.push(s);var C=[d.getActionsCategory({linkedComponent:a,props:y})];return v(l)||l===m.EVENT_TRIGGERED?b(C,F(a)):l===m.VOICE_COMMAND&&b(C,c.getVoiceTriggeredCategories(a)),C}function w(){var e=[d.getPageXML()],t=d.getMasterPageXML();return t&&e.push(t),e}function S(e){return o.getSequenceXMLFromId(e,w())}function k(){return o.getAllActionSequencesFromPages(w())}function P(){return{id:r(),label:function(e){for(var t=e||"New Sequence",n=t,i=0;S(n);)n=t+ ++i;return n}()}}function x(e){var t,n=e.state,i=n.attr("label"),a=n.attr("type")||m.REUSABLE;return a===m.REUSABLE?i||function(e){return e.state.attr("id")}(e):a===m.EVENT_TRIGGERED?"(Event: "+((t=n.attr("event-name"))?'"'+d.getEventLabelByName(t)+'"':"Not specified")+")"+(i?" "+i:""):a===m.VOICE_COMMAND?c.getActionSequenceLabel(n,i):void 0}function F(e,n){var i=e;return[{name:"Inputs",tree:{id:"inputs",label:"Inputs",addtooltip:"Add Input",deleteable:!1,icon:"sk-icon-component-pack",isChild:!0,linkedComponent:e,props:(n=n||{}).topLevelProps||[],refreshLinkedComponent:!1,childrenFunction:function(e){return[{id:"input",deletetooltip:"Remove Input",deleteable:!n.staticInputs,addable:!n.staticInputs,refreshLinkedComponent:!1,linkedComponent:i,indent:0,icon:function(){return"fa-cog"},labelFunction:function(e){return(e.attr("name")||"New Input")+": "+(e.attr("type")||"value")},defaultStateFunction:function(){return a('<input type="value" name=""/>')},propsFunction:function(a){var o=a.state.attr("type"),r=[{id:"name",label:"Name",type:"string",readonly:n.staticInputs||!1,onChange:function(){e.refresh()}},{id:"type",label:"Type",type:"picklist",picklistEntries:[{value:"value",label:"Value"},{value:"model",label:"Model"},{value:"model-field",label:"Model Field"},{value:"model-condition",label:"Model Condition"}],onChange:function(){a.save(),a.refresh().rebuildProps()}}];return"model-field"!==o&&"model-condition"!==o||r.push({id:"model-source",label:"Input Model Source",type:"picklist",picklistEntries:function(){var e=T(i.state),n=[];return t.each(e,function(e,t){var i=t.attr("name");n.push({label:i,value:i})}),n}}),r}}]}}}]}function T(e){return t.map(N(e),function(e){if("model"===e.attr("type"))return e})}function N(e){if(e){var n=e.children("inputs").children();return t.map(n,function(e){return t(e)})}}var A=new d.Builder({id:"actionsequence",name:"Action Sequence",componentRenderer:function(e){var n=x(e);e.actionbar.addClass("nx-pagebuilder-actionbar-tag"),e.element.data("component",e),e.tagText=n,e.body.addClass("nx-pagebuilder-resourcewrapper").css("padding","0").append(t(l).addClass("nx-pagebuilder-resourcetag").append(t(l).addClass("sk-icon fa-cogs").css("float","left"),t(l).text(n).css({"margin-left":"24px","margin-top":"1px"}))),e.addActionItem("","sk-bi-label-delete",function(){e.remove()}).addActionItem("Clone","fa-code-fork",function(){!function(e,n){var a=n.attr("label"),o=n.clone().attr({id:r(),label:a+" (clone)"});t.each(o.find("[uniqueid]"),function(e,n){t(n).attr("uniqueid",i.generateUniqueId())}),y(o),e.save(),g()}(e,e.state)})},propertiesRenderer:function(e,t){var n=C({onChange:function(){t.refresh(),e.setTitle("Sequence - "+x(t))},propertiesObj:e,linkedComponent:t});e.applyPropsWithCategories(n,t.state),e.setTitle("Sequence - "+x(t))},defaultStateGenerator:function(e){var t=P(),n=e||t.label;return a('<actionsequence id="'+t.id+'" label="'+n+'"><description/></actionsequence>')},hideWrapper:!0});function E(e){if(!e)return e;return 0!==e.indexOf("{{$Input.")?e:e.substring("{{$Input.".length,e.length-2)}d.registerBuilder(new d.Builder({id:"actionsequences",name:"Action Sequences",componentRenderer:function(e){var n=e.childItems=e.body,i=d.masterPageXML&&d.masterPageXML.children("resources");i&&i.children("actionsequences").children("actionsequence").each(function(){var e=d.componentFactory(t(this),A);n.append(e.element)}),e.state.children().each(function(){var e=d.componentFactory(t(this),A);n.append(e.element)}),e.childItems.sortableComponent({axis:"y",component:e,placeholder:"sk-placeholder",items:"> :not(.nx-pagebuilder-component-readonly)"}),this.component=e},propertiesRenderer:function(e){var n=this;!function(e,n,i){t("#toolbarWrapper .nx-pagebuilder-toolbarpanel-headertext .nx-pagebuilder-component-headerbuttons").remove();var a=t(l).addClass("nx-pagebuilder-component-headerbuttons").css({float:"right",cursor:"pointer"}),o=t("<span>").addClass("nx-pagebuilder-component-actionicon sk-icon");o.addClass(e),a.on("click",function(){i()}),a.append(o),""!==n&&a.skootip(n),t("#toolbarWrapper .nx-pagebuilder-toolbarpanel-headertext").append(a)}("sk-icon-add","Add Action Sequence",function(){var e=A.getDefaultState(),t=n.component;t.state.append(e);var a=d.componentFactory(e,A);t.body.append(a.element),i.scrollTo(a.element,0),t.save(),a.select()}),e.setTitle("Action Sequences"),e.body.empty().append(t(l).addClass("nx-pagebuilder-infotext").html(h))},hideWrapper:!0})),d.registerBuilder(A),d.actionSequences={appendActionSequenceActionProps:function(e,n,o){var r,l,s=k(),u=n.state,c=u.attr("action-sequence-id"),p=s.filter(function(e){return v(e.attr("type"))}).map(function(e){var t=e.attr("id");return{label:e.attr("label")||t,value:t}});c||(c=p.length&&p[0].value||"",u.attr("action-sequence-id",c)),l=N(r=d.actionSequences.getSequenceXMLFromId(c)),s?(e.push({id:"action-sequence-id",label:"Action Sequence",type:"picklist",picklistEntries:p,onChange:function(e,t){n.refresh(),t&&n.rebuildProps()}}),l&&b(e,t.map(l,function(e){return function(e,n){var i=n.state,o=e.attr("type")||"text",r=e.attr("name"),l=i.children("inputs"),s=l.children(),u={id:"input-"+r,label:r,isStateless:!0,onChange:function(e,d){var u;if((l=i.children("inputs")).length||(l=a("<inputs/>").appendTo(i)),s=l.children(),t.each(s,function(e,n){if((n=t(n)).attr("name")===r)return u=n,-1}),!e&&!1!==e&&0!==e)return u&&u.remove(),void n.save();u||(u=a("<input/>").attr({name:r})).appendTo(l),u.attr("value",e),n.save(),"model"===o&&!1===d&&n&&n.refresh().rebuildProps()},valueFunction:function(){for(var e=0;e<s.length;e++){var t=s.eq(e);if(t.attr("name")===r)return t.attr("value")}}};if(u.type={value:"text",model:"model","model-field":"field","model-condition":"condition"}[o],"model-field"===o||"model-condition"===o){var c=e.attr("model-source");t.each(s,function(e,n){if((n=t(n)).attr("name")===c)return u.modelname=u.modelName=n.attr("value"),-1}),u.modelName||(u.modelname=u.modelName=d.getFirstModelOnPage())}return u}(e,n)})),e.push({mode:"readonly",type:"textarea",label:"Description",isStateless:!0,valueFunction:function(){if(!c)return"";if(!r)return"";var e=r.children("description").text()||"";if(o){var t=d.getModelFromModelName(o);if(t)return i.mergeAsTextInContext(e,{model:{sobject:t.attr("sobject"),id:t.attr("id"),label:t.attr("label")}})}return i.mergeAsTextInContext(e)}})):e.push({type:"string",label:"Action Sequence Name",value:"No sequences on page",readonly:!0,isStateless:!0})},convertActionsToActionSequenceItem:function(t){return t.state.parent("actionsequence").length?[]:[{label:"",icon:"sk-icon-hierarchy",tooltip:"Convert to Action Sequence",action:function(){var n,i=t.state,o=function(){var t=e.$M(p);return t||(t=new e.model.Model('<model id="'+p+'" query="true" createrowifnonefound="true" datasource="Ui-Only" processonclient="true"><fields><field id="label" displaytype="TEXT" label="Display Name" required="true"/><field id="id" displaytype="TEXT" label="Id" required="true"/><field id="description" displaytype="TEXTAREA" label="Description" helptext="The description for the action sequence" ogdisplaytype="TEXT" length="2000"/></fields><conditions/><actions/></model>')),t.initialize().register(),t}();o.emptyData(),n=o.createRow(),o.updateRow(n,P()),e.snippet.register("createActionSequence",function(){var e,o=a('<actionsequence id="'+n.id+'" label="'+n.label+'"><actions></actions><description>'+(n.description||"")+"</description></actionsequence>");o.children("actions").prepend(i.children().clone()),y(o),e=d.getComponentFromState(t.state.parent()),i.empty(),i.prepend('<action type="action-sequence" action-sequence-id="'+n.id+'"/>'),e.save().refresh().rebuildProps(),g()}),function(t){e.actions.runActionNode(a('<action type="showPopup"><popup title="Convert to Action Sequence" width="90%"><components><pagetitle uniqueid="'+r()+'" model="'+p+'"><maintitle>New Action Sequence</maintitle><actions/></pagetitle><basicfieldeditor showheader="true" showsavecancel="false" showerrorsinline="true" model="'+p+'" buttonposition="" uniqueid="'+r()+'" mode="edit"><columns><column width="100%"><sections><section title="Action Sequence Details"><fields><field uniqueid="'+r()+'" id="label" valuehalign="" type=""/><field uniqueid="'+r()+'" id="description" valuehalign="" type=""/></fields></section></sections></column></columns></basicfieldeditor><buttonset model="'+p+'" uniqueid="'+r()+'"><buttons><button type="multi" label="Create" uniqueid="'+r()+'" icon="sk-icon-page-edit"><actions><action type="custom" snippet="createActionSequence"/><action type="closeTopmostPopup"/></actions><renderconditions logictype="and"/><enableconditions logictype="and" message="Display Name Needed"><condition type="fieldvalue" operator="!=" enclosevalueinquotes="true" fieldmodel="'+p+'" sourcetype="fieldvalue" field="label"/></enableconditions></button><button type="multi" label="Cancel" uniqueid="'+r()+'" secondary="true"><actions><action type="closeTopmostPopup"/></actions></button></buttons></buttonset></components></popup></action>'),t)}(t)}}]},getActionSequenceActionItems:function(e){return[{label:"",icon:"sk-icon-hierarchy",tooltip:"Break up into individual actions",action:function(){var t=S(e.state.attr("action-sequence-id")),n=t&&t.children("actions").children().clone();if(n.length){var i=e.state.parent().parent();e.state.before(n),e.state.remove(),d.getComponentFromState(i).save().refresh().rebuildProps()}}}]},getAllActionSequences:k,getLabelForActionSequenceAction:function(e){if(!e)return"Run Action Sequence";var t,n=e.attr("action-sequence-id");return n&&(n=(t=d.actionSequences.getSequenceXMLFromId(n))&&t.attr("label")||n),n?"Run: "+n:"Run Action Sequence"},getSequenceXMLFromId:S,getActionSequenceFromChildAction:function(e){if(e){var t=e.parents("actionSequence");if(t.length)return t}},getModelXMLForPickerOfInputModel:function(e,n){var i=function(e,n){return t.map(N(e),function(e){if("model-field"===e.attr("type")&&e.attr("model-source")===n)return e.attr("name")})}(e,n=E(n)),o=function(e,n){return t.map(N(e),function(e){if("model-condition"===e.attr("type")&&e.attr("model-source")===n)return e.attr("name")})}(e,n);return a('<model datasource="Ui-Only"><fields>'+t.map(i,function(e){return'<field id="{{$Input.'+e+'}}" label="'+e+'" displaytype="Any Type"/>'}).join(" ")+"</fields><conditions>"+t.map(o,function(e){return'<condition type="fieldvalue" name="{{$Input.'+e+'}}" label="'+e+' (input)"  displaytype="Any Type"/>'}).join(" ")+"</conditions></model>")},getModelInputsFromActionSequenceXML:T,addInputMerge:function(e){return"{{$Input."+e+"}}"},removeInputMerge:E,getInputsCategory:F}}(skuid)},284:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=e.events.publish,a=e.utils.makeXMLDoc,o=["background","background-image","background-size","background-attachment","background-repeat","background-position","background-color"],r=["min-height","border","border-left","border-right","border-top","border-bottom","padding","padding-left","padding-top","padding-right","padding-bottom"],l=["color","font-size"],s=o.concat(r,l);function d(){i("builder.colorcheck")}t.extend(n,{getStandardStyleTree:function(e){e||(e={});var i,o=e.component,r=e.propViewer,l=o.state,s=function e(n){n.element.append(t.map(n.items,function(i){var a=n.itemcomponent,r=n.styleProps,l=n.isSelectedFunction,s=n.property,d=t("<div>");return!l&&r&&s&&(l=function(e){return e===r[n.property]}),i instanceof Array?(d.addClass("nx-pagebuilder-prop-visualoptiongroup"),n.forceNewLinesForGroups&&d.css("width","100%"),n.element=d,n.items=i,e(n)):(d.addClass("nx-pagebuilder-prop-visualoption ui-state-default"+(l(i.value)?" ui-state-highlight":"")).append(t("<div>").addClass(i.fullCSS?i.fullCSS:n.cssPrefix+i.value.replace(" ","-")).attr("title",i.label)),i.minilabel&&d.append('<div class="minilabel">'+i.minilabel+"</div>"),"readonly"===a.mode?d.addClass("nx-pagebuilder-prop-visualoption-disabled"):d.on("click",function(){r&&(r[s]=i.value,p(a.state,r)),n.onClick&&n.onClick(i.value),a.rebuildProps().refresh(),o.save().refresh()})),d}))},u={background:{defaultState:'<styleitem type="background" bgtype="none" />',labelFunction:function(){return"Background"},propsFunction:function(e){var t=e.state,i=t.children("styles").first(),a=t.attr("bgtype")||"none",l=[{id:"bgtype",label:"Background Type",type:"picklist",default:"none",options:[{value:"none",label:"Not Set"},{value:"image",label:"Image"},{value:"color",label:"Color"}],beforeChange:function(e){e!==a&&(t.children().remove(),h(t))},onChange:function(t,n){t!==n&&void 0!==n&&(e.rebuildProps().refresh(),o.save().refresh(),d())}}],u={},c=function(){p(t,u)};switch(a){case"none":c();break;case"image":u["background-size"]=i.children('[property="background-size"]').attr("value")||"auto",u["background-attachment"]=i.children('[property="background-attachment"]').first().attr("value")||"scroll",u["background-position"]=i.children('[property="background-position"]').first().attr("value")||"center center",u["background-repeat"]=i.children('[property="background-repeat"]').first().attr("value")||"no-repeat",0===i.children().length&&c(),(l=l.concat(n.getImageProperties({component:e,propViewer:r,prefix:"bg-",filter:{noRecordContext:!0},additionalOnRefresh:function(){o.refresh()},additionalOnRebuildProps:function(){o.save().refresh()},additionalOnRebuildAndRefresh:function(){o.save().refresh()}}))).push({label:"Size",type:"custom",renderProperty:function(t){s({element:t.element,items:[{label:"Do not resize the image.",value:"auto",minilabel:"Original"},{label:"Maintaining its aspect ratio, resize the image to fit within the Wrapper. The image will not be clipped.",value:"contain",minilabel:"Contain"},{label:"Maintaining its aspect ratio, resize the image to completey cover the Wrapper. The image may be clipped.",value:"cover",minilabel:"Cover"}],property:"background-size",styleProps:u,cssPrefix:"preview bg size_",itemcomponent:e})}},{label:"Position",type:"custom",renderProperty:function(t){s({element:t.element,forceNewLinesForGroups:!0,items:[[{label:"Top Left",value:"top left"},{label:"Top Center",value:"top center"},{label:"Top Right",value:"top right"}],[{label:"Center Left",value:"center left"},{label:"Center",value:"center center"},{label:"Center Right",value:"center right"}],[{label:"Bottom Left",value:"bottom left"},{label:"Bottom Center",value:"bottom center"},{label:"Bottom Right",value:"bottom right"}]],property:"background-position",styleProps:u,cssPrefix:"preview bg position_",itemcomponent:e})}},{label:"Repeat",type:"custom",renderProperty:function(t){s({element:t.element,items:[{label:"None",value:"no-repeat",minilabel:"No Repeat"},{label:"Horizontally",value:"repeat-x",minilabel:"Horizontal"},{label:"Vertically",value:"repeat-y",minilabel:"Vertical"},{label:"Both",value:"repeat",minilabel:"Both"}],property:"background-repeat",styleProps:u,cssPrefix:"preview bg repeat_",itemcomponent:e})}},{label:"Special Effects",type:"custom",renderProperty:function(t){s({element:t.element,items:[{label:"No Effects",value:"scroll",minilabel:"No Effects",fullCSS:"preview bg"},{label:"Parallax Effect",value:"fixed",minilabel:"Parallax",fullCSS:"preview effects_parallax"}],property:"background-attachment",styleProps:u,itemcomponent:e})}});case"color":u["background-color"]=i.children('[property="background-color"]').attr("value")||"transparent",0===i.children().length&&(c(),o.save(),d()),l.push({isStateless:!0,label:"Color",type:"color",valueFunction:function(){return u["background-color"]},beforeChange:function(e){u["background-color"]=e,c()},onChange:function(){e.refresh(),o.save().refresh(),d()}})}return l}},size:{defaultState:'<styleitem type="size" />',labelFunction:function(){return"Size"},propsFunction:function(e){var n=e.state,i=n.children("styles").first(),a=n.attr("width")||"full",r=i.children('[property="max-width"]').attr("value")||"",l=i.children('[property="min-width"]').attr("value")||"",d=n.attr("height")||"collapse",u=n.attr("vwheight")||"50",c=i.children('[property="min-height"]').attr("value")||"",h=i.children('[property="max-height"]').attr("value")||"",f=[];function m(){var e={};"collapse"===a?e=t.extend(e,{width:["-webkit-fit-content","-moz-fit-content"],"-ms-grid-columns":"min-content",display:"table"}):"custom"===a&&(e=t.extend(e,{"min-width":l,"max-width":r}),l&&""!==l&&(e["min-width"]=l),r&&""!==r&&(e["max-width"]=r)),"viewport"===d?(n.attr("vwheight",u),e["overflow-y"]="auto"):"custom"===d&&(c&&""!==c&&(e["min-height"]=c),h&&""!==h&&(e["max-height"]=h,e["overflow-y"]="auto")),p(n,e)}return f.push({label:"Width",type:"custom",renderProperty:function(t){s({element:t.element,items:[{label:"Full Width",value:"full",minilabel:"Full"},{label:"Collapse",value:"collapse",minilabel:"Collapse"},{label:"Custom",value:"custom",minilabel:"Custom"}],isSelectedFunction:function(e){return a===e},cssPrefix:"preview sz width_",itemcomponent:e,onClick:function(e){a=e,m(),t.updateState({key:"width",value:e})}})}}),"custom"===a&&f.push({isStateless:!0,label:"Maximum Width",type:"csssize",valueFunction:function(){return r},beforeChange:function(e){r=e,m()},onChange:function(){e.refresh(),o.save().refresh()}},{isStateless:!0,label:"Minimum Width",type:"csssize",valueFunction:function(){return l},beforeChange:function(e){l=e,m()},onChange:function(){e.refresh(),o.save().refresh()}}),f.push({label:"Height",type:"custom",renderProperty:function(t){s({element:t.element,items:[{label:"Collapse",value:"collapse",minilabel:"Collapse"},{label:"Custom",value:"custom",minilabel:"Custom"}],isSelectedFunction:function(e){return d===e},cssPrefix:"preview sz height_",itemcomponent:e,onClick:function(e){d=e,m(),t.updateState({key:"height",value:e})}})}}),"custom"===d&&f.push({isStateless:!0,label:"Minimum Height",type:"csssize",helptext:'Pro-tip: Use "100vh" to match the viewport height. 100% doesn\'t usually work.',valueFunction:function(){return c},beforeChange:function(e){c=e,m()},onChange:function(){e.refresh(),o.save().refresh()}},{isStateless:!0,label:"Maximum Height",type:"csssize",helptext:'Pro-tip: Use "100vh" to match the viewport height. 100% doesn\'t usually work.',valueFunction:function(){return h},beforeChange:function(e){h=e,m()},onChange:function(){e.refresh(),o.save().refresh()}}),f}},itemsize:{defaultState:'<styleitem type="itemsize" />',labelFunction:function(){return"Size"},propsFunction:function(e){var t=e.state,n=t.children("styles").first(),i=t.attr("width")||"auto",a=n.children('[property="width"]').attr("value")||"",r=t.attr("height")||"auto",l=n.children('[property="height"]').attr("value")||"",d=[];function u(){var e={};"auto"===i||"custom"===i&&a&&""!==a&&(e.width=a),"auto"===r||"custom"===r&&l&&""!==l&&(e.height=l),p(t,e)}return d.push({label:"Width",type:"custom",renderProperty:function(t){s({element:t.element,items:[{label:"Fill Container",value:"auto",minilabel:"Auto"},{label:"Custom",value:"custom",minilabel:"Custom"}],isSelectedFunction:function(e){return i===e},cssPrefix:"preview sz width_",itemcomponent:e,onClick:function(e){i=e,u(),t.updateState({key:"width",value:e})}})}}),"custom"===i&&d.push({isStateless:!0,label:"Width",type:"csssize",valueFunction:function(){return a},beforeChange:function(e){a=e,u()},onChange:function(){e.refresh(),o.save().refresh()}}),d.push({label:"Height",type:"custom",renderProperty:function(t){s({element:t.element,items:[{label:"Proportional",value:"auto",minilabel:"Auto"},{label:"Custom",value:"custom",minilabel:"Custom"}],isSelectedFunction:function(e){return r===e},cssPrefix:"preview sz height_",itemcomponent:e,onClick:function(e){r=e,u(),t.updateState({key:"height",value:e})}})}}),"custom"===r&&d.push({isStateless:!0,label:"Height",type:"csssize",valueFunction:function(){return l},beforeChange:function(e){l=e,u()},onChange:function(){e.refresh(),o.save().refresh()}}),d}},border:{defaultState:'<styleitem type="border" />',labelFunction:function(){return"Border and Padding"},propsFunction:function(e){var n=e.state,i=n.children("styles").first(),a=["all","left","top","right","bottom"],r=n.attr("borders")||"none",l={},d=["all","left","top","right","bottom"],u=n.attr("padding")||"none",c={},h=["all","left","top","right","bottom"],f=n.attr("margin")||"none",m={},b=[];function v(){var e={};t.each(a,function(t,n){r.indexOf(n)>-1&&(e["border"+("all"===n?"":"-"+n)]=l[n])}),t.each(d,function(t,n){u.indexOf(n)>-1&&(e["padding"+("all"===n?"":"-"+n)]=c[n])}),t.each(h,function(t,n){f.indexOf(n)>-1&&(e["margin"+("all"===n?"":"-"+n)]=m[n])}),e["box-sizing"]="border-box",p(n,e)}return t.each(a,function(e,t){l[t]=i.children('[property="border'+("all"===t?"":"-"+t)+'"]').attr("value")||"0px solid transparent",l[t+"Vals"]=l[t].split(" ")}),t.each(d,function(e,t){c[t]=i.children('[property="padding'+("all"===t?"":"-"+t)+'"]').attr("value")||"0px"}),t.each(h,function(e,t){m[t]=i.children('[property="margin'+("all"===t?"":"-"+t)+'"]').attr("value")||"0px"}),b.push({label:"Border",type:"custom",renderProperty:function(t){s({element:t.element,items:[{label:"No Borders",value:"none",minilabel:"No Borders"},{label:"All Borders the Same",value:"all",minilabel:"All"},[{label:"Left Border On/Off",value:"left",minilabel:"Left"},{label:"Top Border On/Off",value:"top",minilabel:"Top"},[{label:"Right Border On/Off",value:"right",minilabel:"Right"},{label:"Bottom Border On/Off",value:"bottom",minilabel:"Bottom"}]]],isSelectedFunction:function(e){return r.indexOf(e)>-1},cssPrefix:"preview bd border_",itemcomponent:e,onClick:function(e){r="all"===e||"none"===e?e:(r="all"===r||"none"===r?"":r).indexOf(e)>-1?r.replace(e+",",""):e+","+r,v(),t.updateState({key:"borders",value:r})}})}}),t.each([{label:"",value:"all"},{label:"Left",value:"left"},{label:"Top",value:"top"},{label:"Right",value:"right"},{label:"Bottom",value:"bottom"}],function(t,n){r.indexOf(n.value)>-1&&b.push({isStateless:!0,label:n.label+" Border Width",type:"csssize",valueFunction:function(){var e=l[n.value+"Vals"];return e.length>0?e[0]:"0px"},beforeChange:function(e){var t=l[n.value+"Vals"];3===t.length?l[n.value]=e+" "+t[1]+" "+t[2]:l[n.value]=e+" solid transparent",l[n.value+"Vals"][0]=e,v()},onChange:function(){e.refresh(),o.save().refresh()}},{isStateless:!0,label:n.label+" Border Color",type:"color",valueFunction:function(){var e=l[n.value+"Vals"];return 3===e.length?e[2]:"transparent"},beforeChange:function(e){var t=l[n.value+"Vals"];3===t.length?l[n.value]=t[0]+" "+t[1]+" "+e:l[n.value]="0px solid "+e,l[n.value+"Vals"][2]=e,v()},onChange:function(){e.refresh(),o.save().refresh()}})}),b.push({label:"Padding",type:"custom",renderProperty:function(t){s({element:t.element,items:[{label:"No Padding",value:"none",minilabel:"No Padding"},{label:"All Padding the Same",value:"all",minilabel:"All"},[{label:"Left Padding On/Off",value:"left",minilabel:"Left"},{label:"Top Padding On/Off",value:"top",minilabel:"Top"},[{label:"Right Padding On/Off",value:"right",minilabel:"Right"},{label:"Bottom Padding On/Off",value:"bottom",minilabel:"Bottom"}]]],isSelectedFunction:function(e){return u.indexOf(e)>-1},cssPrefix:"preview bd padding_",itemcomponent:e,onClick:function(e){u="all"===e||"none"===e?e:(u="all"===u||"none"===u?"":u).indexOf(e)>-1?u.replace(e+",",""):e+","+u,v(),t.updateState({key:"padding",value:u})}})}}),t.each([{label:"",value:"all"},{label:"Left",value:"left"},{label:"Top",value:"top"},{label:"Right",value:"right"},{label:"Bottom",value:"bottom"}],function(t,n){u.indexOf(n.value)>-1&&b.push({isStateless:!0,label:n.label+" Padding Width",type:"csssize",valueFunction:function(){return c[n.value]||"0px"},beforeChange:function(e){c[n.value]=e,v()},onChange:function(){e.refresh(),o.save().refresh()}})}),b.push({label:"Margin",type:"custom",renderProperty:function(t){s({element:t.element,items:[{label:"No Margin",value:"none",minilabel:"No Margin"},{label:"All Margins the Same",value:"all",minilabel:"All"},[{label:"Left Margin On/Off",value:"left",minilabel:"Left"},{label:"Top Margin On/Off",value:"top",minilabel:"Top"},[{label:"Right Margin On/Off",value:"right",minilabel:"Right"},{label:"Bottom Margin On/Off",value:"bottom",minilabel:"Bottom"}]]],isSelectedFunction:function(e){return f.indexOf(e)>-1},cssPrefix:"preview bd padding_",itemcomponent:e,onClick:function(e){f="all"===e||"none"===e?e:(f="all"===f||"none"===f?"":f).indexOf(e)>-1?f.replace(e+",",""):e+","+f,v(),t.updateState({key:"margin",value:f})}})}}),t.each([{label:"",value:"all"},{label:"Left",value:"left"},{label:"Top",value:"top"},{label:"Right",value:"right"},{label:"Bottom",value:"bottom"}],function(t,n){f.indexOf(n.value)>-1&&b.push({isStateless:!0,label:n.label+" Margin Width",type:"csssize",valueFunction:function(){return m[n.value]||"0px"},beforeChange:function(e){m[n.value]=e,v()},onChange:function(){e.refresh(),o.save().refresh()}})}),b}}};function c(e,t){return a("<styleitem />").attr("property",e).attr("value",t)}function p(e,t){var n,i,o,r,l=[];if(t)for(n in t)if(i=t[n])if(i instanceof Array)for(o=0;o<i.length;o++)l.push(c(n,i[o]));else l.push(c(n,i));l.length?(r=a("<styles/>").append(l),e.empty().append(r)):e.empty()}function h(e){for(var t,n=0,i=[];n<e[0].attributes.length;n++)"type"!==(t=e[0].attributes[n].name)&&i.push(t);for(n=0;n<i.length;n++)e[0].removeAttribute(i[n])}var f=e.standardStyleSections||[];e.customStyleSections&&t.each(e.customStyleSections,function(e,t){u[e]=t,f.push(e)});var m=!1;return f&&f.length&&((i=l.children("styles").first()).length||(i=a("<styles/>"),l.append(i),m=!0),t.each(f,function(e,t){var n=u[t];if(n&&0===i.children('styleitem[type="'+t+'"]').length){var o=i.children("styleitem[type]").last();o.length?a(n.defaultState).insertAfter(o):i.append(a(n.defaultState)),m=!0}}),t.each(i.children("styleitem[type]"),function(){var e=t(this);if(-1===f.indexOf(e.attr("type"))){var n=e.find("styleitem");n.length&&i.append(n),e.remove(),m=!0}}),m&&o.save()),{id:e.id||"styles",label:"Style Attributes",deleteable:!1,icon:"sk-icon-generate-assets",isChild:!0,linkedComponent:o,children:[{id:"styleitem",addtooltip:"Add New Style Attribute",linkedComponent:o,labelFunction:function(e){var t=e.attr("property"),n=e.attr("value"),i=e.attr("type");return i&&u[i]?u[i].labelFunction(e):(t||"(none)")+" : "+(n||"(none)")+";"},noItemsFunction:function(e){var n=e.attr("type");if(n&&u[n])return function(e){var n=[];return t.each(e.children("styles").first().children(),function(){var e=t(this),i=e.attr("property"),a=e.attr("value");i&&n.push(t("<div>").addClass("nx-pagebuilder-styleitem-desc").text(i+": "+a+";"))}),!!n.length&&n}(e)},defaultStateFunction:function(){return a("<styleitem/>")},afterDelete:function(){o.refresh(),d()},deleteableFunction:function(e){var t=e.attr("type");return-1===["background","size","itemsize","border"].indexOf(t)},actionItemsFunction:function(e){var t=e.state,n=t.attr("type");return!(!n||!u[n])&&[{label:"",icon:"fa-bomb",action:function(){t.empty(),h(t),o.save(),o.refresh(),e.refresh().rebuildProps(),d()},tooltip:"Reset Property Group"}]},propsFunction:function(e){var t=e.state.attr("type"),n={id:"property",type:"string",label:"Property",onChange:function(){o.refresh(),e.refresh(),d()}},i={id:"value",type:"string",label:"Value",onChange:function(){o.refresh(),e.refresh(),d()}};return t&&u[t]?u[t].propsFunction(e):[n,i]}}]}},builderSafeStyleProperties:s,builderSafeBackgroundProperties:o,builderSafePositionProperties:r,builderSafeFormatProperties:l})}(skuid)},285:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=e.utils,a=i.makeXMLDoc,o=n.getFieldInfoFromCache,r=e.constants,l=r.SALESFORCE,s=r.DISPLAY_TYPES;function d(r){r||(r={});var d=r.fieldsNodeId||"searchfields",u=r.isReference,c=r.sobject,p=r.modelName,h=r.propViewer,f=!0===r.hideOrderingOptions;return{label:"Search Fields",linkedComponent:r.linkedComponent,id:d,isChild:!0,deleteable:!1,propsFunction:function(e){var t,a=e.state,o=a.parent().attr("searchmethod"),r=[{type:"helptext",html:"Use Search Fields to specify which fields to search on.  If you do not specify any fields, all searchable fields will be searched."}],s=n.getModelFromModelName(p),d=n.getDataSourceTypeFromModel(s).name;return s&&(d===l||!d)&&("server"===o||u)&&(t="true"===a.attr("usesosl"),r.push({type:"boolean",label:"Use SOSL to improve search performance",id:"usesosl",onChange:function(){e.state.attr("soslfields","Name Fields").empty(),e.save().refresh().rebuildProps(h)}}),t&&(r.push({id:"soslfields",type:"picklist",label:"Fields to Search",defaultValue:"Name Fields",picklistEntries:[{label:"Name Fields",value:"Name Fields"},{label:"All Text Fields",value:"All Fields"},{label:"Email Fields",value:"Email Fields"},{label:"Phone Fields",value:"Phone Fields"},{label:"SideBar Fields (Name, Phone, Email, External Ids)",value:"Sidebar Fields"}],onChange:function(){e.refresh().rebuildProps(h)}}),f||r.push({id:"defaultordering",type:"boolean",label:"Use Default Ordering",helptext:"If checked, no additional sorting will be applied to the results of this search",defaultValue:!1,onChange:function(){e.rebuildProps()}})),f||(!t||"true"===a.attr("defaultordering"))&&t||r.push({id:"orderby",type:"string",placeholder:i.getNameField(c||s&&s.objectName),label:"Fields to order records by",helptext:"How to order the data records returned for this Field, e.g. 'LastName DESC, FirstName' would order by LastName going from Z to A, then by FirstName going from A to Z."})),r},noItemsFunction:function(e){return e.attr("usesosl")?t("<div>").text("(Searching on "+e.attr("soslfields")+".)"):t("<div>").text(u?"(Searching on name field.)":"(Searching on all searchable fields.)")},childrenFunction:function(l){if("true"===l.state.attr("usesosl"))return[];var d=l.state.parent(),p="model"===d.attr("optionsource")?d.attr("optionmodel"):r.modelName;return[{id:"searchfield",indent:1,linkedComponent:r.linkedComponent,addtooltip:"Add New Search Field",labelFunction:function(e){var t,n,a=e.attr("operator")||"contains",l=e.attr("field");return!l||u&&"true"!==e.attr("query")||(n=o(r.modelName,l,c))&&n.displaytype&&(t=" "+i.getSearchOperatorForDisplayType(a,n.displaytype,l)+" [Search]"),(e.attr("field")||"[No Field Selected]")+(t||"")},defaultStateFunction:function(){return a(u?'<searchfield query="true" return="true" show="true"/>':"<searchfield/>")},propsFunction:function(l){var d=l.state,f=d.attr("return"),m=d.attr("show"),b=d.attr("query"),v=d.attr("field"),g=!!v&&o(r.modelName,v,c),y=!!g&&g.displaytype,C=e.ui.searchableDisplayTypes,w=!!g&&y in C;void 0===f&&(f="true"===m?"true":"false",d.attr("return",f),l.save());var S=[{id:"field",type:"field",label:"Field",displayTypeFilter:function(e){return!e.uiOnly&&(!!u||(!0===e.filterable||e.displaytype in C&&!1!==e.filterable))},modelname:p,sobject:c,allowModelFieldAdds:!0,onChange:function(e){if(u){var t=o(r.modelName,e,c);if(t&&t.displaytype===s.REFERENCE){var p,f=t.rel+"."+i.getNameField(c),m=d.siblings('[field="'+i.escapeSelector(f)+'"]'),b=d.parent();m.length||(b.append(a('<searchfield query="true" return="true" show="false" field="'+f+'"/>')),(p=n.getComponentFromState(b.parent()))&&(p.save(),p.rebuildProps&&p.rebuildProps(),p.renderProperties&&p.renderProperties(h)))}}l.refresh().rebuildProps()}}];if(u&&w&&S.push({id:"query",type:"boolean",label:"Search this Field",onChange:function(){l.save().refresh().rebuildProps(h)}}),v&&(!u||"true"===b)&&g&&w){var k,P=!1,x=t.map(n.getValidOperators("searchfield",y),function(e,t){return"contains"===t&&(P=!0),{label:e.name,value:t}});k=y===s.MULTIPICKLIST?"includes":P?"contains":x[0].value,x.length&&S.push({id:"operator",type:"picklist",label:"Search Operator",defaultValue:k,picklistEntries:x,onChange:function(){l.refresh()}})}return u&&(S.push({id:"return",type:"boolean",readonly:"true"===m,label:"Return Field in query results",onChange:function(){l.save().rebuildProps(h)}}),"true"===f&&S.push({id:"show",type:"boolean",label:"Show Field in Search Popup",onChange:function(){l.save().rebuildProps(h)}}),"true"===m&&S.push({id:"label",type:"template",displayAs:"input",location:"node",label:"Custom Label"})),S}}]}}}t.extend(n,{getListSearchPropsCategory:function(t){t||(t={});var i=t.component,a=i.state,o=t.modelName,r=t.propViewer,l=!0===t.hideOrderingOptions,s=!!i.updateSearchBox&&i.updateSearchBox,u=n.getModelFromModelName(o),c=n.getDataSourceTypeFromModel(u),p=a.attr("searchmethod"),h=!0,f="server"===p,m=!c||!1!==c.prop("canFieldsBeIndividuallySearched")&&!1!==c.prop("showSearchFields"),b=t.additionalBehaviorProps,v=[],g=[];return e.mobile||(g.push({id:"instantfilters",type:"boolean",label:"Apply Filters and Search Immediately",defaultValue:!0,helptext:'By default, changing a Filter or entering search text will immediately re-query this Component\'s Model. Disable this setting to instead shown "Apply" and "Cancel" buttons which delay execution of filters and search until the user clicks "Apply".'}),b&&("function"==typeof b&&(b=b()),Array.prototype.push.apply(g,b)),v.push({label:"Filter & Search Behavior",linkedComponent:i,deleteable:!1,props:g})),t.showFiltersPosition&&v.push({label:"Filters Properties",linkedComponent:i,deleteable:!1,propsFunction:function(e){var t=[{id:"filtersposition",type:"picklist",picklistEntries:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"}],label:"Position",defaultValue:"top",helptext:"The relative position of filters.",onChange:function(){i.refresh(),e.rebuildProps(r)}}];return"left"!==a.attr("filtersposition")&&"right"!==a.attr("filtersposition")||t.push({id:"filterswidth",type:"csssize",label:"Filters Container Width",defaultValue:"150px",onChange:function(){i.refresh()}}),t}}),v.push({label:"Search Properties",linkedComponent:i,deleteable:!1,propsFunction:function(e){var t=[{id:"searchbox",type:"boolean",label:"Show Search Box",helptext:"By default, a search box is displayed, allowing for full-text search on all searchable fields. Uncheck this box to hide this search box.",defaultValue:!0,onChange:function(){s&&s(),e.rebuildProps(r)}}];return c&&!1===c.prop("canServerSearch")&&(h=!1),"true"===a.attr("searchbox")&&(t.push({id:"searchmethod",type:"picklist",label:"Search Method",defaultValue:"server",helptext:'By default, table search is performed server-side, meaning that all records in the database will be searched for the text in the search box. To search just the records initially retrieved in the model, select "Client" instead.',picklistEntries:h?[{label:"Server",value:"server"},{label:"Client",value:"client"}]:[{label:"Client",value:"client"}],onChange:function(){i&&(i.rebuildProps&&i.rebuildProps(r),i.renderProperties&&i.renderProperties(r))}}),!m&&f&&t.push({id:"searchconditionname",type:"condition",modelName:o,label:"Search Condition / Merge Parameter"}),m&&t.push({id:"tokenizesearch",type:"boolean",label:"Tokenize Search Terms",helptext:"If checked, this will split search terms on the 'space' character and search for them separately."}),t.push({id:"searchplaceholdertext",type:"template",displayAs:"input",location:"attribute",label:"Search box placeholder text",onChange:function(){s&&s()},helptext:'(Optional) Custom text to display as a placeholder in the search box until the user starts typing, e.g. "Search newly created Accounts...". Defaults to "Search " + the plural label of the Model\'s SObject, e.g. "Search Accounts"'}),f&&t.push({id:"emptysearchbehavior",type:"picklist",label:"Empty Search Behavior",defaultValue:"query",helptext:'By default, when the search box is emptied, the Model is requeried, but with no search Condition applied, so records will likely be returned. To remove all records from this Model when the search box is emptied, select "Remove all Model data".',picklistEntries:[{label:"Re-query for Model data",value:"query"},{label:"Remove all Model data",value:"remove"}]})),t}}),(m||"client"===p)&&v.push(d({fieldsNodeId:"searchfields",modelName:o,linkedComponent:i,hideOrderingOptions:l})),{name:"Filters & Search",tree:v}},getSearchFieldsTreeItem:d})}(skuid)},286:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=e.utils,a=n.defaultJavaScriptResourceBodies,o=n.defaultJavaScriptResourceNames,r=e.platform.getEntityFieldNames("static_resource");t.extend(n,{getLabelProperties:function(e){var t={id:"id",type:"string",label:"Label Id"};return e&&e.onChange&&(t.onChange=e.onChange),[t]},getJSItemProperties:function(t){var n=t.state,l=!0;n.attr("content_type")&&(l=n.attr("content_type")===e.constants.MIME_TYPES.ZIP);var s={id:"location",type:"picklist",label:"Resource Location",defaultValue:"staticresource",picklistEntries:[{label:e.$L("file_resource"),value:"staticresource"},{label:"External",value:"external"},{label:"In-Line",value:"inline"},{label:"In-Line (Snippet)",value:"inlinesnippet"},{label:"In-Line (Component)",value:"inlinecomponent"}],onChange:function(e,r){"staticresource"===e?n.attr({url:"",cachelocation:"false",name:"",namespace:""}):"external"!==e&&n.attr("url",""),e&&i.startsWith(e,"inline")&&r&&r!==e&&(n.text()&&n.text()!==a[r]||n.text(a[e]),n.attr("name")&&n.attr("name")!==o[r]||n.attr("name",o[e])),t.save().refresh().rebuildProps()}},d=e.platform.builder.getStaticResourceProperty({id:"name",valueTemplates:{name:"{{{"+r.name+"}}}",namespace:"{{{"+r.namespace+"}}}",content_type:"{{{"+r.content_type+"}}}"},helptext:"The name of the Static Resource where this JavaScript is stored.",onChange:function(){n.attr("filepath")&&(n.removeAttr("filepath"),t.save()),t.refresh().rebuildProps()}}),u={id:"name",type:"string",label:"Snippet Name",onChange:function(){t.refresh()}},c={id:"name",type:"string",label:"Component Name",onChange:function(){t.refresh()}},p={id:"namespace",type:"string",label:"Namespace (if in managed package)",helptext:"ONLY needed if this StaticResource is included in a Managed Package."},h={id:"name",type:"string",label:"Resource Name (optional)",onChange:function(){t.refresh()}},f={id:"url",type:"string",label:"Resource URL",divisionSize:"2",onChange:function(){t.refresh()}},m={id:"cachelocation",type:"boolean",label:"Cache Resource Location",helptext:"Leave UNCHECKED unless the contents of your Static Resource are very stable and will not be changing."},b=e.platform.builder.getNestedPathProperty({state:n,nameProperty:"name",namespaceProperty:"name"}),v={external:[s,h,f],inline:[s,h,{type:"code",syntax:"javascript",label:"Resource Body",divisionSize:"2"}],inlinesnippet:[s,u,{type:"code",syntax:"javascript",label:"Snippet Body",divisionSize:"2"}],inlinecomponent:[s,c,{type:"code",label:"Component Body",syntax:"javascript",divisionSize:"2"}],staticresource:[s,d,p,m],DEFAULT:[s,h,p]};return e.utils.inPlatform([e.constants.VISUALFORCE,e.constants.LIGHTNING])||e.$.each([p,m],function(e,t){var n=v.staticresource.indexOf(t);-1!==n&&v.staticresource.splice(n,1)}),n.attr("name")&&l&&v.staticresource.push(b),v[n.attr("location")||"DEFAULT"]},getCSSItemProperties:function(t){var n=t.state,i=!0;n.attr("content_type")&&(i=n.attr("content_type")===e.constants.MIME_TYPES.ZIP);var a={id:"location",type:"picklist",label:"Resource Location",defaultValue:"staticresource",picklistEntries:[{label:e.$L("file_resource"),value:"staticresource"},{label:"External",value:"external"},{label:"In-Line",value:"inline"}],onChange:function(e){"staticresource"===e?n.attr({url:"",cachelocation:"false",name:"",namespace:""}):"external"!==e&&n.attr("url",""),t.refresh().rebuildProps()}},o=e.platform.builder.getStaticResourceProperty({id:"name",valueTemplates:{name:"{{{"+r.name+"}}}",namespace:"{{{"+r.namespace+"}}}",content_type:"{{{"+r.content_type+"}}}"},helptext:"The name of the Static Resource where this CSS is stored.",required:!0,onChange:function(){n.attr("filepath")&&(n.removeAttr("filepath"),t.save()),t.refresh().rebuildProps()}}),l={id:"namespace",type:"string",label:"Namespace (if in managed package)",helptext:"ONLY needed if this StaticResource is included in a Managed Package."},s={id:"name",type:"string",label:"Resource Name (optional)",onChange:function(){t.refresh()}},d={id:"url",type:"string",label:"Resource URL",divisionSize:"2",onChange:function(){t.refresh()}},u={id:"cachelocation",type:"boolean",label:"Cache Resource Location",helptext:"Leave UNCHECKED unless the contents of your Static Resource are very stable and will not be changing."},c=e.platform.builder.getNestedPathProperty({state:n,nameProperty:"name",namespaceProperty:"name",onChange:function(){t.refresh()}}),p={external:[a,s,d],inline:[a,s,{type:"code",syntax:"css",label:"Resource Body",divisionSize:"2"}],staticresource:[a,o,l,u],DEFAULT:[a,s,l]};return e.utils.inPlatform([e.constants.VISUALFORCE,e.constants.LIGHTNING])||e.$.each([l,u],function(e,t){var n=p.staticresource.indexOf(t);-1!==n&&p.staticresource.splice(n,1)}),n.attr("name")&&i&&p.staticresource.push(c),p[n.attr("location")||"DEFAULT"]}})}(skuid)},287:function(e,t,n){"use strict";!function(e){var t=e.builder.core;t.getModalProperties=function(e,n){n=n||{};var i=[{id:"title",type:"template",location:"attribute",label:"Popup Title",onChange:function(t){e.element.dialog("option","title",t)}},{id:"buttonsJustification",type:"picklist",defaultValue:"",picklistEntries:[{label:"Left",value:""},{label:"Middle",value:"center"},{label:"Right",value:"right"}],label:"Button Alignment",onChange:function(){e.refresh()}},{id:"fullScreen",type:"boolean",defaultValue:!1,label:"Full Screen Modal",onChange:function(){e.rebuildProps()}}],a=[{name:"Basic",props:i}];return"true"!=e.state.attr("fullScreen")&&i.push({id:"width",type:"csssize",label:"Width",onChange:function(t){e.element.dialog("option","width",t)}}),n.useAfterCloseActions&&a.push(t.getActionsCategory({customNodeId:"afterclose",label:"After Close Actions",linkedComponent:e})),a},t.getPopupProperties=function(n,i){var a=[{name:"Basic",props:[{id:"title",type:"template",location:"attribute",label:"Popup Title",onChange:function(e){n.element.dialog("option","title",e)}},{id:"width",type:"csssize",label:"Width",onChange:function(e){n.element.dialog("option","width",e)}}]},{name:"Advanced",props:[{id:"closeicon",type:"icon",label:"Close Icon",defaultValue:"sk-icon-close",onChange:function(t){n.element.parent().find(".ui-dialog-titlebar-close .ui-icon, .ui-dialog-titlebar-close .sk-icon, .ui-dialog-titlebar-close .sk-webicon").after(e.$(e.ui.createIcon(t||"sk-icon-close")).css("left","0")).remove()}}]}];return(i=i||{}).useAfterCloseActions&&a.push(t.getActionsCategory({customNodeId:"afterclose",label:"After Close Actions",linkedComponent:n})),a}}(skuid)},288:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=e.utils,a=e.constants,o=a.DISPLAY_TYPES,r=a.SALESFORCE,l=n.getDefaultAliasName,s="Allow Page Render Before Query Completes";function d(e,t,n){n||(n={});var i=[],a=n.isLocked,o=n.dataSourceTypeCriteria,r=!1!==n.autoClearStateOnChange,l=h({component:e,propViewer:t,isLocked:a,filter:o,autoClearStateOnChange:r}),s=f({component:e,propViewer:t,isLocked:a,autoClearStateOnChange:r});return l&&i.push(l),s&&i.push(s),i}function u(n){return t.map(e.dataSource.map(),function(e,t){if(e.getDataSourceTypeName()===n)return{value:t,label:t===r?"Current Salesforce Org":t}}).sort(function(e,t){return e.value===r?-1:e.label>t.label})}function c(i){i.children("fields, groupby, conditions, actions, methods").empty();var a=n.getDataSourceFromModel(i),o=a.name,l=a.getDataSourceType(),s=["datasource","service","id","query","createrowifnonefound","unloadwarningifunsavedchanges","limit"];i.removeAttr(t.map(i.attr(),function(e,n){if(-1===t.inArray(n,s))return n}).join(" ")),o&&(e.offline.isEnabled()||o!==r)&&i.attr("processonclient","true"),l&&l.onDataSourceChange&&l.onDataSourceChange(i)}function p(t){var i=t.component,a=t.propViewer;return{id:"id",type:"string",label:"Model Id",helptext:"A unique identifier for this Model. Can only contain letters, numbers, or underscores.",validator:function(e){return n.validators.modelId(e,i)},onChange:function(t,o){i.headerTitle?i.headerTitle.text(i.builder.name+" - "+t):i.element&&(i.element.find(".nx-pagebuilder-modeltag").children().eq(1).text(t),i.element.find(".nx-pagebuilder-fieldtag").attr("data-model",t)),a&&a.setTitle(i.builder.name+" - "+t),n.publishStateEvent({type:"model.idChange",oldId:o,newId:t}),e.events.publish("skuidBuilderRefreshModelList")}}}function h(t){var a,o=t.component,r=t.propViewer,l=t.isLocked,s=t.filter,d=o.state,p=e.dataSource.listAllTypes();if(["datasourcetype","adapter"].forEach(function(e){i.isUndefined(d.attr(e))||d.removeAttr(e)}),p.length){var h=p.filter(function(e){var t=u(e.name);return!(!t||!t.length)&&(!s||s(e))}).map(function(e){return{value:e.name,label:e.label||e.name}}).sort(function(e,t){return(e.label?e.label:e.name)>(t.label?t.label:t.name)});a={id:"datasourcetype",isStateless:!0,valueFunction:function(){return n.getDataSourceFromModel(o.state).dataSourceTypeName},type:h&&h.length>1?"picklist":"readonly",label:"Data Source Type",picklistEntries:h,defaultValue:e.platform.getDefaultDataSourceTypeName(),readonly:!0===l,onChange:function(e,n){var i=u(e);o.dataSourceTypeValue=e,i&&i[0]&&d.attr("datasource",i[0].value),void 0!==e&&void 0!==n&&!1!==t.autoClearStateOnChange&&c(d),o.save().refresh().rebuildProps(r)}}}return a}function f(t){var i,a=t.component,o=t.propViewer,r=t.isLocked,l=a.state,s=e.platform.getDefaultDataSourceTypeName(),d=a.dataSourceTypeValue||s,p=n.getDataSourceFromModel(l),h=l.attr("datasource")||l.attr("service"),f=t.filter?t.filter():u(d),m=l.attr("service"),b=l.attr("datasource");return f.length>0&&(m&&(b||l.attr("datasource",m),l.removeAttr("service")),d!==s||h?void 0===p&&(t.autoClearStateOnChange=!1,f.unshift({value:h,label:"* "+h+" (invalid)"})):(l.attr("datasource",e.platform.getDefaultDataSourceName()),a.save()),i={id:"datasource",type:f&&f.length>1?"picklist":"readonly",label:"Data Source",picklistEntries:f,readonly:!0===r,onChange:function(e,n){void 0!==e&&void 0!==n&&!1!==t.autoClearStateOnChange&&c(l),a.save().refresh().rebuildProps(o)}}),i}t.extend(n,{getAsyncLoadProperty:function(e){var t="true"===e.component.state.attr("query"),n=e.defaultValue;return{id:"async",type:"boolean",label:s,defaultValue:!!n,disabled:!t,init:function(e){var t=(e=e||{}).label;this.disabled&&(this.readonly=!0,t&&t.addClass("nx-basicfieldeditor-item-disabled"))},helptext:"If true, the Skuid page will proceed to render while this initial query takes place (Useful for large data sets or slower data sources that may delay page rendering). If false, the Skuid page will not render until this model’s initial query is completed."}},getCacheProperty:function(){return{id:"cacheforoffline",type:"boolean",label:"Allow skuid to cache this model's data for offline use.",defaultValue:!0}},getConditionsBuilderProperties:function(e){var t=e.component.state.closest("model"),i=n.getDataSourceFromModel(t).getDataSourceType(),a=e.propertiesViewer,o=[];return i&&i.prop("canConditionsBeGrouped")&&o.push({id:"logic",type:"string",label:"Grouping Logic",helptext:"How to group and apply these Conditions when loading the Model, e.g. ((1 AND 2) OR (3 AND 4)). By default, all Conditions are applied."}),a.setTitle((i?i.prop("composer.modelConditionsLabel"):"")||"Conditions"),[{name:"",props:o}]},getCoreModelBasicProperties:function(e){var t=e.component,n=e.propViewer,i=e.isDataSourceLocked,a=[p({component:t,propViewer:n})],o=h({component:t,propViewer:n,isLocked:i,filter:function(e){return!1!==e.modelable}}),r=f({component:t,propViewer:n,isLocked:i});return o&&a.push(o),r&&a.push(r),a},getCreateDefaultRowProperty:function(e){return{id:"createrowifnonefound",type:"boolean",label:"Create default row if Model has none",defaultValue:!!e,helptext:"Typically used for Pages functioning as Overrides for the 'New' action. If true, then when this Page loads, if no data records exist in the Model, then a default row will be automatically created."}},getDeferFieldRenderingProperty:function(e){return{id:"deferfieldrendering",type:"boolean",label:"Defer Rendering",defaultValue:!!e,helptext:"Some entities require multiple queries to be made at a single time.  This allows you to specify if fields should be rendered before any additional requests are made, if those fields require an additional request.  If checked, these fields will be loaded asynchronously."}},getFieldsToDeferProperty:function(e){var n=e.state.children("fields").children("field");return{id:"fieldstodefer",type:"multipicklist",label:"Fields To Defer",picklistEntries:t.map(n,function(e){return{label:(e=t(e)).attr("id"),value:e.attr("id")}})}},getDataSourceAccessMethodProperty:function(e){e||(e={});var n,i=[],a=e.state;return a&&"true"===a.attr("batch")?i.push("POST"):i.push("DELETE"),n={query:["GET","POST"],insert:["POST"],update:["PUT","PATCH","POST"],delete:i},{id:"verb",type:"picklist",label:"Data Source HTTP Verb",defaultValue:"GET",picklistEntries:t.map(n[e.type||"query"],function(e){return{value:e,label:e}}),onChange:e.onChange}},getDataSourceSelectionProps:d,getDataSourceTypeProperty:h,getDataSourcesOfType:u,getDataSourceProperty:f,getModelIdProperty:p,getModelFieldProperties:function(a){function r(e){var n=[],i={Checkbox:{value:o.BOOLEAN,label:"Checkbox"},Combobox:{value:o.COMBOBOX,label:"Combobox"},Currency:{value:o.CURRENCY,label:"Currency"},Date:{value:o.DATE,label:"Date"},Datetime:{value:o.DATETIME,label:"Datetime"},Email:{value:o.EMAIL,label:"Email"},Formula:{value:o.FORMULA,label:"Formula"},Percent:{value:o.PERCENT,label:"Percent"},Picklist:{value:o.PICKLIST,label:"Picklist"},MultiPicklist:{value:o.MULTIPICKLIST,label:"Multi-select Picklist"},Number:{value:o.DOUBLE,label:"Number"},Reference:{value:o.REFERENCE,label:"Reference"},Text:{value:o.TEXT,label:"Text"},Textarea:{value:o.TEXTAREA,label:"Textarea"},Url:{value:o.URL,label:"Url"},UUID:{value:o.UUID,label:"Unique Id (UUID)"}},a=0;if(e)for(e=e.sort();a<e.length;a++)n.push(i[e[a]]);else n=t.map(i,function(e){return e});return n}var s,u=a.component,c=u.state,p=c.closest("model").first(),h="aggregate"===p.attr("type"),f=c.parent().is("groupby"),m=e.dataSource.get(p.attr("datasource")||p.attr("service")||e.platform.getDefaultDataSourceName()).dataSourceType,b=m.prop("isUiOnly"),v=r(),g=c.attr("id"),y=c.attr("name"),C="true"===c.attr("readonly"),w="true"===c.attr("uionly")||b,S=w?null:n.getMetadataForField(u,{readMetadataFromFieldNode:!1}),k=m&&m.prop("runtime.metadataSource"),P="local"===k||"hybrid"===k,x="true"===c.attr("overridemetadata"),F=a.propViewer,T=F,N=void 0,A=void 0,E=void 0,I=void 0,M=void 0,R=void 0,L=void 0,O=void 0,D=void 0,B=void 0,V=void 0,q=void 0,U=void 0,_=void 0,j=void 0,G=void 0,X=void 0,W=void 0,H=void 0,z=void 0,Y=void 0,K=void 0,$=void 0,Q=void 0,J=void 0,Z=void 0;function ee(){var e="Field: "+n.getModelFieldComponentLabel(c);h&&(e=(f?"Grouping ":"Aggregation")+" "+e),T.setTitle(e)}if(h&&!w)return z=[],f?f&&m&&m.getAggregateGroupingProperties&&i.mergeArrays(z,m.getAggregateGroupingProperties(u,F,S)):m&&m.getAggregateFieldProperties&&i.mergeArrays(z,m.getAggregateFieldProperties(u,F)),z.push({id:"name",type:"string",label:"Alias Name",helptext:"An alias for this field to be used in Components that refer to it. Must be alphanumeric and have 3-25 characters.",onChange:function(e){e||c.attr("name",l(c.attr("id"),c.attr("function"))),u.save().refresh(),ee()}}),ee(),[{name:"Basic",props:z}];if(s={id:"overridemetadata",type:"boolean",label:"Override field metadata",defaultValue:!1,onChange:function(e){var t=void 0;if(S&&S.displaytype){if(c.attr("ogdisplaytype")||c.attr("ogdisplaytype",S.displaytype),t=S.displaytype,e)switch(t){case o.ADDRESS:case o.ENCRYPTEDSTRING:case o.ID:case o.LOCATION:case o.OBJECT:case o.PHONE:case o.STRING:t=o.TEXT;break;case o.INTEGER:t=o.DOUBLE}c.attr("displaytype",t),u.save()}u.rebuildProps(F)}},A=[{id:"id",type:"string",readonly:!w&&!P,label:"Field Id",validator:function(e){return n.validators.fieldId({field:c,model:p,newFieldId:e})},onChange:function(){ee(),u.refresh()}}],w||P||A.push(s),P&&!b&&A.push({type:"boolean",id:"uionly",defaultValue:!1,label:"Ui-Only",helptext:"If true, then this field will not be sent with any insert or update requests, and will not be requested as part of any queries."}),w||x||P){for(I=o.TEXT,_={id:"label",type:"template",modelName:p.attr("id"),location:"attribute",displayAs:"input",label:"Label",onChange:function(e){n.publishStateEvent({type:"model.field.metadataChange",fieldId:g,fieldName:y,modelId:p.attr("id"),changes:{label:e},newMetadata:c})}},V={id:"helptext",displayAs:"textarea",label:"Inline Help Text",type:"string"},X={id:"placeholder",displayAs:"input",label:"Placeholder",location:"attribute",type:"template"},G={id:"required",label:"Required",type:"boolean"},H={id:"precision",label:"Length",type:"picklist",helptext:"Number of digits to the LEFT of the decimal point",defaultValue:w?"9":"",picklistEntries:[]},K={id:"returntype",label:"Return Type",type:"picklist",required:!0,defaultValue:o.TEXT,picklistEntries:[{value:o.BOOLEAN,label:"Checkbox"},{value:o.CURRENCY,label:"Currency"},{value:o.DATE,label:"Date"},{value:o.DATETIME,label:"Datetime"},{value:o.PERCENT,label:"Percent"},{value:o.DOUBLE,label:"Number"},{value:o.TEXT,label:"Text"}],onChange:function(){u.rebuildProps(F)}},Q={id:"scale",label:"Decimal Places",type:"picklist",helptext:"Number of digits to the RIGHT of the decimal point",defaultValue:w?"2":"",picklistEntries:[]},Y={id:"readonly",label:"Read-Only",type:"boolean"},N=n.getConditionValueProperties(u,{handleChange:function(){u.refresh()},handleRefresh:function(){u.rebuildProps&&u.rebuildProps(),u.renderProperties&&u.renderProperties(F)},validTypes:["fieldvalue","multiple","param","userinfo","blank","modelmerge","join"],modelName:p.attr("id"),isDefaultValueField:!0}),Z={id:"displayasrichtext",defaultValue:S&&S.htmlFormatted,label:"Rich Text",type:"boolean",helptext:""},S&&S.required&&(G.isStateless=!0,G.readonly=!0,G.value=!0),x&&S&&($=S.scale,W=S.precision,Q.picklistEntries.push({value:"",label:"(Use field default"+($?": "+$:"")+")"}),H.picklistEntries.push({value:"",label:"(Use field default"+(W?": "+W:"")+")"})),q=0;q<18;)H.picklistEntries.push({value:""+q,label:""+q}),q<10&&Q.picklistEntries.push({value:""+q,label:""+q}),q++;if(!w&&S&&(S.label&&(_.placeholder=S.label),S.inlineHelpText&&(V.placeholder=S.inlineHelpText)),R=c.attr("displaytype")||I,w||P)L=v;else switch(c.attr("ogdisplaytype")||c.attr("displaytype")){case o.BOOLEAN:L=r(["Checkbox","Formula","Picklist"]);break;case o.CURRENCY:L=r(["Currency","Formula","Number","Text","Textarea","Picklist"]);break;case o.DATE:case o.DATETIME:L=r(["Date","Datetime","Formula","Text"]);break;case o.EMAIL:L=r(["Email","Formula","Text","Textarea","Url","Picklist","Combobox"]);break;case o.INTEGER:case o.DOUBLE:L=r(["Formula","Currency","Number","Text","Textarea","Picklist","Reference"]);break;case o.PERCENT:L=r(["Formula","Currency","Number","Percent","Text","Textarea","Picklist"]);break;case o.LOCATION:L=r(["Formula","Number","Text","Textarea"]);break;case o.PHONE:L=r(["Formula","Number","Text","Textarea","Picklist","Combobox"]);break;case o.PICKLIST:L=r(["Formula","Text","Textarea","MultiPicklist","Combobox","Picklist"]);break;case o.MULTIPICKLIST:L=r(["Formula","Text","Textarea","Picklist","MultiPicklist"]);break;case o.REFERENCE:L=r(["Formula","Text","Textarea","Reference","Combobox"]);break;case o.STRING:case o.ENCRYPTEDSTRING:case o.TEXT:case o.TEXTAREA:L=r(["Email","Formula","Currency","Number","Text","Textarea","Picklist","MultiPicklist","Reference","UUID","Combobox"]);break;case o.URL:L=r(["Email","Formula","Text","Textarea","Url","Picklist","Combobox"]);break;default:L=v}if(R===o.ARRAY&&L.unshift({value:o.ARRAY,label:"Array"}),O={id:"displaytype",label:"Display Type",type:"picklist",defaultValue:I,picklistEntries:L,onChange:function(e,t){c.attr("ogdisplaytype")||c.attr("ogdisplaytype",t),u.save().rebuildProps(F),n.publishStateEvent({type:"model.field.metadataChange",fieldId:g,fieldName:y,modelId:p.attr("id"),changes:{displaytype:e},newMetadata:c})}},U=c.attr("displaytype")===o.FORMULA,A.push(_,V,O),C||A.push(G),t.inArray(R,[o.PICKLIST,o.MULTIPICKLIST,o.COMBOBOX])>-1){c.attr("picklistsource")||c.attr("picklistsource","manual");var te={id:"picklistsource",label:"Picklist Source",type:"picklist",defaultValue:"manual",picklistEntries:[{value:"manual",label:"Manual"},{value:"rowsinmodel",label:"Rows in Model"},{value:"snippet",label:"Snippet"}],onChange:function(){u.save().rebuildProps(F)}};A.push(te,K),"snippet"===c.attr("picklistsource")&&A.push({id:"snippet",label:"Snippet",helptext:"A snippet that returns an array in the form of [{value, label}, ...] for picklist entries",type:"snippet",location:"attribute"})}if(U&&e.mobile&&A.push({id:"formula",label:"Formula",type:"code"}),U?A.push({label:"Read-Only",type:"custom",renderProperty:function(e){var t=e.state;"true"!==t.attr("readonly")&&(t.attr("readonly","true"),u.save()),n.propertyRenderers.boolean({isStateless:!0,value:!0,readonly:!0},t).appendTo(e.element)}}):A.push(Y),R===o.PICKLIST||R===o.MULTIPICKLIST||R===o.COMBOBOX)J=c.attr("picklistsource"),R===o.COMBOBOX&&A.push({id:"limitentries",label:"Restrict Input to Picklist Entries",type:"boolean",defaultValue:!1,helptext:"By default, users can enter values that do not correspond the specified picklist entries. If this property is checked, then users must select one of the provided picklist entries, otherwise their input will be discarded."}),E=[{name:"Basic",props:A}],"manual"===J?E.push({name:"Picklist Entries",tree:{id:"picklistentries",label:"Picklist Entries",deleteable:!1,icon:"sk-bi-options",isChild:!0,children:[{id:"entry",labelFunction:function(e){return e.attr("label")||"[No Label]"},defaultStateFunction:function(){return i.makeXMLDoc('<entry value="New Entry" label="New Entry"/>')},propsFunction:function(e){return[{id:"value",label:"Value",type:"string"},{id:"label",label:"Label",type:"template",displayAs:"input",location:"attribute",onChange:function(){e.save().refresh()}}]}}]}}):"rowsinmodel"===J&&E.push({name:"Picklist Model",props:[{id:"picklistmodel",type:"model",label:"Model"},{id:"entryvalue",type:"template",label:"Entry Value",defaultValue:"{{Id}}",location:"attribute",displayAs:"input"},{id:"entrylabel",type:"template",label:"Entry Label",defaultValue:"{{Name}}",location:"attribute",displayAs:"input"}]});else if(R===o.REFERENCE){var ne=n.getDataSourceFromModel(c).getDataSourceType(),ie=ne.getReferenceHandler&&ne.getReferenceHandler(),ae=d(u,F,{autoClearStateOnChange:!1});ie?(ae.push({id:"rel",type:"string",label:"Relationship Field Name",helptext:"The name of the (Ui-Only) field that will be created, if it does not exist already, to store related information about the referenced record."},{id:"keyfield",type:"string",placeholder:'e.g. "id"',label:"Related Entity: Key Field",helptext:"The name of the primary key / id field on the related entity that will be used as the key to link the data."}),ie.getBaseReferenceProps&&(ae=ae.concat(ie.getBaseReferenceProps(u)))):ae.push({type:"helptext",html:"This Data Source Type does not support referencing."}),E=[{name:"Basic",props:A}];var oe=[{label:"Reference Setup",linkedComponent:u,deleteable:!1,props:ae}];ie&&(ie.getOverrideSearchProperties&&oe.push({label:"Search Route",linkedComponent:u,deleteable:!1,props:ie.getOverrideSearchProperties(u)}),oe.push({id:"batchfields",label:"Item Labels Route",linkedComponent:u,isChild:!0,deleteable:!1,propsFunction:function(e){return ie.getOverrideBatchProperties?ie.getOverrideBatchProperties(e):[]},noItemsFunction:ie.getOverrideBatchNoItemsFunction&&ie.getOverrideBatchNoItemsFunction(u),childrenFunction:ie.getOverrideBatchFieldChildrenFunction&&ie.getOverrideBatchFieldChildrenFunction(u)})),E.push({name:"Reference",tree:oe})}else if(-1!==t.inArray(R,[o.DOUBLE,o.CURRENCY,o.PERCENT]))E=[{name:"Basic",props:A.concat(H,Q)}];else if(R===o.INTEGER){for(M={id:"digits",label:"Length",type:"picklist",defaultValue:w?"9":"",picklistEntries:[]},w||M.picklistEntries.push({value:"",label:"(Use field default"+(S?": "+S.digits:"")+")"}),q=0;q<18;)M.picklistEntries.push({value:""+q,label:""+q}),q++;E=[{name:"Basic",props:A.concat(M)}]}else-1!==t.inArray(R,[o.TEXT,o.TEXTAREA,o.STRING])?(j={id:"length",label:"Length",type:"string",helptext:"The maximum number of characters that can be entered in this field",defaultValue:w?"255":""},!w&&S&&S.length&&(j.placeholder="Default: "+S.length),E=[{name:"Basic",props:S&&S.htmlFormatted?A.concat(j):A.concat(X,j)}],R===o.TEXTAREA&&E[0].props.push(Z)):-1!==t.inArray(R,[o.PHONE,o.URL,o.EMAIL])?E=[{name:"Basic",props:A.concat(X)}]:R===o.FORMULA?(K.label="Formula Return Type",K.required=!0,B=A.concat(K),[o.DOUBLE,o.CURRENCY,o.PERCENT].includes(c.attr("returntype"))&&B.push(H,Q),E=[{name:"Field",props:B},{name:"Formula",customPropFunction:function(e,t){e.css({margin:"10px"}).append(n.propertyRenderers.formula({id:"formula",location:"node",modelName:p.attr("id"),fieldState:t},t))}}]):R===o.ARRAY?(E=[{name:"Basic",props:A}],O.readonly=!0):E=[{name:"Basic",props:A}];E.push({name:"Default Items",props:N})}else(D=c.attr("displaytype")||S&&S.displaytype)&&A.push({label:"Display Type",type:"string",isStateless:!0,value:D,readonly:!0}),E=[{name:"Basic",props:A}];return ee(),E},getModelIdFieldProperty:function(){return{id:"idfields",filter:[o.INTEGER,o.NUMBER,o.PICKLIST,o.STRING,o.TEXT,o.UUID],label:"Id Field / Primary Key",maxSelected:5,modelProp:"id",noneSelectedText:"Select Field...",type:"multifield"}},getModelLabelProperties:function(){return[{id:"label",type:"string",label:"Model Label"},{id:"labelplural",type:"string",label:"Model Plural Label"}]},getModelLimitProperty:function(){return{id:"limit",type:"string",label:"Max # of records (Limit)",helptext:"The maximum number of data records to pull in to this Model, out of all data records that match the Model's Conditions."}},getModelNameFieldProperty:function(){return{id:"namefield",displayTypeFilter:[o.COMBOBOX,o.FORMULA,o.PICKLIST,o.STRING,o.TEXT,o.UUID],label:"Name Field",location:"attribute",storeAs:{type:"attribute"},maxSelected:1,modelProp:"id",noneSelectedText:"Select Field...",type:"multifield"}},getModelOrderByProperty:function(){return{id:"orderby",type:"string",label:"Fields to order records by",helptext:"How to order the data records pulled in to this Model, e.g. 'LastName DESC, FirstName' would order by LastName going from Z to A, then by FirstName going from A to Z (this is the ORDER BY clause of the generated SOQL statement)."}},getModelProperties:function(e,t){var i=e.state,a=n.getDataSourceFromModel(i),o=a.getDataSourceType();return o&&o.getModelProperties(e,t,a)},getModelQueryOnPageLoadProperty:function(e){var t=e.component,n=e.propViewer;return{id:"query",type:"boolean",label:"Query on Page Load",helptext:"If true, an initial query for data on this model will be performed upon page load.  If false, the model will not be queried on page load, meaning it will contain no data and must be queried by other means.",defaultValue:!0,onChange:function(e){var i=n.body.find("div:contains('"+s+"')").last(),a=i.parent().find("input");e?(i.removeClass("nx-basicfieldeditor-item-disabled"),a.prop("disabled",!1)):(i.addClass("nx-basicfieldeditor-item-disabled"),a.prop("disabled",!0)),t.save()}}},getModelTypeProperty:function(e){var t=e.component;return{id:"type",helptext:"Basic Models allow for reading, creating, and modifying data. Aggregate Models are read-only, and enable retrieval of grouped, aggregated data from Data Sources.",type:"picklist",label:"Model Behavior",picklistEntries:[{label:"Basic",value:""},{label:"Aggregate",value:"aggregate"}],defaultValue:"",onChange:function(){t.state.children("fields, groupby").empty(),t.save().refresh()}}},getPathToContentProperty:function(e){var n=e.component,a=n.state,r=a.is("model"),l=r?a:a.closest("model");return{id:"pathtocontent",type:"field",ignorePathToContent:!0,displayTypeFilter:[o.OBJECT,o.ARRAY],modelprop:!!r&&"id",modelName:!r&&l.attr("id"),label:"Path to Contents",helptext:"The path through the result of this GET request to the desired contents of this Model.",onChange:function(e,a,o,r){l.children("fields").children().each(function(){var n,a=t(this),o=a.attr("id");e&&i.startsWith(o,e)?n=o.substring(e.length+1):!e&&r&&(n=r+"."+o),a.attr("id",n)}),n.save().refresh()}}},getUnsavedChangesWarningProperty:function(e){var t,n=e.component.state,i=n&&"Ui-Only"===n.attr("datasource");return"yes"===n.closest("skuidpage").attr("unsavedchangeswarning")&&(t={id:"unloadwarningifunsavedchanges",type:"boolean",defaultValue:!i,label:"Prevent users from leaving page if this Model has unsaved changes",helptext:"This Skuid Page has been configured to prevent users from navigating away from it if any of its Models have unsaved changes. Uncheck this property to tell Skuid to ignore this particular Model when performing its check for unsaved changes."}),t}})}(skuid)},289:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core;t.extend(n,{getImageProperties:function(i){var a,o,r=i.component,l=i.propViewer,s=i.additionalOnRebuildProps,d=i.additionalOnRebuildAndRefresh,u=i.prefix||"",c=r.state,p=c.attr(u+"source"),h=i.modelName?[]:n.getDataSourceSelectionProps(r,l,{autoClearStateOnChange:!1}),f=c.attr("datasource"),m=function(i,a,o){var r=i&&n.getModelFromModelName(i),l=r?n.getDataSourceFromModel(r):e.dataSource.get(a||e.platform.getDefaultDataSourceName());return t.map(l.getImageSources(),function(e,t){if(o){if(o.needsRecordContext&&!e.needsRecordContext)return null;if(o.needsFieldContext&&!e.needsFieldContext)return null;if(o.noRecordContext&&e.needsRecordContext)return null}return{label:e.label,value:t,needsFieldContext:e.needsFieldContext,needsRecordContext:e.needsRecordContext,optionalRecordContext:e.optionalRecordContext,relatedObjectName:e.relatedObjectName,automaticFieldMappings:e.automaticFieldMappings,builderProps:e.builderProps,dataSource:l}})}(i.modelName,f,i.filter);if(m&&m.length&&(t.map(m,function(e){return e.value===p||null}).length||(c.attr(u+"source",m[0].value),p=m[0].value)),a=function(e,t){var n=e.filter(function(e){return e.value===t});return n&&n.length?n[0]:null}(m,p),r.currentImageSource=a,h.push({id:u+"source",label:"Image Source",type:"picklist",options:m,onChange:function(){r.refresh().rebuildProps(),d&&d()}}),a){if((a.needsRecordContext||a.optionalRecordContext)&&(i.modelName||h.push({id:"model",type:"model",label:"Model",onChange:function(){r.rebuildProps(),s&&s()}}),a.needsFieldContext))if(o=n.getModelFromModelName(i.modelName||c.attr("model")).attr("sobject"),a.automaticFieldMappings&&a.automaticFieldMappings.hasOwnProperty(o))c.attr("field","");else{var b={id:i.customFieldPropId||"field",type:"field",label:"Image Field",helptext:"A field that contains an Image ID",modelprop:"model"};a.relatedObjectName&&(b.displayTypeFilter="REFERENCE",b.refFilter=a.relatedObjectName),i.modelName?b.modelname=i.modelName:b.modelprop="model",h.push(b)}a.builderProps&&("function"==typeof a.builderProps?h=h.concat(a.builderProps(r,c,t.extend({},i,{dataSource:a.dataSource}))):t.each(a.builderProps,function(){h.push(this)}))}return h}})}(skuid)},290:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=e.utils.makeXMLDoc,a=[{label:"Alt",value:"alt"},{label:"Ctrl",value:"ctrl"},{label:"Command",value:"meta"},{label:"Shift",value:"shift"}],o={disabled:!0,label:"",value:""},r=function(e){return{disabled:!0,label:e,value:""}},l=[r("Letters/Numbers")],s=1;for("ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890".split("").forEach(function(e){l.push({label:e,value:e.toLowerCase()})}),l.push(o,r("Arrow Keys")),["Left","Up","Right","Down"].forEach(function(e){l.push({label:e,value:e.toLowerCase()})}),l.push(o,r("Special Keys")),t.each([{l:"Backspace/Delete",v:"backspace"},{l:"Delete Right",v:"del"},{l:"End",v:"end"},{l:"Home",v:"home"},{l:"Page Down",v:"pagedown"},{l:"Page Up",v:"pageup"},{l:"Tab",v:"tab "}],function(){l.push({label:this.l,value:this.v})}),l.push(o,r("Function Keys"));s<13;s++)l.push({label:"F"+s,value:"f"+s});n.getHotkeysCategory=function(e){e||(e={});var o=e.propViewer,r=e.useModelName,s=e.allowChildActions||!1,d=e.id||"hotkeys",u=e.label||"Hotkeys",c={id:"hotkey",deletetooltip:"Remove Hotkey",labelFunction:function(e){var n=e.attr("modifiers"),i=e.attr("key"),o="";return n&&t.each(n.split(","),function(e,n){t.each(a,function(){if(this.value===n)return o+=this.label+"+",!1})}),t.each(l,function(){if(this.value===i)return o+=this.label,!1}),o},defaultStateFunction:function(){return i('<hotkey modifiers="ctrl" key="n"/>')},propsFunction:function(e){var t=function(){e.refresh&&e.refresh()};return[{id:"modifiers",location:"attribute",type:"multipicklist",label:"Modifiers",helptext:"Choose one or more modifiers that must be pressed at the same time as the principal hot key",picklistEntries:a,defaultValue:"ctrl",noneSelectedText:"Select Modifiers...",onChange:function(n){n&&"shift"!==n||(e.state.attr("ignoretextinputs","true"),e.save().rebuildProps(o)),t()}},{id:"key",type:"picklist",label:"Key",picklistEntries:l,defaultValue:"S",onChange:t},{id:"ignoretextinputs",type:"boolean",label:"Ignore Hot Key if user is typing in input element",helptext:"If true, then this Hot Key will be ignored while a user is entering text into any text input area. This option should be used if the Hot Key would conflict with typical data entry Hot Keys, such as arrow keys, copy/paste, etc."}]}};return s&&(c.childrenFunction=function(e){return[n.getActionTreeNode({component:e,propViewer:o,useModelName:r,treeNode:{indent:1,invisibleParent:"actions"}})]},c.addtooltip="Add Hotkey Action"),{name:u,tree:{id:d,label:u,linkedComponent:e.linkedComponent,deleteable:!1,icon:"sk-icon-component-pack",addtooltip:"Add Hotkey",isChild:!0,children:[c]}}}}(skuid)},291:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=e.constants;function a(){e.events.publish("builder.colorcheck")}function o(e){return t.map(e,function(e,t){return[{label:t,value:t}]})}function r(e){e.refresh(),a()}function l(e){return[{id:"flexDirection",type:"picklist",label:"Main Axis",helptext:"The direction to align the divisions. X-axis will align in a row. Y-axis will stack on top each other.",picklistEntries:o(i.FLEX.DIRECTION),onChange:r.bind(this,e)},{id:"justifyContent",type:"picklist",label:"Justify Divisions",helptext:"Determines how the divisions will justify themselves along the main axis.",picklistEntries:o(i.FLEX.JUSTIFY),onChange:r.bind(this,e)},{id:"alignItems",type:"picklist",label:"Align Divisions",helptext:"Determines the position within the grid. For example, middle will ensure all items are centered along the cross axis.",picklistEntries:o(i.FLEX.ALIGNMENT),onChange:r.bind(this,e)}]}function s(e,n){return{type:"custom",label:"Change Order",renderProperty:function(i){var o=i.element,r=i.state,l=t("<button>").append('<div class="nx-picker-icon sk-icon fa-arrow-left">').addClass("nx-picker-icon-btn"),s=t("<button>").append('<div class="nx-picker-icon sk-icon fa-arrow-right">').addClass("nx-picker-icon-btn"),d=r.index(),u=r.parent(),c=u.children().length;d>0?l.click(function(){r.insertBefore(u.children().eq(d-1)),n.save().rebuildProps().refresh(),e.select().rebuildProps(),a()}):l.addClass("nx-disabled"),d<c-1?s.click(function(){d+2<c?r.insertBefore(u.children().eq(d+2)):d+2>=c&&r.appendTo(u),n.save().rebuildProps().refresh(),e.select().rebuildProps(),a()}):s.addClass("nx-disabled"),o.append(l,s)}}}t.extend(n,{getFlexProperties:l,getGridProperties:function(e){return[{id:"columngutter",type:"csssize",label:"Column Gutter Size",onChange:function(){e.refresh(),a()}},{id:"rowgutter",type:"csssize",label:"Row Gutter Size",onChange:function(){e.refresh(),a()}}]},getDivisionProperties:function(e,n,i){i=t.extend({addReorderProp:!0},i);var o=[],r=e.state,l=r.attr("behavior"),d={id:"behavior",type:"picklist",label:"Division Behavior",defaultValue:"flex",picklistEntries:[{label:"Flexible Width",value:"flex"},{label:"Fit to Content",value:"fit"},{label:"Specified Width",value:"specified"}],onChange:function(t){"flex"===t?(r.removeAttr("width"),r.attr({ratio:"1",minwidth:"100px"})):"fit"===t?r.removeAttr("width minwidth ratio"):"specified"===t&&(r.removeAttr("minwidth ratio"),r.attr("width","200px")),e.save().rebuildProps().refresh(),a()}},u={id:"minwidth",type:"csssize",label:"Minimum Width",onChange:function(){e.refresh(),a()}},c={id:"ratio",type:"string",label:"Flex Ratio",onChange:function(){e.refresh(),a()}},p={id:"verticalalign",type:"picklist",label:"Vertical Align",defaultValue:"top",picklistEntries:[{label:"Top",value:"top"},{label:"Center",value:"center"},{label:"Bottom",value:"bottom"}],onChange:function(){e.refresh(),a()}},h={id:"width",type:"csssize",label:"Width",onChange:function(){e.refresh(),a()}},f=s(e,n);return i.hideDivisionBehavior||o.push(d),l&&"flex"!==l?"specified"===l&&o.push(h):(i.hideFlexRatio||o.push(c),o.push(u)),o.push(p),i.addReorderProp&&o.push(f),o},getDivisionReOrderProp:s,getInkGridProperties:function(t){var n=this;return e.builder.desktop.getSpacingTokensAsPicklist().then(function(e){var i=l(t);return i.push({id:"columnGutter",type:"picklist",picklistEntries:e,label:"Column Gutter Size",onChange:r.bind(n,t)},{id:"rowGutter",type:"picklist",picklistEntries:e,label:"Row Gutter Size",onChange:r.bind(n,t)},{id:"fullWidth",type:"boolean",label:"Full width",helptext:"If true, the furthest left/right components will remove their margin and press up against the edge.",onChange:r.bind(n,t)}),i})},getInkDivisionProperties:function(e,n,a){a=t.extend({addReorderProp:!0},a);var l=[],d={id:"minWidth",type:"csssize",label:"Minimum Width",onChange:r.bind(this,e)},u={id:"maxWidth",type:"csssize",label:"Maximum Width",onChange:r.bind(this,e)},c={id:"ratio",type:"string",label:"Flex Ratio",onChange:r.bind(this,e)},p={id:"alignSelf",type:"picklist",label:"Align Self",helptext:"Allows custom aligning of this division.",picklistEntries:o(i.FLEX.ALIGNMENT),defaultValue:"auto",onChange:r.bind(this,e)},h=s(e,n);return a.hideFlexRatio||l.push(c),l.push(d),l.push(u),l.push(p),a.addReorderProp&&l.push(h),l}})}(skuid)},292:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=e.utils,a=i.makeXMLDoc,o=e.model,r=n.getConditionByName,l=n.getModelFromModelName,s=n.getFieldInfoFromCache,d=e.constants.DISPLAY_TYPES;function u(){return n.getPageRow().Id}function c(e){var t,n=e.closest("skootable, queue, eventview, deck, filterset");return n.is("skootable, queue, deck, filterset")?t=n.attr("model"):n.is("eventview")&&(t=n.attr("groupingmodel")),t}function p(e){return"__autofilter__start__"+e}function h(e){return"__autofilter__end__"+e}function f(e){return"__autofilter__nstart__"+e}function m(e){return"__autofilter__nend__"+e}function b(e){return"__autofilter__"+e}function v(e){e||(e={});var t,i,a,o=e.currentOperator,r=e.filterType,l=e.fieldName,u=e.modelName;return"multiselect"===r?(u&&l&&(i=!!(t=s(u,l))&&t.displaytype)&&(a=n.getValidOperators({type:"multiple",displayType:i})),a&&o&&o in a?o:i===d.MULTIPICKLIST?"includes":"in"):"="}function g(e,t){var n,o,s,d=e.attr("type"),u=e.attr("conditionfield")||e.attr("conditionField"),c=l(t).children("conditions");c.length&&("daterange"===d?(s=p(u),r(s,c).length||c.append(a("<condition/>").attr({type:"fieldvalue",field:u,operator:"gte",inactive:"true",enclosevalueinquotes:"false",name:s,state:"filterableoff",value:""}),a("<condition/>").attr({type:"fieldvalue",field:u,operator:"lte",inactive:"true",enclosevalueinquotes:"false",name:h(u),state:"filterableoff",value:""}))):"numericrange"===d?(s=f(u),r(s,c).length||c.append(a("<condition/>").attr({type:"fieldvalue",field:u,operator:"gte",inactive:"true",enclosevalueinquotes:"false",name:s,state:"filterableoff",value:""}),a("<condition/>").attr({type:"fieldvalue",field:u,operator:"lte",inactive:"true",enclosevalueinquotes:"false",name:m(u),state:"filterableoff",value:""}))):i.contains(d,"select")&&(n=b(u),o="multiselect"===d,r(n,c).length||c.append(a("<condition/>").attr({type:o?"multiple":"fieldvalue",field:u,operator:v({fieldName:u,modelName:t,currentOperator:e.attr("conditionoperator"),filterType:d}),inactive:"true",enclosevalueinquotes:"true",name:n,state:"filterableoff",value:""}))))}function y(e,n){var a,r,s,d=e.attr("type"),c=e.attr("conditionfield")||e.attr("conditionField"),v=l(n).children("conditions").children();v.length&&("daterange"===d?(s=p(c),r=h(c),t.removeCookie(o.getConditionCookieName(n,s,u())),t.removeCookie(o.getConditionCookieName(n,r,u())),v.each(function(){var e=t(this),n=e.attr("name");n!==s&&n!==r||e.remove()})):"numericrange"===d?(s=f(c),r=m(c),t.removeCookie(o.getConditionCookieName(n,s,u())),t.removeCookie(o.getConditionCookieName(n,r,u())),v.each(function(){var e=t(this),n=e.attr("name");n!==s&&n!==r||e.remove()})):i.contains(d,"select")&&(a=b(c),t.removeCookie(o.getConditionCookieName(n,a,u())),v.each(function(){var e=t(this);if(e.attr("name")===a)return e.remove(),!1})))}function C(e,n,a){var r,s,d,c,y,C,w=e.attr("type"),S=e.attr("conditionfield")||e.attr("conditionField"),k=l(n).children("conditions").children(),P=!1,x=!1,F=!1;k.length&&("daterange"===w?(C=p(a),y=h(a),d=p(S),r=h(S),k.each(function(){var e=t(this),i=e.attr("name"),a=i===C,l=i===y;(a||l)&&(a?(F=!0,e.attr("name",d)):l&&(x=!0,e.attr("name",r)),e.attr("field",S),t.removeCookie(o.getConditionCookieName(n,i,u())))}),F&&x||g(e,n)):"numericrange"===w?(C=f(a),y=m(a),d=f(S),r=m(S),k.each(function(){var e=t(this),i=e.attr("name"),a=i===C,l=i===y;(a||l)&&(a?(F=!0,e.attr("name",d)):l&&(x=!0,e.attr("name",r)),e.attr("field",S),t.removeCookie(o.getConditionCookieName(n,i,u())))}),F&&x||g(e,n)):i.contains(w,"select")&&(c=b(a),s=b(S),k.each(function(){var i=t(this);if(i.attr("name")===c)return P=!0,i.attr({name:s,field:S,operator:v({fieldName:S,modelName:n,currentOperator:e.attr("conditionoperator"),filterType:w})}),t.removeCookie(o.getConditionCookieName(n,c,u())),!1}),P||g(e,n)))}t.extend(n,{getEffectItemProperties:function(e){var n=e.state;e.modelName=c(n);var i=[{id:"action",type:"picklist",label:"Action",defaultValue:"activate",picklistEntries:[{label:"Activate and Set Value",value:"set"},{label:"Activate",value:"activate"},{label:"De-Activate",value:"deactivate"}],onChange:function(){e.refresh().rebuildProps()}},{id:"condition",label:"Model Condition",modelName:e.modelName,type:"condition",onChange:function(n,i){e.refresh(),i&&t.removeCookie(o.getConditionCookieName(e.modelName,i,u()))}}],a=n.parent().parent(),r=a&&a.is("source");return"set"===n.attr("action")&&(r&&"model"===a.attr("type")?i.push({id:"value",label:"Value to inject into Condition",type:"template",location:"attribute",displayAs:"input",defaultValue:"{{Id}}",onChange:function(){e.refresh()}}):r&&"metadata"===a.attr("type")||i.push({id:"value",label:"Value",type:"string",onChange:function(){e.refresh()}})),i},getFilterItemProperties:function(e){var i,a,l,p,h,f,m,v,w,S,k,P,x,F,T,N,A,E,I,M,R,L,O,D,B=e.state,V=B.attr("conditionsource"),q=B.attr("type"),U=B.attr("filteroffoptionlabel"),_=B.attr("conditionfield"),j="false"!==B.attr("affectcookies");function G(){"manual"===B.attr("labelmode")&&I.push(T)}switch("New Filter"===U&&B.attr("filteroffoptionlabel",""),V||(V=q?"manual":"auto"),"auto"===V&&_&&j&&(g(B,A),e.save()),e.modelName||(e.modelName=c(B)),A=e.modelName,_&&A&&(P=s(A,_),k=!!P&&P.displaytype),E=q+"_"+V,O={id:"type",type:"picklist",label:"Filter Type",defaultValue:"select",picklistEntries:[{label:"Date Range",value:"daterange"},{label:"Numeric Range",value:"numericrange"},{label:"Multi-select Option",value:"multiselect"},{label:"Select Option",value:"select"},{label:"Toggle",value:"toggle"}],onChange:function(t,n){B.removeAttr("conditionoperator"),B.empty(),e.element.children(".nx-childwrapper").empty(),"auto"===B.attr("conditionsource")&&"toggle"!==n&&y(B,A),"toggle"===t&&"toggle"!==n&&B.attr("conditionsource","manual"),"auto"===B.attr("conditionsource")&&"false"!==B.attr("affectcookies")&&B.attr("conditionfield")&&g(B,A),e.save().refresh().rebuildProps()}},D={id:"filtermethod",type:"picklist",label:"Filter Method",defaultValue:"server",helptext:'By default, filters are performed server-side; all records in the database that fit the criteria of the filter will be returned. To filter only the records present within the Skuid model, select "Client" instead.',picklistEntries:[{label:"Server",value:"server"},{label:"Client",value:"client"}],onChange:function(){e&&(e.rebuildProps&&e.rebuildProps(),e.renderProperties&&e.renderProperties())}},l={id:"condition",label:"Model Condition to Affect",helptext:"The Condition on this Model whose values this Filter will affect by default -- unless specified otherwise in the Effects of this Filter's options.",modelName:A,type:"condition",onChange:function(n,i){e.refresh(),i&&t.removeCookie(o.getConditionCookieName(e.modelName,i,u())),e.rebuildProps()}},p=t.extend({},l,{helptext:"The Condition on this Model whose values this Filter will affect by default -- unless specified otherwise in the Effects of this Filter's options. Only conditions with multiple values are valid for a multi-select filter type.",filter:function(e){return"multiple"===e.attr("type")}}),m={id:"conditionsource",type:"picklist",label:"Condition Source",defaultValue:"auto",picklistEntries:[{label:"Auto Generate Conditions",value:"auto"},{label:"Specify Existing Conditions",value:"manual"}],onChange:function(t,n){n&&n!==t&&("auto"===t&&B.attr("conditionfield")&&"false"!==B.attr("affectcookies")?g(B,A):"manual"===t&&y(B,A),e.save().refresh().rebuildProps())}},v={id:"conditionsource",type:"picklist",label:"Condition Source",defaultValue:"auto",picklistEntries:[{label:"Auto Generate Conditions",value:"auto"},{label:"Specify Existing Conditions",value:"manual"}],onChange:function(t,n){n&&n!==t&&("auto"===t&&B.attr("conditionfield")&&"false"!==B.attr("affectcookies")?g(B,A):"manual"===t&&y(B,A),e.save().refresh().rebuildProps())}},w={id:"conditionfield",type:"field",label:"Numeric Field",displayTypeFilter:[d.INTEGER,d.NUMBER,d.DOUBLE,d.PERCENT,d.CURRENCY],addFieldToModel:!1,modelname:A,onChange:function(t,n,i,a){a&&"[No Field Selected]"!==a?(C(B,A,a),e.save()):(g(B,A),e.save()),e.refresh()}},M={id:"conditionsource",type:"picklist",label:"Pick Options and Condition(s)",defaultValue:"auto",picklistEntries:[{label:"Automatically",value:"auto"},{label:"Manually",value:"manual"}],onChange:function(t,n){n&&n!==t&&("auto"===t&&B.attr("conditionfield")&&"false"!==B.attr("affectcookies")?g(B,A):"manual"===t&&(y(B,A),"auto"===B.attr("labelmode")&&B.removeAttr("labelmode")),B.removeAttr("conditionoperator"),e.save().refresh().rebuildProps())}},f={id:"conditionfield",type:"field",label:"Date/Datetime Field",displayTypeFilter:[d.DATE,d.DATETIME],addFieldToModel:!1,modelname:A,onChange:function(t,n,i,a){a&&"[No Field Selected]"!==a?(C(B,A,a),e.save()):(g(B,A),e.save()),e.refresh()}},R={id:"conditionfield",type:"field",label:"Filter Field",displayTypeFilter:[d.PICKLIST,d.MULTIPICKLIST,d.REFERENCE],addFieldToModel:!1,modelname:A,onChange:function(t,n,i,a){a&&"[No Field Selected]"!==a?(C(B,A,a),e.save()):(g(B,A),e.save()),a!==t&&B.children("conditions").remove(),e.refresh().rebuildProps()}},L={id:"startcondition",label:"Begin Model Condition",modelName:A,type:"condition",onChange:function(n,i){e.refresh(),i&&t.removeCookie(o.getConditionCookieName(A,i,u()))}},S={id:"endcondition",label:"End Model Condition",modelName:A,type:"condition",onChange:function(n,i){e.refresh(),i&&t.removeCookie(o.getConditionCookieName(A,i,u()))}},i={id:"affectcookies",label:"Remember last-selected filter value",helptext:"Skuid will remember each user's last filter value selection.",type:"boolean",defaultValue:!0,onChange:function(t){B.attr("conditionfield")&&"auto"===B.attr("conditionsource")&&(!0===t?g(B,A):y(B,A),e.save()),e.refresh().rebuildProps()}},h={id:"createfilteroffoption",label:'Create "None Selected" Option',helptext:"If checked, an option which turns off this filter will be added to the options list.",type:"boolean",onChange:function(){e.refresh().rebuildProps()}},x={id:"filteroffoptionlabel",label:'"None Selected" Option Text',type:"string",helptext:'If desired, you can change the text of the "Filter Off" option, to be something like "Any Status", "Any Record Type", etc.',defaultValue:"",onChange:function(){e.refresh()}},F={id:"labelmode",label:"Show Label above Filter",type:"picklist",helptext:"If desired, an always-visible label will be shown above this filter.",defaultValue:"no",picklistEntries:[{label:"Yes, use Field's label",value:"auto"},{label:"Yes, use custom label",value:"manual"},{label:"No",value:"no"}],onChange:function(){e.rebuildProps()}},T={id:"label",label:"Filter Label",type:"string",onChange:function(){e.refresh()}},a={id:"autocompthreshold",label:"Switch Filter to Autocomplete at X Items",type:"number",defaultValue:"25",helptext:"By default, Select Option filters will become Autocompletes when the count of items in their list reaches 25. Change this amount if you'd like that to happen at a higher or lower number."},N={id:"maxheight",label:"Maximum Height (Optional)",type:"csssize"},E){case"toggle_manual":return[O,T,i];case"daterange_auto":return I=[O,D,m,f,F],G(),I.push(x),I;case"daterange_manual":return F.picklistEntries[0].label="Yes, use Condition's Field's label",I=[O,D,m,i,L,S,F],G(),I.push(x),I;case"numericrange_auto":return I=[O,D,v,w,F],G(),I.push(x),I;case"numericrange_manual":return F.picklistEntries[0].label="Yes, use Condition's Field's label",I=[O,v,i,L,S,F],G(),I;case"multiselect_auto":return I=[O,D,M,R],P&&k&&I.push(n.getConditionOperatorPropObj(e,{id:"conditionoperator",label:"Filter Condition Operator",conditionType:"multiple",fieldMetadata:P,handleChange:function(t){var n=b(B.attr("conditionfield")),i=r(n,A);i&&i.length&&(i.attr("operator",t),e.save())},defaultValue:k===d.MULTIPICKLIST?"includes":"in"})),I.push(i,F),G(),I.push(x),I;case"multiselect_manual":return B.attr("condition")?F.picklistEntries[0].label="Yes, use Condition's Field's label":F.picklistEntries.splice(0,1),I=[O,D,M,p,i,F],G(),I.push(x),I;case"select_manual":return B.attr("condition")?F.picklistEntries[0].label="Yes, use Condition's Field's label":F.picklistEntries.splice(0,1),I=[O,D,M,l,i,a,F],G(),I.push(h),"true"===B.attr(h.id)&&I.push(x),I;default:return I=[O,D,M,R,i,N],k!==d.REFERENCE&&I.push(a),I.push(F),G(),I.push(x),I}},removeModelConditionsForAutoFilter:y,getFilterDefaultModelName:c,adjustFieldForAutoFilterConditions:C,addModelConditionsForAutoFilter:g,getSelectAutoFilterConditionName:b,getDateRangeAutoFilterEndConditionName:h,getDateRangeAutoFilterStartConditionName:p,getNumericRangeAutoFilterStartConditionName:f,getNumericRangeAutoFilterEndConditionName:m})}(skuid)},293:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=e.utils,a=i.escapeSelector,o=i.makeXMLDoc,r=e.constants,l=r.DISPLAY_TYPES,s=r.FIELD_TYPES,d=[1,2,3,4,5,6,7,8,9,10];t.extend(n,{getFieldProperties:function(r,u,c,p){var h,f,m,b,v,g,y,C,w,S,k,P,x,F,T,N,A,E,I,M,R,L,O,D,B,V,q,U,_,j,G,X,W,H,z,Y,K,$,Q,J,Z,ee,te,ne,ie,ae,oe,re,le,se,de,ue,ce,pe,he,fe,me,be,ve,ge,ye=n.getModelFromModelName(u),Ce=!!ye&&"aggregate"===ye.attr("type"),we=r.state,Se=we.attr("type"),ke=we.attr("id"),Pe=!!ke&&n.getFieldInfoFromCache(u,ke),xe=!!Pe&&Pe.uiOnly,Fe=!!Pe&&Pe.displaytype,Te=n.getSObjectNameFromModelName(u),Ne='The desired width of this column, relative to the total width available to its containing table. This is an Approximate width, as the actual width may be different depending on how much room the HTML table has available to it. A percentage (e.g. 25%) is recommended, but a pixel amount, e.g. "200px" is also possible --- however, do NOT mix and match pixels/percents among columns in the table.';if(Pe&&(Pe.dataSourceName=ye.attr("datasource")),se={id:"allowordering",type:"boolean",label:"Allow Sorting"},ce={id:"hideable",type:"boolean",label:"Allow Users to Show/Hide Column",defaultValue:!1,onChange:function(){r.state.attr("showbydefault")||r.state.attr("showbydefault","true"),r.save().refresh().rebuildProps(p)}},de={id:"showbydefault",type:"boolean",label:"Show Column by Default",defaultValue:!0},pe={id:"showlengthcounter",type:"boolean",label:"Show Length Counter",defaultValue:!1},Se===s.COMBO||Se===s.CHILDREL||Se===s.IMAGE||Fe===l.ARRAY)me=[{id:"label",type:"template",label:"Label",onChange:function(){r.refresh()}}],Se===s.IMAGE?(me.push({id:"url",type:"template",label:"Image URL"},{id:"alt",type:"template",label:"Alternate Text"},{id:"height",type:"csssize",label:"Height",onChange:function(){r.rebuildProps()}}),(we.attr("height")||we.attr("columnwidth"))&&me.push({id:"fill",type:"boolean",label:"Fill Container",helptext:"Whether or not the image should fill the entire space of the element containing it."})):me.push({id:"template",type:"template",label:"Template",onChange:function(){r.refresh()}},{id:"allowhtml",type:"boolean",label:"Allow HTML",defaultValue:!1,onChange:function(){r.refresh()}},{id:"valuehalign",type:"picklist",label:"Horizontal Alignment",helptext:"(Optional) The alignment of the field value within its container. Defaults to Left.",picklistEntries:[{label:"Left (default)",value:""},{label:"Right",value:"right"}],defaultValue:""}),Fe!==l.ARRAY&&Se!==s.IMAGE&&Se!==s.CHILDREL&&me.push({id:"readonly",type:"boolean",label:"Read-only",defaultValue:!1,onChange:function(){r.rebuildProps()}}),"skootable"===c&&(me.push({id:"columnwidth",type:"csssize",label:"Column Width",helptext:Ne,onChange:function(){r.rebuildProps()}}),Se===s.COMBO&&(me.push(t.extend({},se,{onChange:function(){r.rebuildProps()}})),"true"===we.attr("allowordering")&&me.push({id:"orderfield",type:"field",label:"Sort Field",showUiOnlyFields:!1,sobject:Te})),me.push(ce)),"true"!==we.attr("readonly")&&Se===s.COMBO&&"basicfieldeditor"===c&&(me.push({id:"editmodebehavior",type:"picklist",label:"Edit Mode behavior",defaultValue:"autopopup",picklistEntries:[{label:"Show default Popup",value:"autopopup"},{label:"Show custom Popup",value:"custompopup"}],onChange:function(){r.rebuildProps()}}),"custompopup"===we.attr("editmodebehavior")&&(B=e.builder.desktop.makePopupBuilder({title:"Template Field Edit Mode Popup Properties",linkedComponent:r}),0===(V=we.children("editmodepopup")).length&&((be=we.children("template").text()).length&&(L=i.extractFieldsFromTemplate(be,{ignoreGlobals:!0})),V=B.defaultStateGenerator({id:"editmodepopup",title:we.children("label").text()||"Template Field",width:"450",childComponents:o('<basicfieldeditor showsavecancel="false" mode="edit" model="'+u+'"><columns><column width="100%"><sections><section title=""><fields>'+(L&&L.length?'<field id="'+L.join('"/><field id="')+'"/>':"")+"</fields></section></sections></column></columns></basicfieldeditor>")}),we.append(V)),r.editModePopupComponent=n.componentFactory(V,B,!0),me.push({id:"editmodepopup",type:"customaction",label:"Configure Edit Mode Popup",icon:"sk-bi-popup",customAction:function(){r.editModePopupComponent.select()}}))),Se!==s.CHILDREL&&Fe!==l.ARRAY||me.push({id:"delimiter",type:"string",label:"Delimiter"}),A=[{name:"Basic",props:me}];else{for(q=[],Fe&&(Fe===l.PICKLIST?(q.push({label:"Standard",value:""}),q.push({label:"Radio Buttons",value:"RADIO_BUTTONS"})):Fe===l.MULTIPICKLIST?(q.push({label:"Standard",value:""}),q.push({label:"Checkboxes",value:"CHECKBOXES"})):Fe===l.REFERENCE?"skuid__Image__c"===Pe.ref?q.push({label:"File Upload",value:""}):(q.push({label:"Auto-Complete",value:""}),q.push({label:"Picklist",value:"REFPICK"})):Fe===l.DATE?q.push({label:"Standard",value:""}):Fe!==l.STRING&&Fe!==l.TEXT||(q.push({label:"Standard",value:""}),q.push({label:"Password",value:"PASSWORD"}))),q.length||q.push({label:"Standard",value:""}),q.push({label:"Custom (run a Snippet)",value:"CUSTOM"}),j="mobilefield"===c?{id:"id",type:"field",label:"Field",modelname:u,filter:function(e,t){return 0!==(e.displaytype!==l.REFERENCE?ye.children("fields,groupby").find('field[id="'+a(t+e.id)+'"]'):ye.children("fields,groupby").find('field[id^="'+a(t+e.rel+".")+'"]')).length},onChange:function(e){r.element.attr("data-field",e),r.state.removeAttr("type"),r.save().refresh().renderProperties(p)}}:{id:"id",type:"readonly",label:"Field Id"},ge={id:"type",type:"picklist",label:"Field Renderer",defaultValue:"",picklistEntries:q,onChange:function(){r.save().refresh().rebuildProps(p)}},g={id:"name",type:"readonly",label:"Field Alias Name"},H={id:"label",type:"template",location:"node",label:"Custom Label",onChange:function(){r.refresh()}},ne={id:"placeholder",displayAs:"input",label:"Placeholder",location:"attribute",placeholder:Pe?Pe.placeholder:null,type:"template"},Z={id:"optionsource",type:"picklist",label:"Option Source",defaultValue:"",picklistEntries:[{label:"Automatic",value:""},{label:"Model",value:"model"}],onChange:function(){we.removeAttr("displaytemplate searchtemplate"),void 0!==we.attr("optionmodel")&&we.removeAttr("optionmodel"),r.refresh().rebuildProps(p)}},J={id:"optionmodel",type:"model",label:"Option Model",entryFilter:function(t){var i=!!Pe&&Pe.ref,a=n.getSObjectNameFromModelName(t.attr("id")),o=e.dataSource.get(t.attr("datasource")),r=o.dataSourceType;return r.getEntitySet?i===r.getEntitySet(a,o.metadata).entityType:i===a},onChange:function(e,t){!0!==t&&(we.removeAttr("displaytemplate searchtemplate"),r.refresh().rebuildProps(p))}},D={id:"displaytemplate",type:"template",label:"Display Template",modelprop:"optionmodel",fieldContext:Pe||null,fieldId:ke,location:"attribute",helptext:'The fields from related records to display, specified using Merge syntax, e.g. "{{Name}} - {{Industry}}" would show the Name and Industry of related Accounts, if this is the AccountId field. Fields can be easily added using the Merge-Field Picker to the right.'},re={id:"searchtemplate",type:"template",label:"Search Template",modelprop:"optionmodel",fieldContext:Pe||null,fieldId:ke,location:"attribute",helptext:'The fields from related records to display on search, specified using Merge syntax, e.g. "{{Name}} - {{Industry}}" would show the Name and Industry of related Accounts, if this is the AccountId field. Fields can be easily added using the Merge-Field Picker to the right.'},I={id:"columnwidth",type:"string",label:"Column Width",helptext:Ne},N={id:"summaries",location:"node",type:"multipicklist",storeAs:{type:"node",name:"summary"},label:"Column Summaries",helptext:"Choose one or more summary type(s) for this field. Summaries are displayed at the bottom of a table.",picklistEntries:[{label:"Sum",value:"sum"},{label:"Average",value:"avg"},{label:"Min",value:"min"},{label:"Max",value:"max"},{label:"Median",value:"med"}],noneSelectedText:"Select Summary Type(s)...",onChange:function(){r.rebuildProps(p)}},M={id:"countBlanks",type:"boolean",label:"Count Blanks in Summaries",helptext:"Set this to true if you  want blank values to be counted in summary calculations."},ae={id:"readonly",type:"boolean",label:"Read-only",readonly:U=!!Pe&&(Pe.calculated||!(Pe.createable||Pe.editable)),defaultValue:U},oe={id:"required",type:"boolean",label:"Required",defaultValue:!!Pe&&Pe.required,readonly:!!Pe&&Pe.required||!!Pe&&Pe.calculated,onChange:function(){Fe&&(Fe===l.PICKLIST||Fe===l.REFERENCE&&"REFPICK"===we.attr("type"))&&r.save().refresh().rebuildProps(p)}},h={id:"addnoneoption",type:"boolean",label:'Add "None" option',helptext:'When a Picklist is required, Skuid normally does not add a "--None--" option at the beginning of the list of options, and instead will auto-select the first available Picklist option if none has yet been selected. There is then no way for the user to go back to "--None--". This is sometimes undesirable and can lead to bad data, because users will not realize that an option was auto-selected and therefore will not select an accurate option. Checking this property will add a "--None--" option at the top of the list, which will be selected by default.',defaultValue:!1,onChange:function(){r.rebuildProps(p)}},$={id:"nonelabel",type:"template",location:"attribute",displayAs:"input",label:"None Option Label",placeholder:e.$L("select_option_none")},ve={id:"tokenizesearch",type:"boolean",label:"Tokenize autocomplete search",defaultValue:!1,helptext:"Search separately on each term, rather than requiring a field to contain a match on the whole search string entered."},Y={id:"maxdisplaycharacters",type:"string",label:"Max Characters to Display",helptext:"(Read Mode only) The maximum number of characters that will be displayed for this textarea in Read mode before the text is curtailed with '...'",placeholder:"URL"===Fe?"40":""},O={id:"displayrows",type:"string",label:"Rows to Display",helptext:"(Optional, Edit Mode only) The number of visible text lines for this textarea. If blank, the textarea will auto-expand to its content.",validator:function(e){return!!(e&&e>0&&i.isNumber(e))||"Value must be a number greater than 0."}},R={id:"decimalplaces",type:"picklist",label:"# of Decimal Places",helptext:"(Optional) The number of decimal places / digits to show in Read mode. Defaults to the number of decimal places configured in the Salesforce field's metadata.",picklistEntries:[{label:"(Use field metadata)",value:""}],defaultValue:""},_={id:"valuehalign",type:"picklist",label:"Horizontal Alignment",helptext:"(Optional) The alignment of the field value within its container.",picklistEntries:[{label:"Left (default)",value:""},{label:"Right",value:"right"}],defaultValue:""},he={id:"snippet",type:"snippet",label:"Render Snippet Name",helptext:'The name of a Skuid Snippet to run that will serve as a "Custom Renderer". Snippets are named JavaScript functions, and can be created by going to the Resources tab and creating a new JavaScript Resource of type "Inline (Snippet)". If your Resource Name is "CustomDatepicker", then you should enter "CustomDatepicker" here.'},ue={id:"showhelp",type:"boolean",label:"Show Inline Help",defaultValue:!0,helptext:"If true, Inline Help Text for this field will be shown."},oe={id:"required",type:"boolean",label:"Required",onChange:function(){Fe&&(Fe===l.PICKLIST||Fe===l.REFERENCE&&"REFPICK"===we.attr("type"))&&r.save().refresh().rebuildProps(p)}},ee={id:"pagesize",type:"picklist",label:"Visible Rows",defaultValue:"5",picklistEntries:[{label:"5",value:"5"},{label:"10",value:"10"},{label:"25",value:"25"},{label:"50",value:"50"},{label:"Show All",value:"all"}]},Pe&&Pe.required&&(oe.defaultValue=!0),Pe&&(Pe.required||Pe.calculated)&&(oe.readonly=!0),W=0;W<9;W++)R.picklistEntries.push({value:W+"",label:W+""});if(!ke)return A=[{name:"Basic",props:[j]}];Fe&&i.startsWith(Fe,l.DATE)&&(m=[{id:"monthpicker",type:"boolean",defaultValue:!1,label:"Show Month Picker",helptext:"If true, a month picker will be displayed, allowing for quickly jumping to a specific month."},{id:"yearpicker",type:"boolean",defaultValue:!1,label:"Show Year Picker",helptext:"If true, a year picker will be displayed, allowing for quickly jumping to a specific year.",onChange:function(){r.rebuildProps(p)}}],"true"===we.attr("yearpicker")&&(te=d.concat(20,30,40,50,60,70,80,90,100),m.push({id:"yearpickermin",type:"picklist",label:"Year Picker Lower Bound",defaultValue:"c-10",picklistEntries:t.map(te,function(e){return{value:"c-"+e,label:"Selected - "+e}}).concat(t.map(te,function(e){return{value:"-"+e,label:"Today - "+e}}))},{id:"yearpickermax",type:"picklist",label:"Year Picker Upper Bound",defaultValue:"c+10",picklistEntries:t.map(te,function(e){return{value:"c+"+e,label:"Selected + "+e}}).concat(t.map(te,function(e){return{value:"+"+e,label:"Today + "+e}}))})),Fe===l.DATETIME&&(b=m.slice(0)).push({id:"minuteincrement",type:"picklist",label:"Minute Picker Increment",defaultValue:"5",picklistEntries:t.map([1,5,10,15,20,30],function(e){return{value:e=""+e,label:e}})})),Fe&&Fe===l.MULTIPICKLIST&&(K=[{id:"maxselected",type:"string",label:"Max selectable items",placeholder:"(No maximum)",helptext:"The maximum number of picklist items that a user can select. By default, the user can select as many items as they want."}],"CHECKBOXES"!==Se&&(z={id:"selectedlist",type:"picklist",label:'Show "# items selected" after what # items',picklistEntries:[{label:'0 (Always show "# items selected")',value:"0"}].concat(t.map(d.concat([11,12,13,14,15]),function(e){var t=e+"";return{label:t,value:t}})),defaultValue:"3",helptext:["Until the user selects more than this number of items, ","the Multiselect Picklist widget will display the selected values, ",'e.g. "Alpha, Beta, Gamma", but when the user selects more than this number of items, ','the widget will start displaying "# items selected", to conserve space on the screen. '].join("")},K.push(z))),X=Fe===l.TEXTAREA&&Pe&&!0===Pe.htmlFormatted,"skootable"===c?(C=[j,H,ae,oe,I,_,ge,ce],w=[j,H,ne,ae,oe,Y,I,_,ge,ce,pe],k=[j,H,N,ae,oe,I,R,_,ge,ce],P=[j,H,N,ae,oe,I,_,ge,ce],x=[j,H,ae,oe,I,_,ge,ce],F=[j,H,ae,oe,I].concat(K,_,ge,ce),T=[j,H,ae,ge,_,I,ce],S=[j,H,ne,ae,oe,ce,pe],X?S.splice(2,1):S.push(O),S.push(Y,I,_,ge),y=[C,w,S,k,P,x,F,T],ie={TEXT:w,TEXTAREA:S,COMBOBOX:w,ANYTYPE:w,STRING:w,URL:w,REFERENCE:x,DEFAULT:C,MULTIPICKLIST:F,BOOLEAN:T,INTEGER:P,DOUBLE:k,PERCENT:k,CURRENCY:k,NUMBER:k},f={REFERENCE:[Z,D,re,ee],DATE:m,DATETIME:b,DEFAULT:[]},E=["TEXT","DOUBLE","INTEGER","PERCENT","CURRENCY","DATE","DATETIME","EMAIL","PICKLIST","MULTIPICKLIST","COMBOBOX","REFERENCE","STRING"],"true"===we.closest(c).attr("sortonclient")?t.inArray(Pe.displaytype,E)>-1&&t.each(y,function(e,t){t.splice(2,0,se)}):!xe&&Pe&&Pe.sortable&&t.each(y,function(e,t){t.splice(2,0,se)}),we.children("summaries").children("summary").length>0&&(P.splice(4,0,M),k.splice(4,0,M))):(C=[j,H,ue,ae,oe,_,ge],w=[j,H,ue,ne,ae,oe,Y,_,ge,pe],S=[j,H,ue,ne,ae,oe],X?S.splice(3,1):S.push(O),S.push(Y,_,ge,pe),ie={TEXTAREA:S,ANYTYPE:w,TEXT:w,STRING:w,COMBOBOX:w,URL:w,REFERENCE:[j,H,ue,ae,oe,_,ge],BOOLEAN:[j,H,ue,ae,_,ge],MULTIPICKLIST:[j,H,ue,ae,oe].concat(K,_,ge),DOUBLE:[j,H,ue,ae,oe,R,_,ge],PERCENT:[j,H,ue,ae,oe,R,_,ge],CURRENCY:[j,H,ue,ae,oe,R,_,ge],DEFAULT:C},f={REFERENCE:[Z,D,re,ee],DATE:m,DATETIME:b,DEFAULT:[]}),(Fe===l.PICKLIST||Fe===l.REFERENCE&&"REFPICK"===Se)&&(Q=[],Pe&&Pe.required||"true"===we.attr("required")?(Q.push(h),"true"===we.attr("addnoneoption")&&Q.push($)):Q.push($),Array.prototype.splice.apply(ie[Fe]||ie.DEFAULT,[5,0].concat(Q))),"model"===we.attr("optionsource")&&f.REFERENCE.push(J),we.attr("type")||f.REFERENCE.push(ve),me=(ie[Fe]||ie.DEFAULT).slice(0),"basicfieldeditor"===c&&Pe&&(Pe.inlineHelpText?void 0===we.attr("showhelp")&&we.attr("showhelp","true"):me.splice(2,1)),v=(f[Fe]||f.DEFAULT).slice(0),"CUSTOM"===we.attr("type")&&me.push(he),Ce?(me=((ie={TEXTAREA:[j,g,H,I,Y,_,ce],DOUBLE:[j,g,H,I,R,_,ce],PERCENT:[j,g,H,I,R,_,ce],CURRENCY:[j,g,H,I,R,_,ce],DEFAULT:[j,g,H,I,_,ce]})[Fe]||ie.DEFAULT).slice(0),G=(fe=ye.children("groupby").children('[name="'+a(we.attr("name"))+'"]'))&&fe.length,"true"===we.attr("hideable")&&me.splice(me.indexOf(ce)+1,0,de),G?Pe&&Pe.sortable&&me.push(se):(me.push(N),we.children("summaries").children("summary").length>0&&me.push(M),me.push(se)),me.push(ge),"CUSTOM"===we.attr("type")&&me.push(he),A=[{name:"Basic",props:me}]):Fe===l.REFERENCE?(le=[{label:"Search Properties",linkedComponent:r,deleteable:!1,props:v}],Pe.referenceTo&&1===Pe.referenceTo.length&&le.push(n.getSearchFieldsTreeItem({sobject:Pe.ref,modelName:u,linkedComponent:r,isReference:!0})),A=[{name:"Basic",props:me},{name:"Search",tree:le}]):A=[{name:"Basic",props:me},{name:"Advanced",props:v}],Ce||Fe!==l.REFERENCE||(function(){var t,n,a,l,s,d=ye&&e.dataSource.getDataSource(ye.attr("datasource")),u=d&&d.dataSourceType,c=i.inPlatform(e.constants.NATIVE),p=e.dataSource.DataSourceType.prototype.getNameFieldURLForReferenceField;t=[{label:"No link",value:"none"},{label:"Custom URL",value:"customurl"}],u&&u.getNameFieldURLForReferenceField&&u.getNameFieldURLForReferenceField!==p&&t.splice(0,0,{label:"Data source default",value:"datasourcedefault"}),c&&(t.splice(2,0,{value:"page",label:"Skuid Page"}),t.splice(3,0,{value:"route",label:"Route"}));var h={id:"redirecttype",type:"picklist",label:"Navigation Type",options:t,onChange:function(){we.removeAttr("page route"),r.rebuildProps()}};n=we.attr("redirecttype"),l={name:"Link",tree:s={id:"urlparameters",label:"Link Options",linkedComponent:r,deleteable:!1,props:a=[h]}},c&&"page"===n&&a.push(e.platform.builder.getPageSelectProperty({id:"page",label:"Skuid Page",valueTemplates:{page:"{{{name}}}"}})),c&&"route"===n&&a.push(e.platform.builder.getRouteSelectProperty({id:"route",label:"Skuid Route",platform:[e.constants.NATIVE]})),"none"!==n&&"datasourcedefault"!==n&&n?("customurl"===n&&(a.push({id:"rooturl",label:"URL",defaultValue:"",type:"template",location:"attribute",displayAs:"input"}),a.push({id:"window",type:"picklist",label:"Open URL in",defaultValue:"self",picklistEntries:[{label:"Current window",value:"self"},{label:"New tab",value:"blank"}]})),s.children=[{id:"param",labelFunction:function(e){var t=e.attr("key")||"[No Key]",n=e.attr("value");return i.isUndefined(n)&&(n="[No Value]"),t+": "+n},invisibleParent:"params",invisibleParentLabel:"Parameters",indent:1,addtooltip:"Add Parameter",deletetooltip:"Remove Parameter",propsFunction:function(){return[{id:"key",type:"text",label:"Key"},{id:"value",type:"text",label:"Value"}]},defaultStateFunction:function(){return o("<param/>")},onChange:function(){r.rebuildProps()}}],A.push(l)):A.push(l)}(),A.push({name:"Filters",tree:{id:"filters",label:"Lookup Filters",linkedComponent:r,deleteable:!1,icon:"sk-bi-filters",isChild:!0,children:[{id:"filter",addtooltip:"Add New Lookup Filter",labelFunction:function(e){return n.getConditionDisplayString(e)},defaultStateFunction:function(){return o('<filter type="fieldvalue" operator="=" enclosevalueinquotes="true"/>')},propsFunction:function(t){var i=t.state,a=e.dataSource.get(Pe.dataSourceName).getConditionSourceProperties(t,{renderMode:"propsonly",url:Pe.searchRoute});if(i.attr("operator")||i.attr("operator","="),t.isLookupFilterCondition=!0,!a||0===a.length){var o=n.getMetadataForField(t,{modelName:u});if(!o&&i.attr("field")){var r=n.getSObjectForField(t);if(-1===r.indexOf(","))return n.getDataSourceFromModel(ye).getEntityMetadata({entities:r,ignoreMetadataOverrides:!0}).then(function(){n.getMetadataForField(t,{modelName:u})||i.removeAttr("field"),t.rebuildProps(p)}),[]}a=[n.getConditionFieldPropObj(t,{sobject:n.getSObjectForField(t),modelName:u,showObjectPickerIfPolymorphic:!0,handleChange:function(){t.rebuildProps(p)}}),n.getConditionOperatorPropObj(t,{fieldMetadata:o})]}return a.concat(n.getConditionValueProperties(t,{handleRefresh:function(){t.rebuildProps(p)},modelName:u,validTypes:["fieldvalue","multiple","blank","userinfo","param","modelmerge","dependent"]}))}}]}}))}return"skootable"===c&&"false"!==we.attr("hideable")&&me.indexOf(de)<0&&me.splice(me.indexOf(ce)+1,0,de),"skootable"!==c&&A[0].props.push(n.coreProps.cssClassProp()),A.push(n.getRenderingCategory({component:r,propViewer:p,model:u,showOnHideDataBehaviorProp:!0,showEnableDisableConditions:!0,showMessageWhenDisabledProp:!0})),A},getErrorBehaviorProperties:function(e){var t,n,i=[],a=e.state,o=!0;return void 0===a.attr("showerrorsinline")&&(o=!1),t={id:"showerrorsinline",type:"boolean",label:"Show Errors Inline",helptext:"If true, field level errors will display next to the fields themselves.",defaultValue:o,onChange:function(){e.rebuildProps()}},n={id:"showerroronhover",type:"boolean",label:"Show Inline Error Only on Hover",helptext:"If true, field level error text will only be displayed when the user hovers over the field.",defaultValue:!1},i.push(t),"true"===a.attr("showerrorsinline")&&i.push(n),i}})}(skuid)},294:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core;t.extend(n,{getEventLabelByName:function(t){var n=e.events.get(t);return n?n.getLabel():t},getSubscribableEventEntries:function(){var n=[];return Array.prototype.push.apply(n,e.events.getRegisteredGlobalEvents()),t.each(e.events.getRegisteredComponentEvents(),function(e,t){Array.prototype.push.apply(n,t)}),n.filter(function(e){return e.isSubscribable()}).map(function(e){return{value:e.getName(),label:e.getLabel()}})}})}(skuid)},295:function(e,t,n){"use strict";!function(e){var t="custom-props",n="custom-prop",i="id",a="value",o="type",r="dst",l=e.utils.isUndefined,s=e.builder.core,d=e.utils.makeXMLDoc;function u(e,a,o,l,s){var d=o.state,u=e.id,b=e.type,v=e.onChange;!function(e,n){var i=n.children(t);if(!i.length)return void m(e,n);i.attr(r)!==e.name&&(!function(e){e.remove(t)}(n),m(e,n))}(a,d),function(e,t,a,o){var r=c(e,t);if(r)return void h(r,a,o);!function(e,t,a,o){var r=function(e,t,a){var o=p(n);return o.attr(i,e),h(o,t,a),o}(t,a,o),l=f(e);r.appendTo(l)}(e,t,a,o)}(d,u,l,b),function(e,t,n){if(e)e(t,n)}(v,l,s),o.save()}function c(e,t){var i=f(e),a=i&&i.children(n+"[id='"+t+"']");if(a.length)return a}function p(e){return d("<"+e+"/>")}function h(e,t,n){e.attr(o,n),e.attr(a,t)}function f(e){return e.children(t)}function m(e,n){(function(e){var n=p(t);return n.attr(r,e.name),n})(e).appendTo(n)}function b(e,t){var n=c(e,t);if(n)return n.attr(a)}e.$.extend(s,{createDSTSpecificProp:function(e,t,n){var i=n.state,a=e.id,o=e.type;!function(e,t,n){var i=e.defaultValue;if(!l(i)){var a=b(n.state,e.id);l(a)&&u(e,t,n,i)}}(e,t,n);var r={id:t.name+"-"+a,label:e.label,type:o,isStateless:!0,defaultValue:e.defaultValue,helptext:e.helptext,onChange:function(i,a){u(e,t,n,i,a)},valueFunction:function(){return b(i,a)}};return e.picklistEntries&&(r.picklistEntries=e.picklistEntries),r}})}(skuid)},296:function(e,t,n){"use strict";!function(e){var t=e.builder.core,n=e.utils.makeXMLDoc;t.getContextCategory=function(e){e||(e={});var i=e.state,a=e.model,o=e.modelprop,r=function e(n){var i,a=n.parent();if(a.length){if(a[0]&&"skuidpage"===a[0].nodeName)return!1;if(i=t.getComponentFromState(a)){var o=i.builder;return o&&(o.givesContext||o.givesMultipleContextRows)?i:e(a)}return e(a)}return!1}(i);if(!r&&0===i.children("conditions").children("condition").length)return!1;var l=t.getComponentFromState(i),s=r.getContextModelName&&r.getContextModelName(),d=r.givesMultipleContextRows,u=l&&l.builder&&l.builder.supportsMultipleContextRows,c=!0===d&&!0===u;return{name:"Context",tree:{id:"conditions",label:"Context Conditions",deleteable:!1,isChild:!0,linkedComponent:e.linkedComponent,children:[{id:"condition",labelFunction:function(e){var n=e.attr("field")||"Id",i=t.operatormap[e.attr("operator")||""].name,a=e.attr("mergefield")||"Id",o="contextrows"===e.attr("type")?"rows":"row";return n+" of record"+(c?"(s)":"")+" "+i+" "+a+" of "+o+" in context."},defaultStateFunction:function(){var e=n('<condition type="'+(c?"contextrows":"contextrow")+'" field="Id" mergefield="Id" />');return c&&e.attr("operator","in"),e},propsFunction:function(e){e.isContextCondition=!0;var n,r=[];return o?n=i.attr(o):a&&(n=a),!!n&&(r.push({id:"field",type:"field",label:"Field",helptext:"The field on this component's model that will be checked against a field on the row in context.",modelname:n,useAliasNamesIfAggregate:!0,onChange:function(){e.refresh()}}),s&&r.push({id:"mergefield",type:"field",label:"Merge Field",helptext:"The field on the row in context that will be checked against a field on this component's model.",modelname:s,onChange:function(){e.refresh()}}),r.push(t.getConditionOperatorPropObj(e,{fieldMetadata:t.getMetadataForField(e,{modelName:n})})),r)}}]}}}}(skuid)},297:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=e.utils,a=i.makeXMLDoc,o=e.constants.DISPLAY_TYPES,r=n.isDistanceQueryable,l=n.getMetadataForField,s="type",d="value",u="name",c="field",p="sourceparam",h="sourcetype",f="operator",m="model",b="datasourceuserinfo",v="fieldvalue",g="multiple",y="param",C="userinfo",w="modelmerge",S="blank",k="join",P="dependent",x="search",F="boolean";function T(e,i){i=i||{};var a=e.state,u=i.modelname||i.modelName,p=!1;a.attr(s)===x&&(p=!0,a.attr(c,"Id"));var h={id:c,type:"field",label:"Field",readonly:p,onChange:function(c,p,h){n.updateState(a,{key:"fieldtargetobjects",value:h});var f=l(e),m=!!f&&f.displaytype;a.attr(s)===v&&(m===o.BOOLEAN?"false"!==a.attr(d)&&a.attr(d,"true"):m===o.INTEGER?a.attr(d,"0"):-1!==t.inArray(m,[o.CURRENCY,o.DOUBLE])?a.attr(d,"0.0"):-1!==t.inArray(m,[o.DATE,o.DATETIME])&&a.attr(d,"")),r(m)||a.removeAttr("fieldfunction locationsource latitudefield longitudefield locationnovaluebehavior"),n.determineQuotedness(e,{modelName:u}),e.save().refresh(),i.handleChange&&i.handleChange(),e.rebuildProps()}};return i.sobject?h.sobject=i.sobject:i.modelprop?h.modelprop=i.modelprop:u&&(h.modelname=u),i.addFieldToModel&&(h.addFieldToModel=!0),i.showObjectPickerIfPolymorphic&&(h.showObjectPickerIfPolymorphic=!0),h}t.extend(n,{getConditionFieldPropObj:T,getConditionFieldProperties:function(e,n){n=n||{};var i=e.state,a=T(e,n),o=[a],u=n.fieldMetadata||l(e),c=u&&u.displaytype;if(r(c)){var p=!1,h=function(e,t,n){(n||i.attr(e)!==t)&&(i.attr(e,t),p=!0)};if(h("fieldfunction","DISTANCE"),i.attr("units")||h("units","mi",!0),i.attr(d)||h(d,"5",!0),h("enclosevalueinquotes","false"),-1===t.inArray(i.attr(f),["lt","gt"])&&h(f,"lt",!0),p)return e.save(),n.handleChange&&n.handleChange(),n.handleRefresh&&n.handleRefresh(),!1;o.push({id:"fieldfunction",defaultValue:"DISTANCE",type:"picklist",picklistEntries:[{value:"DISTANCE",label:"DISTANCE"}],required:!0,readonly:!0,label:"Field Function"})}return e.isSubcondition&&i.parent().closest("condition").attr(s)===k&&(a.sobject=i.parent().closest("condition").attr("joinobject")),o},getConditionOperatorPropObj:function(e,i){i||(i={});var a=e.state,o=i.id||f,l=i.label||"Operator",d=i.defaultValue||"=",u=i.conditionType||a.attr(s),c=i.fieldMetadata||!1,p=!!c&&c.displaytype,h=n.getValidOperators({type:u,displayType:p}),m=i.validOperators,b={id:o,type:"picklist",label:l,defaultValue:d,onChange:function(t){e.save().refresh(),i.handleChange&&i.handleChange(t)}};return r(p)?b.picklistEntries=[{label:"<",value:"lt"},{label:">",value:"gt"}]:m&&m.length?b.picklistEntries=t.map(m,function(e){var t=h[e];if(t)return{label:t.name,value:e}}):b.picklistEntries=t.map(h,function(e,t){return{label:e.name,value:t}}),b},getConditionParameterProperties:function(e,n){n=n||{};var a,o=e.state,r=o.closest("model"),l={id:p,label:"URL Merge Parameter Name",onChange:function(){o.attr(h)!==y&&(o.attr(h,y),e.save()),e.refresh(),n.handleChange&&n.handleChange()}};function d(e){if(e){var t,n=i.extractFieldsFromTemplate(e,{ignoreGlobals:!0});if(n&&n.length){for(t=n.length-1;t>=0;t--)"."===n[t]&&n.splice(t,1);a?Array.prototype.push.apply(a,n):a=n}}}return n.url?d(n.url):"readwrite"===r.attr(s)?r.children("methods").first().children().each(function(){d(t(this).attr("endpoint"))}):d(r.attr("endpoint")),a&&a.length?(l.type="picklist",l.picklistEntries=t.map(a.sort(),function(e){return{value:e,label:e}})):(l.type="readonly",l.value="This Model's Service URL does not contain any Merge Parameters.",l.isStateless=!0),[l]},getConditionValueProperties:function(u,c){c=c||{};var p,h,x,T,N,A=u.state,E="filterablerequired"===A.attr("state"),I="fixed"===A.attr("state"),M=c.picklistEntries,R=M&&M.length,L=c.modelName,O=n.getDataSourceFromModelName(L).dataSourceType,D=O&&O.getUserInfoProperties?O.getUserInfoProperties():[],B=c.isDefaultValueField,V=B?"defaultValue":d,q=B?"defaultvaluetype":s,U={modelName:L},_=[],j=i.inPlatform(e.constants.NATIVE)?"Skuid":"Salesforce";h=!!(p=c.fieldMetadata?c.fieldMetadata:l(u,U))&&p.displaytype,x=r(h),_.push({label:"Single specified value",value:v},{label:"Multiple specified values",value:g},{label:"Field from another model",value:w},{label:"Page/URL parameter value",value:y},{label:j+" user attribute",value:C},{label:"Data Source user attribute",value:b},{label:"True or False",value:F}),B||_.push({label:"None - blank value",value:S},{label:"Result of subquery",value:k},{label:"Another field from row",value:P}),T=x?[v,y,S,w]:R?[v]:c.validTypes,(E||I)&&(N=T.indexOf(S))>-1&&T.splice(N);var G={id:q,type:"picklist",label:(x?"Distance value ":"")+"Content",defaultValue:v,picklistEntries:_,onChange:function(e,i){var o=l(u,U),r=o?o.displaytype:null;if(i===v&&e===g&&(A.attr(V)||B))A.append(a("<values/>").append(a("<value/>").text(A.attr(V))));else if(B){var s=A.children("values");s&&s.length&&s[0].remove()}else A.empty();A.attr(V,""),B||A.attr(f)in n.getValidOperators(e,r)||A.attr(f,-1!==t.inArray(e,[g,k])?"in":"="),A.removeAttr("enclosevalueinquotes model joinfield joinobject"),e===w&&A.attr(m,n.getFirstModel().attr("id")),e===S&&A.attr(V,"null"),n.determineQuotedness(u,U),u.save().refresh(),c.handleChange&&c.handleChange(),c.handleRefresh&&c.handleRefresh()}};if(T){var X=[];t.each(G.picklistEntries,function(){-1!==t.inArray(this.value,T)&&X.push(this)}),G.picklistEntries=X}var W={id:V,type:"string",label:"Value",onChange:function(){u.refresh(),c.handleChange&&c.handleChange()},metadata:p};R&&(W.type="picklist",W.picklistEntries=t.map(M,function(e){return{value:(e=t(e)).attr("value"),label:e.attr("label")}}));var H,z,Y,K={id:V,type:"boolean",label:"Value",onChange:function(){u.refresh(),c.handleChange&&c.handleChange()},metadata:p},$={id:V,type:"string",label:"Parameter",onChange:function(){u.refresh(),c.handleChange&&c.handleChange()}},Q={id:"userinfotype",type:"picklist",label:j+" User attribute",helptext:"An attribute about the running User to merge in as the value for the selected field, e.g. the User's first name, username, or user id.",defaultValue:"userid",picklistEntries:t.map(n.userinfomap,function(e,t){return{label:e.label,value:t}}),onChange:function(){u.refresh(),c.handleChange&&c.handleChange()}},J={id:"userinfotype",type:"picklist",label:"Data Source User attribute",helptext:"An attribute about the Model Data Source User to merge in as the value for the selected field, e.g. the User's first name, username, or user id.",picklistEntries:D,defaultValue:D.length&&D.find(function(e){return!0===e.defaultValue}).value,onChange:function(){u.refresh(),c.handleChange&&c.handleChange()}},Z={id:"mergefield",type:"field",label:"Source Field",modelprop:m,defaultValue:"Id",displayTypeFilter:function(e,t){var i=u.state.attr(m);return!!i&&n.isFieldInModel(i,t)},onChange:function(){u.refresh(),c.handleChange&&c.handleChange()}},ee={id:m,type:"model",label:"Source Model",helptext:"The Model whose first row's specified Merge Field's value will be used as the merge value for this Condition.",onChange:function(){u.refresh(),c.handleChange&&c.handleChange(),c.handleRefresh&&c.handleRefresh()}},te={id:"joinobject",dataSourceName:L?n.getModelFromModelName(L).attr("datasource"):null,type:"sobject",label:"Join Object",helptext:"The Object to join in when performing a Semi-Join Sub-Select, e.g. Case in 'WHERE Id in (SELECT ContactId FROM Case)' ",onChange:function(){u.refresh(),c.handleChange&&c.handleChange(),c.handleRefresh&&c.handleRefresh()}},ne={id:"joinfield",type:"field",label:"Join Field",helptext:"The field to join when performing a Semi-Join Sub-Select, e.g. ContactId in 'WHERE Id in (SELECT ContactId FROM Case)' ",sobject:A.attr("joinobject"),displayTypeFilter:O.joinFieldDisplayTypeFilter?O.joinFieldDisplayTypeFilter:[o.ID,o.REFERENCE],onChange:function(){u.refresh(),c.handleChange&&c.handleChange()}},ie={id:"logic",type:"string",label:"Subcondition Logic",onChange:function(){u.refresh()}},ae={id:"values",location:"node",type:"multiitem",storeAs:{type:"node",name:"value"},label:"Values",onChange:function(){u.refresh(),c.handleChange&&c.handleChange()},metadata:p},oe={id:"depfield",type:"field",label:"Depends On",modelname:L,onChange:function(){u.refresh()}},re=[G,$],le=[G,ee,Z],se={};return se[v]=[G,W],se[g]=[G,ae],se[y]=re,se[C]=[G,Q],se[b]=[G,J],se[w]=le,se[F]=[G,K],B||(se[S]=[G],se[k]=[G,te,ne,ie],se[P]=[G,oe],le.push({id:"novaluebehavior",type:"picklist",label:"If no row in Source Model, then...",helptext:"Specifies the action to take if no rows are returned by the source model.",defaultValue:"deactivate",picklistEntries:[{label:"Deactivate this Condition",value:"deactivate"},{label:"Abort this Model's Query",value:"noquery"}]}),u.isRenderCondition||re.push({id:"novaluebehavior",type:"picklist",label:"If this Parameter is not provided, then...",helptext:"Specifies the action to take if the specified URL Parameter is not provided.",defaultValue:"",picklistEntries:[{label:"Set its value to Blank",value:""},{label:"Deactivate this Condition",value:"deactivate"},{label:"Abort this Model's Query",value:"noquery"}]})),H=se[A.attr(q)||v],x&&(z={id:"locationsource",type:"picklist",label:"Comparison Location Source",helptext:'For "DISTANCE from Location" queries, you must specify a source Latitude and Longitude defining the Location to compare against. The Latitude and Longitude can be retrieved from fields on another Model, or from Page/URL Parameters.',defaultValue:w,picklistEntries:[{label:"Page/URL parameter values",value:y},{label:"Running user's location",value:"userlocation"},{label:"Fields from another model",value:w}],onChange:function(e){A.removeAttr("locationmodel latitudefield longitudefield"),e===w&&A.attr("locationmodel",n.getFirstModel().attr("id")),u.save().refresh(),c.handleChange&&c.handleChange(),c.handleRefresh&&c.handleRefresh()}},H.push({id:"units",type:"picklist",label:"Units",defaultValue:"mi",picklistEntries:[{label:"Miles",value:"mi"},{label:"Kilometers",value:"km"}],onChange:function(){u.refresh(),c.handleChange&&c.handleChange()}},z),(Y=A.attr(z.id)||z.defaultValue)===w?H.push({id:"locationmodel",type:"model",label:"Location Source Model",helptext:"The Model whose first row's specified Latitude / Longitude Fields' values will be used as the source for this DISTANCE Condition.",onChange:function(){u.refresh(),c.handleChange&&c.handleChange(),c.handleRefresh&&c.handleRefresh()}},{id:"locationnovaluebehavior",type:"picklist",label:"If no row in Location Source Model, then...",helptext:"Specifies the action to take if no rows are returned by the Location Source Model.",defaultValue:"deactivate",picklistEntries:[{label:"Deactivate this Condition",value:"deactivate"},{label:"Abort this Model's Query",value:"noquery"}]},{id:"latitudefield",type:"field",label:"Latitude Source Field",modelprop:"locationmodel",displayTypeFilter:[o.STRING,o.DOUBLE,o.NUMBER],onChange:function(){u.refresh(),c.handleChange&&c.handleChange()}},{id:"longitudefield",type:"field",label:"Longitude Source Field",modelprop:"locationmodel",displayTypeFilter:[o.STRING,o.DOUBLE,o.NUMBER],onChange:function(){u.refresh(),c.handleChange&&c.handleChange()}}):Y===y?H.push({id:"latitudefield",type:"string",label:"Latitude Parameter",onChange:function(){u.refresh(),c.handleChange&&c.handleChange()}},{id:"longitudefield",type:"string",label:"Longitude Parameter",onChange:function(){u.refresh(),c.handleChange&&c.handleChange()}},{id:"locationnovaluebehavior",type:"picklist",label:"If Latitude / Longitude Parameters are not provided, then...",helptext:"Specifies the action to take if either the Latitude or Longitude URL Parameters are not provided.",defaultValue:"deactivate",picklistEntries:[{label:"Deactivate this Condition",value:"deactivate"},{label:"Abort this Model's Query",value:"noquery"}]}):"userlocation"===Y&&(H.push({id:"locationnovaluebehavior",type:"picklist",label:"If user's location cannot be determined, then...",helptext:"Specifies the action to take if the user's location cannot be determined, which may happen if the user decides to deny the browser permission to access location data.",defaultValue:"deactivate",picklistEntries:[{label:"Deactivate this Condition",value:"deactivate"},{label:"Abort this Model's Query",value:"noquery"}]},{id:"locationchangebehavior",type:"boolean",label:"Re-query Model when user's location changes",helptext:"If true, then whenever the user's location changes by more than a certain amount, this Model will be requeried.",defaultValue:!0,onChange:function(){c.handleChange&&c.handleChange(),c.handleRefresh&&c.handleRefresh()}}),"false"!==A.attr("locationchangebehavior")&&H.push({id:"locationdelta",type:"string",label:"Minimum change in location before re-query (in meters)",helptext:"The user's location must change by at least this many meters before this Model will be re-queried.",defaultValue:"100",validator:function(e){return!!(e&&e>0&&i.isNumber(e))||"Value must be a number greater than 0."}}))),H},getConditionStateProperties:function(e,t){t=t||{};var a=e.state,o=a.attr("state"),r="filterablerequired"===o,l="fixed"===o,s={id:"state",type:"picklist",label:"Condition State",defaultValue:"",picklistEntries:l?[{label:"Fixed, Required",value:"fixed"}]:r?[{label:"Filterable, Required",value:"filterablerequired"}]:t.validStates||[{label:"Always On",value:""},{label:"Filterable Default On",value:"filterableon"},{label:"Filterable Default Off",value:"filterableoff"},{label:"Always Off",value:"off"}],readonly:r||l,onChange:function(i){if(i&&"filterableon"!==i?a.attr("inactive","true"):a.attr("inactive","false"),"filterableon"!==i&&"filterableoff"!==i)a.removeAttr(u);else if(!a.attr(u)&&(a.attr(c)||a.attr(p))){for(var o=a.attr(c)||a.attr(p),r=o,l=1;n.getConditionByName(r,a.closest("model").attr("id")).length;)r=o+""+l++;a.attr(u,r)}e.save().refresh(),t.handleChange&&t.handleChange(),t.handleRefresh&&t.handleRefresh()}},d={id:u,type:"string",label:"Condition Name",helptext:"A unique name for this Condition, allowing it to be affected by Filters.",validator:function(t){return n.validators.conditionName(t,e)},onChange:function(i,o){n.publishStateEvent({type:"model.condition.nameChange",modelId:a.closest("model").attr("id"),oldName:o,newName:i}),e.save().refresh(),t.handleChange&&t.handleChange()}};return i.startsWith(o,"filterable")?[s,d]:[s]}})}(skuid)},298:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=e.utils.makeXMLDoc,a=n.determineQuotedness;function o(o){var r=o.propViewer,l=o.component,s=o.model,d=o.showOnHideDataBehaviorProp,u=o.showMessageWhenDisabledProp,c=o.conditionsNodeId||"renderconditions",p=o.conditionsNodeLabel||"Render Conditions",h=o.conditionsNodeIcon||"sk-bi-renderconditions",f=o.doLabel||"Render",m=o.undoLabel||"Don't render",b=o.conditionNodeId||"rendercondition",v=o.addConditionNodeLabel||"Add new Render Condition",g=o.conditionsIndent||0;return{id:c,label:p,deleteable:!1,icon:h,isChild:!0,linkedComponent:l,propsFunction:function(e){var t=[],n=e.state,i=n.attr("logictype");if(i||(i="and",n.attr("logictype",i)),t.push({id:"logictype",type:"picklist",label:f+" if...",defaultValue:"and",picklistEntries:[{label:"ALL Conditions are met",value:"and"},{label:"ANY Conditions are met",value:"or"},{label:"Custom logic is met",value:"custom"}],onChange:function(t,i){if("custom"===t&&!n.attr("logic")){var a=n.children(),o=[];a.length&&(a.each(function(e){o.push(e+1)}),n.attr("logic",o.join(" AND ")),e.save())}t&&i&&e.rebuildProps(r)}}),"custom"===i&&t.push({id:"logic",type:"string",label:"Condition Logic",helptext:"Custom logic for grouping and applying these Conditions, e.g. ((1 AND 2) OR (3 AND 4))."}),d){""===n.attr("onhidedatabehavior")&&n.attr("onhidedatabehavior","cancel"),t.push({id:"onhidedatabehavior",type:"picklist",label:"If hidden, Model field changes should be...",helptext:"When this Field is hidden by Conditional Rendering, by default any changes to this Field's Model data will be left in the Model. You may want to have hidden data changes cancelled, so that the changes are not saved along with visible data changes.",defaultValue:"keep",picklistEntries:[{label:"Retained in Model",value:"keep"},{label:"Cancelled",value:"cancel"}]})}return u&&t.push({id:"message",isNew:!0,type:"string",label:"Message to show when disabled",helptext:"When disabled, the user will be shown this message to explain why."}),t},children:[{id:b,indent:g,addtooltip:v,labelFunction:function(e){return n.getConditionDisplayString(e)},defaultStateFunction:function(){return i("<"+b+' type="fieldvalue" operator="=" enclosevalueinquotes="true"/>')},propsFunction:function(i){i.isRenderCondition=!0;var o,l,d,u,c=i.state,p=c.attr("fieldmodel"),h=c.attr("datasource"),b=[],v={},g=!1,y=function(e){return"modelproperty"===e||"rowproperty"===e},C=c.attr("sourcetype")||"fieldvalue",w=y(C),S="rowproperty"===C,k=c.attr("sourceproperty"),P=c.attr("value"),x=function(){i.refresh()},F=function(e,t){c.attr(e,t),g=!0},T=[{label:"Model field value",value:"fieldvalue"},{label:"Model property",value:"modelproperty"},{label:"Row property",value:"rowproperty"},{label:"Page/URL Parameter value",value:"param"},{label:"Running User attribute",value:"userinfo"},{label:"Snippet returns true",value:"snippet"}],N={id:"sourcetype",type:"picklist",label:"Source Type",defaultValue:"fieldvalue",picklistEntries:T,onChange:function(e,t){t&&e!==t&&(y(e)&&(y(t)&&c.removeAttr("sourceproperty"),c.removeAttr("field value operator")),a(i,v),i.save().refresh().rebuildProps(r))}},A={id:"fieldmodel",type:"model",label:"Source Model",helptext:"The Model to use when evaluating this Condition. If there is a row in context that is in this Model, Conditions will be evaluated against the context row. Otherwise, Conditions will be evaluated against this Model's first row.",onChange:function(){i.refresh().rebuildProps(r)}},E={id:"nosourcerowbehavior",type:"picklist",label:"If no rows in Model...",helptext:"Specifies the action to take if no rows are returned by the source model.",defaultValue:"deactivate",picklistEntries:[{label:"Ignore this Condition",value:"deactivate"},{label:"Skip other Conditions, and "+f.toLowerCase(),value:"skipandrender"},{label:"Skip other Conditions, and "+m.toLowerCase(),value:"skipandnorender"}]},I={id:"sourceparam",type:"string",label:"Parameter Name",onChange:x},M={id:"sourceuserinfotype",type:"picklist",label:"User attribute",helptext:"The name of the property on the running User's record to compare against",defaultValue:"profilename",picklistEntries:[],onChange:x},R=t.map(e.dataSource.map(),function(e,t){var n=e.getDataSourceType();if(n&&n.getUserInfoProperties)return{value:t,label:t}}),L=R.length&&R[0].value,O={id:"datasource",type:"picklist",picklistEntries:R,defaultValue:L,label:"Data Source"},D={id:"sourcedatasourcetypeuserinfo",type:"picklist",label:"Data Source user attribute",helptext:"The name of the property on the running User's record for a particular Data Source to compare against",onChange:x},B={id:"operator",type:"picklist",label:"Is",picklistEntries:[{value:"=",label:"True"},{value:"!=",label:"False"}],onChange:x},V={id:"value",type:"string",label:"Feature Name",helptext:"The name of the feature we want to check for",onChange:x},q={id:"permissionnamespace",type:"picklist",label:"Permission Namespace",helptext:"The namespace of the permission we want to check for"},U={id:"value",type:"picklist",label:"Permission Name",helptext:"The name of the permission we want to check for",onChange:x},_={id:"sourceproperty",type:"picklist",label:"Model Property",defaultValue:"hasRows",picklistEntries:[{value:"data.length",label:"# of rows in Model"},{value:"hasNoRows",label:"Doesn't have data rows"},{value:"hasRows",label:"Has data rows"},{value:"hasChanged",label:"Has unsaved changes"},{value:"label",label:"Model label"},{value:"labelPlural",label:"Model plural label"}],onChange:function(e){"hasRows"===e||"hasNoRows"===e?c.removeAttr("type enclosevalueinquotes operator value"):("hasChanged"===e&&(c.attr("value")||c.attr({type:"fieldvalue",value:"true",enclosevalueinquotes:"false"})),a(i,v)),i.save().refresh().rebuildProps(r)}},j={id:"sourceproperty",type:"picklist",label:"Row Property",defaultValue:"isNew",picklistEntries:[{value:"hasChanged",label:"Has unsaved changes"},{value:"isNew",label:"Is new record"},{value:"isSaved",label:"Is existing record in database"},{value:"isCloned",label:"Is unsaved clone of existing record"},{value:"isMarkedForDeletion",label:"Is marked for deletion"}],onChange:function(e){["hasChanged","isCloned","isMarkedForDeletion"].includes(e)?c.attr("value")||c.attr({type:"fieldvalue",value:"true",enclosevalueinquotes:"false"}):c.removeAttr("type enclosevalueinquotes operator value"),a(i,v),i.save().refresh().rebuildProps(r)}},G={id:"sourcesnippet",type:"snippet",label:"Snippet Name",helptext:"The name of the Skuid JavaScript Snippet to run to determine whether to render.",onChange:x};if((h=h||L)&&(N.picklistEntries.push({label:"Data Source user attribute",value:"datasourceuserinfo"}),(l=(o=e.dataSource.getDataSource(h))&&o.getDataSourceType()).getUserInfoProperties&&(D.picklistEntries=l.getUserInfoProperties({renderCondition:!0}),t.each(D.picklistEntries,function(e,t){if(t.defaultValue)return D.defaultValue=t.value,!1}))),e.utils.inPlatform(e.constants.NATIVE)&&(T.splice(5,0,{label:"Running User has permission",value:"userhaspermission"}),U.picklistEntries=[{value:"configure_self",label:"Configure Self"},{value:"configure_site",label:"Configure Site"}],q.picklistEntries=[{label:"Skuid",value:"skuid"}]),"feature"===C&&T.unshift({label:"Feature is enabled",value:"feature"}),t.each(n.userinfomap,function(e,t){M.picklistEntries.push({label:t.label,value:e})}),p)u=p;else if(s)F("fieldmodel",u=s);else{var X=n.getLastSelectedModelComponent();F("fieldmodel",u=X&&X.state?X.state.attr("id"):n.getAllModelsInPage().children().first().attr("id"))}v.modelName=u,w&&(k||F("sourceproperty",k=S?j.defaultValue:_.defaultValue),S&&["isCloned","hasChanged","isMarkedForDeletion"].includes(k)?(void 0===P&&F("value","true"),"false"!==c.attr("enclosevalueinquotes")&&F("enclosevalueinquotes","false")):!S&&["data.length","hasChanged"].includes(k)&&(void 0===P&&"hasChanged"===k&&F("value","true"),"false"!==c.attr("enclosevalueinquotes")&&F("enclosevalueinquotes","false"))),g&&(g=!1,i.save().refresh()),b.push(N),d=n.getMetadataForField(i,{modelName:u});var W={showObjectPickerIfPolymorphic:!0,addFieldToModel:!0,handleChange:function(){i.rebuildProps(r)}};W.modelName=c.attr("fieldmodel")?c.attr("fieldmodel"):u;var H=[A],z={feature:[V,B],fieldvalue:H,modelproperty:[A,_],rowproperty:[A,j],param:[I],userinfo:[M],userhaspermission:[q,U,B],datasourceuserinfo:[O,D],snippet:[G]};return s&&s===u||H.push(E),H.push(n.getConditionFieldPropObj(i,W)),t.each(z[C],function(){b.push(this)}),w&&["hasRows","hasNoRows","hasChildRows","hasNoChildRows","isNew","isSaved"].includes(k)||["feature","snippet","userhaspermission"].includes(C)?b:(b.push(n.getConditionOperatorPropObj(i,{fieldMetadata:d})),b.concat(n.getConditionValueProperties(i,{handleRefresh:function(){i.rebuildProps(r)},handleChange:function(){i.refresh()},modelName:u,validTypes:["isCloned","hasChanged","isMarkedForDeletion"].includes(k)?["fieldvalue"]:["fieldvalue","multiple","blank","userinfo","param"]})))}}]}}t.extend(n,{getRenderingCategory:function(e){e||(e={});var n=e.showEnableDisableConditions||!1,i=e.showSelectedConditions||!1,a=[o(t.extend({},e,{showOnHideDataBehaviorProp:e.showOnHideDataBehaviorProp,showMessageWhenDisabledProp:!1}))];return n&&a.push(o(t.extend({},e,{showOnHideDataBehaviorProp:!1,showMessageWhenDisabledProp:!0,conditionsNodeId:e.enableConditionsNodeId||"enableconditions",conditionsNodeLabel:"Enable Conditions",doLabel:"Enable",undoLabel:"Disable",conditionNodeId:"condition",addConditionNodeLabel:"Add new Enable Condition"}))),i&&a.push(o(t.extend({},e,{showOnHideDataBehaviorProp:!1,showMessageWhenDisabledProp:!1,conditionsNodeId:e.selectedConditionsNodeId||"selectedconditions",conditionsNodeLabel:"Selected Conditions",doLabel:"Enable",undoLabel:"Disable",conditionNodeId:"condition",addConditionNodeLabel:"Add new Selected Condition"}))),{name:"Rendering",tree:a}}})}(skuid)},299:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=function(){return e.builder.desktop},a=e.utils,o=a.makeXMLDoc,r=n.getModelFromModelName,l=n.getActionLabel,s=t.each,d={tap:"Click",swipeeither:"Swipe",swipe:"Swipe",swipeleft:"Swipe Left",swiperight:"Swipe Right",press:"Press",onrender:"On Render"},u=e.constants.EVENT_SCOPES;function c(s){s||(s={});var d,u=s.treeNode||{},h=s.propViewer,f=s.useModelName,m=s.linkedComponent,b=s.refreshLinkedComponent,g=u.indent||s.indent||0;return d={id:s.customNodeId||"action",addtooltip:s.addtooltip||"Add Action",deletetooltip:s.deletetooltip||"Remove Action",refreshLinkedComponent:b,linkedComponent:m,indent:g,icon:function(e){return"branch"===e.attr("type")?"fa-code-fork":"fa-cog"},labelFunction:function(e){return l(e,s.additionalActionOptions)},labelEventHandlers:{dblclick:function(e){var t=e.state.attr("type");i()&&("drawer"===t?i().showDrawerBuilder({parentComponent:e,getContextModelName:function(){return f}}):"openSlidingPanel"===t||"toggleSlidingPanel"===t?i().showSlidingPanelBuilder({parentComponent:e,getContextModelName:function(){return f}}):"showPopup"===t&&i().showPopupBuilder({parentComponent:e,getContextModelName:function(){return f},useAfterCloseActions:!0}))}},defaultStateFunction:function(){return o('<action type="save"/>')},propsFunction:function(e){return function(e,a,o,r){r=r||{};var l=e.state.attr("type"),s=[],d=[],u=r.onActionTypeChange,c=r.additionalActionOptions||[],p=t.merge([],n.getValidActionOptions());c&&c.length&&(p.push({value:"-",label:"",disabled:!0}),p.push({value:"-",label:"Additional actions",disabled:!0}),t.each(c,function(){p.push(this),l===this.value&&(this.props&&this.props.length&&t.each(this.props,function(){d.push(this)}),this.propsFunction&&(d=d.concat(this.propsFunction(e))))})),s.push({id:"type",label:"Action Type",type:"picklist",options:p,onChange:function(t){e.refresh().rebuildProps(a),u&&u(t)}}),"showPopup"===l?s.push({type:"customaction",label:"Configure Popup",icon:"sk-bi-popup",mode:"edit",customAction:function(){i().showPopupBuilder({parentComponent:e,getContextModelName:function(){return o},useAfterCloseActions:!0})}}):"showModal"===l?s.push({type:"customaction",label:"Configure Modal",icon:"sk-bi-popup",mode:"edit",customAction:function(){i().showModalBuilder({parentComponent:e,getContextModelName:function(){return o},useAfterCloseActions:!0})}}):"showToast"===l?s.push({id:"message",type:"template",label:"Message to display",location:"attribute"},{id:"duration",type:"picklist",label:"Display duration",options:[{value:"0",label:"Indefinite"},{value:"2",label:"2 seconds"},{value:"4",label:"4 seconds"},{value:"10",label:"10 seconds"}],defaultValue:4,location:"attribute"},{id:"clickToDismiss",type:"boolean",location:"attribute",label:"Click to dismiss"},{id:"styleSettingsVariant",type:"picklist",label:"Message type",options:[{value:"default",label:"Default"},{value:"error",label:"Error"},{value:"warning",label:"Warning"}],defaultValue:"default"}):"toggleSlidingPanel"===l||"openSlidingPanel"===l?s.push({type:"customaction",label:"Configure Panel",icon:"sk-bi-popup",mode:"edit",customAction:function(){i().showSlidingPanelBuilder({parentComponent:e,getContextModelName:function(){return o},useAfterCloseActions:!0})}}):-1!==t.inArray(l,["toggleLeftPanel","setLeftPanel","setMainPanel","setPopupPanel"])&&(s.push({id:"panel",label:"Panel",type:"panel"}),"setPopupPanel"===l&&s.push({id:"title",label:"Popup Title",type:"template",location:"attribute"}));var h=v({propViewer:a,component:e,getContextModelName:function(){return o}});return h.length&&t.each(h,function(e,t){s.push(t)}),d.length&&t.each(d,function(e,t){s.push(t)}),s}(e,h,f,s)},actionItemsFunction:function(e){if("action-sequence"===e.state.attr("type"))return n.actionSequences.getActionSequenceActionItems(e)},childrenFunction:function(i){var l=i.state,d=l.attr("type"),u=s.additionalActionOptions,f=[];switch(d){case"branch":return[function(e,n){return c(t.extend({},n,{treeNode:{invisibleParent:"iftrueactions",invisibleParentLabel:"If-True Actions",indent:1+e,addtooltip:"Add If-True Action",deletetooltip:"Remove If-True Action"}}))}(g,s)];case"createRow":return[function(e,t,i){return{id:"default",labelFunction:function(e){var t=e.attr("field")||"[No Field]",n=e.attr("value");return a.isUndefined(n)&&(n="[No Value]"),t+": "+n},invisibleParent:"defaults",invisibleParentLabel:"Default Values",indent:1+e,addtooltip:"Add Default Value",deletetooltip:"Remove Default Value",propsFunction:function(e){var a,o=e.state,l=o.attr("field"),s=[],d=t.attr("model"),u={showObjectPickerIfPolymorphic:!0,addFieldToModel:!0,handleChange:function(){e.refresh().rebuildProps(i)},modelName:d};if(s.push(n.getConditionFieldPropObj(e,u)),l&&d){var c=r(d);c&&(a=n.getFieldInfoFromCache(d,l,c.attr("sobject")))}return s.concat(n.getConditionValueProperties(e,{fieldMetadata:a,handleRefresh:function(){var t=o.attr("field");t&&e.rebuildProps(i)},modelName:d,validTypes:["blank","fieldvalue"]}))},defaultStateFunction:function(){return o("<default/>")}}}(g,l,h)];case"pageredirect":return[function(e){return{id:"param",labelFunction:function(e){var t=e.attr("key")||"[No Key]",n=e.attr("value");return void 0===n&&(n="[No Value]"),t+": "+n},invisibleParent:"params",invisibleParentLabel:"Parameters",indent:1+e,addtooltip:"Add Parameter",deletetooltip:"Remove Parameter",propsFunction:function(e){var t=function(){return e.refresh()};return[{id:"key",type:"text",label:"Key",onChange:t},{id:"value",type:"text",label:"Value",onChange:t}]},defaultStateFunction:function(){return o("<param/>")}}}(g)];case"publish":return[function(t,n){var i=e.events.get(n);return{id:"param",labelFunction:function(e){var t=e.attr("name"),n=e.attr("value"),i=p(e),o=i?i.getLabel():t||"[No Name]";return a.isUndefined(n)&&(n="[No Value]"),o+": "+n},invisibleParent:"params",invisibleParentLabel:"Event Parameters",indent:1+t,addtooltip:"Add Parameter",deletetooltip:"Remove Parameter",mode:i?"readonly":"edit",propsFunction:function(e){var t,n=p(e.state),i={id:"value",label:"Value",onChange:function(){e&&e.refresh()}},a=!1;if(n)switch(a=!0,t=n.getMetadata()||{},i.defaultValue=t.defaultValue,i.required=!0===t.required,n.getDisplayType()){case"PICKLIST":i.type="picklist",i.picklistEntries=t.picklistEntries;break;case"BOOLEAN":i.type="boolean"}return i.type||(i.type="template",i.location="attribute"),[{id:"name",type:"string",label:"Parameter Name",onChange:function(){e&&e.refresh()},readonly:a},i]},defaultStateFunction:function(){return o("<param/>")}}}(g,l.attr("event"))];case"action-sequence":case"custom":case"datasource-action":case"modelAction":case"requeryModel":case"requeryModels":case"runProcessPlugin":case"save":case"searchModel":case"sfdc-custom-apex":return[function(e,n){var i={invisibleParent:"onerroractions",invisibleParentLabel:"On-Error Actions",indent:1+e,icon:"sk-bi-action-error",addicon:"sk-bi-action-error",addtooltip:"Add on-error Action",deletetooltip:"Remove on-error Action",defaultStateFunction:function(){return o('<action type="blockUI" message="There was an error" timeout="3000"/>')}};return c(t.extend({},n,{treeNode:i}))}(g,s)]}return u&&t.each(u,function(){if(this.value===d&&this.childrenFunction){var e=this.childrenFunction(i);t.isArray(e)?Array.prototype.push.apply(f,e):f.push(e)}}),f}},u&&t.extend(d,u),d}function p(t){var n=t.closest("action").attr("event"),i=e.events.get(n);if(i)return i.getParam(t.attr("name"))}function h(e){e||(e={});var t=e.linkedComponent,i=!1,a={},o=e.actionsIndent;return o&&(a.indent=o),t&&e.refreshLinkedComponent&&(i=!0),{id:e.customNodeId||"actions",label:e.label||"Actions",addtooltip:"Add Action",deleteable:!1,icon:e.icon||"sk-icon-component-pack",isChild:!0,linkedComponent:t,props:e.props,actionItemsFunction:n.actionSequences.convertActionsToActionSequenceItem,refreshLinkedComponent:i,childrenFunction:function(n){return[c({linkedComponent:t,refreshLinkedComponent:i,component:n,propViewer:e.propViewer,useModelName:e.useModelName,additionalActionOptions:e.additionalActionOptions,treeNode:a})]}}}function f(e){e||(e={});var t=e.linkedComponent,n=!1;e.actionsIndent;return t&&e.refreshLinkedComponent&&(n=!0),{id:e.customNodeId||"interactions",label:e.label||"Interactions",addtooltip:"Add Interaction",deleteable:!1,icon:"sk-icon-component-pack",isChild:!0,linkedComponent:t,refreshLinkedComponent:n,childrenFunction:function(){return[m(e)]}}}function m(e){e||(e={});var t=e.linkedComponent,n=!1,i={},a=e.actionsIndent,r=e.propViewer,l=(e.useModelName,!0===e.isChild),s=void 0===e.deleteable||e.deleteable;return a&&(i.indent=a),t&&e.refreshLinkedComponent&&(n=!0),{id:"interaction",label:"Interaction",addtooltip:"Add Interaction",deleteable:s,icon:"sk-bi-interaction",isChild:l,linkedComponent:t,props:e.props,refreshLinkedComponent:n,childrenFunction:function(a){return[c({linkedComponent:t,refreshLinkedComponent:n,component:a,propViewer:e.propViewer,useModelName:e.useModelName,additionalActionOptions:e.additionalActionOptions,treeNode:i,indent:1})]},labelFunction:function(e){return d[e.attr("type")+("swipe"===e.attr("type")?e.attr("direction"):"")]},defaultStateFunction:e.childStateFunction||function(){return o('<interaction type="tap"/>')},propsFunction:function(e){return function(e,t){var n=e.state.attr("type"),i=[];return i.push({id:"type",label:"Action Type",type:"picklist",options:[{value:"tap",label:"Click"},{value:"swipe",label:function(){return"Swipe"}},{value:"press",label:"Press"}],onChange:function(){e.refresh().rebuildProps(t)}}),"swipe"===n&&i.push({id:"direction",label:"Direction",type:"picklist",options:[{value:"either",label:"Either"},{value:"left",label:"Left"},{value:"right",label:"Right"}],onChange:function(){e.refresh()}}),i}(e,r)}}}var b={emptyModelData:[{id:"idxrows",type:"idxrows",label:"Abandoned Rows",helptext:"Rows are indexed by Model Id. E.g., {{$Output.output_name.model_id.0.field_name}}"}],createRow:[{id:"rows",type:"rows",label:"Created Rows"}],adoptRows:[{id:"rows",type:"rows",label:"Adopted Rows"}],abandonRows:[{id:"rows",type:"rows",label:"Abandoned Rows"}],requeryModel:[{id:"rows",type:"rows",label:"Queried Rows"}],requeryModels:[{id:"idxrows",type:"idxrows",label:"Queried Rows",helptext:"Rows are indexed by Model Id. E.g., {{$Output.output_name.model_id.0.field_name}}"}]};function v(i){var r,l=i.component,d=i.propViewer,c=i.getContextModelName?i.getContextModelName():i.contextModelName,p=l.state,h=p.attr("type"),f=n.getAttrFromClosestParentComponent(p,"model"),m=!!f&&n.getModelFromModelName(f),v=m?m.attr("datasource"):"",g=[],y=function(){l&&l.refresh()},C=function e(t){var i,a=t.parent();return!!a.length&&((!a[0]||"skuidpage"!==a[0].nodeName)&&(!(!(i=n.getComponentFromState(a))||!i.globalContext)||(i?e(a):void 0)))}(p),w=b[h]||[],S={id:"behavior",type:"picklist",label:"Query Behavior",defaultValue:"standard",picklistEntries:[{label:"Standard - Completely Replace Data",value:"standard"},{label:"Get More - Merge in new Rows with old",value:"loadmore"}]},k={id:"affectedrows",type:"picklist",label:"Rows to use",defaultValue:"context",picklistEntries:[{label:"Rows in context",value:"context"},{label:"All rows in model",value:"all"}]},P=t.extend({},k,{picklistEntries:[{label:"Rows in context",value:"context"},{label:"None",value:"all"}]});if(-1!==t.inArray(h,["cancel","deactivateFilterableConditions","emptyModelData","requeryModels","save","unmarkAllRowsForDeletion"])){var x="Models";"save"===h?x+=" to Save":"cancel"===h?x+=" to Cancel":"requeryModels"===h?x+=" to Query":"emptyModelData"===h?x+=" to Empty":"deactivateFilterableConditions"===h&&(x="Deactive Filterable Conditions on"),g.push({id:"models",label:x,type:"models",onChange:y}),"save"===h?g.push({id:"rollbackonanyerror",label:"Roll back entire save on any error",helptext:"If true, then if there is any error while saving any of the selected Models, then the entire save operation will be rolled-back, as if no part of it ever occurred. ",type:"boolean"}):"requeryModels"===h&&g.push(S)}else if("branch"===h)g.push({id:"formula",label:"Formula",type:"code",location:"node"},{id:"model",label:"Formula Context Model (optional)",type:"model",helptext:"Use to forcibly set the Context Model to use for Formula merges, otherwise the default context Model will be used.",required:!1},{id:"label",type:"string",label:"Description",helptext:"Friendly label for this Branch to describe its purpose.",onChange:y},{id:"whenfinished",type:"picklist",label:"After running the branch",helptext:"Use to change the behavior of the branch when the formula is true: stop running additional actions, or continue with the next action after the branch.",defaultValue:"stop",picklistEntries:[{label:"Do not run any additional actions",value:"stop"},{label:"Continue with the next action",value:"continue"}]});else if("redirect"===h)g.push({id:"url",label:"URL",type:"template",location:"attribute"},{id:"window",type:"picklist",label:"Open URL in",defaultValue:"self",picklistEntries:[{label:"Current window",value:"self"},{label:"Blank window",value:"blank"},{label:"Parent window",value:"parent"}]});else if("pageredirect"===h)g.push({id:"redirecttype",type:"picklist",label:"Navigation Type",defaultValue:"page",platform:[e.constants.NATIVE],options:[{value:"page",label:"Skuid Page"},{value:"route",label:"Route"}],onChange:function(){p.removeAttr("page route"),l.rebuildProps()}}),"route"!==p.attr("redirecttype")&&g.push(e.platform.builder.getPageSelectProperty({id:"page",label:"Skuid Page",valueTemplates:{page:"{{{name}}}"}})),"route"===p.attr("redirecttype")&&g.push(e.platform.builder.getRouteSelectProperty({id:"route",label:"Skuid Route",platform:[e.constants.NATIVE]}));else if("blockUI"===h){g.push({id:"message",type:"string",label:"Message"});for(var F={id:"timeout",type:"picklist",label:"Timeout (seconds)",picklistEntries:[{label:"Never",value:""}]},T=1;T<=20;T++)F.picklistEntries.push({value:500*T,label:T/2});g.push(F)}else if("publish"===h){var N=p.attr("event"),A=N&&e.events.get(N),E=A&&A.getScope(),I="By default, this event will only be published to this page's subscribers. This event may also be published to other active Skuid pages in the current window. ",M=[{value:u.SKUID,label:"All active pages"},{value:u.PAGE,label:"Only this page"}];a.inPlatform([e.constants.VISUALFORCE,e.constants.LIGHTNING])&&(I+='If within Lightning Experience, you can also publish this event to Lightning Components that handle the "skuid:event" Application Event.',M.unshift({value:u.GLOBAL,label:"All active pages and Lightning Components"})),g.push({id:"event",label:"Event Name",type:"combobox",entries:function(){return e.events.getRegisteredGlobalEvents().map(function(e){return{label:e.getLabel(),value:e.getName()}})},onChange:function(t){var n,i=e.events.get(t),r=i?i.getScope():null,s=p.children("params");s.length||(s=o("<params/>").appendTo(p)),n=i?i.getParameters().map(function(e){var t=(e.getMetadata()||{}).defaultValue;return o("<param/>").attr({name:e.getName(),value:a.isUndefined(t)?"":t})}):[],p.attr("scope",r||u.PAGE),s.empty().append(n),l.save().refresh().rebuildProps()}},{id:"scope",label:"Publishing Scope",type:"picklist",defaultValue:u.PAGE,readonly:!!E,helptext:I,picklistEntries:M},{id:"channel",type:"template",displayAs:"input",label:"Channel",location:"attribute",helptext:"(Optional) A targeted channel on which to publish event. If specified, subscribers to this event will only be notified if they are listening on this channel."})}else if("runProcessPlugin"===h)g.push({id:"pluginname",label:"Plugin Name",type:"string"});else if(t.inArray(h,["abandonRows","createRow","markRowsForDeletion","requeryModel","unmarkRowsForDeletion"])>-1)g.push({id:"model",label:"Model",type:"model",location:"attribute",onChange:y}),"createRow"===h?(g.push({id:"appendorprepend",type:"picklist",label:"Place row at...",defaultValue:"prepend",picklistEntries:[{label:"Start of Model data",value:"prepend"},{label:"End of Model data",value:"append"}]},{id:"defaultmodefornewitems",type:"picklist",label:"Have associated Components initially show this row in...",defaultValue:"edit",picklistEntries:[{value:"edit",label:"Edit mode"},{value:"read",label:"Read mode w/ inline-editing"}],helptext:"When this row is created, Components bound to this Model will create a new Item corresponding to the row. What Mode should the new Item start in?"}),C||g.push(P)):"requeryModel"===h&&g.push(S);else if("sortModel"===h)g=g.concat(function(e,t,i){var a=[],o="true"===e.attr("client-side"),r=function(e){if(!e)return!1;var t=n.getDataSourceTypeFromModelName(e);return t&&!1!==t.prop("supportsServerSideSort")};a.push({id:"model",label:"Model",type:"model",location:"attribute",onChange:function(n){var i=!r(n);i&&e.attr("client-side","true"),t.save().refresh().rebuildProps()}},{id:"field",label:"Field",type:"field",addFieldToModel:!0,displayTypeFilter:function(e){return!!o||e.sortable},modelprop:"model",location:"attribute"},{id:"method",label:"Sort Behavior",type:"picklist",defaultValue:"toggle",picklistEntries:[{value:"toggle",label:"Cycle Sort"},{value:"asc",label:"Ascending"},{value:"desc",label:"Descending"},{value:"clear",label:"Clear Sort"}]});var l={id:"client-side",label:"Sort Client Side",helptext:"When enabled, only rows within the model—and not records on the server side—will be sorted.",type:"boolean",onChange:function(){t.refresh().rebuildProps()}},s=e.attr("model")||i;r(s)||(l.isStateless=!0,l.value="This model only supports client-side sorting.",l.readonly=!0,l.type="text",e.attr("client-side","true"));a.push(l),"true"!==e.attr("client-side")&&a.push({id:"should-query",helptext:"When enabled, the model will immediately requery for results after its field sorting is set.",label:"Query After Setting Sort",defaultValue:"true",type:"boolean"});return a}(p,l,f));else if("searchModel"===h)g.push({id:"model",label:"Model",type:"model",location:"attribute",entryFilter:function(t){var n=t.attr("datasource")||e.platform.getDefaultDataSourceName(),i=n&&e.dataSource.getDataSource(n),a=i&&i.getDataSourceType();return a&&a.modelsCanSearch()},onChange:y},{id:"search",type:"template",location:"attribute",modelName:c,label:"Search Text",displayAs:"input"});else if("adoptRows"===h)g.push({id:"sourcemodel",label:"Source Model",type:"model",location:"attribute"},{id:"targetmodel",label:"Target Model",type:"model",location:"attribute"});else if("updateRow"===h){g.push({id:"fieldmodel",label:"Model",type:"model",required:!0,location:"attribute",onChange:function(){l.refresh().rebuildProps(d)}});var R=n.getConditionFieldPropObj(l,{handleChange:function(){l&&l.refresh().rebuildProps(d)},modelName:p.attr("fieldmodel")});g.push(R),l.isUpdateAction=!0,g.push({id:"value",type:"string",label:"Value",metadata:n.getMetadataForField(l,{modelName:p.attr("fieldmodel")})})}else if("updateIncludePanel"===h||"loadIncludePanel"===h){var L=e.platform.builder.getPageSelectProperty({id:"pagename",label:"Skuid Page",helptext:"The Skuid Page that will be loaded into the specified Page Include component when an item in the queue is selected. Note: this page will overwrite the page specified the Page Include properties, which should be considered the default page, whereas this page will be loaded \tin context of a queue item when the item is selected.",onChange:function(){l.refresh(),l.rebuildProps()}}),O={id:"panelid",type:"component",label:"Page Include Component Id",filter:"pageinclude",helptext:"The Unique Id of the Page Include Component that you want to pair with this queue."};"updateIncludePanel"===h?g.push(L,O,{id:"querystring",type:"string",label:"Query String",helptext:'URL Parameters / Query String to be passed in when loading the specified Skuid Page into the Page Include. For example, "id={{Id}}", or "id={{{Id}}}&accountid={{{AccountId}}}", if you need to pass in multiple parameters. Use Merge Syntax to identify fields.'}):g.push(L,O,{id:"defaultitemparameter",type:"string",label:"Default Item Parameter",helptext:"Name of URL Parameter passed from predecessor page"})}else if("openSlidingPanel"===h)g.push({id:"openbehavior",type:"picklist",label:"Behavior",defaultValue:"open",picklistEntries:[{value:"open",label:"Open"},{value:"toggle",label:"Toggle"}]});else if("closeSlidingPanel"===h)g.push({id:"closebehavior",type:"picklist",label:"Behavior",defaultValue:"close",picklistEntries:[{value:"close",label:"Close all"},{value:"topmost",label:"Close topmost"}]});else if("toggleRenderComponent"===h)g.push({id:"behavior",type:"picklist",label:"Behavior",defaultValue:"toggle",picklistEntries:[{value:"toggle",label:"Toggle"},{value:"show",label:"Show"},{value:"hide",label:"Hide"}]},{id:"componentid",label:"Component",type:"component",location:"attribute"});else if("runComponentAction"===h)!function(t,n){var i=n.component,o=i.state,r=o.attr("componentid"),l=r?e.builder.desktop.getComponentById(r):null,s=e.builder.getBuilders(),d=Object.keys(s).map(function(e){return s[e]}).filter(function(e){return!!e.actions}).map(function(e){return e.name.toLowerCase().replace(/[^a-z]/g,"")});if(t.push({id:"componentid",label:"Component",type:"component",location:"attribute",filter:d,onChange:function(){a.removeAllAttrsExcept(o,["componentid","type"]),i.save().refresh().rebuildProps()}}),!l)return;var u=l.builder.actions,c=o.attr("action");t.push({id:"action",label:"Action to Run",type:"picklist",picklistEntries:u,onChange:function(e,t){e&&t&&e!==t&&i.save().refresh().rebuildProps()}});var p=u.find(function(e){return e.value===c})||u[0],h=function(e){return Array.prototype.push.apply(t,e)};p.props?h(p.props):p.propsFunction&&h(p.propsFunction(l))}(g,i);else if("custom"===h)g.push({id:"snippet",label:"Name of Snippet to run",type:"snippet",location:"attribute",onChange:y});else if(-1!==t.inArray(h,["setCondition","activateCondition","deactivateCondition"])){g.push({id:"model",label:"Model",type:"model",location:"attribute",onChange:function(e,t,n){!0!==t&&n&&l&&l.rebuildProps(d),l&&l.refresh()}});var D=p.attr("model");D||(D=(D=n.getFirstModel())?D.attr("id"):null),g.push({id:"condition",label:"Condition",type:"condition",modelName:D,location:"attribute",onChange:y,filter:function(e){return("deactivateCondition"!==h||"filterablerequired"!==e.attr("state"))&&"fixed"!==e.attr("state")}}),"setCondition"===h&&g.push({id:"value",label:"Value",type:"template",location:"attribute",modelName:c})}else a.startsWith(h,"sfdc-")&&(h="datasource-action",p.attr("type",h),p.attr("actionname","apex"));return"datasource-action"===h?function(n,i,o){var r,l,d=i.component,u=d.state,c=u.attr("datasource"),p=[],h=[],f=i.propViewer,m=[],b=u.attr("actionname"),v={},g=!1,y={type:"string",label:"Action",value:"No Actions for this datasource",readonly:!0,isStateless:!0},C=function(){d&&d.refresh().rebuildProps(f)};s(e.dataSource.map(),function(e){h.push({label:e,value:e})}),h.sort(function(e,t){return e.label<t.label?-1:1}),c=c||o||h[0].value,l={id:"datasource",type:"picklist",picklistEntries:h,label:"Data Source",defaultValue:c,onChange:function(e,t){a.removeAllAttrsExcept(u,["datasource","type"]),d.save(),t?C():e?u.attr("datasource",e):u.attr("datasource",c)}},n.push(l),c&&(r=e.dataSource.getDataSource(c),v={type:"string",label:"Action",value:"Loading actions ...",readonly:!0,isStateless:!0},n.push(v),r.getActions(u,i).done(function(e){var i={};if(g)d.refresh().rebuildProps(f);else if(n.pop(),e&&a.size(e)){if(p=e,t.isArray(p)?(m=t.map(p,function(e){if(!e.deprecated)return{label:e.label,value:e.name,disabled:e.disabled}}),s(p,function(e,t){t.disabled||(i[t.name]=t)})):(s(p,function(e,t){t.deprecated||m.push({label:t.label,value:e})}),m.sort(function(e,t){return e.label<t.label?-1:1}),i=p),m.length&&!b)for(var o=0;!b&&o!==m.length;)m[o].disabled||(b=m[o].value),o++;if(v={id:"actionname",type:"picklist",picklistEntries:m,label:"Action",onChange:function(e,t){a.removeAllAttrsExcept(u,["datasource","type","actionname"]),d.save(),t?C():b&&u.attr("actionname",b)}},m.length?n.push(v):n.push(y),b){var r=i[b];if(r){var l=r.builderProps,c=a.isFunction(l)?l():l;s(c,function(e,t){n.push(t)})}else n.push({type:"string",label:"Action Properties",value:"This action has no metadata",readonly:!0,isStateless:!0})}}else n.push(y)}),g=!0)}(g,i,v):"action-sequence"===h?n.actionSequences.appendActionSequenceActionProps(g,l,c):"voice-command"===h&&n.voiceCommands.appendVoiceCommandProps(g,l,c),C||-1===t.inArray(h,["unmarkRowsForDeletion","markRowsForDeletion","updateRow","abandonRows","adoptRows"])||g.push(k),w.length&&((r=p.children("outputs")).length||(r=o("<outputs/>")),g.push({label:"Named Outputs",helptext:'Use Named Outputs to "tag" data created or modified by this action and make it accessible in following actions via the $Output merge variable.',type:"custom",renderProperty:function(e){e.element.append(w.map(function(i){var a,l=i.label,s=i.id,d=i.type,u=t("[id="+s+"]",r);return u.length||(u=o("<output/>").attr({id:s,type:d})),i.helptext&&(a=t("<div>").addClass("sk-icon sk-icon-help inline").css({"vertical-align":"top","margin-left":"4px"})).skootip(i.helptext),t("<div>").append(t("<div>").text(l).append(a),n.propertyRenderers.standard({id:"name",label:l,validator:n.validators.alphaNumericUnder,onChange:function(n){var i=t.contains(r[0],u[0]);i&&(!n||n.length<1)?(u.detach(),r.children().length||r.detach(),e.updateState()):!i&&n&&n.length>0&&(u.appendTo(r),t.contains(p[0],r[0])||r.appendTo(p),e.updateState())}},u))}))}})),g}e.events.subscribe(["__skuid.builder.model.idChange","__skuid.builder.model.field.remove","__skuid.builder.model.remove"],function(i){var a=n.getPageXML().find("renderconditions > rendercondition, enableconditions > condition");a.length&&t.each(a,function(){var a=t(this);n.handleModelIdChange(a,i,"fieldmodel"),n.handleModelRemove(a,i,{modelPropId:"fieldmodel"}),"model.field.remove"===i.type&&a.attr("field")===i.fieldId&&a.remove(),e.events.publish("skuidBuilderSave")})}),e.events.subscribe("__skuid.builder.component.uniqueIdChange",function(t){n.getPageXML().find('action[componentid="'+t.oldId+'"]').attr("componentid",t.newId),e.events.publish("skuidBuilderSave")}),t.extend(n,{getCoreActionProperties:v,getActionTreeNode:c,getActionsCategory:function(e){return{name:e&&e.label?e.label:"Actions",tree:h(e)}},getInteractionsCategory:function(e){return{name:e&&e.label?e.label:"Interactions",tree:f(e)}},getActionsTree:h,getInteractionTree:m,getInteractionsTree:f})}(skuid)},300:function(e,t,n){"use strict";!function(e){var t,n,i=e.$,a=i.each,o=e.builder.core,r=e.utils,l=e.ui.getRenderer,s=o.getAllModelsInPage,d=o.getPageXML,u=o.getStoredValue,c={},p={},h=o.updateState,f=e.constants.DISPLAY_TYPES,m=f.PICKLIST,b=f.BOOLEAN,v=f.MULTIPICKLIST,g=f.COMBOBOX,y=f.TEXT;function C(){var t,n,i,o,l,s=d().attr("theme")||e.builder.core.defaultTheme||e.settings.theme("default"),u=e.platform.getEntityFieldNames("theme"),c=e.builder.core.availableThemes?e.builder.core.availableThemes:e.components.config.pagebuilder.themes;if(!c)return e.utils.resolve();if(s?(a(c,function(e,t){if(t[u.name]===s)return l=t,!1}),l&&(u.resource_namespace&&u.resource_name?(i=l[u.resource_namespace],n=l[u.resource_name]):(i=null,n=l[u.name]))):2===(o=e.page.runtimeThemeResource.split("__")).length?(i=o[0],n=o[1]):(i=null,n=o[0]),n&&(t=e.platform.themeBuilder.getThemeResourceUrl({name:n,namespace:i,modstamp:(new Date).getTime()})),t){var h,f={Name:n,NamespacePrefix:i},m=(i?i+"__":"")+n,b=p[m];return b?r.resolve(b):(h=e.$.map(["skuid_theme.json","resources.json"],function(t){return e.platform.themeBuilder.getResource(f,t)}),e.$.when.all(h).then(function(e){var n=r.parseAsJSONIfString,i={url:t,"skuid_theme.json":n(e[0]),"resources.json":n(e[1])};return p[m]=i,i}))}return e.utils.resolve()}var w={};function S(t){var o=e.constants.WEB_ICON_SET_PREFIXES.indexOf(n)>-1;function r(r){r=r.sort(function(e,t){var i=e.split(":")[1]||e.substr(n.length+1),a=t.split(":")[1]||t.substr(n.length+1);return i<a?-1:i>a?1:0}),a(r,function(a,r){var l=r.split(":")[1]||r.substr(n.length+1),s=(o?"sk-webicon-":"")+r,d=i(e.ui.createIcon(s)).addClass("nx-picker-icon").attr({handle:s});i('<div class="nx-picker-icon-wrapper">').attr("title",l).append(d).appendTo(t)}),t.skootip()}t.empty(),o?w[n]?r(w[n]):(e.platform.preloadIconSetDependencies(n).then(function(t){w[n]=t.find("symbol").map(function(){return e.utils.makeXMLDoc(this.outerHTML).attr("id")}),r(w[n])}),e.constants.WEB_ICON_SET_PREFIXES.forEach(function(t){w[t]||t===n||e.platform.preloadIconSetDependencies(t).then(function(n){w[t]=n.find("symbol").map(function(){return e.utils.makeXMLDoc(this.outerHTML).attr("id")})})})):c&&c[n]&&r(Object.keys(c[n].icons))}function k(t,o,l){t.addClass("nx-picker-wrapper").appendTo("body");var s=i('<div class="nx-picker-body">'),d=i('<div class="nx-picker-filter-input-icon sk-icon sk-icon-cancel">').skootip("Clear Filter Text").hide(),u=i('<div class="nx-picker-filter-input-icon sk-icon sk-icon-search">').css({cursor:"default","pointer-events":"none"}),p=i('<select class="nx-picker-header-category-select">'),h=i('<label class="nx-picker-header-category-select-label">All Icon Sets</label>'),f=i('<div class="nx-picker-header-category-select-wrapper">'),m=r.generateUniqueId(),b=i('<div class="nx-picker-header">'),v=i('<input type="text" class="nx-picker-filter-input" placeholder="Search">'),g=i('<div class="nx-picker-filter-input-wrapper">'),y=i('<div class="nx-picker-header-category-wrapper">'),w='<div style="margin: 8px 20px; padding: 1.25rem 1.25rem 0.5rem; border-radius: 0.25rem; color: #004085; background-color: #cce5ff; border: solid 1px #b8daff;"><h1 style="font-size: 125%">Use of the Salesforce Lightning Design System icons requires proper attribution in your app.</h1><p>Here is an example of proper attribution:</p><div style="border: dashed 1px #b8daff;padding: 8px 16px; background: #f0f0f0;"><strong>Salesforce <a href="https://www.lightningdesignsystem.com/icons/" target="_blank">Lightning Design System</a> icons are used with permission under the <a href="http://creativecommons.org/licenses/by-nd/4.0" target="_blank">Creative Commons Attribution-NoDerivatives 4.0</a> license.</strong></div><p>Copy it (including the links) into a visible page in your app such as on a Help or About page.</p></div>';function k(e){n=e,p.val(e),y.find(".nx-picker-selected").removeClass("nx-picker-selected"),i.each(y.children(),function(t,n){var a=i(n);a.data("prefix")===e&&a.addClass("nx-picker-selected")}),S(s),"lightning-icons"===e&&s.prepend(w),v.val("")}p.attr("id",m),h.attr("for",m),f.append(h,p),b.append(y,f,g.append(v,d,u)),t.append(b,s),e.features&&e.features["INK Design System Components"]&&-1===e.constants.WEB_ICON_SET_PREFIXES.indexOf("ink")&&(e.constants.WEB_ICON_SET_PREFIXES.unshift("ink-filetypes"),e.constants.WEB_ICON_SET_PREFIXES.unshift("ink")),a(e.constants.WEB_ICON_SET_PREFIXES,function(t,n){p.append('<option value="'+n+'">'+e.constants.WEB_ICON_SET_LABELS[n]+"</option>"),c[n]||(c[n]={})}),y.on("click",".nx-picker-header-category",function(){k(i(this).data("prefix"))}),p.on("change",function(){k(this.value)}),r.delayInputCallback(v,function(e){var t=s.parent();e=e.toLowerCase(),s.detach(),""===e?(s.find(".nx-picker-icon-wrapper").css("display",""),d.hide(),u.show()):(d.show(),u.hide(),s.find(".nx-picker-icon-wrapper").not('[title*="'+e+'"]').css("display","none"),s.find('.nx-picker-icon-wrapper[title*="'+e+'"]').css("display","")),s.appendTo(t)}),d.click(function(){v.val("").change()}),s.on("click",".nx-picker-icon-wrapper",function(){var e=i(this).children(".sk-webicon, .sk-icon").first(),a=e.attr("handle");o.val(e.attr("handle")).change(),e.attr("handle")?l.attr("icon",a):l.addClass("nx-picker-icon "+n+" inline "+n+"-"+a),t.dialog("close")}),C().then(function(t){var o,r,l=t["skuid_theme.json"];if(c=l.iconsets||{},o=Object.keys(c).concat(l.iconsetsSVG||[]),r=function(t){return l.iconsets[t]&&l.iconsets[t].label?l.iconsets[t].label:e.constants.WEB_ICON_SET_LABELS[t]||t},n=o[0]||e.constants.WEB_ICON_SET_PREFIXES[0],o){a(o,function(e,t){var a=i('<div class="nx-picker-header-category">').text(r(t));a.data("category",t),n===t&&a.addClass("nx-picker-selected"),a.data("prefix",t),y.append(a),c[t]||(c[t]={})});for(var d=o.length-1;d>=0;d--){var u=o[d];p.children('option[value="'+u+'"]').remove(),p.prepend('<option value="'+u+'">'+r(u)+"</otion>")}n&&p.val(n)}S(s)})}function P(e){var t=e.parent(),n=t.find(".nx-property-error");return n.length||(n=i("<div>").addClass("nx-property-error").css("margin-top","8px").insertAfter(e),t.css("display","block")),n}function x(e,t){var n,r,l=[],d=e.entryFilter,u="multipicklist"==e.type,c=e.id,p=[],h=e.storeAs;!u||h&&"node"!==h.type?(r=t.attr(c))&&"undefined"!=r&&p.push(r):(r="",(n=t.children(c)).length&&h&&"node"===h.type&&(a(n.children(h.name),function(){p.push(i(this).text())}),r=p.join(","))),s().children().each(function(){var e=i(this),t=e.attr("id");if("function"==typeof d&&!d(e))return!0;l.push({value:t,label:t})});var f=o.actionSequences,m=f.getActionSequenceFromChildAction(t);if(m){var b=f.getModelInputsFromActionSequenceXML(m);i.each(b,function(e,t){var n=t.attr("name");l.push({value:f.addInputMerge(n),label:n+" (input)"})})}return l}t={readonly:function(e){return i('<div class="nx-fieldtext">').text(void 0===e?"":e).addClass("nx-pagebuilder-readonly-text")},models:function(e,n,i){return e.type="multipicklist",e.storeAs||(e.storeAs={type:"node",name:"model"}),e.location||(e.location="node"),e.noneSelectedText||(e.noneSelectedText="Select Models..."),e.picklistEntries=x(e,n),t.multipicklist(e,n,i)},model:function(e,n){var a=e.id,o=!0===e.isStateless,r=!1===o?n.attr(a):e.value||e.valueFunction&&e.valueFunction(),s=r&&void 0!==r,d=x(e,n),u=!1!==e.required;if(e.noneOption&&d.unshift(e.noneOption),u&&!s&&d.length&&(s=(r=d[0].value)&&void 0!==r,r&&s&&!o?h(n,{key:a,value:r}):o&&r&&s&&e.onChange&&e.onChange(r)),e.readonly)return t.readonly(r);var c=l(m).edit({value:r,entries:d,required:u,onChange:function(t,i){o||h(n,{key:a,value:t}),e.onChange&&e.onChange(t,!1,i)}});return i('<label class="nx-basicfieldeditor-item-select-label">').append(c)},attributesNode:function(e,n){var i=e.id,a=n.children(i).attr()||{},o=e.onChange;return delete e.id,e.value=a[e.name],e.onChange=function(t){h(n,{childNodeName:i,key:e.name,value:t}),o&&o.apply(arguments)},t.standard(e,n)},multifield:function(e,n,a){return e.type="multipicklist",e.storeAs||(e.storeAs={type:"node",name:"field"}),e.location||(e.location="node"),"attribute"===e.location&&(e.valueDelimiter="::"),e.noneSelectedText||(e.noneSelectedText="Select Field(s)..."),e.picklistEntries=function(e,t){var n=[],a=e.modelName||(e.modelProp?t.attr(e.modelProp):null),r=o.getDataSourceTypeFromModelName(a),l=o.getModelFromModelName(a),s=e.filter,d={};if(!l.length){var u=o.actionSequences,c=u.getActionSequenceFromChildAction(t);c&&(l=u.getModelXMLForPickerOfInputModel(c,a))}return l.length?(s&&i.isArray(s)&&(s=function(t,n){return n&&i.inArray(n.displaytype,e.filter)>-1}),l.find("> fields > field").each(function(){var e,t=i(this).attr("name")||i(this).attr("id");r&&r.isRelationshipField&&r.isRelationshipField(t)||(e=o.getFieldInfoFromCache(l,t),s&&!s(t,e)||(d[t]=e&&e.label||t,n.push(t)))}),n.sort(),i.map(n,function(e){return{value:e,label:d[e]}})):[]}(e,n),t.multipicklist(e,n,a)},boolean:function(e,t){var n,a,o=e.id,s=!0===e.isStateless;n=!0===s?e.value||e.valueFunction&&e.valueFunction()||e.defaultValue:"true"===t.attr(o)||!t.attr(o)&&(e.defaultValue||!1),a=l(b).edit({value:n,onChange:function(n){!1===(e.beforeChange?e.beforeChange(n):null)?a.val(!a.val()):(s||h(t,{key:o,value:n}),e.onChange&&e.onChange(n))}}),e.readonly&&a.prop("disabled",!0);var d="sk-builder-check-"+r.generateGUID();a.attr("id",d);var u=i("<div>");return u.append(a,'<label for="'+d+'"></label>'),u},condition:function(e,n){var a,d=e.id,u=!0===e.isStateless,c=!1===u?n.attr(d):e.value||e.valueFunction&&e.valueFunction(),p=e.filter,f=o.actionSequences;if(e.modelName){var b=s().children('[id="'+e.modelName+'"]');if(!b.length){var v=f.getActionSequenceFromChildAction(n);v&&(b=f.getModelXMLForPickerOfInputModel(v,e.modelName))}a=b.children("conditions, havings").find("[name]").map(function(){var e=i(this),t=e.attr("name"),n=f.removeInputMerge(t);if(!r.startsWith(t,"__autofilter__")&&(!p||p(e)))return{value:t,label:n}})}if(e.readonly)return t.readonly(c);var g=l(m).edit({value:c,entries:a,onChange:function(t){var i=n.attr(d);u||h(n,{key:d,value:t}),e.onChange&&e.onChange(t,i)},noneLabel:"--None--"});return i('<label class="nx-basicfieldeditor-item-select-label">').append(g)},picklist:function(e,n){var o,r,s="multipicklist"==e.type,d=e.id,c=e.storeAs,p=e.options||e.entries||e.picklistEntries,f="function"==typeof p?p():p,b=e.valueDelimiter||",",g=[],y=!0===e.isStateless;function C(e){var t;s&&c&&"node"===c.type?(t={childNodeName:d,storeAs:c,value:e?e.split(","):[]},g=t.value):t={key:d,value:e||""},y||h(n,t),r=!0,o=e}function w(t){var i=u(n,e);e.beforeChange&&e.beforeChange(t,i),C(t),e.onChange&&e.onChange(t,i)}if(!0===y)o=e.value||e.valueFunction&&e.valueFunction()||e.defaultValue,r=o&&void 0!==o;else if(s&&c&&"node"===c.type){var S=n.children(d);o="",(r=S.length)&&c&&"node"===c.type&&(a(S.children(c.name),function(){g.push(i(this).text())}),o=g.join(b))}else o=n.attr(d),r=o&&void 0!==o;if(!s&&!r&&"defaultValue"in e&&C(e.defaultValue),e.readonly||!0===e.writeOnce&&void 0!==o){var k=i.map(f,function(e){if(e.value===o)return e});return t.readonly(k[0]&&k[0].label||o)}return function(){if(s)return l(v).edit({value:o,entries:f,maxSelected:e.maxSelected,noneSelectedText:e.noneSelectedText,valueDelimiter:b,selectedList:4,onChange:function(e,t){w(e)}});var t=l(m).edit({value:o,entries:f,defaultValue:e.defaultValue,required:!1!==e.required,onChange:function(e,t){w(e)}});return i('<label class="nx-basicfieldeditor-item-select-label">').append(t)}()},filepath:function(t,n){var o,s,d,u,c=t.id,p=!0===t.isStateless,f=!1===p?n.attr(c):t.value||t.valueFunction&&t.valueFunction();if(t.readonly)d=i("<div>").addClass("nx-fieldtext").text(f||"").css("margin-top","6px");else{d=i("<div>");var m=l("AUTOCOMPLETE").edit({source:function(n,l,d,c){var p,h;d(),(h=i.Deferred(),o=t.getResourceName(),s=t.getResourceNamespace(),o?u&&u.length>=0?h.resolve(u).promise():(p=e.platform.getSiteResourceUrl({name:o,namespace:s,path:void 0,modstamp:(new Date).getTime()}),r.loadJS(e.platform.getResourceUrl({name:"lib/jSZip.js",namespace:"skuid"})).done(function(){JSZipUtils.getBinaryContent(p,function(e,t){var n;e&&h.reject(e);try{n=new JSZip(t),u=[],n.files&&a(n.files,function(e,t){t.options&&t.options.dir||r.startsWith(e,".")||r.contains(e,"/.")||u.push(e)}),h.resolve(u)}catch(e){h.reject(e)}})}).fail(function(e){h.reject(e)}),h.promise()):(u=!1,h.reject().promise())).then(function(e){c(),l(e.filter(function(e){return-1!==e.toLowerCase().indexOf(n.term.toLowerCase())}))},function(){c(),l([])})},onChange:function(e,i){var a=i.item.value;p||h(n,{key:c,value:a}),t.onChange&&t.onChange(a)},value:f,parentElem:d});d.append(m)}return d},entity:function(t,n){var i=t.id,a=!0===t.isStateless,o=!1===a?n.attr(i):t.value||t.valueFunction&&t.valueFunction(),r=t.invalidEntryMessage;return r||"sobject"!==t.type||(r="Please select a valid SObject."),l("ENTITY").edit({value:o,filter:t.filter,dataSource:function(){return e.dataSource.get(t.dataSourceName||e.platform.getDefaultDataSourceName())},invalidEntryMessage:r,readOnly:!1!==t.readonly&&(o||t.readonly),showLabelInTextInput:t.showLabelInTextInput,onChange:function(e,o){a||h(n,{key:i,value:e}),t.onChange&&t.onChange(e,o)}})},autocomplete:function(n,o){var s,d,u=i("<div>").addClass("nx-field"),c=n.id,p=n.sobject,f=n.order,m=n.onChange,b=n.dataSource||e.dataSource.get(e.platform.getDefaultDataSourceName()),v=n.fieldsToSearch||["Name"],g=n.fieldsToReturn||["Name"],y=n.displayTemplate||"{{Name}}",C=n.valueTemplates||{},w={},S=c&&o.attr(c)||n.valueFunction&&n.valueFunction(),k=!0===n.isStateless;return c in C||(C[c]="{{Name}}"),s=n.readonly?t.readonly(r.decodeHTML(S||"")):l("AUTOCOMPLETE").edit({minLength:2,value:r.decodeHTML(S),source:n.source||function(t,n,i,o){if(t.term in w)n(w[t.term]);else{d=t.term.split(" ");var r,l=1,s=[],u={dataSource:b,fields:[{id:"Id"}],conditions:[],objectName:p,doQuery:!0};for(a(g,function(e,t){"Id"!=t.toLowerCase()&&u.fields.push({id:t})}),f&&(u.orderByClause=f),a(v,function(e,t){a(d,function(e,n){u.conditions.push({field:t,operator:"LIKE",value:"%"+n+"%"})})});l<=u.conditions.length;l++)s.push(""+l);u.conditionLogic=s.join("OR"),r=new e.model.Model(u),i(),b.load([r]).then(function(e){o();var i=e[0];w[t.term]=i.data,n(i.data)},function(){o(),n([])})}},onChange:function(t,n){var i={};return a(C,function(t,a){var r=e.Mustache.render(a,n.item);i[t]=r,k||h(o,{key:t,value:r})}),m&&m(i[c],n.item),!1},onFocus:function(t,n){return s.val(e.Mustache.render(C[c],n.item)),!1},onClose:function(){s.focus()},onClear:function(){var e={};return a(C,function(t){e[t]="",h(o,{key:t,value:""})}),m&&m(e[c]),!1},optionRenderer:function(t,n){var o="<a>"+e.Mustache.render(y,n)+"</a>";return d&&a(d,function(e,t){o=o.replace(t,"<b>"+t+"</b>")}),i("<li></li>").data("ui-autocomplete-item",n).append(o).appendTo(t)},parentElem:u}),u.append(s),u},combobox:function(e,n){var a=e.id,o=!0===e.isStateless,s=i('<div style="position: relative;">'),d=!1===o?n.attr(a):e.value||e.valueFunction&&e.valueFunction(),u=e.entries||e.source||e.picklistEntries;function c(e){var n=e.filter(function(e){return e.value===d}),i=n.length&&n[0].label?n[0].label:d;s.append(t.readonly(i))}return e.readonly||!0===e.writeOnce&&void 0!==d?r.isFunction(u)?(u=u(),r.isPromise(u)?u.then(c):c(u)):c(u):s.append(l(g).edit({entries:u,getErrorContainer:function(){return P(s)},invalidEntryMessage:e.invalidEntryMessage,onChange:function(t,i){o||h(n,{key:a,value:t}),d=t,e.onChange&&e.onChange(t,i)},parentElem:s,showLabelInTextInput:!0,value:d})),s},icon:function(n,a){var o,l=n.id,s=!0===n.isStateless,d=l&&a.attr(l)||n.valueFunction&&n.valueFunction()||n.defaultValue||"",u=i("<div>").addClass("nx-pagebuilder-property-button-area"),c=i("<input>").attr("type","text").addClass("nx-picker-icon-input").val(d).appendTo(u),p=i("<button>").addClass("nx-picker-icon-btn nx-picker-icon-runtime"),f=i("<div>").append(e.ui.createIcon(""===d?"sk-webicon-font-awesome:question":d)),m=i("<div>").addClass("nx-pagebuilder-property-button-wrapper");if(n.readonly){var b=i("<div>").addClass("nx-pagebuilder-property-button-area").append(t.readonly(d));return m.append(f).css("margin-top","6px"),[m,b]}return p.append(f),p.on("click",function(){o?o.dialog("open"):(k(o=i("<div>"),c,f),o.dialog({width:Math.max(.7*document.documentElement.clientWidth,800),height:Math.max(.6*document.documentElement.clientHeight,600),title:"Choose an Icon",resizable:!1,modal:!0,open:function(){var e=i(".nx-picker-header");i(".nx-picker-body").height(e.parent().outerHeight()-e.outerHeight()-21)}}))}),m.append(p),r.delayInputCallback(c,function(t){f.empty().append(e.ui.createIcon(""===t?"sk-webicon-font-awesome:question":t)),s||h(a,{key:l,value:t}),n.onChange&&n.onChange(t)}),[m,u]},formula:function(n,a){var l,s=n.fieldState,d=s.attr("name")?s.attr("name"):s.attr("id"),c=n.id,p=i("<div>").addClass("nx-field").css({float:"left",width:"100%"}),f=i("<textarea>").css({height:"155px","font-family":"Courier"}).appendTo(p),m=function(e){var t=f.val(),n=f.getCursorPosition(),i=[];0===n?e+=t:n===t.length?e=t+e:(i[0]=t.substring(0,n),i[1]=t.substring(n,t.length),e=i[0]+e+i[1]),f.val(e).trigger("change")},b=i('<div class="nx-actionbutton">').actionSelect({items:[{value:"",label:"Insert Field",icon:"sk-icon-add",onSelect:function(){var t,a,r,l,s,u,c,p,h,f,b,v=!1;h?p||h.dialog("open"):(h=i("<div>").addClass("nx-picker-wrapper").css("z-index","104"),u=i("<div>").appendTo(h).addClass("nx-pagebuilder-fieldpicker-header"),s=i("<div>").appendTo(u),c=i("<div>").appendTo(u).addClass("nx-pagebuilder-fieldpicker-headertext"),l=i("<div>").appendTo(h).addClass("nx-pagebuilder-fieldpicker-body"),b=n.showObjectPickerIfPolymorphic,n.modelName&&(a=n.modelName),a&&(r=o.getModelFromModelName(a)),((v=o.getSObjectNameFromModelName(a))||r)&&(t=[{rel:f=v||a,ref:f,id:a}],r&&o.getModelPathToContent(r)&&t&&(t=o.createBreadcrumbForModel(r)),b&&(t[0].isPolymorphic=!0),p=e.builder.desktop.makeFieldSelector(t,{showObjectPickerIfPolymorphic:b,showUiOnlyFields:!0,useMetadataOverrides:!0,element:l,headertext:c,filterboxwrapper:s,onChange:function(e){m("{{"+e.fieldId+"}}"),h.dialog("close")},filter:function(e){return(e.name?e.name:e.id)!==d}})),i.when(p).then(function(){h.dialog({width:800,height:400,title:"Select Field",resizable:!1,modal:!1})}))}}],type:"button"}),v=i('<div class="nx-actionbutton">').actionSelect({onItemSelect:function(e){e.value&&m(e.value)},maxHeight:"170px",items:[{value:"",label:"Insert Operator",icon:"sk-icon-add"},{value:"+",label:"+  Add"},{value:"-",label:"-  Subtract"},{value:"*",label:"*  Multiply"},{value:"/",label:"/  Divide"},{value:"==",label:"== Equals"},{value:"!=",label:"!= Does not Equal"},{value:">",label:"> Greater than"},{value:">=",label:">= Greater than or Equal to"},{value:"<",label:"< Less than"},{value:"<=",label:"<= Less than or Equal to"},{value:" and ",label:"And"},{value:" or ",label:"Or"}],type:"button"}),g=i('<div class="nx-actionbutton">').actionSelect({uniqueId:"function-inserter",onItemSelect:function(e){e.value&&m(e.value)},maxHeight:"170px",items:[{value:"",label:"Insert Function",icon:"sk-icon-add"}].concat(e.builder.core.formula.getFormulasAsItems()),type:"button"}),y=i("<div>").text("Enter Formula").addClass("nx-basicfieldeditor-item-label").css({float:"left",width:"20%",clear:"none"}),C=i("<div>").addClass("nx-pagebuilder-property-button-wrapper").css({position:"relative",right:"-4px"}).append(b,v,g),w=i("<div>").append(y,C),S={};"node"==n.location&&c?S.childNodeName=c:"attribute"==n.location&&(S.key=c),!(l=u(a,n))&&n.defaultValue&&(l=n.defaultValue,S.value=l,h(a,S));var k=o.getComponentFromState(a);return n.readonly||k&&"readonly"===k.mode?(y.text("Formula Value"),[y,t.readonly(l)]):(l&&f.val(l),r.delayInputCallback(f,function(e){!function(e){S.value=e,h(a,S)}(e),n.onChange&&n.onChange(e)}),[w,p])},numberbox:function(e,n){var o,r,l=u(n,e)||0,s=i("<div>").addClass("sk-numberbox-wrapper"),d=[],c=e.boxes,p=function(e){a(d,function(t){i(this).toggleClass("sk-selected",t<e)})};if(e.readonly)return t.readonly(l);for(r=0;r<c;r++)o=i("<div>").addClass("sk-numberbox").css("width",100/c+"%"),d.push(o);return s.append(d),p(l),s.on("click",".sk-numberbox",function(){var t=i(this).index()+1;h(n,{value:t,key:e.id}),p(t),e.onChange&&e.onChange(t)}),s},quicknumber:function(e,n){var o=u(n,e),r=i("<div>").css({width:"80%",display:"inline-block"}),s=i("<div>").css({width:"20%",display:"inline-block"}),d=function(t){h(n,{value:t,key:e.id}),function(t){var n=r.children();n.filter(".sk-selected").removeClass("sk-selected"),a(n,function(n){t==e.options[n]&&i(this).addClass("sk-selected")})}(t),c.val()!=t&&c.val(t),e.onChange&&e.onChange(t)};if(e.options&&(a(e.options,function(){var e=i("<div>").addClass("sk-optionbutton").text(this);o==this&&e.addClass("sk-selected"),r.append(e)}),r.on("click",".sk-optionbutton",function(){d(e.options[i(this).index()])})),e.readonly)s.append(t.readonly(o)),r.off("click");else{var c=l(y).edit({value:u(n,e),onChange:d});s.append(c)}return[r,s]},color:function(e,t){var n=e.id,i=!0===e.isStateless,a=n&&t.attr(n)||e.valueFunction&&e.valueFunction()||e.defaultValue||"";return l("COLOR")[e.readonly?"read":"edit"]({value:a,placeholder:e.placeholder,onChange:function(a,o){e.beforeChange&&e.beforeChange(a,o),i||h(t,{key:n,value:a}),e.onChange&&e.onChange(a)}})},csssize:function(n,r){var l,s,d=n.id,u=!0===n.isStateless,c=d&&r.attr(d)||n.valueFunction&&n.valueFunction()||n.defaultValue||"",p=function(){var e=l&&s?l+s:"";n.beforeChange&&n.beforeChange(e),u||h(r,{key:d,value:e}),n.onChange&&n.onChange(e)},f=e.utils.getCSSSizeObj(c),m=[],b=i("<div>"),v=[{value:"px",label:"px"},{value:"em",label:"em"},{value:"rem",label:"rem"},{value:"%",label:"%"},{value:"vh",label:"vh"},{value:"vw",label:"vw"}];return n.allowUnits?a(n.allowUnits,function(e,t){var n=v.filter(function(e){return e.value===t})[0];n&&m.push(n)}):m=v,0===m.length?b:(f?(l=f.number+"",s=f.unit):(l="",s=m[0].value),s||(s=n.defaultUnit||"px"),n.readonly?t.readonly(l+(l?" "+s:"")):(b.append(t.picklist({isStateless:!0,value:s,picklistEntries:m,onChange:function(e){s=e,p()}}).css("width","50px").css("float","right")),b.append(i("<div>").append(o.getValueEditorFromMetadata({isStateless:!0,valueFunction:function(){return l},validator:o.validators.numericOnly,onChange:function(e){l=e,p()}})).css("margin-right","58px")),b))},component:function(t,n){var a,l,s=t.id,d=!0===t.isStateless,u=t.filter,c=u&&r.isString(u),p=u&&i.isArray(u),f=["skootable","basicfieldeditor"];return a=!0===d?t.value||t.valueFunction&&t.valueFunction()||t.defaultValue:n.attr(s)?n.attr(s):t.defaultValue||"",l=i("<select>"),i.each(e.builder.desktop.getComponents(),function(e,t){var n=t.builder.name.toLowerCase().match(/[a-zA-Z]/g).join(""),a="",r="";if(u&&(c&&n!==u||p&&i.inArray(n,u)<0))return!0;"field"===n&&f.forEach(function(e){if(t.state.parents(e).length){r=e;var n=o.getBuilder(e);n&&(a=n.name+" ")}}),n=r+n,0==l.find("[componentname="+n+"]").length&&l.append('<optgroup componentname="'+n+'" label="'+a+t.builder.name+'"> <optgroup>'),l.find("[componentname="+n+"]").append("<option>"+t.state.attr("uniqueid")+"</option>")}),l.val(a),l.on("change",function(i){var o=i.target.value;!function(e){function t(){e.css("outline","3px dashed #F08B1E")}function n(){e.css("outline","")}for(var i=0;i<3;i++)setTimeout(t,2*i*500/2),setTimeout(n,500*(2*i+1)/2)}(e.builder.desktop.getComponents()[o].element),h(n,{key:s,value:o}),t.onChange&&t.onChange(o,a)}),i("<div>").append(i('<label class="nx-basicfieldeditor-item-select-label">').append(l))},custom:function(t,n){var a=t.renderProperty,o=i("<div>");if(!a||"function"!=typeof a)return o;var r={element:o,state:n,updateState:function(){var t,i=arguments;i.length>=1?(t=1===i.length?{key:i[0].key,value:i[0].value}:{key:i[0],value:i[1]},h(n,t)):e.events.publish("skuidBuilderSave")}};return a(r),r.element},standard:function(e,n){return e.readonly?t.readonly(u(n,e)):o.getValueEditorFromMetadata(e,n,e.id)},snippet:function(e,t){var n=i("<div>"),a=e.id,r=t.attr(a);return n.append(l(g).edit({entries:o.getSnippetNames,getErrorContainer:function(){return P(n)},onChange:function(e){h(t,{key:a,value:e})},parentElem:n,value:r})),n}},a({sobject:"entity",multipicklist:"picklist"},function(e,n){t[e]=t[n]}),o.buildIconPicker=k,o.getThemeResources=C,o.propertyRenderers=t,o.getFirstModelOnPage=function(){var e;return s().children().each(function(){var t=i(this);return e=t.attr("id"),-1}),e}}(skuid)},301:function(e,t,n){"use strict";var i,a,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t=e.$,n=e.builder={},i=n.core={},a=e.utils,r=e.platform,l=a.isString,s=a.escapeSelector,d=a.makeXMLDoc,u=e.snippet,c=e.events.publish,p=e.dataSource,h=e.ui.getRenderer,f={},m=t(),b={},v=e.constants.DISPLAY_TYPES,g=v.BASE64,y=v.BOOLEAN,C=v.COMBOBOX,w=v.CURRENCY,S=v.DATE,k=v.DATETIME,P=v.DOUBLE,x=v.EMAIL,F=v.INTEGER,T=v.NUMBER,N=v.MULTIPICKLIST,A=v.PERCENT,E=v.PHONE,I=v.PICKLIST,M=v.REFERENCE,R=v.STRING,L=v.TEXTAREA,O=v.TEXT,D=v.TIME,B=v.URL,V=e.constants.SALESFORCE,q="node",U="attribute",_=/[^A-Za-z0-9_]+/g,j=/[^A-Za-z0-9_]+/g,G=/[^A-Za-z0-9_]+/g,X={inline:"(function(skuid){\n\tvar $ = skuid.$;\n\t$(document.body).one('pageload',function(){\n\t\tvar myModel = skuid.model.getModel('MyModelId');\n\t\tvar myComponent = skuid.component.getById('MyComponentUniqueId');\n\t});\n})(skuid);",inlinesnippet:"var params = arguments[0],\n\t$ = skuid.$;\n",inlinecomponent:"var element = arguments[0],\n\t$ = skuid.$;\n\nelement.html('Hello <b>world!</b>');"},W=r.getEntityFieldName("page","composer_settings");function H(e){var t=e.starter,n=e.isUnique;t||(t="NewValue");var i,o,r=t.substring(t.length-1,t.length);for(a.isNumber(r)?(o=parseInt(r,10)-2+3,i=(t=t.substring(0,t.length-1))+o):(i=t,o=1);!n(i);)i=t+""+o++;return i}function z(e){return H({starter:e||"NewModel",isUnique:function(e){return 0===Fe(e).length}})}function Y(e,t){var n,i=e.split("."),a=i.shift(),o=a.charAt(0),r=(t?t.toLowerCase()+o.toUpperCase():o.toLowerCase())+a.slice(1);if(i.length)for(n=0;n<i.length;n++)r+=(a=i[n]).charAt(0).toUpperCase()+a.slice(1);return r.replace(/_/g,"").substring(0,25)}function K(e){t.extend(this,e)}i.fonts={webFontsLoaded:!1,web:[],standard:["Arial/Arial, Helvetica, sans-serif",'Comic Sans MS/"Comic Sans MS", cursive, sans-serif','Courier New/"Courier New", Courier, monospace',"Georgia/Georgia, serif",'Lucida Sans Unicode/"Lucida Sans Unicode", "Lucida Grande", sans-serif',"Tahoma/Tahoma, Geneva, sans-serif",'Times New Roman/"Times New Roman", Times, serif','Trebuchet MS/"Trebuchet MS", Helvetica, sans-serif',"Verdana/Verdana, Geneva, sans-serif"]},i.prefillMetadataForObject=function(e,t,n){p.getDataSource(t).prefillMetadataForObject(e,n)},n.ink={},i.validators={modelId:function(e,t){if(_.test(e))return"Model Ids can only contain letters, numbers, or underscores.";var n=Fe(e);return!n.length||n[0]===t[0]||"There is already another Model with this name."},fieldId:function(e){var t,n=e.field,i=e.model,a=e.newFieldId;return!(t=i?i.children("fields, groupby").children('[id="'+s(a)+'"]'):null)||!t.length||t.index()===n.index()||"There is already another Field in this Model with this id."},conditionName:function(e,t){if(j.test(e))return"Condition Names can only contain letters, numbers, or underscores.";var n=Ee(e,t.state.closest("model").attr("id"));return!n.length||n[0]===t[0]||'There is already another Condition with the name "'+e+'" on this Model."'},alphaNumericUnder:function(e,t){t||(t={});var n=t.description||"Input";return!G.test(e)||n+" may only contain letters, numbers, or underscores."},uniqueAttribute:function(e,n,i){i||(i={}),!1===i.hasOwnProperty("attribute")&&(i.attribute="id");var a=!0,o=i.description||"item",r=i.attributeDescription||"value";return!0===i.hasOwnProperty("nodeList")&&t.each(i.nodeList,function(){var l=t(this);if(l.attr(i.attribute)===e&&l!==n.state)return a="There is already another "+o+" with the "+r+" of "+e,!1}),a},numericOnly:function(e){return!1!==a.isNumber(e)||"Must contain a numeric value"}},i.defaultStateGenerators={model:function(){return d('<model id="'+z()+'" limit="20" query="true" createrowifnonefound="false"/>')},field:function(e){var t="string"==typeof e,n=t?e:e.id,i=d('<field id="'+n+'"/>');if(!t&&e.needsAlias){var a=e.functionName;i.attr("name",e.alias?e.alias:Y(n,a)),a&&i.attr("function",a)}return e.isRelationship&&(i.attr({type:"childRelationship",limit:"10"}),e.keyField&&(i.attr("keyfield",e.keyField),i.attr("anchorfield",e.anchorField),i.attr("childobject",e.childObject))),i},label:function(e){return d("<label"+(e?' id="'+e+'"':"")+"/>")},jsitem:function(){return d('<jsitem location="inlinesnippet" name="newSnippet" cachelocation="false"/>').text(X.inlinesnippet)},cssitem:function(){return d('<cssitem location="inline" name="newcss" cachelocation="false"/>')},javascript:function(){return d("<javascript/>")},labels:function(){return d("<labels/>")},css:function(){return d("<css/>")}},i.coreProps={uniqueIdProp:function(e){var t=e&&e.component,n=e.isSubComponent;if(!t&&!0!==n)throw"A component param is required to use uniqueIdProp";return{id:"uniqueid",type:"string",label:e.label||"Unique Id",helptext:e.helptext||"Required parameter that uniquely identifies this component within the Skuid framework.",validator:function(a){if(e.validator){var o=e.validator(a);if(!0!==o)return o}if(!0===n)return!0;if("string"!=typeof a||null===a||0===a.trim().length)return"Unique Id is a required field. Please provide a non-empty value.";var r,l=[],s=ee();for(r in s)!0!==s[r].hideFromComponentsList&&l.push(r);var d=Ce().find("> components").find(l.join(","));return i.validators.uniqueAttribute(a,t,{attribute:"uniqueid",description:"component",attributeDescription:"Unique Id",nodeList:d})},onChange:function(t,i){!0!==n&&Be({type:"component.uniqueIdChange",oldId:i,newId:t}),e.onChange&&e.onChange(t,i)}}},domIdProp:function(e){return t.extend({id:"domid",type:"string",label:"DOM Id",helptext:"Optional parameter that gives this component's DOM element an id attribute."},e||{})},cssClassProp:function(e){return t.extend({id:"cssclass",type:"string",label:"CSS Class",helptext:"Optional parameter that gives this component's DOM element a CSS class."},e||{})}},u.registerSnippet("skuid.builder.page.preview",function(n){var o,l,s=n.model,u=n.row||s.getFirstRow(),c=!0===n.saveFirst,h=n.editor,f=n.params||{},m=t("body"),b=!1,v=!1,g=_e(),y=r.getEntityFieldNames("page");function C(e,n){var i=r.getBasePreviewUrl(e,n);t.each(f,function(e,t){i+="&"+e+"="+t}),l?l.location=i:function(e){l=window.open(e||"")}(i)}function w(){var e=i.getPageModels().find('condition[type="param"][inactive!="true"]');if(i.masterPage){var t=i.getMasterPageXML().children("models");e=e.add(t.find('condition[type="param"][inactive!="true"]'))}return e}function S(){var n,o=i.getPageModels(),r=w(),l={},s=[],h=o.find('field[defaultvaluetype="param"]');if(i.masterPage){var f=i.getMasterPageXML().children("models");h=h.add(f.find('field[defaultvaluetype="param"]'))}if(r.length||h.length){l={},n={},r.each(function(){var e=t(this),i=e.attr("value");if(!i||i.toLowerCase()in l)return!0;var a,o=e.closest('condition[type="join"][joinobject][inactive!="true"]'),r=e.closest("model"),d=e.attr("field");if(a=o.length?o.attr("joinobject"):r.attr("sobject")){var u,c,p=Ae(r),h=p.buildEntityMetadataRequest({model:r,targetEntity:a}),f=p.getCachedEntityMetadata(h),m=!f,b=d&&f&&!f.getField(d);(m||b)&&((c=n[p.name])||(c=n[p.name]={}),delete h.dataSource,c[u=JSON.stringify(h)]||(c[u]={fields:{}}),d&&(c[u].fields[d]=1))}s.push(e)}),h.each(function(){var e=t(this),n=e.attr("defaultValue");if(!n||n.toLowerCase()in l)return!0;e.attr("value",n),s.push(e)});var g=[],S=t.Deferred();if(a.size(n)){b=!0,m.block({message:"Retrieving metadata for fields associated with URL Parameter Conditions..."});var k=[];t.each(n,function(e,n){var i=p.getDataSource(e||"salesforce"),a=t.Deferred(),o=[];k.push(a.promise()),t.each(n,function(e,t){var n=JSON.parse(e);n.dataSource=i,t.fields&&(n.fields=Object.keys(t.fields)),o.push(n)}),i.getEntityMetadata({entities:o,ignoreMetadataOverrides:!0}).then(function(){a.resolve()},function(e){a.reject(e)})}),t.when.all(k).then(function(){S.resolve()},function(e){S.reject(e)})}else S.resolve();S.then(function(){if(g.length)return t.when.all(g)}).then(function(){m.unblock()}).catch(function(e){m.block({message:e,timeout:4e3})}).always(function(){!function(){t.each(s,function(){var e,n,i,o=t(this),r=o.attr("value"),s=o.attr("field"),d=o.closest('condition[type="join"][joinobject]'),u=o.closest("model"),c=Ae(u);if(i=d.length?d.attr("joinobject"):u.attr("sobject"),"ID"===(e=s?t.extend(!0,{},pe(u,s,i)):{displaytype:O}).displaytype){var p=r+"__FakeLookup";e.id=p+"__c",s=e.id,t.extend(e,{editable:!0,filterable:!0,displaytype:M,ref:i,rel:p+"__r"}),n={id:e.rel+"."+a.getNameField(i)}}else e.displaytype===M?n={id:e.rel+"."+a.getNameField(e.rel)}:e.displaytype===I&&(e.displaytype=O);e.createable=!0,e.editable=!0,e.overrideMetadata=!0,!r||r.toLowerCase()in l||(l[r.toLowerCase()]={field:s,fieldInfo:e,refInfo:n,sobject:i,dataSource:c})});var n=t("<div>").addClass("nx-basicfieldeditor nx-editor-contents").prepend(t("<div>").css({border:"solid 1px #ddd",backgroundColor:"#efefef",padding:"6px",marginBottom:"10px"}).html('A condition/default values was set for this page that references a URL parameter. Please provide a sample value for that URL Parameter so that the Page will behave appropriately.<br/><br/>If the Parameter is on a Reference field, please enter the Name (e.g. "ACME"), not the Id, in the Autocomplete. Skuid will grab the related record and use its Id for the preview.')),i=[];function o(e){var i="",o=[];n.find(".nx-previewfield").each(function(){var e=t(this).data("param"),n=t(this).data("object"),r=n.metadata.id?a.getObjectProperty(n.row,n.id):n.element.find("input").val();if(n.metadata&&n.metadata.keyField&&(r=r[n.metadata.keyField]),!r||r&&n&&-1!==t.inArray(n,["ID",M])&&r.length<15)return o.push("Please select a value for Parameter "+e),!0;r&&(i+="&"+e+"="+encodeURIComponent(r))});var r=n.find(".nx-messages");o.length?(r.length?r.empty():r=t('<div class="nx-messages"/>').appendTo(n),t.each(o,function(){r.append(t('<div class="nx-property-error">'+this+"</div><br/>"))})):(C(u,i),r.length&&r.empty().hide(),e.remove())}function r(){i&&i.length&&t.each(i,function(e,t){t.unregister()})}t.each(l,function(a){var o,r,l,s,d=this,u=t("<div>").addClass("nx-basicfieldeditor-item nx-pagebuilder-property-item"),c=t("<div>").addClass("nx-basicfieldeditor-item-label").text(a+(d.fieldInfo.ref?" ("+(-1!==d.fieldInfo.ref.indexOf(",")?"multiple objects":this.fieldInfo.ref)+")":"")),p=d.dataSource;n.append(u),u.append(c),o=new e.model.Model({fields:d.refInfo?[d.fieldInfo,d.refInfo]:[d.fieldInfo],data:[],conditions:[],createRowIfNoneFound:!0,doClone:!1,objectName:this.sobject,preventUnloadIfUnsavedChanges:!1,dataSourceName:p.name,dataSourceTypeName:p.getDataSourceTypeName()}).initialize().register(),i.push(o),g.push(o.once("initialized").then(function(){r=o.getFirstRow(),l={fieldId:d.field,mode:"edit",useSOSLSearch:!0,SOSLFields:"Name Fields",tokenizeSearch:"true"},(s=new e.ui.Field(r,o,!1,l)).metadata=d.fieldInfo,s.element.addClass("nx-previewfield").data("param",a),s.render(),u.append(s.element)}))});var c="Set Parameters needed to View Page: "+u[y.name],p=a.generateGUID(),h="PreviewWindowGo_"+p;n.dialog({width:500,height:400,title:c,resizable:!1,modal:!0,close:function(){t(this).remove(),r(),e.hotkeys.unbind(h)},buttons:[{text:"Go",id:h,click:function(){r(),o(t(this))}},{text:"Cancel",id:"PreviewWindowCancel_"+p,click:function(){n.dialog("close")}}]}),e.hotkeys.bind(d("<keys/>").append(d('<k key="return" ignoretextinputs="true"/>')),h,function(){o(n)},t("#"+h))}()})}else b||v||c?function(){var n=t("<div>").addClass("nx-basicfieldeditor nx-editor-contents").css({"min-height":"200px"}).append(t("<div>").css({padding:"6px",marginBottom:"10px","word-wrap":"break-word",height:"60px",width:"600px"}).html('<h1 style="font-weight: 700; font-size: 1.2em;">'+a.encodeHTML(u[y.name])+"</h1><br/>Click <b>Go</b> to preview this page "+(e.mobile?"":" in a new window"))),i=e.utils.generateGUID(),o="PreviewWindowCancel_"+i,r="PreviewWindowGo_"+i;function l(){C(u),n.dialog("close")}n.dialog({width:640,title:"Preview Page",resizable:!1,modal:!0,close:function(){e.hotkeys.unbind(r),t(this).remove()},buttons:[{text:"Go",id:r,click:l},{text:"Cancel",id:o,click:function(){n.dialog("close")}}]}),e.hotkeys.bind(d("<keys/>").append(d('<k key="return" ignoretextinputs="true"/>')),r,l,t("#"+r))}():C(u)}var k=t.Deferred();if(n.xml)k.resolve(n.xml);else{var P=!1;t.each(g,function(e,t){if(u.hasOwnProperty(t))return P=!0,!1}),P?k.resolve(s.getFieldValues(u,g,!0).join("")):(v=!0,m.block({message:"Loading page layout data to check for required parameters..."}),k=e.platform.services.page(u[y.name],u[y.module]).then(function(e){return e.xml}))}t.when(k).then(function(n){if(m.unblock(),n.jquery)i.pageXML=n;else{if(!n)return void window.alert("This page does not have any layout yet. Please continue building your page before previewing.");o=d(n),i.pageXML=o}if(c){m.block({message:"Saving Page..."});var a=function(e){m.unblock(),e.totalsuccess&&S()};h?h.save({callback:function(e){a(e)}}):s&&s.save({callback:function(e){a(e)}})}else(r=w().toArray().reduce(function(e,n){var i=(n=t(n)).closest("model"),a=i&&i.attr("datasource");return a&&!e.includes(a)&&e.push(a),e},[]),r.length?e.loader.service.loadDataSourcesAndDependencies(r):t.when()).then(function(){S()});var r})}),u.registerSnippet("skuid.builder.page.triggerVersionCheck",function(e){ae(e.model,e.row)}),K.prototype={renderComponent:function(t,n){this.componentRenderer?this.componentRenderer(t,n):function(t){t.setTitle(t.builderId),t.body.css("padding","8px").text(e.$L("pb_no_component_renderer"))}(t)},renderProperties:function(n,i){i.mode?n.mode=i.mode:delete n.mode,this.propertiesRenderer?this.propertiesRenderer(n,i):function(n,i){n.clear(),n.setTitle(i.builderId+" "+e.$L("properties")),n.body.append(t("<div>").addClass("nx-pagebuilder-infotext").text(e.$L("pb_no_properties_renderer")))}(n,i)},getDefaultState:function(e,t){var n=this.defaultStateGenerator?this.defaultStateGenerator(e):d("<"+this.id+"/>");return t&&t.setUniqueId&&!n.attr("uniqueid")&&n.attr("uniqueid",a.generateUniqueId()),n}};var $={};function Q(){return t.map($,function(e){return e})}function J(e){f[e.id]=e}function Z(e){return f[e]}function ee(){return f}function te(e,n){n||(n={location:q});var i,a=n.storeAs,o=n.location,r=!0===n.isStateless,l=n.id,s=n.defaultValue;if(o||(o=l?U:q),!0===r)i=n.value||n.valueFunction&&n.valueFunction();else if(a){if(a.type===q&&a.name){var d=e.children(l).first().children(a.name);1===d.length?i=d.first().text():d.length>1&&(i=[],t.each(d,function(){i.push(t(this).text())}))}}else i=o===U?e.attr(l):l?e.children(l).first().text():e.text();return t.isArray(i)&&0===i.length?i.push(s):void 0===i&&(i=s),i}function ne(e,t,n){var i={value:n};return(t.location||q)===q&&t.id?i.childNodeName=t.id:t.location===U&&(i.key=t.id),ie(e,i)}function ie(n,i){i||(i={});var a=!1;if(n){var o,r=n;i.selector?r=n.find(i.selector):i.childNodeName&&(r=n.children(i.childNodeName)).length<1&&(r=d("<"+i.childNodeName+"/>").appendTo(n)),i.storeAs&&i.storeAs.type&&"node"===i.storeAs.type?(r.empty(),t.each(i.value,function(e,t){r.append(d("<"+i.storeAs.name+"/>").text(t))}),a=!0):i.key?(o=r.attr(i.key),(a=void 0!==i.value&&i.value!==o)&&r.attr(i.key,i.value)):(a=i.value!==r.text())&&r.text(i.value),""===i.value&&i.key&&r.removeAttr(i.key),!i.childNodeName||void 0!==i.value&&""!==i.value||r.remove()}a&&e.events.publish("skuidBuilderSave")}function ae(e,t){var n,i=null,a={};e.hasChanged&&(i=e.getField("skuid__Last_Modified_Date_Check__c"),n=e.getFieldValue(t,"LastModifiedDate"),i&&n&&(a[i.id]=n,e.updateRow(t,a)))}var oe=[T,F,y,w,S,k,P,A],re=[R,O,L,E,x,I,B,C,g],le=[T,R,L,E,x,I,B,C,g,S,k,P,F,A,w,D],se={name:"=",longname:"is",validFor:["fieldvalue","param","userinfo","datasourceuserinfo","blank","modelmerge","dependent","searchfield","contextrow"]},de={"data.length":F,hasChildRows:y,hasNoChildRows:y,hasRows:y,hasNoRows:y,hasChanged:y,isNew:y,isCloned:y,isSaved:y,isMarkedForDeletion:y},ue={"":se,"=":se,"!=":{name:"!=",longname:"is not",validFor:["blank","contextrow","datasourceuserinfo","dependent","fieldvalue","modelmerge","param","userhaspermission","userinfo"]},gt:{name:">",longname:"is greater than",validFor:["fieldvalue","param","userinfo","modelmerge","dependent"],validForDisplayTypes:le},lt:{name:"<",longname:"is less than",validFor:["fieldvalue","param","userinfo","modelmerge","dependent"],validForDisplayTypes:le},gte:{name:">=",longname:"is greater than or equal to",validFor:["fieldvalue","param","userinfo","modelmerge","dependent"],validForDisplayTypes:le},lte:{name:"<=",longname:"is less than or equal to",validFor:["fieldvalue","param","userinfo","modelmerge","dependent"],validForDisplayTypes:le},in:{name:"in",longname:"is in the set of values",validFor:["modelmerge","multiple","join","search","contextrows"]},"not in":{name:"not in",longname:"is not in the set of values",validFor:["modelmerge","multiple","join","contextrows"]},includes:{name:"includes",longname:"includes one or more of these values",validFor:["fieldvalue","param","userinfo","modelmerge","dependent","multiple","searchfield"],validForDisplayTypes:[N]},excludes:{name:"excludes",longname:"does not include any of these values",validFor:["fieldvalue","param","userinfo","modelmerge","dependent","multiple"],validForDisplayTypes:[N]},"starts with":{name:"starts with",validFor:["fieldvalue","param","userinfo","modelmerge","dependent","searchfield"],validForDisplayTypes:re},"ends with":{name:"ends with",validFor:["fieldvalue","param","userinfo","modelmerge","dependent"],validForDisplayTypes:re},contains:{name:"contains",validFor:["fieldvalue","param","userinfo","modelmerge","dependent","searchfield"],validForDisplayTypes:re},"does not contain":{name:"does not contain",validFor:["fieldvalue","param","userinfo","modelmerge","dependent"],validForDisplayTypes:re},"does not start with":{name:"does not start with",validFor:["fieldvalue","param","userinfo","modelmerge","dependent"],validForDisplayTypes:re},"does not end with":{name:"does not end with",validFor:["fieldvalue","param","userinfo","modelmerge","dependent"],validForDisplayTypes:re}},ce={defaultcurrency:{label:"Default Currency"},firstname:{label:"First Name"},lastname:{label:"Last Name"},email:{label:"Email"},locale:{label:"Locale"},name:{label:"Name",value:"name"},organizationid:{label:"Organization Id"},organizationname:{label:"Organization Name"},profileid:{label:"Profile Id"},profilename:{label:"Profile Name"},sessionid:{label:"Session Id"},userid:{label:"User Id"},username:{label:"User Name"},userroleid:{label:"User Role Id"},usertype:{label:"User Type"},ismulticurrencyorganization:{label:"Is Multi Currency Org"}};function pe(n,i,a,o){o||(o={});var r,d,u,c,p,h,f,m,b,v,g,y,C,w,S,k,P=!1,x=!1!==o.readMetadataFromFieldNode,F="";if(n&&(l(n)?r=Fe(n):n.length&&(n=(r=n).attr("id"))),r&&(g=((y=Ve(r))?y+".":"")+i,c=r.children("fields,groupby").children('[id="'+s(i)+'"]')),g||(g=i),d=Ne(r),u=Ae(r),S="local"===(k=d.prop("runtime.metadataSource"))||"hybrid"===k,c&&c.length){if("true"===c.attr("uionly")||S&&x)return new e.model.Field({xml:c,dataSourceType:d,model:{pathToContent:y,id:n}});"childRelationship"===c.attr("type")&&(P=!0)}if(o.isChildRelationship&&(P=o.isChildRelationship),a||(a=n&&ve(n)),m=(f=g.split(".")).pop(),b=c&&c.attr("targetobjects"),v=b&&b.split(","),P||f.length&&t.each(f,function(e,n){if(F+=n+".",C=u.buildEntityMetadataRequest({model:r,targetEntity:a,path:F,ignorePathToContent:!0}),(p=u.getCachedEntityMetadata({entities:C}))&&t.each(p.getFieldsList(),function(e,t){if(t.rel===n)return a=t.ref,!1}),(w=a?a.split(","):[]).length>0)if(v){var i=v.shift();a=w.indexOf(i)?i:w[0]}else a=w.length>1?"Name":w[0]}),C=u.buildEntityMetadataRequest({model:r,targetEntity:a,path:F,ignorePathToContent:!0}),h=null,(p=u.getCachedEntityMetadata({entities:C}))&&!(h=p["get"+(P?"ChildRelationship":"Field")](m))&&g){var T=g.indexOf(".");-1!==T&&(h=p["get"+(P?"ChildRelationship":"Field")](g.substring(T+1)))}return c&&c.length&&h&&"true"===c.attr("overridemetadata")&&x?new e.model.Field({xml:c,field:t.extend({},h),dataSourceType:d,model:{pathToContent:y,id:n}}):h}function he(e,n){n||(n={});var i,a,o=e.state,r=o.attr("field"),l=n.modelName;if(o.is("field")?(i=o.attr("id"),l=o.closest("model").attr("id")):r&&(i=r,l||o.is("condition")&&(l=o.closest("model").attr("id"))),t.inArray(o.attr("sourcetype"),["modelproperty","rowproperty"])>-1)a={displaytype:de[o.attr("sourceproperty")]||"STRING"};else if(i){var s={},d="readMetadataFromFieldNode";!1===n[d]&&(s[d]=!1),a=pe(l,i,fe(e),s)}return a||(a=!1),a}function fe(t){var n,i=t.state;if(i.is("field"))n=i.closest("model").attr("sobject");else if(t.isSubcondition)n=i.parent().closest("condition").attr("joinobject");else if(t.isChildRelationshipCondition){var a=function(e,t,n){n||(n=e&&ve(e));var i=Ae(Fe(e)).getCachedEntityMetadata({entities:[{objectName:n}]});return i?i.getChildRelationship(t):null}(i.closest("model").attr("id"),i.closest(e.mobile?"mobilefield":"field, skuid__field").attr("id"));n=a.childObject||a.childSObject}else if(t.isLookupFilterCondition){var o=pe(i.parent().closest("[model]").attr("model"),i.closest(e.mobile?"mobilefield":"field, skuid__field").attr("id"));n=o?-1!==o.ref.indexOf(",")&&i.attr("fieldtargetobjects")?i.attr("fieldtargetobjects"):o.ref:null}else if(t.isReferenceFilterCondition){var r=pe(i.parent().closest("[model]").attr("model"),i.closest("filter").attr("conditionfield"));n=r?r.ref:null}else n=t.isRenderCondition||t.isUpdateAction?i.attr("fieldmodel")?ve(i.attr("fieldmodel")):ve(i.closest("[model]").attr("model")):t.isContextCondition?ve(i.closest("[model]").attr("model")):i.closest("model").attr("sobject");return n}var me=["Id","LastReferencedDate","LastViewedDate","Name","Type"],be=["FirstName","LastName"];function ve(e){return Fe(e).attr("sobject")}function ge(){var e=i.pageModel.getFieldValue(i.pageRow,W,!0);return e&&a.isString(e)?e=JSON.parse(e):e||(e={}),e}function ye(e){i.pageModel.updateRow(i.pageRow,W,JSON.stringify(e))}function Ce(){return i.pageXML}function we(){return i.masterPageXML}function Se(){return t(Ce()).find('> resources > javascript > jsitem[location="inlinesnippet"]')}function ke(){return t(we()).find('> resources > javascript > jsitem[location="inlinesnippet"]')}function Pe(){return t.extend({},ke(),Se())}function xe(){return Ce().children("models")}function Fe(e){e=a.escapeSelector(e);var t,n=Ce().children("models").children('model[id="'+e+'"]');return n.length||(t=we())&&(n=t.children("models").children('model[id="'+e+'"]')),n}function Te(e){var t=e.closest("model");if(t.length)return Ne(t)}function Ne(e){var t=Ae(e).getDataSourceType();return void 0===t?p.getType():t}function Ae(t){return e.dataSource.getDataSourceFromXML(t)}function Ee(e,t){var n;return l(t)?(n=Fe(t))&&(n=n.children("conditions")):t&&t.jquery&&"conditions"===t.prop("nodeName")&&(n=t),n?n.find('condition[name="'+e+'"]'):null}var Ie={field:function(e,t){if("search"===e.attr("type"))return"Id";if(e.attr("field")){var n=e.attr("fieldfunction"),i=n&&"DISTANCE"===n;return t+" records where <b>"+(n&&!i?n.toUpperCase()+"(":"")+e.attr("field")+(n&&!i?")":"")+"</b>"}return"[No Field Selected]"},operator:function(e){var t="search"===e.attr("type")?"in":e.attr("operator")||"",n=i.operatormap[t];return"<b>"+(n.longname||n.name)+"</b>"},value:function(e){var n,i,o,r=e.attr("type"),l=Te(e),s=e.attr("locationsource");if("fieldvalue"===r)n="<b>"+e.attr("value")+"</b>";else if("multiple"===r)n="",e.children("values").children().each(function(){n+=t(this).text()+", "}),n=n.substring(0,n.length-2);else if("param"===r)n=e.attr("value")?"the <b>"+e.attr("value")+" page parameters</b>":"[No Parameter Given]";else if("userinfo"===r)o=(i=ce[e.attr("userinfotype")])?i.label:"User Id",n="the <b>"+o+"</b> of the user running this page";else if("datasourceuserinfo"===r){var d=l&&l.getUserInfoProperties&&l.getUserInfoProperties()||[],u=a.keyBy(d,"value"),c=d.length&&d.find(function(e){return e.defaultValue}),p=e.attr("userinfotype")||c&&c.value;o=(i=u[p])?i.label:p,n="the <b>"+o+"</b> of the Data Source user accessing this Model's data"}else if("blank"===r)n="a <b>blank</b> value";else if("modelmerge"===r){var h=-1!==t.inArray(e.attr("operator"),["in","not in"]);n=e.attr("mergefield")?(h?"containing":"the value of")+" the <b>"+e.attr("mergefield")+"</b> field from "+(h?"any":"the first")+" row returned by the <b>"+e.attr("model")+"</b> model":"[No Merge Field Selected]"}else"join"===r?n=e.attr("joinfield")?"specified by returning <b>"+e.attr("joinfield")+"</b> values from a subquery on the <b>"+e.attr("joinobject")+"</b> object":"[No Join Field Selected]":"search"===r&&(n="returned by searching <b>"+(e.attr("fieldfunction")||"Name Fields")+"</b> for '<b>"+e.attr("value")+"</b>'");if(s){var f=e.attr("units");if(f&&(n+=" <b>"+("km"===f?"kilometers":"miles")+"</b> from "),"userlocation"===s)n+=" the running user's location.";else if("param"===s)n+=" the location provided in the <b>"+(e.attr("latitudefield")||"[No Latitude Parameter]")+"</b> and <b>"+(e.attr("longitudefield")||"[No Longitude Parameter]")+"</b> page parameters";else if("modelmerge"===s){var m=e.attr("locationmodel");n+=m?" the location provided in values of the <b>"+(e.attr("latitudefield")||"[No Latitude Field]")+"</b> and <b>"+(e.attr("longitudefield")||"[No Longitude Field]")+"</b> fields in the <b>"+e.attr("locationmodel")+"</b> model.":"[Please choose a Location Model and Latitude, Longitude Fields]"}}return n},state:function(e,t){var n="This "+t,i=e.attr("state");return i?"filterableon"===i||"filterableoff"===i?(e.attr("name")&&(n+=", named <b>"+e.attr("name")+"</b>,"),n+=" can be modified by filters, but is <b>"+("filterableon"===i?"on":"off")+" by default</b>."):"filterablerequired"===i?(e.attr("name")&&(n+=", named <b>"+e.attr("name")+"</b>,"),n+=" can be modified by filters, but is required and thus cannot be deactivated."):"fixed"===i?(e.attr("name")&&(n+=", named <b>"+e.attr("name")+"</b>,"),n+=" cannot be modified by filters, and is required, therefore it cannot be deactivated."):n+=" is <b>always off</b>":n+=" is <b>always on</b>.",n},parameter:function(e){var t=e.attr("sourceparam");return t?"<b>"+a.encodeHTML(t)+"</b> equals ":"[No Parameter provided]"}};var Me=[],Re=function(e,t){return e&&e.attr?e.attr(t):0};function Le(){var t=Me;return t=t.concat(e.offline.addActions())}var Oe=!1;e.events.subscribe("skuidBuilderNeedSave",function(){Oe=!0}),e.events.subscribe("skuidBuilderComponentNeedsRefresh",function(e){b[e._GUID]=e});var De,Be=function(e){var n=Ce(),i=e&&e.type;n&&(t.each(Q(),function(t,n){var i,a=n.builder;a&&(i=a.handleStateEvent)&&i(n.state,e,n)}),function e(n,i){var a,o=Z(n.prop("tagName"));o&&o.handleStateEvent&&(a=o.handleStateEvent(n,i)),!1!==a&&n.children().each(function(){e(t(this),i)})}(n,e),Oe&&(Oe=!1,c("skuidBuilderSave"))),i&&c("__skuid.builder."+i,[e])};function Ve(e){return"readwrite"===e.attr("type")?e.children("methods").children('method[type="query"][pathtocontent]').first().attr("pathtocontent"):e.attr("pathtocontent")}function qe(e){var n;return t.each(Q(),function(){if(e[0]&&this.state&&this.state[0]&&this.state[0]===e[0])return n=this,!1;n=!1}),n}function Ue(e){if(!e)return!1;var t=e.indexOf("("),n=e.indexOf(")");return!(!t&&n)&&e.substring(t+1,n).trim().split(",")}function _e(){return a.getLayoutFields()}t.extend(i,{Builder:K,getBuilder:Z,getBuilders:ee,getLayoutFields:_e,registerBuilder:J,registerBuilders:function(e){t.each(e,function(){J(this)})},registerComponent:function(t){return t._GUID=e.utils.generateGUID(),$[t._GUID]=t,t},unregisterComponent:function(e){delete $[e._GUID]},getComponentsList:Q,defaultJavaScriptResourceNames:{inline:"newInlineJS",inlinesnippet:"newSnippet",inlinecomponent:"newComponent"},defaultJavaScriptResourceBodies:X,dropStack:m,componentsNeedingRefresh:b,getStoredValue:te,updateState:ie,getStateProperty:te,updateStateProperty:ne,getFieldInfoFromCache:pe,getConditionDisplayString:function(e){var n,i,o,r=e.index()+1+": ",l=e.attr("type"),s="search"===l,d=e.attr("value"),u=e.attr("sourcetype"),c=e.attr("fieldfunction"),p=e.attr("operator"),h="false"!==e.attr("enclosevalueinquotes"),f=Te(e);if("param"===u)n=e.attr("sourceparam"),r+=n?"(param) '"+n+"'":"[No Parameter]";else{if("snippet"===u)return(n=e.attr("sourcesnippet"))?"Snippet '"+n+"' returns true":"[No Snippet]";if("boolean"===u)n=e.attr("sourceparam"),r+="(boolean) '"+n+"'";else if("userinfo"===u)n=e.attr("sourceuserinfotype"),r+=n?"(userinfo) "+n:"[No Property]";else{if(["feature","userhaspermission"].includes(u))return(n=e.attr("value"))?"(user "+("!="===p?"does not have":"has")+" "+("feature"===u?"feature":"perm")+") "+n:"[No "+("feature"===u?"Feature":"Permission")+" selected]";if("datasourceuserinfo"===u)n=e.attr("sourcedatasourcetypeuserinfo"),r+=n?"(userinfo) "+n:"[No Property]";else if("modelproperty"===u||"rowproperty"===u){if(!(n=e.attr("sourceproperty")))return r+"[No Property selected]";var m,b=e.attr("fieldmodel");if(m=b?b+" Model ":"Context Model ","modelproperty"===u){if("hasRows"===n||"hasNoRows"===n)return r+m+"has"+("hasNoRows"===n?" no":"")+" data rows";if("hasChildRows"===n||"hasNoChildRows"===n)return r+"Context row in the "+m+"has"+("hasNoRows"===n?" no":"")+(e.attr("childrel")||"[No Child Relationship]")+" data rows";r+="data.length"===n?"# of rows in the "+m:"hasChanged"===n?m+" has unsaved changes":m+" "+n}else{if(m="Context Row in "+m,"isNew"===n)return r+m+" is new";if("isCloned"===n)r+=m+" is clone of existing record";else if("hasChanged"===n)r+=m+" has unsaved changes";else{if("isSaved"===n)return r+=m+" already exists in database";"isMarkedForDeletion"===n&&(r+=m+" is marked for deletion")}}}else{r+=(c&&!s?c+"(":"")+(e.attr("field")||"[No Field]");var v=e.attr("locationsource"),g=e.attr("latitudefield"),y=e.attr("longitudefield");if(v)if(r+=",","userlocation"===v)r+="User Location";else if("param"===v)r+="("+(g?"(param) '"+g+"'":"[No Latitude Parameter]")+","+(y?"(param) '"+y+"'":"[No Longitude Parameter]")+")";else if("modelmerge"===v){var C=e.attr("locationmodel")||"[No Location Model]";r+="("+C+")("+(g||"[No Latitude Field]")+","+(y||"[No Longitude Field]")+")"}r+=c&&!s?")":""}}}if(r+=" "+ue[p||""].name+" ","param"==l)r+="(param) ";else if("userinfo"==l)o=(i=ce[e.attr("userinfotype")])?i.label:"User Id",r+="(userinfo) "+o;else if("datasourceuserinfo"==l){var w=f&&f.getUserInfoProperties&&f.getUserInfoProperties()||[],S=a.keyBy(w,"value"),k=w.length&&w.find(function(e){return e.defaultValue}),P=e.attr("userinfotype")||k&&k.value;o=(i=S[P])?i.label:P,r+="(data source user) "+o}else if("join"==l)r+="(SELECT "+(e.attr("joinfield")||"")+" FROM "+(e.attr("joinobject")||""),e.children("condition").length&&(r+=" WHERE (<Sub Conditions>)"),r+=")";else if("modelmerge"===l)r+="("+(e.attr("model")||"")+")("+(e.attr("mergefield")||"")+")";else if("multiple"===l){r+="(";var x=e.children("values").children();x.length&&(x.each(function(){r+=(h?"'":"")+t(this).text()+(h?"',":",")}),r=r.substring(0,r.length-1)),r+=")"}else if("dependent"===l){var F=e.attr("depfield")||"<Unspecified>";r+="the value of the '"+F+"' field from the current row"}else s&&(r+="the search of "+c+" for '"+d+"'");if(["datasourceuserinfo","param","userinfo"].includes(l)&&(h=!1),["blank","boolean","datasourceuserinfo","fieldvalue","param","userinfo"].includes(l)){h&&(r+="'"),r+=d||"";var T=e.attr("units");T&&(r+=" "+T),h&&(r+="'")}return"filterableon"!==e.attr("state")&&"filterableoff"!==e.attr("state")||!e.attr("name")||(r+=" (filterable as "+e.attr("name")+")"),"true"===e.attr("inactive")&&(r+=" (inactive)"),r},getModelFieldComponentLabel:function(e){var t,n,i,a;return e.jquery&&e.attr?(t=e.attr("name"),n=e.attr("function"),i=e.attr("id"),a="true"===e.attr("uionly")):(t=e.name,n=e.function,i=e.id,a=e.uiOnly),(t?t+" - "+(n?n+"("+i+")":i):i)+(a?" (Ui-Only)":"")},save:function(e,n,i){a.writeXmlToPageLayoutFields(e,n,i),ae(n,i);var o=a.size(b);o>0&&t.each(b,function(e,t){if(!(o>0))return!0;t&&t.refresh&&t.refresh(),delete b[e],o--})},userinfomap:ce,operatormap:ue,dateliteralmap:{YESTERDAY:{label:"Yesterday"},TODAY:{label:"Today"},TOMORROW:{label:"Tomorrow"},NOW:{label:"Now"},LAST_WEEK:{label:"Last Week"},THIS_WEEK:{label:"This Week"},NEXT_WEEK:{label:"Next Week"},LAST_N_WEEKS:{label:"Last n Weeks",merge:!0},NEXT_N_WEEKS:{label:"Next n Weeks",merge:!0},N_WEEKS_AGO:{label:"n Weeks Ago",merge:!0},LAST_MONTH:{label:"Last Month"},THIS_MONTH:{label:"This Month"},NEXT_MONTH:{label:"Next Month"},LAST_N_MONTHS:{label:"Last n Months",merge:!0},NEXT_N_MONTHS:{label:"Next n Months",merge:!0},N_MONTHS_AGO:{label:"n Months Ago",merge:!0},LAST_90_DAYS:{label:"Last 90 Days"},NEXT_90_DAYS:{label:"Next 90 Days"},LAST_N_DAYS:{label:"Last n Days",merge:!0},NEXT_N_DAYS:{label:"Next n Days",merge:!0},N_DAYS_AGO:{label:"n Days Ago",merge:!0},THIS_QUARTER:{label:"This Quarter"},LAST_QUARTER:{label:"Last Quarter"},NEXT_QUARTER:{label:"Next Quarter"},NEXT_N_QUARTERS:{label:"Next n Quarters",merge:!0},LAST_N_QUARTERS:{label:"Last n Quarters",merge:!0},N_QUARTERS_AGO:{label:"n Quarters Ago",merge:!0},THIS_YEAR:{label:"This Year"},LAST_YEAR:{label:"Last Year"},NEXT_YEAR:{label:"Next Year"},NEXT_N_YEARS:{label:"Next n Years",merge:!0},LAST_N_YEARS:{label:"Last n Years",merge:!0},N_YEARS_AGO:{label:"n Years Ago",merge:!0},THIS_FISCAL_QUARTER:{label:"This Fiscal Quarter",serverside:!0},LAST_FISCAL_QUARTER:{label:"Last Fiscal Quarter",serverside:!0},NEXT_FISCAL_QUARTER:{label:"Next Fiscal Quarter",serverside:!0},NEXT_N_FISCAL_QUARTERS:{label:"Next n Fiscal Quarters",serverside:!0,merge:!0},LAST_N_FISCAL_QUARTERS:{label:"Last n Fiscal Quarters",serverside:!0,merge:!0},N_FISCAL_QUARTERS_AGO:{label:"n Fiscal Quarters Ago",serverside:!0,merge:!0},THIS_FISCAL_YEAR:{label:"This Fiscal Year",serverside:!0},LAST_FISCAL_YEAR:{label:"Last Fiscal Year",serverside:!0},NEXT_FISCAL_YEAR:{label:"Next Fiscal Year",serverside:!0},NEXT_N_FISCAL_YEARS:{label:"Next n Fiscal Years",serverside:!0,merge:!0},LAST_N_FISCAL_YEARS:{label:"Last n Fiscal Years",serverside:!0,merge:!0},N_FISCAL_YEARS_AGO:{label:"n Fiscal Years Ago",serverside:!0,merge:!0}},getValidOperators:function(e){var n,a,o={},r=arguments;return e&&!l(e)&&1===r.length?(n=e.type,a=e.displayType):(n=r[0],a=r[1]),t.each(i.operatormap,function(e,i){if(e&&-1!==t.inArray(n||"fieldvalue",i.validFor)){var r=i.validForDisplayTypes,l=!0;r&&r.length&&a&&-1===t.inArray(a,r)&&(l=!1),l&&(o[e]=i)}}),o},determineQuotedness:function(e,n){var i,a=e.state,o=he(e,n),r=a.attr("sourcetype"),l=a.attr("type");o&&(i=o.displaytype),"blank"===l||t.inArray(r,["modelproperty","rowproperty"])>-1&&de[a.attr("sourceproperty")]||i&&-1!==t.inArray(i,oe)?a.attr("enclosevalueinquotes","false"):a.attr("enclosevalueinquotes","true")},getMetadataForField:he,isValidFieldForPossibleTargetObjects:function(e,n){return-1!==t.inArray("User",n)||(-1!==t.inArray("Contact",n)||-1!==t.inArray("Lead",n))&&-1!==t.inArray(e.id,be)||-1!==t.inArray(e.id,me)},isDistanceQueryable:function(e){return-1!==t.inArray(e,["LOCATION","ADDRESS"])},getConditionByName:Ee,isFilterableCondition:function(e){return a.startsWith(e.attr("state"),"filterable")},getDefaultAliasName:Y,getPageSettings:ge,updatePageSettings:ye,createComponentFromModel:function(e,t,n){var a=i.getBuilder(t);return a.createFromModel?a.createFromModel(e,n):a.getDefaultState(n,{setUniqueId:!0})},createModel:function(n,a){a||(a={});var o,r,l=Z("model"),s=!0===a.select;if(n&&!n.jquery)throw"Cannot create Model: initialState must be XML node";n||(n=l.getDefaultState()),o=xe(),s&&((r=t(".nx-pagebuilder-modelstab")).is(".nx-pagebuilder-toolbar-tab-selected")||r.click(),e.events.subscribeOnce("skuid.pageComposer.propertyPanel.afterRender",function(e){e.propertiesViewer.element.find("input")[0].focus()}));var d=i.getComponentFromState(o),u=i.componentFactory(n,l);return d.body.append(u.element),o.append(u.state),u.save(),s&&u.select(),u},createModelSettingsService:function(e){return new a.KeyValueService({id:e,type:"model",get:ge,set:ye})},createComponentSettingsService:function(e){return new a.KeyValueService({id:e,type:"component",get:ge,set:ye})},getPageXML:Ce,getMasterPageXML:we,getPageSnippets:Se,getMasterPageSnippets:ke,getSnippets:Pe,getSnippetNames:function(){return t.map(Pe(),function(e){return t(e).attr("name")})},isInMasterPage:function(e){return!!(i.masterPage&&e&&e[0]&&e[0].ownerDocument.children[0]===i.getMasterPageXML()[0])},getPageRegions:function(){var e=[],t=we();return t&&t.length&&t.children("components").find("pageregion").each(function(){e.push(this)}),i.getPageXML().children("components").find("pageregion").each(function(){e.push(this)}),e},getAllModelsInPage:function(){var e=we();return e&&e.children("models").length?e.children("models").clone().append(Ce().children("models").children("model").clone()):Ce().children("models")},getPageModels:xe,getPageRow:function(){return n.pagebuilderui.row},getFirstModel:function(){return xe().children("model").first()},getModelFromModelName:Fe,getDataSourceTypeFromModelName:function(e){var t=Fe(e),n=p.get(t.attr("datasource")||t.attr("service")||r.getDefaultDataSourceName());return t?n.getDataSourceType():null},getDataSourceTypeFromModel:Ne,getDataSourceFromModel:Ae,getDataSourceFromModelName:function(e){return Ae(Fe(e))},getModelPathToContent:Ve,getSObjectForField:fe,getSObjectNameFromModelName:ve,getUniqueModelName:z,getUniqueFieldName:function(e,t){return H({starter:e||"NewField",isUnique:function(e){return 0===t.children("groupby, fields").children('[id="'+e+'"]').length}})},isFieldInModel:function(e,t,n){if(!e||!t)return!1;n||(n={searchByName:!1});var i,a=n.searchByName;if(!0===l(e))i=Fe(e);else{if(!e.jquery)return!1;i=e}var o=!0===a?"name":"id",r=i.children("fields,groupby").find("field["+o+'="'+s(t)+'"]');return!!(r&&r.length>0)},addFieldToModel:function(n){n||(n={});var a,l,u=n.fieldId,c=n.view,h=n.isChildRelationship||c&&"childonly"===c,f=n.model,m=n.fieldBuilder||e.builder.fieldBuilder,b=t("body");if(a=m&&!e.mobile?function(e){return m.getDefaultState(e)}:i.defaultStateGenerators.field,u&&f){var v,g=n.fieldsNode,y=n.fieldsElement,C=n.targetObjects;g||(g=f.children("fields")),y||(v=qe(g),y=v&&v.element.find(".nx-pagebuilder-fieldschildren"));var x=g.children('[id="'+s(u)+'"]'),T="aggregate"===f.attr("type"),N=!!T&&g.is("groupby"),E=f.attr("id"),I=pe(E,u,null,{isChildRelationship:n.isChildRelationship}),R=I?I.displaytype:null,L=[],O=p.getType(f.attr("datasourcetype")||f.attr("adapter")||r.getDefaultDataSourceTypeName()),D=O.prop("runtime.metadataSource"),B="local"===D||"hybrid"===D;if(T||0===x.length){var q,U,_={id:u,needsAlias:T};if(T&&(N?R===k&&O.name===V&&(q="CALENDAR_YEAR"):q=I&&t.inArray(R,["NUMBER",w,P,F])>-1?"SUM":I&&R===A?"AVG":!I||R!==S&&R!==k?"COUNT":"MAX"),q&&(_.functionName=q),h){var j=t.Deferred(),G=Ae(f);_.isRelationship=!0;var X=G.getCachedEntityMetadata(I.childObject||I.childSObject);X?j.resolve(X):G.getEntityMetadata({entities:I.childObject,ignoreMetadataOverrides:!0}).then(function(e){j.resolve(e)},function(e){j.reject(e)}),I.keyField&&(_.anchorField=I.anchorField,_.childObject=I.childObject,_.keyField=I.keyField)}U="Id"!==u&&R===M;var W=a(_);if(L.push(W),t.when(j).then(function(e){if(e){var t=W.children("fields");t.length||(t=d("<fields/>"),W.append(t));var n=e.get("idFields");n&&n.forEach(function(e){t.append(i.defaultStateGenerators.field({id:e}))})}}).catch(function(e){b.block({message:e,timeout:4e3})}),U&&(!T||N)&&I.referenceTo&&I.referenceTo.length&&I.rel&&"null"!==I.rel){var H=I.referenceTo[0].objectName,z=1===I.referenceTo.length?H:"Name",Y=Ae(f);!z||z in Y.getCachedEntityMetadata()||Y.getEntityMetadata({entities:z,ignoreMetadataOverrides:!0}),Y.dataSourceType.getDefaultFieldsForReferenceField&&(l=Y.dataSourceType.getDefaultFieldsForReferenceField(u,I,Y)),t.each(l,function(e,t){if(!t)return!0;0===g.children('[id="'+s(t)+'"]').length&&L.push(a({id:t,needsAlias:T}))})}t.each(L,function(e,n){if(C&&n.attr("targetobjects",C),B){var a=pe(E,n.attr("id"),null,{readMetadataFromFieldNode:!1});a&&t.each(a,function(e,t){void 0!==t&&null!==t&&"id"!==e&&"object"!==(void 0===t?"undefined":o(t))&&n.attr(e.toLowerCase(),t)})}g.append(n),y&&m&&y.append(i.componentFactory(n,m).element)})}if(L.length)return L}return!1},getLastSelectedModelComponent:function(){if(De&&De.state){var e=Fe(De.state.attr("id"));if(e&&e.length)return De}return De=null},setLastSelectedModelComponent:function(e){De=e},createBreadcrumbForModel:function(e,n){var i,a=e.attr("id"),o=Ve(e),r=e.attr("sobject"),l=[{rel:r,ref:r,id:a,selectable:!0}];return n&&n.isPolymorphic&&(l[0].isPolymorphic=!0),o&&(i=o.split("."),l[0].selectable=!1,t.each(i,function(e,t){l.push({rel:t,ref:t,id:a,selectable:e===i.length-1})})),l},prettyPrintAPIName:function(e){return e.replace(/__.$/g,"").replace(/^.+__/g,"").replace("_"," ")},processBreadCrumbInfo:function(n,a){a=a||{};var o,r,l="",s="",u=!!n.length&&n[0].id,c=!u&&n.length?d('<model sobject="'+n[0].rel+'"/>'):null,p=a.model||u&&Fe(u)||c,h=a.dataSourceName?e.dataSource.get(a.dataSourceName):p&&Ae(p),f=h.getDataSourceType(),m=f.name,b=[],v=i.actionSequences,g=v.getActionSequenceFromChildAction(a.state);return g&&0===p.length&&(p=v.getModelXMLForPickerOfInputModel(g,u),m=(f=(h=Ae(p)).getDataSourceType()).name),t.each(n,function(e,i){if(h.populateBreadcrumbFromEntityMetadata({crumb:i,index:e,modelXML:p}),!i.rel)return!1;0!==e&&(s+=i.rel+".");var o=t("<span>").text(i.rel+(i.isPolymorphic&&i.ref!==i.rel?"("+i.ref+")":"")).addClass("nx-pagebuilder-breadcrumb");e===n.length-1&&o.addClass("last"),i.isPolymorphic&&(l+=i.ref+"."),i.ref&&-1!==i.ref.indexOf(",")&&(i.possibleTargetObjects=i.ref.split(","),a.showObjectPickerIfPolymorphic?i.isPolymorphic=!0:i.ref="Name"),e<=n.length-2&&!1!==i.selectable&&o.addClass("nx-pagebuilder-breadcrumb-link"),b.push(o)}),o=n[n.length-1].ref,r=n[n.length-1].rel,l.length>0&&-1!==l.indexOf(".")&&(l=l.substring(0,l.length-1)),{dataSourceTypeName:m,dataSourceType:f,elements:b,endsobject:o,endrel:r,isAggregate:!!p&&"aggregate"===p.attr("type"),modelId:u,model:p,prefix:s,targetObject:l}},publishStateEvent:Be,handleModelRemove:function(e,t,n){var i,a;return n&&(i=n.modelPropId,a=n.component),i||(i="model"),"model.remove"===t.type&&e.attr(i)===t.modelId&&(a?a.remove(!1,!0):e.remove(),c("skuidBuilderNeedSave"),!0)},handleModelIdChange:function(e,t,n){return"model.idChange"===t.type&&e.attr(n||"model")===t.oldId&&(e.attr(n||"model",t.newId),c("skuidBuilderNeedSave"),!0)},getComponentFromState:qe,getAvailableComponentsWithFolders:function(){var n={},i={},o={},l=[],s=r.builder.getAvailableComponentPacks();return s&&t.each(t.map(s,function(e){return e}).sort(function(e,t){return e.orderIndex>t.orderIndex?1:e.orderIndex<t.orderIndex?-1:0}),function(){var r=this,s=r.components,d=r.folders;s&&s.length&&t.each(s,function(){var t,o=r.id+"__"+this.id,l=a.inPlatform(e.constants.LIGHTNING),s=o.split("__");if("skuidcore"===s[0]||"skuidmobilecore"===s[0]?(s.shift(),t=s.join("__")):Z(o)?t=o:(s.shift(),t=s.join("__")),this.builder=Z(t),!this.builder||this.builder.isLightningOnly&&!l||this.builder.isVFOnly&&l)return!0;this.folderId?(this.folderId in n||(n[this.folderId]={}),n[this.folderId][o]=this):i[r.id+"__"+this.id]=this}),d&&d.length&&t.each(d,function(){this.components=n[this.id],o[r.id+"__"+this.id]=this,l.push(this)})}),{noFolderComponents:i,activeFolders:o,activeFoldersList:l}},getAttrFromClosestParentComponent:function(e,t){var n=e.closest("["+t+"]");return n.length?n.first().attr(t):""},doesParentAcceptComponent:function(e,n){if(!e||!n)return!1;var i=e.emitsComponentAspects,a=n.acceptsComponentAspects,o=n.rejectsComponentAspects,r=!e.rejectByDefault;if(a&&a.length){if(!i||!i.length)return!1;r=!1,t.each(a,function(e,t){if(-1!==i.indexOf(t))return r=!0,!1})}return r&&o&&o.length&&i&&i.length&&t.each(o,function(e,t){if(-1!==i.indexOf(t))return r=!1,!1}),r},showCodeEditor:function(e){var n,i,a=e.state,o=e.property,r=e.syntax,l=e.onChange,s=e.onClose,d=!0===e.readonly,u=e.actionItems,c=te(a,o),p=t("<div>"),h=t('<div id="skuidcodeditor">').addClass("nx-code-editor").appendTo(p).hide();if(p.dialog({width:e.width||"80%",height:"auto",minHeight:600,title:e.title||(!0===d?"View":"Edit")+" Inline Code",resizable:!0,modal:!0,close:function(){var e=n.getValue();p.dialog("destroy"),p.remove(),s&&s(e)}}),n=e.codeEditor=window.ace.edit("skuidcodeditor"),t(".ui-dialog").addClass("sk-dialog-codeeditor"),t(".ui-widget-overlay").addClass("sk-overlay-codeeditor"),r&&n.getSession().setMode("ace/mode/"+r),u){var f=p.siblings(".ui-dialog-titlebar"),m=t("<div>").addClass("ui-dialog-titlebar-actionswrapper").css({position:"absolute",top:0,right:f.find(".ui-dialog-titlebar-close").outerWidth()}).appendTo(f);t.each(u,function(e,n){var i=n.text,a=n.icon,o=n.action,r=n.tooltip,l=t("<div>").addClass("nx-pagebuilder-component-actionitem").append(t("<div>").addClass("nx-pagebuilder-component-actionicon sk-icon "+a)).appendTo(m);i&&t("<div>").addClass("nx-pagebuilder-component-actiontext").text(i).appendTo(l),l.append(t("<div>").addClass("nx-pagebuilder-component-actionspacer")),r&&l.skootip(r),l.click(function(e){o&&o(),e.stopPropagation()}),n.element=l})}n.setValue(c),(i=n.getSession().getUndoManager()).reset(),n.getSession().setUndoManager(i),n.getSession().getSelection().clearSelection(),h.show(),n.getSession().on("change",function(){var e=n.getValue();ne(a,o||{},e),l&&l(e)}),!0===d&&n.setReadOnly(!0)},getValueEditorFromMetadata:function(n,o,r,l){var s,d,u,c,p,f,m,b,v,g=!0===n.isStateless,C=function(){return n.valueFunction?n.valueFunction():l?l.text():r?o.attr(r):n.value||n.defaultValue||""},w=function(e,t){n.beforeChange&&n.beforeChange(e,t),g||ie(c,{key:p,value:e}),n.onChange&&n.onChange(e,t)},P=n.validator;if(n.metadata&&(m=(d=n.metadata.displaytype)===S||d===k),l?(c=l,p=void 0):r?(c=o,p=r):(c=void 0,p=void 0),u=C(),d===y)s={value:"true"===u,onChange:function(e){w(e?"true":"false",e?"false":"true")}};else if(d===I&&n.metadata.picklistEntries)w=function(e,t){n.beforeChange&&n.beforeChange(e,t),g||ie(c,{key:p,value:e,required:!0}),n.onChange&&n.onChange(e,t)},s={value:a.decodeHTML(u),onChange:function(e,t){w(e,t)},entries:n.metadata.picklistEntries};else if(m){if(b=u,v="",u&&-1!==u.indexOf(":")){var x=u.split(":");b=x[0],v=x[1]}s={value:a.decodeHTML(u),onChange:function(e,t){w(e,t)}}}else d=O,s={value:u=u||n.defaultValue||"",onChange:function(e,n){if(e!==n){var i=!0,a=f.parent().find(".nx-property-error");P&&(i=P(e)),!0===i?(a.length&&a.hide(),w(e,C())):(a.length?a.show():a=t('<div class="nx-property-error">').insertAfter(f),a.text(i))}}};if(P&&(s.dataPropertyName="currentValue"),f=e.ui.renderers[d].edit(s),P){var F,T=function(){if(f.closest(".nx-pagebuilder-toolbarpanel").length){var t,n=f.val();!0!==P(n)&&(t=C())!==n&&(f.val(t),f.data("currentValue",t),f.parent().find(".nx-property-error").hide())}else e.events.unsubscribe(F)};f.off("blur.skuid").on("blur.skuid",T),F&&e.events.unsubscribe(F),F=e.events.subscribe("skuid.pageComposer.propertyPanel.beforeRender",T)}if("BOOLEAN"==d){var N="sk-builder-check-meta",A=t("<div>");f.attr("id",N),A.append(f,'<label for="'+N+'"></label>'),f=A}if(m){var E,M,R,L,D,B=function(){"NONE"===E?M.show():M.hide(),v?D.show():D.hide()},V=i.dateliteralmap[b],q=[],U=o.is("rendercondition")||o.is("action[type=updateRow]")||o.is("action > defaults > default");q.push({label:"Specific Date",value:"NONE"}),t.each(i.dateliteralmap,function(e){U&&!0===this.serverside||q.push({label:this.label,value:e})}),V?E=b:(E="NONE",v=""),M=f,R=h(I).edit({value:E,onChange:function(e){var t;e?(V=i.dateliteralmap[e])?(E=e,V.merge?(v="1",D.val(v),t=E+":"+v):(t=E,v="")):(E="NONE",t="",v=""):(t="",E="NONE",v=""),M.is(".hasDatepicker")?M.datepicker("setDate",""):M.find(".hasDatepicker").datepicker("setDate",""),ie(c,{key:p,value:t}),n.onChange&&n.onChange(t),B()},entries:q,required:!0}),D=h(O).edit({value:v,onChange:function(e){var t=R.val()+":"+e;ie(c,{key:p,value:t}),n.onChange&&n.onChange(t)}}),B(),M.css({margin:"6px 0"}),M.find(".nx-dt-timewrapper > select").wrap('<label class="nx-basicfieldeditor-item-select-label">'),L=t('<label class="nx-basicfieldeditor-item-select-label">').append(R),f=t("<div>").append(L,M,D)}else n.placeholder&&f.attr("placeholder",n.placeholder);return f},conditionDescriptionRenderers:Ie,getCoreActionOptions:function(){return[{value:"-",label:"Logic",disabled:!0},{value:"branch",label:function(e){var t=Re(e,"label");return"Branch"+(t?": "+t:"")}},{value:"-",label:"",disabled:!0},{value:"-",label:"Model Conditions / Querying",disabled:!0},{value:"setCondition",label:function(e){var t=Re(e,"model"),n=Re(e,"condition");return t?"Activate & Set Model Condition: "+t+(n?" > "+n:""):"Activate & Set value of Model Condition"}},{value:"activateCondition",label:function(e){var t=Re(e,"model"),n=Re(e,"condition");return"Activate Model Condition"+(t?": "+t+(n?" > "+n:""):"")}},{value:"deactivateCondition",label:function(e){var t=Re(e,"model"),n=Re(e,"condition");return"Deactivate Model Condition"+(t?": "+t+(n?" > "+n:""):"")}},{value:"deactivateFilterableConditions",label:function(e){var t=e&&e.children?e.children("models").children():0;return t&&t.length?1===t.length?"Deactivate Filterable Conditions: "+t.first().text():"Deactivate Filterable Conditions: "+t.length+" Models":"Deactivate Filterable Model Conditions"}},{value:"requeryModel",label:function(e){var t=Re(e,"model");return"Query Model"+(t?": "+t:"")}},{value:"requeryModels",label:function(e){var t=e&&e.children?e.children("models").children():0;return t&&t.length?1===t.length?"Query Model: "+t.first().text():"Query "+t.length+" Models":"Query Models"}},{value:"searchModel",label:function(e){var t=Re(e,"model");return"Search Model"+(t?": "+t:"")}},{value:"sortModel",label:function(e){var t=e&&e.attr("model"),n=e&&e.attr("field"),i="Sort Model";return t&&(i+=": "+t,n&&(i+=" by "+n)),i}},{value:"-",label:"",disabled:!0},{value:"-",label:"Model data changes",disabled:!0},{value:"createRow",label:function(e){var t=Re(e,"model");return(t?t+": ":"")+"Create new row(s)"}},{value:"updateRow",label:function(e){var t=Re(e,"fieldmodel"),n=Re(e,"field");return t&&n?t+": Update "+n+" field":"Update a field on row(s)"}},{value:"markRowsForDeletion",label:"Mark row(s) for deletion"},{value:"unmarkRowsForDeletion",label:"Unmark row(s) for deletion"},{value:"unmarkAllRowsForDeletion",label:"Unmark all rows for deletion"},{value:"emptyModelData",label:function(e){var t=e&&e.children?e.children("models").children():0;return t&&t.length?1===t.length?"Remove all rows in Model: "+t.first().text():"Remove all rows in "+t.length+" Models":"Remove all rows from Model"}},{value:"abandonRows",label:function(e){var t=Re(e,"model");return"Remove row(s) from Model"+(t?": "+t:"")}},{value:"cancel",label:function(e){var t=e&&e.children?e.children("models").children():0;return t&&t.length?1===t.length?"Cancel changes in Model: "+t.first().text():"Cancel changes in "+t.length+" Models":"Cancel Model changes"}},{value:"save",label:function(e){var t=e&&e.children?e.children("models").children():0;return t&&t.length?1===t.length?"Save changes in Model: "+t.first().text():"Save changes in "+t.length+" Models":"Save Model changes"}},{value:"adoptRows",label:function(e){var t=Re(e,"sourcemodel"),n=Re(e,"targetmodel");return"Adopt rows into "+(n&&t?n+" from "+t:"Model")}},{value:"-",label:"",disabled:!0},{value:"-",label:"Data Source Specific Actions",disabled:!0},{value:"datasource-action",label:function(e){var t=Re(e,"datasource");return t?"Run "+t+" Action":"Run Data Source Action"}},{value:"-",label:"",disabled:!0},{value:"-",label:"Advanced",disabled:!0},{value:"action-sequence",label:function(e){return i.actionSequences.getLabelForActionSequenceAction(e)}},{value:"custom",label:function(e){var t=Re(e,"snippet");return t?"Run Snippet: "+t:"Run a Skuid JavaScript Snippet"}},{value:"publish",label:function(t){var n=Re(t,"event"),i=e.events.get(n);return n?"Publish: "+(i?i.getLabel():n):"Publish Event"}}]},getValidActionOptions:Le,addValidActionOptions:function(e){t.each(e,function(){Me.push(this)})},getActionLabel:function(e,n){var i=Le(),a=e.attr("type"),o=function(n){var i;return n&&t.each(n,function(t,n){if(n.value===a)return i="function"==typeof n.label?n.label(e):n.label,!1}),i};return o(i)||o(n)||a},getJSItemLabel:function(e){var n=e.attr("location"),i={};return"external"===n?t.extend(i,{prefix:"(External)",name:e.attr("name")||e.attr("url")}):(i.name=e.attr("name"),i.prefix="(","inlinesnippet"===n?i.prefix+="Snippet":"inlinecomponent"===n?i.prefix+="Component":"inline"===n?i.prefix+="Inline":"staticresource"===n&&(i.prefix+="Static Resource"),i.prefix+=")"),i},getCSSItemLabel:function(e){var n=e.attr("location"),i={};return"external"===n?t.extend(i,{prefix:"(External)",name:e.attr("name")||e.attr("url")}):(i.name=e.attr("name"),i.prefix="(","inline"===n?i.prefix+="Inline":"staticresource"===n&&(i.prefix+="Static Resource"),i.prefix+=")"),i},getFilterItemLabel:function(e){var t,n=e.attr("filteroffoptionlabel"),i=e.attr("conditionfield");switch(e.attr("type")){case"multiselect":case"select":return t="auto"===e.attr("conditionsource")?i?n||i:"(No field selected)":("true"===e.attr("createfilteroffoption")&&n?n:"Filter")+(e.attr("condition")?" - "+e.attr("condition"):"");case"toggle":return e.attr("label")||"Filter";case"daterange":case"numericrange":return t="Range: ","auto"===e.attr("conditionsource")?i?t=(n="New Filter"!==n?n:"")||t+i:t+="(No field selected)":e.attr("startcondition")&&e.attr("endcondition")&&(t+=e.attr("startcondition")+" <-> "+e.attr("endcondition")),t}},getEffectItemLabel:function(e){var t=e.attr("action");return"set"===t?(e.attr("condition")||"[No Condition]")+" --\x3e "+e.attr("value"):("activate"===t?"Activate ":"Deactivate ")+(e.attr("condition")||"[No Condition]")},getIconLabelProps:function(e){var t=e.component,n=!0===e.refreshComponent,i=e.labelOnChange,a=e.labelid||"label",o=e.labelName||"Label",r=e.iconOnChange;return[{id:a,type:"string",label:o,onChange:function(e,a){!0===n&&t.refresh(),i&&i(e,a)}},{id:e.iconid||"icon",type:"icon",label:e.iconName||"Icon",onChange:function(e){!0===n&&t.refresh(),r&&r(e)}}]},getClosestBackground:function e(t){var n,i,a=t.css("background-color");return!a||"rgba(0, 0, 0, 0)"===a||"transparent"===a||(i=(n=Ue(a))[3],n&&i&&parseFloat(i)<.2)?!(!t||!t.length||t[0]===document.body)&&e(t.parent()):a},getColorLightness:function(e){var t=Ue(e);return!!t&&(299*t[0]+587*t[1]+114*t[2])/1e3},getDefaultConditions:function(e){e||(e={});var t,n=d("<conditions/>"),i=!0===e.isMultiRow,a=e.state;return t=d(!0===i?'<condition type="contextrows" field="Id" mergefield="Id" operator="in" autocreated="true"/>':'<condition type="contextrow" field="Id" mergefield="Id" autocreated="true"/>'),n.append(t),a&&a.append(n),n}})}(skuid),i=skuid.$,a={init:function(e){return this.each(function(){var t,n=i(this),a=e.axis,o=e.parentStateSelector,r=e.grandparentStateSelector,l=e.component,s=e.items,d=e.placeholder,u=e.connectWith,c=e.containment;s&&(t=s.substr(2)),l&&n.sortable({items:s||"> *",placeholder:d||!1,axis:a,opacity:.75,delay:200,handle:e.handle,tolerance:"pointer",revert:200,connectWith:u||!1,containment:c||!1,start:function(e,n){n.item.startingIndex="> *"==s?n.item.index():n.item.parent().children(t).index(n.item);var i=n.item.parent().closest(".nx-pagebuilder-component"),a=i.parent().children(".nx-pagebuilder-component");n.item.parentStartingIndex=a.index(i)},stop:function(n,i){var a,d,u,c=i.item.startingIndex,p="> *"==s?i.item.index():i.item.parent().children(t).index(i.item),h=i.item.parentStartingIndex,f=i.item.parent().closest(".nx-pagebuilder-component"),m=f.parent().children(".nx-pagebuilder-component").index(f);if(h!=m){var b=l.state.find(r).eq(h).children(o).first(),v=l.state.find(r).eq(m).children(o).first();(d=b.children().eq(c)).detach(),p<(u=v.children().length)?d.insertBefore(v.children().eq(p)):p>=u&&d.appendTo(v)}else(d=(a=o?o&&r?l.state.find(r).eq(m).children(o).first():l.state.find(o).first():l.state).children().eq(c)).detach(),p<(u=a.children().length)?d.insertBefore(a.children().eq(p)):p>=u&&d.appendTo(a);l.save(),e.onSort&&e.onSort(i.item)}})})}},i.fn.sortableComponent=function(e){return a[e]?a[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==(void 0===e?"undefined":o(e))&&e?void i.error("Method "+e+" does not exist on the sortableComponent plugin"):a.init.apply(this,arguments)}},302:function(e,t,n){"use strict";!function(e){var t=e.builder.mobile={},n=e.$,i=e.utils,a=i.makeXMLDoc,o=e.builder.core,r=e.mobile,l=e.events.subscribe,s=e.events.publish,d=e.componentType.register,u=e.componentType.get;o.addValidActionOptions([{value:"-",label:"Visual navigation",disabled:!0},{value:"setLeftPanel",label:"Set Left Panel"},{value:"toggleLeftPanel",label:"Toggle Left Panel"},{value:"hideLeftPanel",label:"Hide Left Panel"},{value:"setMainPanel",label:"Set Main Panel"},{value:"setPopupPanel",label:"Set Popup Panel"},{value:"hidePopupPanel",label:"Hide Popup Panel"},{value:"blockUI",label:"Show message and block UI"},{value:"unblockUI",label:"Unblock the UI"},{value:"redirect",label:"Go to URL"},{value:"toggleSetupMenu",label:"Toggle Setup Menu"}]),o.addValidActionOptions(o.getCoreActionOptions()),t.model,t.row,t.pageXML,t.mobileXML,t.resourcesXML,t.componentViewer,t.propertyViewer,t.makeAddComponentsCategory=function(e){return{label:(e=e||{}).label||"Add Components",props:[{type:"validcomponents",childrenNodeName:e.childrenNodeName}]}},t.makeDraggableComponent=function(e,i){e.draggable({handle:".smb-component-gripper",appendTo:r.panelarea,delay:100,helper:function(){var e=n("<div>").addClass("smb-component-draghelper");return e.append(n("<div>").text(i.name)),e},scroll:!0,revert:"invalid",start:function(){e.addClass("smb-component-dragging");var i=n(this).data("ui-draggable");i.scrollParent=t.componentViewer.element,i.overflowOffset=i.scrollParent.offset()},stop:function(){e.removeClass("smb-component-dragging")},scrollSensitivity:60,scrollSpeed:10,drag:function(e,t){var i=n(this).data("ui-draggable"),a=i,o=a.options,r=!1;t.position.top-=a.scrollParent[0].scrollTop,a.overflowOffset.top+a.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?a.scrollParent[0].scrollTop=r=a.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-a.overflowOffset.top<o.scrollSensitivity&&(a.scrollParent[0].scrollTop=r=a.scrollParent[0].scrollTop-o.scrollSpeed),r&&n.ui.ddmanager.prepareOffsets(i,e)},cursorAt:{right:10,top:10}})},t.FieldSelectDeck=function(t,i){var a=this;if(t||(t=n("<div>")),a.breadcrumb=i.breadcrumb,!a.breadcrumb)return!1;if(a.options=i,a.element=t,t.addClass("smb-fielddeck nx-list-contents sm-grid"),t.off(),t.on("tap",".smb-fieldcard",function(e){e.stopPropagation()}),t.on("tap",".smb-fieldcard-inmodel",function(){var e=n(this).closest(".smb-fieldcard").data("card");e.component&&e.component.select&&e.component.select()}),t.on("hold",".smb-fieldcard",function(e){n(this).closest(".smb-fieldcard").data("card").toggleSelect(),e.stopPropagation()}),t.on("tap",".smb-fieldcard-toggle",function(e){n(this).closest(".smb-fieldcard").data("card").toggleSelect(),e.stopPropagation()}),t.on("tap",".smb-fieldcard-referencelink",function(e){var t=n(this).closest(".smb-fieldcard").data("card");a.followReference(t.fielddata),e.stopPropagation()}),i.controls){a.subcontrolwrapper=n("<div>").addClass("smb-fielddeck-subcontrol"),a.breadcrumbwrapper=n("<div>").addClass("smb-breadcrumb-wrapper"),a.quickletterwrapper=n("<div>").addClass("smb-quickletter-wrapper");var o=n("<div>").addClass("smb-fielddeck-search-wrapper"),r=n("<div>").addClass("smb-fielddeck-selected-wrapper");if(i.showSelectedFilter){var l=n("<div>").addClass("smb-fielddeck-selected-toggle").text("S").on("tap",function(){a.selectedOnly=!a.selectedOnly,n(this).toggleClass("active"),a.render()});r.append(l)}else r.hide(),a.subcontrolwrapper.addClass("nofilter");a.searchBox=e.ui.renderers.TEXT.edit({onChange:function(e){a.searchtext=e,a.render()}}).css("padding","3px 6px"),o.append(a.searchBox),a.subcontrolwrapper.append(a.breadcrumbwrapper,a.quickletterwrapper),i.controls.append(o,r,a.subcontrolwrapper),a.breadcrumbwrapper.on("tap",".nx-pagebuilder-breadcrumb-link",function(){a.breadcrumb=a.breadcrumb.slice(0,n(this).index()+1),a.render()})}},t.FieldSelectDeck.prototype.render=function(){var i=this,a=n.Deferred();return i.element.empty(),n.when(o.processBreadCrumbInfo(i.breadcrumb)).fail(function(e){a.reject(e)}).done(function(l){if(!l.endsobject)return i.element.append(n("<div>").addClass("smb-fielddeck-error").text("Select an SObject for this Model.")),void a.reject("Select an SObject for this Model");var s=i.options.controls,d=l.endsobject;s&&(i.breadcrumbwrapper.empty(),i.breadcrumbwrapper.append(l.elements)),i.options.prefix=l.prefix;var u,c=e.dataSource.getDataSource("salesforce"),p={objectName:d};l.prefix&&(p.objectName=l.endsobject,p.path=l.prefix),u="Loading metadata for object "+d+"...",n.blockUI({message:u}),n.when(c.getEntityMetadata({entities:p,ignoreMetadataOverrides:!0})).fail(function(e){n.blockUI({message:"There was an error retrieving metadata: "+e,timeout:2e3})}).done(function(a){var d=n.merge([],a.getSortedFieldsList()),u=i.options.getUiOnlyFields;u&&!l.prefix&&(u=u())&&u.each(function(){var e=n(this),t=e.attr("id");d.push({id:t,label:o.getModelFieldComponentLabel(e)||t+" (Ui-Only)",displaytype:e.attr("displaytype"),destroyCardOnUnselect:!0})}),n.each(d,function(){if(i.searchtext){var e=-1!==this.id.toLowerCase().indexOf(i.searchtext.toLowerCase()),n=-1!==this.label.toLowerCase().indexOf(i.searchtext.toLowerCase());if(!e&&!n)return!0}return!(!i.options.filter||i.options.filter(this,l.prefix))||(!(!i.selectedOnly||!i.options.isSelected||i.options.isSelected(this,l.prefix))||void i.element.append(new t.FieldSelectCard(this,i.options).element))}),e.responsive.prepareGrid(i.element,{precision:"10",layoutMode:"rigid",minWidth:"160"}),r.processResponsiveArea(i.element),s.find(":input").focus(),n.unblockUI()})}),a.promise()},t.FieldSelectDeck.prototype.followReference=function(e){var t={rel:e.rel,ref:e.ref,isPolymorphic:!1};this.searchBox.val(""),this.searchtext="",this.breadcrumb.push(t),this.render()},t.FieldSelectCard=function(t,i){this.fielddata=t,this.deckoptions=i,this.element=n("<div>").addClass("smb-fieldcard sm-card sm-grid-division"),this.element.data("card",this),this.body=n("<div>").addClass("smb-fieldcard-inner"),this.fieldCardTitle=n("<div>").addClass("smb-fieldcard-title"),this.fieldCardBody=n("<div>").addClass("smb-fieldcard-body"),this.fieldCardToggle=n("<div>").addClass("smb-fieldcard-toggle fa fa-fw");var a=n("<div>").addClass("smb-fieldcard-referencelink fa fa-fw fa-external-link");this.fieldReferenceCount=n("<div>").addClass("smb-fieldcard-referencecount"),this.body.append(this.fieldCardTitle,this.fieldCardBody,this.fieldCardToggle);var o=t.displaytype;this.fieldCardTitle.text(t.label),"REFERENCE"===t.displaytype&&"null"!==t.rel&&t.referenceTo&&t.referenceTo.length&&(this.body.append(a),this.deckoptions.referenceCount&&(this.updateReferenceCount(),this.body.append(this.fieldReferenceCount)),o="REF"),this.fieldCardBody.text(o),e.responsive.prepareDivision(this.element,{relativeSize:"1",minWidth:"160"}),this.setSelect(),this.element.append(this.body)},t.FieldSelectCard.prototype.updateReferenceCount=function(){this.fieldReferenceCount.text(this.deckoptions.referenceCount(this.fielddata,this.deckoptions.prefix))},t.FieldSelectCard.prototype.isSelected=function(){return this.deckoptions.isSelected&&this.deckoptions.isSelected(this.fielddata,this.deckoptions.prefix)},t.FieldSelectCard.prototype.toggleSelect=function(){this.isSelected()?this.deckoptions.onUnselect&&this.deckoptions.onUnselect(this.fielddata,this.deckoptions.prefix,this):this.deckoptions.onSelect&&this.deckoptions.onSelect(this.fielddata,this.deckoptions.prefix,this),this.setSelect()},t.FieldSelectCard.prototype.setSelect=function(){this.isSelected()?(this.body.addClass("smb-fieldcard-inmodel"),this.fieldCardToggle.addClass("fa-times").removeClass("fa-check"),this.component=new t.Component(this.deckoptions.getFieldXML(this.fielddata,this.deckoptions.prefix)).render(),this.component.card=this):!0===this.fielddata.destroyCardOnUnselect?this.element.detach():(this.body.removeClass("smb-fieldcard-inmodel"),this.fieldCardToggle.addClass("fa-check").removeClass("fa-times"))};t.propertyRenderers={helptext:function(e){e.element.append(n("<div>").addClass("smb-proptertyitem-helparea").html(e.html))},field:function(e,i){var a,l,s,d=n("<div>").addClass("sm-field-label").text(e.label),u=o.getStoredValue(i,e),c=function(t){o.updateState(i,{value:t,key:e.id}),h.text(t),e.onChange&&e.onChange(t),r.hidePopupPanel()};e.sobject?(a=e.sobject,s=i.closest("model")):((l=e.modelname?e.modelname:e.modelprop?i.attr(e.modelprop):i.closest("model").attr("id"))&&(s=o.getModelFromModelName(l)),a=o.getSObjectNameFromModelName(l));var p=n("<div>"),h=n("<div>").addClass("smb-propertyitem-valuetextbox").text(u);i.attr(e.id)!==u&&c(u);var f=n("<div>").addClass("smb-propertyitem-actionbutton fa fa-fw fa-wrench").on("tap",function(){var o=n("<div>").addClass("smb-fielddeckcontrols").css({left:"122px","padding-top":"1px"}),d=new t.FieldSelectDeck(n("<div>"),{breadcrumb:[{rel:a,ref:a,id:l}],controls:o,isSelected:function(t,n){return n+t.id===i.attr(e.id)},onSelect:function(e,t){c(t+e.id)},onUnselect:function(){c("")},getUiOnlyFields:function(){return!(!s||s.attr("sobject")!==a)&&s.children("fields").children('[uionly="true"]')},getFieldXML:function(e,t){var n=t+e.id;return!(!s||s.attr("sobject")!==a)&&s.children("fields").children('[id="'+n+'"]')},filter:e.filter});r.setPopupPanel(d.element,{title:function(e){e.append(n("<span>").text("Select a Field"),o)},noPadding:!0}),d.render()});p.append(f,h),e.element.append(d,p)},panel:function(i,a){var r,l=n("<div>").addClass("sm-field-label").text(i.label),s=i.id,d=[];t.panelsXML.children().each(function(){var e=n(this).attr("uniqueid");d.push({value:e,label:e})}),r=e.ui.renderers.PICKLIST.edit({value:a.attr(s),entries:d,onChange:function(e){o.updateState(a,{key:s,value:e}),i.onChange&&i.onChange(e)}}),i.element.append(l,r)},multiitem:function(e,t){var i=e.id,r=e.storeAs,l=n("<div>").addClass("sm-field-label").text(e.label),s=t.children(i),d=n("<div>");function u(a){var r=n("<div>").addClass("smb-propertyitem-multiitem").css("clear","both"),l=n("<div>").addClass("smb-propertyitem-valuebox"),s=n("<div>").addClass("smb-propertyitem-actionbutton smb-propertyitem-actionbutton-black fa fa-fw fa-times").on("tap",function(t){a.remove(),r.remove(),e.onChange&&e.onChange(),t.gesture.preventDefault()});return l.append(o.getValueEditorFromMetadata(e,t,i,a)),r.append(s,l)}s.length||(s=a("<values/>").append(a("<value/>"))).appendTo(t),s.children(r.name).each(function(){d.append(u(n(this)))}),e.element.append(l,d),e.element.append(n("<div>").text("Add Another Value").addClass("smb-property-action").css("margin-left","0px").on("tap",function(t){var n=a("<value/>").appendTo(s);d.append(u(n)),e.onChange&&e.onChange(),t.gesture.preventDefault()}))},validcomponents:function(e,i){var l=i[0].nodeName.toLowerCase(),d=o.getBuilder(l),u=o.getAvailableComponentsWithFolders(),c=u.noFolderComponents,p=u.activeFolders;if(e.element.css("margin-top","0px"),!c)return!1;var h=function(e,i){if(i&&i.options&&!1===i.options.makeDraggable)return!0;if(!o.doesParentAcceptComponent(i,d))return!0;var a=n("<div>").addClass("smb-component-tag-wrapper"),r=n("<div>").addClass("smb-component-tag").text(i.name),l=n("<div>").addClass("smb-component-titlebuttons"),s=n("<div>").addClass("smb-component-titlebutton smb-component-gripper fa fa-bars fa-fw");l.append(s),r.append(l),r.data("builder",i),t.makeDraggableComponent(r,i),a.append(r),e.append(a)};n.each(c,function(){return h(e.element,this.builder)}),n.each(p,function(){var t=n("<div>").addClass("smb-folder"),i=n("<div>").addClass("smb-folder-header").text(this.name),a=n("<div>").addClass("smb-folder-body");n.each(this.components,function(){return h(a,this.builder)}),a.children().length&&(t.append(i,a),e.element.append(t))}),e.element.on("doubletap",".smb-component-tag",function(l){var d=n(this).data("builder"),u=new t.Component(d.defaultStateGenerator()).render(),c=o.getComponentFromState(i);c.body.append(u.element),u.builder&&u.builder.afterAttach&&u.builder.afterAttach(u);var p=e.childrenNodeName||"components",h=i.children(p).first();h.length||(h=a("<"+p+"/>").appendTo(i)),h.append(u.state),s("skuidBuilderSave"),l.gesture.preventDefault(),l.stopPropagation(),r.processResponsiveArea(c.element)})},remove:function(e,t){var i=t[0].nodeName.toLowerCase(),a=o.getBuilder(i),r=n("<div>").addClass("smb-property-action").text("Remove this "+(a?a.name:"Component")).click(function(){o.getComponentFromState(t).remove(),e.onChange&&e.onChange()});e.element.append(r)},customaction:function(e){var t=n("<div>").addClass("smb-property-action").text(e.label||"Custom Action");e.customAction&&t.on("tap",function(){e.customAction()}),e.element.append(t)},template:function(e,t){e.location||(e.location="node");var a=o.getStoredValue(t,e);if(!a&&e.defaultValue){var r={value:a=e.defaultValue};"node"==e.location&&e.id?r.childNodeName=e.id:"attribute"==e.location&&(r.key=e.id),o.updateState(t,r)}var l=e.displayAs,s=n("<"+("input"===l?"input":"textarea")+">").val(a);i.delayInputCallback(s,function(n){var i={value:n};"node"==e.location&&e.id?i.childNodeName=e.id:"attribute"==e.location&&(i.key=e.id),o.updateState(t,i),e.onChange&&e.onChange(n)});var d=n("<div>").addClass("sm-field-label").text(e.label);e.element.append(d,s)},code:function(e,t){n("<div>").addClass("sm-field-label").text(e.label).appendTo(e.element);var i=n("<div>").css("position","relative").css("height","400px").appendTo(e.element),a=n("<div>").addClass("nx-code-editor").appendTo(i).hide(),r=window.ace.edit(a[0]);e.syntax&&r.getSession().setMode("ace/mode/"+e.syntax),r.setValue(o.getStoredValue(t,e));var l=r.getSession().getUndoManager();l.reset(),r.getSession().setUndoManager(l),r.getSession().getSelection().clearSelection(),a.show(),r.getSession().on("change",function(){var n=r.getValue(),i={value:n};e.id&&(i.childNodeName=e.id),o.updateState(t,i),e.onChange&&e.onChange(n)})}},n.each(["autocomplete","boolean","condition","filepath","icon","model","models","multipicklist","numberbox","quicknumber","picklist","sobject","standard"],function(e,i){t.propertyRenderers[i]=function(e,t){!function(e,t,i){var a=n("<div>").addClass("sm-field-label").text(t.label);t.element.append(a,o.propertyRenderers[e](t,i))}(i,e,t)}}),t.Component=function(e,i){if(!e||!e[0])return!1;if(i?(this.builder=i,this.builderId=this.builder.id):(this.builderId=e[0].nodeName.toLowerCase(),this.builder=o.getBuilder(this.builderId)),!this.builder)return!1;o.registerComponent(this),this.builderoptions=n.extend({allowSelection:!0,makeDraggable:!0,makeSiblingDropZone:!0},this.builder.options),this.element=n("<div>").addClass("smb-component"),this.header=n("<div>").addClass("smb-component-header"),this.headerTitle=n("<div>").addClass("smb-component-header-title").text(this.builder?this.builder.name:this.builderId),this.titleButtons=n("<div>").addClass("smb-component-titlebuttons"),this.gripper=n("<div>").addClass("smb-component-titlebutton smb-component-gripper fa fa-ellipsis-v fa-fw"),this.header.append(this.headerTitle,this.titleButtons),this.builderoptions.makeDraggable&&this.titleButtons.append(this.gripper),this.body=n("<div>").addClass("smb-component-body"),this.element.append(this.header,this.body),this.builderoptions.makeSiblingDropZone&&(this.dropzone=new t.DropZone,this.element.append(this.dropzone.element)),this.state=e,this.element.data("component",this)},t.Component.prototype.setTitle=function(e){return this.headerTitle.text(e),this},t.Component.prototype.setHeaderText=function(e){return this.setTitle(e)},t.Component.prototype.render=function(){return this.builder&&(this.body.empty(),this.builder.mobileRenderer?this.builder.mobileRenderer(this):this.builder.componentRenderer&&this.builder.componentRenderer(this)),this},t.Component.prototype.refresh=function(){return this.body.children().detach(),this.render(),r.processResponsiveElements(),this.builder&&this.builder.afterAttach&&this.builder.afterAttach(this),this},t.Component.prototype.rebuildProps=function(e){return this.renderProperties(e)},t.Component.prototype.renderProperties=function(e){s("skuid.pageComposer.propertyPanel.beforeRender");return e||(e=t.propertyViewer),e&&e.clear(),this.builder&&this.builder.propertiesRenderer(e,this),s("skuid.pageComposer.propertyPanel.afterRender"),this},t.Component.prototype.renderChildren=function(e,t){this.addComponents(e,t||this.body)},t.Component.prototype.addComponents=function(e,i){e||(e="components");var r,l=this.state.children(e).first();l.length||(l=a("<"+e+"/>").appendTo(this.state)),r=l.children(),new t.ComponentAcceptor(i,l),r.each(function(){var e=n(this),a=o.getComponentFromState(e)||new t.Component(n(this));a&&(a.render(),a.element&&(a.element.data("component",a),i.append(a.element),a.builder&&a.builder.afterAttach&&a.builder.afterAttach(a)))})},t.Component.prototype.isSelected=function(){return this===t.componentViewer.selectedComponent},t.Component.prototype.select=function(e){this.builderoptions.allowSelection&&(e=n.extend({showPropertiesPanel:!0},e),t.componentViewer.addSelection(this),this.builderoptions.makeDraggable&&t.makeDraggableComponent(this.element,this.builder),s("skuidBuilderViewProperties",[this]),e.showPropertiesPanel&&r.addLeftPanel("propertyviewer",{transition:"slide",replace:!0,position:1}),s("skuidBuilderComponentSelect",[this]))},t.Component.prototype.unselect=function(){this.element.removeClass("smb-selected"),this.builderoptions.makeDraggable&&this.element.data("ui-draggable")&&this.element.draggable("destroy")},t.Component.prototype.remove=function(){t.componentViewer.clearSelection(),t.propertyViewer.clear(),this.element.remove(),this.state.remove(),this.save(),o.unregisterComponent(this),r.processResponsiveElements()},t.Component.prototype.getPersonalizationService=function(){var t="_personalizationService",n=this[t];return n||(n=this[t]=e.personalization.createComponentService({uniqueId:null})),n},t.Component.prototype.save=function(){return s("skuidBuilderSave"),this},t.ComponentAcceptor=function(e,n){this.element=e.addClass("smb-acceptor"),this.element.data("acceptor",this),this.state=n,this.dropzone=new t.DropZone("acceptor"),this.element.append(this.dropzone.element)},t.DropZone=function(i){var a=this;this.type=i||"component",this.element=n("<div>").addClass("smb-dropzone"),this.element.droppable({accept:function(e){var t=e.data("component"),n=t?t.builder:e.data("builder");if(!n)return!1;var i=a.element.closest(".smb-acceptor").data("acceptor");if(!i)return!1;var r=i.element.closest(".smb-component").data("component").builder;return o.doesParentAcceptComponent(n,r)},tolerance:"touch",drop:function(i,l){if(o.dropStack=n(),a.element.is(".smb-dropzone-hover")){var d,u,c=l.draggable.data("component");if(c)c.state.detach(),c.element.detach();else{var p=l.draggable.data("builder");c=new t.Component(p.defaultStateGenerator()).render()}var h=a.element.closest(".smb-acceptor").data("acceptor").state;"acceptor"===a.type?(d=0,u=a.element):(d=a.element.parent().index(),u=a.element.parent()),u.after(c.element),e.utils.insertAtIndex(h,c.state,d),c.builder&&c.builder.afterAttach&&c.builder.afterAttach(c),s("skuidBuilderSave"),a.element.removeClass("smb-dropzone-hover"),r.processResponsiveElements()}},over:function(){o.dropStack=o.dropStack.add(n(this)),o.dropStack.removeClass("smb-dropzone-hover"),o.dropStack.first().addClass("smb-dropzone-hover")},out:function(){o.dropStack.removeClass("smb-dropzone-hover"),o.dropStack=o.dropStack.not(n(this)),o.dropStack.first().addClass("smb-dropzone-hover")},activeClass:"smb-dropzone-active"})},t.ComponentViewer=function(e){this.element=e.addClass("smb-component-viewer"),this.selectedComponent,e.on("tap",".smb-component",function(e){n(this).data("component").select(),e.gesture.preventDefault(),e.stopPropagation()}),e.on("hold",".smb-component",function(e){n(this).data("component").select({showPropertiesPanel:!1}),e.stopPropagation(),e.preventDefault()})},t.ComponentViewer.prototype.loadComponent=function(e){this.element.children().detach();var n=o.getComponentFromState(e);return n||(n=new t.Component(e).render()),this.element.append(n.element),this.clearSelection(),n},t.ComponentViewer.prototype.addSelection=function(e){this.clearSelection(),this.selectedComponent=e,e.element.addClass("smb-selected")},t.ComponentViewer.prototype.clearSelection=function(){this.selectedComponent&&this.selectedComponent.unselect(),this.selectedComponent=null},t.ComponentViewer.prototype.clear=function(){this.element.empty(),this.clearSelection()},t.PropertyViewer=function(e){this.lists=[],this.element=e.addClass("smb-propview"),this.header=n("<div>").addClass("smb-propview-header sm-title"),this.headerText=n("<div>").addClass("smb-propviewer-headertext"),this.titleButtons=n("<div>").addClass("sm-titlebutton-wrapper"),this.closeButton=n("<div>").addClass("sm-titlebutton fa fa-angle-double-left fa-fw"),this.closeButton.click(function(){r.toggleLeftPanel("propertyviewer",{transition:"slide"})}),this.titleButtons.append(this.closeButton),this.header.append(this.titleButtons,this.headerText),this.body=n("<div>").addClass("smb-propview-body"),this.body.on("click",".smb-propertylist-header",function(){var e=n(this).parent().data("list");e&&e.revealContents&&e.revealContents()}),this.openLists={},this.element.append(this.header,this.body)},t.PropertyViewer.prototype.setTitle=function(e){this.headerText.text(e)},t.PropertyViewer.prototype.setHeaderText=function(e){this.setTitle(e)},t.PropertyViewer.prototype.loadComponent=function(e){this.openLists={},this.clear(),e.renderProperties(this)},t.PropertyViewer.prototype.addList=function(e){e.viewer=this,this.lists.push(e)},t.PropertyViewer.prototype.addLists=function(e){var t=this;n.each(e,function(){this.viewer=t,t.lists.push(this)})},t.PropertyViewer.prototype.render=function(){var e=this;this.body.empty(),n.each(this.lists,function(){this.render(this.state),e.body.append(this.element)})},t.PropertyViewer.prototype.clear=function(){this.body.empty(),this.lists=[],this.setTitle("")},t.PropertyViewer.prototype.applyPropTreeItem=function(e,n){if(e.isChild){var i=e.id;i||(i=e.childrenNodeName);var o=n.children(i);o.length||(o=e.defaultStateFunction&&e.defaultStateFunction()||a("<"+i+"/>"),n.append(o)),this.addList(new t.MiniComponentList(o,e))}else this.addList(new t.MiniComponentList(n,e))},t.PropertyViewer.prototype.applyPropTree=function(e,t){var i=this;e instanceof Array?n.each(e,function(e){i.applyPropTreeItem(this,t,{autoselect:0===e,wrapper:i.body})}):i.applyPropTreeItem(e,t,{autoselect:!0,wrapper:i.body})},t.PropertyViewer.prototype.applyPropsWithCategories=function(e,i){var a=this;n.each(e,function(){var e=this,n=e.state?e.state:i;(e.props&&e.props.length>0||e.customPropFunction||e.tree)&&(e.customPropFunction||(e.tree?a.applyPropTree(e.tree,n):a.addList(new t.PropertyList(n,e))))}),this.render()},t.MiniComponentList=function(e,i){i=i||{};var a=this;this.element=n("<div>").addClass("smb-propertylist"),this.element.data("list",this),this.header=n("<div>").addClass("smb-propertylist-header"),this.body=n("<div>").addClass("smb-propertylist-body").hide(),this.bodycontents=n("<div>"),this.propcontents=n("<div>"),this.expandIndicator=n("<div>").addClass("smb-propertylist-titleicon fa fa-chevron-down fa-fw"),this.items=[],this.inactive=i.inactive,this.state=i.state?i.state:e,this.childNodeCount=0,this.options=i,this.inactive&&this.element.hide(),this.fakeComponent={state:a.state,save:t.Component.prototype.save,rebuildProps:function(){a.getItems(),a.renderItems()},refresh:function(){}},this.childrenNodeName=i.childrenNodeName,this.childNodeName=i.childNodeName,this.childrenNodeName&&this.childNodeName&&(this.childbuilder=o.getBuilder(this.childNodeName),this.body.append(this.createAddButton(this.childbuilder,this.childrenNodeName))),this.body.append(this.propcontents,this.bodycontents),this.headertitle=n("<div>").addClass("smb-propertylist-headertitle").text(i.title||i.label),this.header.append(this.expandIndicator,this.headertitle),(this.childrenNodeName||this.childNodeName||this.options.childrenFunction||this.options.children)&&(this.headercount=n("<div>").addClass("smb-propertylist-headercount"),this.header.append(this.headercount)),this.element.append(this.header,this.body),this.getItems()},t.MiniComponentList.prototype.createAddButton=function(e,t,i){var a=this;return n("<div>").addClass("smb-property-action").text(i||"Add new "+e.name).click(function(){a.addChild(e,t)})},t.MiniComponentList.prototype.addItem=function(e){this.items.push(e)},t.MiniComponentList.prototype.addItems=function(e){var t=this;n.each(e,function(){t.push(this)})},t.MiniComponentList.prototype.getItems=function(){var e=this;e.items=[];var i=this.options,a=i.propsFunction&&i.propsFunction(e.fakeComponent)||i.props||[];a&&n.each(a,function(n,i){e.addItem(new t.PropertyItem(i))})},t.MiniComponentList.prototype.renderItems=function(){var e=this;e.propcontents.empty(),n.each(this.items,function(){this.render(e.state),e.propcontents.append(this.element)})},t.MiniComponentList.prototype.createBuilderFromTreeObj=function(e){var i=e.linkedComponent;return new o.Builder({id:e.id,name:e.id,options:{makeSiblingDropZone:!1,makeDraggable:!1},mobileRenderer:function(t){t.bodycontent.text(e.labelFunction&&e.labelFunction(t.state)||e.label)},propertiesRenderer:function(i,a){var o=e.propsFunction&&e.propsFunction(a)||e.props||[],r=new t.PropertyList(a.state);n.each(o,function(){r.addItem(new t.PropertyItem(this))}),i.addLists([r]);var l=e.childrenFunction&&e.childrenFunction({state:a.state})||e.children;l&&n.each(l,function(){var e=this;i.addList(new t.MiniComponentList(a.state,{title:e.invisibleParentLabel||"Child Components",childrenFunction:function(){return[e]}}))}),i.render()},hideWrapper:!0,defaultStateGenerator:function(){return e.defaultStateFunction&&e.defaultStateFunction()||a("<"+e.id+"/>")},onSelect:function(){i&&i.element.addClass("nx-pagebuilder-selected")},resetPropCategory:!1})},t.MiniComponentList.prototype.render=function(){var e,i,a=this;if(a.bodycontents.empty(),a.childbuilder&&a.childrenNodeName){if(this.inactive)return!1;var o=this.state.children(this.childrenNodeName).first().children();o.each(function(){var e=new t.MiniComponent(n(this),a.childbuilder);e.render(),a.bodycontents.append(e.element)}),this.setCount(o.length)}else a.renderItems(),e=a.options.childrenFunction&&a.options.childrenFunction({state:a.state})||a.options.children,i=0,e&&e.length&&n.each(e,function(){var e,o=this,r=a.createBuilderFromTreeObj(o);a.bodycontents.append(a.createAddButton(r,o.invisibleParent,o.addtooltip)),e=n("<div>"),a.bodycontents.append(e),e.sortableComponent({axis:"y",component:a.fakeComponent,parentStateSelector:o.invisibleParent,placeholder:"sk-placeholder",onSort:function(){a.render()},handle:".smb-minicomponent-handle"}),o.invisibleParent?a.state.children(o.invisibleParent).each(function(){n(this).children(o.id).each(function(){var a=new t.MiniComponent(n(this),r);a.render(),e.append(a.element),i++})}):a.state.children(o.id).each(function(){var a=new t.MiniComponent(n(this),r);a.render(),e.append(a.element),i++})}),this.setCount(i)},t.MiniComponentList.prototype.addChild=function(e,n){var i=new t.MiniComponent(e.defaultStateGenerator(),e);if(n){var o=this.state.children(n).first();o.length||(o=a("<"+n+"/>").appendTo(this.state)),this.state.children(n).first().append(i.state)}else this.state.append(i.state);this.bodycontents.append(i.element),i.render(),this.increaseCount(),s("skuidBuilderSave")},t.MiniComponentList.prototype.revealContents=function(){this.body.slideToggle()},t.MiniComponentList.prototype.decreaseCount=function(){this.setCount(this.childNodeCount-1)},t.MiniComponentList.prototype.increaseCount=function(){this.setCount(this.childNodeCount+1)},t.MiniComponentList.prototype.setCount=function(e){this.childNodeCount=e,this.headercount&&this.headercount.text(this.childNodeCount)},t.MiniComponent=function(e,i){var a=this;this.builderId=i.id,this.builder=i,this.state=e,this.element=n("<div>").addClass("smb-minicomponent"),this.handle=n("<div>").addClass("smb-minicomponent-handle fa fa-ellipsis-v"),this.body=n("<div>").addClass("smb-minicomponent-body"),this.bodycontent=n("<div>").addClass("smb-minicomponent-content"),this.properties=new t.MiniPropViewer;var r=n("<div>").addClass("smb-minicomponent-removeicon fa fa-times fa-fw").click(function(e){a.remove(),e.stopPropagation()});o.registerComponent(a),this.body.append(r,this.bodycontent),this.element.append(this.handle,this.body,this.properties.element),this.body.on("click",function(){a.properties.element.slideToggle()})},t.MiniComponent.prototype.refresh=function(){return this.bodycontent.empty(),this.builder.mobileRenderer(this),this},t.MiniComponent.prototype.render=function(){this.builder&&(this.builder.mobileRenderer(this),this.builder.propertiesRenderer(this.properties,this))},t.MiniComponent.prototype.renderProperties=function(){return this.properties.clear(),this.builder.propertiesRenderer(this.properties,this),this},t.MiniComponent.prototype.rebuildProps=function(){return this.renderProperties()},t.MiniComponent.prototype.remove=function(){this.element.closest(".smb-propertylist").data("list").decreaseCount(),this.element.remove(),this.state.remove(),o.unregisterComponent(this),s("skuidBuilderSave")},t.MiniComponent.prototype.save=function(){return s("skuidBuilderSave"),this},t.MiniPropViewer=function(){this.lists=[],this.element=n("<div>").addClass("smb-minicomponent-propviewer").hide()},t.MiniPropViewer.prototype.clear=function(){this.lists=[],this.element.empty()},t.MiniPropViewer.prototype.addList=function(e){this.lists.push(e)},t.MiniPropViewer.prototype.addLists=function(e){var t=this;n.each(e,function(){t.lists.push(this)})},t.MiniPropViewer.prototype.render=function(){var e=this;this.element.empty(),n.each(this.lists,function(){this.render(this.state),e.element.append(this.element)})},t.MiniPropViewer.prototype.applyPropTreeItem=t.PropertyViewer.prototype.applyPropTreeItem,t.MiniPropViewer.prototype.applyPropTree=t.PropertyViewer.prototype.applyPropTree,t.MiniPropViewer.prototype.applyPropsWithCategories=t.PropertyViewer.prototype.applyPropsWithCategories,t.PropertyList=function(e,i){var a=this;i=n.extend({expanded:!1,title:""},i),a.items=[],a.element=n("<div>").addClass("smb-propertylist"),a.element.data("list",a),a.header=n("<div>").addClass("smb-propertylist-header"),a.body=n("<div>").addClass("smb-propertylist-body"),a.expanded=i.expanded,a.viewer=null,a.name=i.title||i.name||i.label,a.element.append(a.header,a.body),a.state=e;var o=i.propsFunction&&i.propsFunction({state:a.state,save:t.Component.prototype.save})||i.props||[];o&&n.each(o,function(e,n){a.addItem(new t.PropertyItem(n))})},t.PropertyList.prototype.addItem=function(e){this.items.push(e)},t.PropertyList.prototype.addItems=function(e){var t=this;n.each(e,function(){t.push(this)})},t.PropertyList.prototype.render=function(){var e=this,t=!1;this.body.empty(),this.name?(t=this.viewer&&this.viewer.openLists&&this.name in this.viewer.openLists?!!this.viewer.openLists[this.name]:this.expanded,this.headertitle=n("<div>").addClass("smb-propertylist-headertitle").text(this.name),this.expandIndicator=n("<div>").addClass("smb-propertylist-titleicon fa fa-chevron-"+(t?"up":"down")+" fa-fw"),this.header.append(this.expandIndicator,this.headertitle)):t=!0,this.expanded=t,this.expanded?this.body.css("display",""):this.body.css("display","none"),n.each(this.items,function(){this.render(e.state),e.body.append(this.element)})},t.PropertyList.prototype.revealContents=function(){this.expanded=!this.expanded,this.expandIndicator.removeClass("fa-chevron-"+(this.expanded?"down":"up")),this.expandIndicator.addClass("fa-chevron-"+(this.expanded?"up":"down")),this.body.slideToggle(),this.viewer&&(this.viewer.openLists[this.name]=this.expanded)},t.PropertyItem=function(e){this.element=n("<div>").addClass("smb-propertyitem"),n.extend(this,e)},t.PropertyItem.prototype.render=function(e){this.element.empty();var n=this.type||"standard";t.propertyRenderers[n]?t.propertyRenderers[n](this,e):t.propertyRenderers.standard(this,e)},t.setupPageXML=function(e){if(e||(e=t.model.getFieldValues(t.row,o.getLayoutFields(),!0).join("")),e.length){t.pageXML=a(e);var n=t.pageXML.children("components").first();t.mobileXML=n.children("skuidmobile").first(),t.mobileXML.length||(t.mobileXML=a("<skuidmobile><mobilepanels/><mobilenavs/></skuidmobile>").appendTo(n)),t.modelsXML=t.pageXML.children("models").first(),t.resourcesXML=t.pageXML.children("resources").first(),t.panelsXML=t.mobileXML.children("mobilepanels").first(),t.navsXML=t.mobileXML.children("mobilenavs").first()}o.pageXML=t.pageXML,s("skuidBuilderXMLLoaded")},d("mobileComponentViewer",function(i){t.model=o.pageModel=e.$M("page"),t.row=o.pageRow=t.model.getFirstRow(),t.setupPageXML();var a=new t.ComponentViewer(i),d=function(){r.setLeftPanel("quicknav",{displaymode:"fit",preventProcessing:!0,transition:"none"}).then(function(){r.addLeftPanel("panels",{displaymode:"push",position:1}),n(".sm-buttonset-nav").removeClass("sm-active"),n("#quicknav").children().eq(2).addClass("sm-active")})};l("skuidBuilderSave",function(){o.save(t.pageXML[0],t.model,t.row)}),t.componentViewer=a,l("skuidMobileReady",function(){d()}),l("skuidMobileSavePage",function(t){t&&t.button&&t.button.startProcessing(),e.$M("page").save({callback:function(){t&&t.button&&t.button.stopProcessing()}})}),l("skuidMobileCancelPage",function(){e.$M("page").cancel(),e.builder.mobile.setupPageXML(),t.propertyViewer.clear(),t.componentViewer.clear(),s("skuidBuilderRefreshModelList"),s("skuidBuilderRefreshNavList"),s("skuidBuilderRefreshPanelList"),s("skuidBuilderRefreshLabelList"),s("skuidBuilderRefreshJSItemList"),s("skuidBuilderRefreshCSSItemList"),d()}),l("skuidMobilePreviewPage",function(){var t=e.$M("page"),n=e.snippet.get("skuid.builder.page.preview");n&&n({model:t})})}),d("mobilePropertyViewer",function(e){var n=new t.PropertyViewer(e);l("skuidBuilderViewProperties",function(e){n.loadComponent(e)}),t.propertyViewer=n}),d("mobileBuilderPageProperty_Theme",function(i){var a=n.map(e.builder.core.availableThemes,function(e){return{label:e.Name,value:e.Name}});a.unshift({label:"Default",value:""});var o={id:"theme",type:"picklist",label:"Theme",picklistEntries:a,helptext:"The name of the theme to use."},r=new t.PropertyItem(o);r.render(t.pageXML),i.append(r.element)}),d("mobileBuilderPageProperty_UnsavedChangesWarning",function(e){var n=new t.PropertyItem({id:"unsavedchangeswarning",type:"picklist",label:"Warn users if page has unsaved changes",picklistEntries:[{label:"No",value:""},{label:"Yes",value:"yes"}],defaultValue:"",helptext:"If a user tries to leave or close this page, and one or more of its Models has unsaved changes, a warning message will be shown before they can leave."});n.render(t.pageXML),e.append(n.element)}),d("mobileBuilderModelList",function(e){e.append(u("mobileBuilderPropertyPanelHeader")({title:"Models",showCloseButton:!0,closePanel:"models",showAddButton:!0,eventToPublishOnAdd:"skuidBuilderAddModel"}),u("mobileBuilderPropertyPanelList")({xmlParentFunction:function(){return t.modelsXML},addEventName:"skuidBuilderAddModel",builderName:"model",refreshEventName:"skuidBuilderRefreshModelList",labelFunction:function(e){return e.attr("id")},showRemoveButton:!1}))}),d("mobileBuilderNavList",function(e){e.append(u("mobileBuilderPropertyPanelHeader")({title:"Headers and Footers",showCloseButton:!0,closePanel:"navs",showAddButton:!0,eventToPublishOnAdd:"skuidBuilderAddNav"}),u("mobileBuilderPropertyPanelList")({xmlParentFunction:function(){return t.navsXML},addEventName:"skuidBuilderAddNav",builderName:"mobilenav",refreshEventName:"skuidBuilderRefreshNavList",labelFunction:function(e){var t="footer"===e.attr("type")?"Footer":"Header",n=e.attr("name")||t;return e.attr("uniqueid")?n+=" - "+e.attr("uniqueid"):n+=" - [New "+t+"]",n},showRemoveButton:!1}))}),d("mobileBuilderPanelList",function(e){e.append(u("mobileBuilderPropertyPanelHeader")({title:"Page Panels",showCloseButton:!0,closePanel:"panels",showAddButton:!0,eventToPublishOnAdd:"skuidBuilderAddPanel"}),u("mobileBuilderPropertyPanelList")({xmlParentFunction:function(){return t.panelsXML},addEventName:"skuidBuilderAddPanel",builderName:"mobilepanel",refreshEventName:"skuidBuilderRefreshPanelList",labelFunction:function(e){return e.attr("uniqueid")||"[New Panel]"},showRemoveButton:!1}))}),d("mobileBuilderPropertyPanelList",function(e){var i=e.element||n("<div>");i.on("tap",".sm-button-custom",function(){var i=e.xmlParentFunction&&e.xmlParentFunction(),a=n(this).index();t.componentViewer.loadComponent(i.children().eq(a)),r.processResponsiveElements()});var a=function a(){var o=e.xmlParentFunction&&e.xmlParentFunction(),l={state:o,save:t.Component.prototype.save,rebuildProps:function(){a()}};i.empty(),i.sortableComponent({axis:"y",component:l,placeholder:"sk-placeholder",onSort:function(){a()},handle:".smb-minicomponent-handle"}),o.children().each(function(){var a,o,l=n(this),s=new r.ui.Button({icon:e.icon,iconColor:"#bbb",label:e.labelFunction(l)});s.element.css("position","relative").addClass("smb-menupropertylist sm-button-custom sm-liststyle sm-level"+(e.indentLevel||0)),e.showRemoveButton&&(a=n("<div>").addClass("sm-titlebutton sm-accordion-item-button fa fa-times fa-fw").on("tap",function(e){new t.Component(l).remove(),t.componentViewer.clear(),s.element.remove(),e.stopPropagation()}),o=n("<div>").addClass("sm-titlebutton-wrapper").append(a),s.element.append(o)),s.element.append(n("<div>").addClass("smb-minicomponent-handle fa fa-ellipsis-v")),i.append(s.element)})};return a(),l(e.addEventName,function(n){var i,l=e.xmlParentFunction&&e.xmlParentFunction();n=n&&n.jquery?n.clone():o.getBuilder(e.builderName).defaultStateGenerator(),l.length||(i=e.xmlGrandParentFunction&&e.xmlGrandParentFunction(),l=o.defaultStateGenerators[e.parentBuilderName](),i.append(l)),l.append(n),t.componentViewer.loadComponent(n).select(),r.processResponsiveElements(),s("skuidBuilderSave"),a()}),l(e.refreshEventName,function(){a()}),i}),d("mobileBuilderPropertyPanelHeader",function(e){var t,i,a=e.element||n("<div>"),o=n("<div>").addClass("sm-titlebutton-wrapper").appendTo(a);return a.addClass("smb-propview-header sm-title").css("padding","10px 10px 9px 10px"),n("<div>").addClass("smb-propviewer-headertext").text(e.title).appendTo(a),e.showCloseButton&&(t=n("<div>").addClass("sm-titlebutton fa fa-angle-double-left fa-fw").appendTo(o),e.closePanel&&t.click(function(){r.toggleLeftPanel(e.closePanel,{transition:"slide"})})),e.showAddButton&&(i=n("<div>").addClass("sm-titlebutton fa fa-plus-circle fa-fw").appendTo(o),e.eventToPublishOnAdd&&i.click(function(){s(e.eventToPublishOnAdd)})),a}),d("mobileBuilderPagePropertiesHeader",function(e){u("mobileBuilderPropertyPanelHeader")({element:e,title:"Edit Page Properties",showCloseButton:!0,closePanel:"pageproperties"})}),d("mobileBuilderResourcePanelHeader",function(e){u("mobileBuilderPropertyPanelHeader")({element:e,title:"Resources",showCloseButton:!0,closePanel:"resources"})}),d("mobileBuilderLabelList",function(e){u("mobileBuilderPropertyPanelList")({element:e,icon:"fa-angle-double-right",xmlParentFunction:function(){return t.resourcesXML.children("labels")},xmlGrandParentFunction:function(){return t.resourcesXML},addEventName:"skuidMobileAddLabelItem",builderName:"label",parentBuilderName:"labels",refreshEventName:"skuidBuilderRefreshLabelList",labelFunction:function(e){return e.attr("id")||"[No Label ID]"},showRemoveButton:!0,indentLevel:2})}),d("mobileBuilderJSList",function(e){u("mobileBuilderPropertyPanelList")({element:e,icon:"fa-angle-double-right",xmlParentFunction:function(){return t.resourcesXML.children("javascript")},xmlGrandParentFunction:function(){return t.resourcesXML},addEventName:"skuidMobileAddJSItem",builderName:"jsitem",parentBuilderName:"javascript",refreshEventName:"skuidBuilderRefreshJSItemList",labelFunction:function(e){return o.getJSItemLabel(e).name||"[No Javascript Item Name]"},showRemoveButton:!0,indentLevel:2})}),d("mobileBuilderCSSList",function(e){u("mobileBuilderPropertyPanelList")({element:e,icon:"fa-angle-double-right",xmlParentFunction:function(){return t.resourcesXML.children("css")},xmlGrandParentFunction:function(){return t.resourcesXML},addEventName:"skuidMobileAddCSSItem",builderName:"cssitem",parentBuilderName:"css",refreshEventName:"skuidBuilderRefreshCSSItemList",labelFunction:function(e){var t=o.getCSSItemLabel(e);return t.prefix+" "+t.name},showRemoveButton:!0,indentLevel:2})}),d("mobileBuilderXMLEditLink",function(t){var n=new e.ui.Editor(t),i=new r.ui.Button({icon:"fa-code",label:"Edit Page XML"});i.element.addClass("sm-button").click(function(){window.location="/apex/skuid__ui?page=PageXMLEdit&id="+e.$M("page").data[0].Id}),n.registerModel(e.$M("page")),n.handleSave=function(e){e&&t.show()},n.handleCancel=function(){t.show()},n.handleChange=function(){t.hide()},t.append(i.element)}),l("skuidBuilderComponentSelect",function(e){"model"===e.builderId&&o.setLastSelectedModelComponent(e)}),e.snippet.register("saveAndPreview",function(){var t=arguments[0],n=t.model||e.$M("page"),i=t.component.editor,a=e.snippet.get("skuid.builder.page.preview");a&&a({editor:i,model:n,saveFirst:!0})})}(skuid)},359:function(e,t,n){"use strict";!function(e){var t=e.builder.mobile,n=e.mobile,i=e.builder.core,a=e.$,o=e.utils,r=o.makeXMLDoc,l=e.events.publish;i.registerBuilders([{id:"mobilepanel",name:"Page Panel",givesContext:!0,rejectsComponentAspects:["needscontext"],options:{makeSiblingDropZone:!1,makeDraggable:!1},mobileRenderer:function(e){e.element.addClass("smb-toplevel-component"),e.setTitle(e.builder.name+" - "+(e.state.attr("uniqueid")||"[New Panel]")),e.renderChildren()},propertiesRenderer:function(e,i){e.setTitle("Panel Properties");var a=new t.PropertyList(i.state);a.addItem(new t.PropertyItem({id:"uniqueid",label:"Unique Id",onChange:function(){i.refresh(),l("skuidBuilderRefreshPanelList")}})),a.addItem(new t.PropertyItem({id:"minwidth",label:"Min Width",type:"quicknumber",options:[200,400,600,800]}));var o=new t.PropertyList(i.state,t.makeAddComponentsCategory()),r=new t.MiniComponentList(i.state,{title:"Interactions",childrenNodeName:"interactions",childNodeName:"interaction"}),s=new t.PropertyList(i.state,{title:"Remove"});s.addItem(new t.PropertyItem({type:"remove",onChange:function(){l("skuidBuilderRefreshPanelList"),n.addLeftPanel("panels",{position:"edge",replace:!0})}})),e.addLists([a,o,r,s]),e.render()},defaultStateGenerator:function(){return r('<mobilepanel minwidth="200"/>')}},{id:"mobilenav",name:"Header / Footer",acceptsComponentAspects:["provideslayout"],options:{makeSiblingDropZone:!1,makeDraggable:!1},mobileRenderer:function(e){var t=e.state.attr("uniqueid"),n="footer"===e.state.attr("type")?"Footer":"Header";e.element.addClass("smb-toplevel-component"),e.setTitle(n+(t?" - "+t:" - [New "+n+"]")),e.renderChildren()},propertiesRenderer:function(e,i){e.setTitle("Nav Properties");var a=new t.PropertyList(i.state);a.addItem(new t.PropertyItem({id:"uniqueid",label:"Unique Id",onChange:function(){i.refresh(),l("skuidBuilderRefreshNavList")}})),a.addItem(new t.PropertyItem({id:"type",label:"Type",options:[{value:"",label:"Header"},{value:"footer",label:"Footer"}],type:"picklist",onChange:function(){i.refresh()}}));var o=new t.PropertyList(i.state,t.makeAddComponentsCategory()),r=new t.MiniComponentList(i.state,{title:"Interactions",childrenNodeName:"interactions",childNodeName:"interaction"}),s=new t.PropertyList(i.state,{title:"Remove"});s.addItem(new t.PropertyItem({type:"remove",onChange:function(){l("skuidBuilderRefreshNavList"),n.addLeftPanel("navs",{position:1,replace:!0})}})),e.addLists([a,o,r,s]),e.render()},defaultStateGenerator:function(){return r("<mobilenav />")}},{id:"mobiledeck",name:"Deck",givesContext:!0,emitsComponentAspects:["provideslayout"],mobileRenderer:function(e){var t=e.state.attr("uniqueid"),n=e.state.attr("model");e.element.attr("data-model",n),e.setTitle("Deck"+(t&&"sk-"!==t.slice(0,3)?" - "+t:"")),e.getContextModelName=function(){return n},e.renderChildren()},handleStateEvent:function(e,t,n){i.handleModelRemove(e,t,{component:n}),i.handleModelIdChange(e,t)},propertiesRenderer:function(e,n){e.setTitle("Deck Properties");var a=n.state,o=a.closest("[model]").attr("model"),r=a.attr("model"),l=o||r,s=[];s.push({name:"",props:[{id:"model",label:"Model",type:"model",onChange:function(e){n.element.attr("data-model",e)}},{id:"title",label:"Deck Title",type:"template",displayAs:"input",location:"node"},{id:"createrecords",type:"boolean",label:"Allow Inline Record Creation action"},{id:"showsavecancel",type:"boolean",label:"Show Save/Cancel"},{id:"showloadmore",type:"boolean",label:'Show "Load More"'}]},t.makeAddComponentsCategory({label:"Add Components to Deck"}),{name:"Built-in Grid Properties",props:[{id:"precision",label:"Max Columns",type:"numberbox",boxes:12,onChange:function(){n.refresh()}},{id:"minwidth",label:"Min Card Width",type:"quicknumber",options:[100,200,300,400],onChange:function(){n.refresh()}}]},{name:"Card Properties",props:[{id:"cardtitle",label:"Card Title",type:"template",displayAs:"input",location:"node"},{id:"mode",type:"picklist",label:"Default Mode",defaultValue:"read",picklistEntries:[{label:"Read with Inline-Editing",value:"read"},{label:"Edit",value:"edit"},{label:"Read-Only",value:"readonly"}]}]},{tree:{title:"Card Interactions",childrenNodeName:"cardinteractions",childNodeName:"interaction"}},i.getListSearchPropsCategory({component:n,modelName:r,propViewer:e,hideOrderingOptions:!0}),i.getActionsCategory({propViewer:e,linkedComponent:n,label:"After Save Actions",customNodeId:"aftersaveactions"}),i.getRenderingCategory({component:n,model:l,propViewer:e}),i.getContextCategory({propViewer:e,state:a,model:r}),{name:"Unique Id / CSS Class",props:[i.coreProps.uniqueIdProp({component:n,onChange:function(){n.refresh()}}),i.coreProps.cssClassProp()]},{name:"Remove",props:[{type:"remove"}]}),e.applyPropsWithCategories(s,a)},defaultStateGenerator:function(){var e=i.getLastSelectedModelComponent(),t=e&&e.state?e.state.attr("id"):null;return r("<mobiledeck/>").attr({uniqueid:o.generateUniqueId(),showsavecancel:"true",showloadmore:"true",searchmethod:"server",searchbox:"true",tokenizesearch:"true",createrecords:"true",precision:"1",minwidth:"400",model:t})}},{id:"mobilegrid",name:"Grid",acceptsComponentAspects:["gridable"],emitsComponentAspects:["provideslayout"],mobileRenderer:function(t){t.body.addClass("sm-grid"),t.body.data("precision",t.state.attr("precision"));var n=t.state.attr("minwidth");n=parseInt(n,10)+16,e.responsive.prepareGrid(t.body,{precision:t.state.attr("precision"),minWidth:n,layoutMode:t.state.attr("layoutmode")}),t.renderChildren("divisions")},propertiesRenderer:function(e,n){e.setTitle("Grid Properties");var i=new t.PropertyList(n.state);i.addItem(new t.PropertyItem({id:"precision",label:"Max Divisions before Wrap",type:"numberbox",boxes:12,onChange:function(){n.refresh()}})),i.addItem(new t.PropertyItem({id:"minwidth",label:"Min Division Width",type:"quicknumber",options:[100,200,300,400],onChange:function(){n.refresh()}}));var a=new t.PropertyList(n.state,t.makeAddComponentsCategory({childrenNodeName:"divisions"})),o=new t.PropertyList(n.state,{title:"Remove"});o.addItem(new t.PropertyItem({type:"remove"})),e.addLists([i,a,o]),e.render()},defaultStateGenerator:function(){return r('<mobilegrid uniqueid="'+o.generateUniqueId()+'" precision="1" minwidth="200"/>').append(r("<divisions/>").append(i.getBuilder("division").defaultStateGenerator()))}},{id:"division",name:"Division",rejectByDefault:!0,emitsComponentAspects:["gridable"],mobileRenderer:function(t){t.element.addClass("sm-grid-division"),t.element.data("size",t.state.attr("size"));var n=t.state.parent().parent().attr("minwidth"),i=t.state.attr("size");e.responsive.prepareDivision(t.element,{behavior:t.state.attr("type"),relativeSize:i,width:i,minWidth:n}),t.renderChildren()},propertiesRenderer:function(e,n){e.setTitle("Division Properties");var a=n.state,o=a.closest("mobiledeck").attr("model"),r={id:"type",label:"Size Calculation",type:"picklist",defaultValue:"flex",picklistEntries:[{label:"Specified",value:"specified"},{label:"Flexible",value:"flex"}],onChange:function(e){"specified"===e?n.state.attr("size","100px"):n.state.attr("size","1"),n.rebuildProps().refresh()}},l={id:"size",label:"Size",type:"specified"===n.state.attr("type")?"string":"numberbox",boxes:12,onChange:function(){n.refresh()}};e.applyPropsWithCategories([{name:"",props:[r,l]},t.makeAddComponentsCategory(),{tree:{title:"Interactions",childrenNodeName:"interactions",childNodeName:"interaction"}},i.getRenderingCategory({component:n,model:o,propViewer:e}),{name:"Remove",props:[{type:"remove"}]}],a)},defaultStateGenerator:function(){return r('<division size="1"/>')}},{id:"mobilebutton",name:"Button",mobileRenderer:function(e){var t=e.body,i=e.state;e.header.hide(),e.element.css("position","relative").append(e.header.find(".smb-component-titlebuttons")),new n.ui.Button({element:t,label:i.attr("label"),icon:i.attr("icon")}),t.addClass("sm-button").removeClass("smb-component-body").css("margin","0px")},propertiesRenderer:function(e,t){e.setTitle("Button Properties");var a,o=t.state,r=o.closest("[model]").attr("model"),l=[{id:"label",label:"Label",onChange:function(){t.refresh(),t.body.data("fullwidth",""),n.processButton(t.body)}},{id:"icon",label:"Icon",type:"icon",onChange:function(){t.refresh(),t.body.data("fullwidth",""),n.processButton(t.body)}},{id:"style",label:"Style",type:"picklist",defaultValue:"nav",options:[{value:"list",label:"List"},{value:"nav",label:"Nav"}]}];a=o.children("interactions").length?{tree:{title:"Interactions",childrenNodeName:"interactions",childNodeName:"interaction"}}:i.getActionsCategory({propViewer:e,linkedComponent:t,label:"On-Tap Actions"}),e.applyPropsWithCategories([{name:"",props:l},a,i.getRenderingCategory({component:t,model:r,propViewer:e,showEnableDisableConditions:!0}),{name:"Unique Id / CSS Class",props:[i.coreProps.uniqueIdProp({component:this}),i.coreProps.cssClassProp()]},{name:"Remove",props:[{type:"remove"}]}],o)},afterAttach:function(e){e.element.removeClass("smb-component-dragging")},defaultStateGenerator:function(){return r('<mobilebutton label="New Button" style="nav" uniqueid="'+o.generateUniqueId()+'"/>')}},{id:"template",name:"Template",mobileRenderer:function(e){var t=e.state.attr("uniqueid");e.setTitle(e.builder.name+(t&&"sk-"!==t.slice(0,3)?" - "+t:""));var n=a("<code>").text(e.state.text()).css("word-break","break-word");e.body.append(n)},propertiesRenderer:function(e,t){e.setTitle("Template Properties");var n=t.state,a=n.closest("[model]").attr("model");e.applyPropsWithCategories([{name:"",props:[{label:"Template Body",type:"template"}]},{name:"Unique Id / CSS Class",props:[i.coreProps.uniqueIdProp({component:t,onChange:function(){t.refresh()}}),i.coreProps.cssClassProp()]},i.getRenderingCategory({component:t,model:a,propViewer:e}),{name:"Remove",props:[{type:"remove"}]}],n)},defaultStateGenerator:function(){return r('<template uniqueid="'+o.generateUniqueId()+'"/>')}},{id:"mobiletitle",name:"Title",mobileRenderer:function(e){e.setTitle("Title: "+e.state.text())},propertiesRenderer:function(e,t){e.setTitle("Title Properties");var n=t.state,a=n.closest("[model]").attr("model");e.applyPropsWithCategories([{name:"",props:[{label:"Title",type:"template",id:"contents",location:"node",onChange:function(){t.refresh()}}]},{name:"Unique Id / CSS Class",props:[i.coreProps.uniqueIdProp({component:t,onChange:function(){t.refresh()}}),i.coreProps.cssClassProp()]},i.getRenderingCategory({component:t,model:a,propViewer:e}),{name:"Remove",props:[{type:"remove"}]}],n)},defaultStateGenerator:function(){return r('<mobiletitle uniqueid="'+o.generateUniqueId()+'"><contents/></mobiletitle>')}},{id:"mobileinfo",name:"Info Text",mobileRenderer:function(e){var t=e.state.attr("uniqueid");e.setTitle(e.builder.name+(t&&"sk-"!==t.slice(0,3)?" - "+t:"")),e.body.html(e.state.children("contents").html())},propertiesRenderer:function(e,t){e.setTitle("Info Text Properties");var n=t.state,a=n.closest("[model]").attr("model");e.applyPropsWithCategories([{name:"",props:[{label:"Contents",type:"template",id:"contents",location:"node",onChange:function(){t.refresh()}}]},{name:"Unique Id / CSS Class",props:[i.coreProps.uniqueIdProp({component:t,onChange:function(){t.refresh()}}),i.coreProps.cssClassProp()]},i.getRenderingCategory({component:t,model:a,propViewer:e}),{name:"Remove",props:[{type:"remove"}]}],n)},defaultStateGenerator:function(){return r('<mobileinfo uniqueid="'+o.generateUniqueId()+'"><contents/></mobileinfo>')}},{id:"mobilefield",name:"Field",emitsComponentAspects:["needscontext"],mobileRenderer:function(e){var n=e.state.attr("id");e.setTitle(e.builder.name+" - "+(n||"[No Field Selected]")),e.element.on("doubletap",function(){t.propertyViewer.lists[0].items[0].element.find(".smb-propertyitem-actionbutton").trigger("tap")}),e.element.attr("data-field",n)},propertiesRenderer:function(e,t){e.setTitle("Field Properties");var n=[],o=t.state.closest("[model]").attr("model"),r=i.getFieldProperties(t,o,"mobilefield",e);a.each(r,function(e,t){"Basic"===t.name&&(t.expanded=!0),n.push(t)}),n.push({name:"Remove",props:[{type:"remove"}]}),e.applyPropsWithCategories(n,t.state)},defaultStateGenerator:function(){return r("<mobilefield/>")},handleStateEvent:function(e,t){var n="model.idChange"===t.type,i="model.remove"===t.type,o="model.field.remove"===t.type,r=!1;if(n||i||o){var s=e.find('filters > filter[type="modelmerge"][model="'+(n?t.oldId:t.modelId)+'"]');s.length&&s.each(function(){i?a(this).remove():n?a(this).attr("model",t.newId):o&&a(this).attr("mergefield")===t.fieldId&&(r=!0,a(this).remove())})}if(o){if(e.closest("[model]").attr("model")===t.modelId){var d=e.attr("id");t.fieldId===d&&(e.remove(),a('.smb-component[data-field="'+d+'"]').each(function(){var e=a(this);e.closest('.smb-component[data-model="'+t.modelId+'"]').length&&e.remove()}))}t.parentChildRelationship}return r&&l("skuidBuilderNeedSave"),!1}},{id:"custom",name:"Custom",mobileRenderer:function(e){var t=e.state.attr("name");e.setTitle(e.builder.name+(t?" - "+t:""))},propertiesRenderer:function(e,t){e.setTitle("Custom Component Properties");var n=t.state,a=n.closest("[model]").attr("model");e.applyPropsWithCategories([{name:"",props:[{id:"name",label:"Component Name",onChange:function(){t.refresh()}}]},{name:"Unique Id / CSS Class",props:[i.coreProps.uniqueIdProp({component:t,onChange:function(){t.refresh()}}),i.coreProps.cssClassProp()]},i.getRenderingCategory({component:t,model:a,propViewer:e}),{name:"Remove",props:[{type:"remove"}]}],n)},defaultStateGenerator:function(){return r('<custom uniqueid="'+o.generateUniqueId()+'"/>')}},{id:"model",name:"Model",options:{makeDraggable:!1,makeSiblingDropZone:!1},mobileRenderer:function(e){e.element.addClass("smb-model"),e.setTitle(e.builder.name+" - "+e.state.attr("id"));var n=e.state.children("fields").first();n.length||(n=i.getBuilder("fields").defaultStateGenerator(),e.state.append(n)),e.body.append(new t.Component(n).render().element);var a=e.state.children("conditions").first();a.length||(a=i.getBuilder("conditions").defaultStateGenerator(),e.state.append(a)),e.body.append(new t.Component(a).render().element),e.body.addClass("smb-model-body")},propertiesRenderer:function(o,r){o.setTitle("Model Properties");var s=r.state,d=i.getDataSourceFromModel(s),u=i.getDataSourceTypeFromModel(r.state),c=[],p=i.getModelProperties(r,o,d),h=u&&"local"===u.prop("runtime.metadataSource"),f=[];a.each(p,function(e,t){var n=!1;t.props&&t.props.length?n=!0:t.tree&&(n=!1),n&&f.push(t)}),a.each(f,function(e,n){var i=f.length>1?{title:n.name}:null;i&&"Basic"===i.title&&(i.expanded=!0);var o=new t.PropertyList(r.state,i);n.props&&a.each(n.props,function(e,n){if("type"===n.id&&"salesforce"===u.name)return!0;o.addItem(new t.PropertyItem(n))}),c.push(o)});var m=new t.PropertyList(r.state,{title:"Actions"});m.addItem(new t.PropertyItem({type:"customaction",label:e.$L("clone"),customAction:function(){var e=r.state.clone();e.attr("id",i.getUniqueModelName(e.attr("id"))),e.children("conditions").find("condition[name^='__autofilter__']").remove(),l("skuidBuilderAddModel",e)}})),m.addItem(new t.PropertyItem({type:"customaction",label:"Add "+(h?"":"Ui-Only ")+"Field",customAction:function(){var e=i.addFieldToModel({fieldId:i.getUniqueFieldName("NewField",r.state),model:r.state,view:""});h||e[0].attr("uionly",!0),l("skuidBuilderAddField",e),l("skuidBuilderSave")}})),m.addItem(new t.PropertyItem({type:"remove",onChange:function(){l("skuidBuilderRefreshModelList"),n.addLeftPanel("models",{position:1,replace:!0})}})),c.push(m),o.addLists(c),o.render()},defaultStateGenerator:function(){return i.defaultStateGenerators.model()},onSelect:function(e){i.setLastSelectedModelComponent(e)}},{id:"fields",name:"Fields",options:{allowSelection:!1,makeDraggable:!1},mobileRenderer:function(n){var o=n.state.closest("model").attr("id"),r=i.getModelFromModelName(o),s=r.attr("sobject"),d=a("<div>").addClass("smb-fielddeckcontrols").css("left","62px");n.header.append(d),n.body.addClass("smb-modelfields-body").data({voffset:"158",vpercent:"50"});var u=new t.FieldSelectDeck(n.body,{breadcrumb:[{rel:s,ref:s}],referenceCount:function(e,t){return n.state.children('[id^="'+t+e.rel+'."]').length},controls:d,isSelected:function(e,t){return n.state.children('[id="'+t+e.id+'"]').length},onSelect:function(e,t,a){var o=t+e.id,s=i.addFieldToModel({fieldId:o,model:r,fieldsNode:n.state,view:""});l("skuidBuilderSave"),s.length>1&&a.updateReferenceCount()},onUnselect:function(e,t){var a=t+e.id;n.state.find('[id="'+a+'"]').remove(),i.publishStateEvent({type:"model.field.remove",fieldId:a,modelId:o}),l("skuidBuilderSave")},getUiOnlyFields:function(){return n.state.children('[uionly="true"]')},getFieldXML:function(e,t){var i=t+e.id;return n.state.children('[id="'+i+'"]')},showSelectedFilter:!0});u.render(),n.header.addClass("smb-modelfields-header"),e.events.subscribe("skuidBuilderAddField",function(e){r.attr("id")===e.closest("model").attr("id")&&u.render()})},propertiesRenderer:function(){},defaultStateGenerator:function(){return r("<fields/>")}},{id:"field",name:"Field",options:{makeDraggable:!1},mobileRenderer:function(e){var t=e.state,n=e.card;if(n){var a=t.attr("id"),o=i.getModelFieldComponentLabel(t)||a,r=t.attr("displaytype");n.fieldCardTitle.text(o),r&&n.fieldCardBody.text(r)}},propertiesRenderer:function(e,t){var n=t.state,o=n.attr("label")||n.attr("id"),r=i.getModelFieldProperties({component:t,propViewer:e});e.setTitle("Field: "+(o||"[Unspecified]")),a.each(r,function(e,t){if("Basic"===t.name)return t.expanded=!0,!1}),e.applyPropsWithCategories(r,n)},defaultStateGenerator:function(){return r("<field/>")},setSelectState:function(e){e.isSelected?(e.body.addClass("smb-fieldcard-inmodel"),e.fieldCardToggle.addClass("fa-times").removeClass("fa-check")):(e.body.removeClass("smb-fieldcard-inmodel"),e.fieldCardToggle.addClass("fa-check").removeClass("fa-times"))}},{id:"conditions",name:"Conditions",options:{makeDraggable:!1},mobileRenderer:function(o){var r=function(e){var t=o.element.prev().data("component").body,i=parseInt(o.body.data("vpercent"),10)+e,a=parseInt(t.data("vpercent"),10)-e;i<=100&&i>=0&&o.body.data("vpercent",""+i),a<=100&&a>=0&&t.data("vpercent",""+a),n.processResponsiveElements()};o.header.addClass("smb-modelconditions-header"),o.element.addClass("smb-modelconditions");var s=a("<div>").addClass("smb-component-titlebutton fa fa-fw fa-plus").on("tap",function(e){var a=i.getBuilder("condition").defaultStateGenerator();o.state.append(a),o.body.append(new t.Component(a).render().element),n.processResponsiveElements(),l("skuidBuilderSave"),e.stopPropagation()}),d=a("<div>").addClass("smb-component-titlebutton fa fa-fw fa-chevron-up").on("tap",function(e){r(50),e.stopPropagation()}),u=a("<div>").addClass("smb-component-titlebutton fa fa-fw fa-chevron-down").on("tap",function(e){r(-50),e.stopPropagation()});o.titleButtons.append(s,d,u),o.body.addClass("smb-modelconditions-body sm-grid nx-list-contents").data({minwidth:"320",precision:"10",layoutmode:"rigid",voffset:"158",vpercent:"50"}),o.state.children().each(function(){o.body.append(new t.Component(a(this)).render().element)}),e.responsive.prepareGrid(o.body,{layoutMode:"rigid",minWidth:"320",precision:"10"})},propertiesRenderer:function(e,t){e.applyPropsWithCategories(i.getConditionsBuilderProperties({component:t,propertiesViewer:e}),t.state,{mode:e.mode})},defaultStateGenerator:function(){return r("<conditions/>")}},{id:"condition",name:"Condition",options:{makeSiblingDropZone:!1,makeDraggable:!1},mobileRenderer:function(t){var n=t.state,a=n.closest("model").attr("sobject"),o=t.body.empty();t.isSubcondition=t.state.parent().parent().is("condition"),t.isSubcondition?t.bodycontent.text(i.getConditionDisplayString(n)):(t.element.css("margin-top","0px"),o.addClass("smb-conditioncard-body").css("border-width","0px").css("background-color","#eee"),t.header.addClass("smb-conditioncard-title"),t.setTitle(i.getConditionDisplayString(n)),o.append(i.conditionDescriptionRenderers.field(n,a)+" "+i.conditionDescriptionRenderers.operator(n)+" "+i.conditionDescriptionRenderers.value(n)+". "+i.conditionDescriptionRenderers.state(n)),t.element.addClass("sm-grid-division sm-card"),e.responsive.prepareDivision(t.element,{relativeSize:"1",minWidth:"320"}))},propertiesRenderer:function(e,n){n.isSubcondition||e.setTitle("Condition Properties");var o=n.state,r=o.closest("model").attr("id"),l=new t.PropertyList(o),s=i.getMetadataForField(n,{modelName:r}),d=["fieldvalue","multiple","param","userinfo","blank","modelmerge"];n.isSubcondition||d.push("join"),a.each(i.getConditionFieldProperties(n,{handleChange:function(){n.renderProperties(e)},modelName:r}),function(e,n){l.addItem(new t.PropertyItem(n))}),l.addItem(new t.PropertyItem(i.getConditionOperatorPropObj(n,{fieldMetadata:s})));var u=new t.PropertyList(o,{title:"Value",expanded:!0});a.each(i.getConditionValueProperties(n,{handleRefresh:function(){n.renderProperties(e)},modelName:r,validTypes:d}),function(){u.addItem(new t.PropertyItem(this))});var c=new t.MiniComponentList(o,{title:"Subconditions",childrenNodeName:"conditions",childNodeName:"condition",inactive:"join"!==o.attr("type")}),p=new t.PropertyList(o,{title:"State",expanded:!0});a.each(i.getConditionStateProperties(n,{handleRefresh:function(){n.renderProperties(e)}}),function(){p.addItem(new t.PropertyItem(this))});var h=new t.PropertyList(o,{title:"Remove"});h.addItem(new t.PropertyItem({type:"remove"})),e.addLists([l,u,c,p,h]),e.render()},defaultStateGenerator:function(){return r('<condition type="fieldvalue" value="" enclosevalueinquotes="true"/>')}},{id:"interaction",name:"Interaction",mobileRenderer:function(e){e.bodycontent.text(e.state.attr("type"))},propertiesRenderer:function(e,t){var o=t.state,r=[{name:"",props:[{id:"type",label:"Type",type:"picklist",options:a.map(n.config.validInteractions,function(e){return{value:e,label:e}}),onChange:function(){t.refresh()}}]},i.getActionsCategory({propViewer:e,linkedComponent:t})];e.applyPropsWithCategories(r,o)},defaultStateGenerator:function(){return r('<interaction type="tap"/>')}},{id:"mobileimage",name:"Image",mobileRenderer:function(e){var t=e.state.attr("uniqueid");e.setTitle(e.builder.name+(t&&"sk-"!==t.slice(0,3)?" - "+t:""))},propertiesRenderer:function(e,t){e.setTitle("Image Properties");var n=t.state,a=i.getImageProperties({component:t,propViewer:e}),o=t.currentImageSource,r=[{name:"Basic",props:a,expanded:!0},{name:"Advanced",props:[i.coreProps.uniqueIdProp({component:t,onChange:function(){t.refresh()}}),i.coreProps.cssClassProp()]},{name:"Styles",tree:i.getStandardStyleTree({component:t,standardStyleSections:["itemsize","border"]})},i.getRenderingCategory({component:t,model:n.attr("model"),propViewer:e})];o&&(o.needsRecordContext||o.optionalRecordContext)&&r.push(i.getContextCategory({propViewer:e,state:n,modelprop:"model"})),r.push({name:"Remove",props:[{type:"remove"}]}),e.applyPropsWithCategories(r,n)},defaultStateGenerator:function(){return r('<mobileimage uniqueid="'+o.generateUniqueId()+'" source="staticresource"/>')}},{id:"mobilewrapper",name:"Wrapper",mobileRenderer:function(e){var t=e.state.attr("uniqueid");e.setTitle(e.builder.name+(t&&"sk-"!==t.slice(0,3)?" - "+t:"")),e.renderChildren()},propertiesRenderer:function(e,n){e.setTitle("Wrapper Properties");var a=n.state;e.applyPropsWithCategories([{name:"",props:[i.coreProps.uniqueIdProp({component:n,onChange:function(){n.refresh()}}),i.coreProps.cssClassProp()]},t.makeAddComponentsCategory(),{tree:{title:"Card Interactions",childrenNodeName:"cardinteractions",childNodeName:"interaction"}},{tree:{title:"Styling",childrenNodeName:"styles",childNodeName:"styleitem"}},i.getRenderingCategory({component:n,model:a.closest("[model]").attr("model"),propViewer:e}),{name:"Remove",props:[{type:"remove"}]}],a)},defaultStateGenerator:function(){return r('<mobilewrapper uniqueid="'+o.generateUniqueId()+'"/>')}},{id:"styleitem",name:"Style",mobileRenderer:function(e){e.bodycontent.text((e.state.attr("property")||"[No Property]")+": "+(e.state.attr("value")||"[No Value]")+";")},propertiesRenderer:function(e,n){var i=new t.PropertyList(n.state);i.addItem(new t.PropertyItem({id:"property",label:"Property",onChange:function(){n.refresh()}})),i.addItem(new t.PropertyItem({id:"value",label:"Value",onChange:function(){n.refresh()}})),e.addList(i),e.render()},defaultStateGenerator:function(){return r("<styleitem/>")}},{id:"label",name:"Label",options:{allowSelection:!1,makeDraggable:!1},mobileRenderer:function(e){var n=function(){e.setTitle(e.state.attr("id")||"[No Label Id]")};n(),e.element.addClass("smb-model"),e.body.css("padding-bottom","10px");var o=new t.PropertyList(e.state),r={onChange:function(){n(),l("skuidBuilderRefreshLabelList")}},s=i.getLabelProperties(r);a.each(s,function(){o.addItem(new t.PropertyItem(this))}),o.render(),e.body.append(o.element)},propertiesRenderer:function(){},defaultStateGenerator:function(){return i.defaultStateGenerators.label()}},{id:"jsitem",name:"Javascript Item",options:{allowSelection:!1,makeDraggable:!1},mobileRenderer:function(o){o.setTitle("Javascript Item"),o.refresh=function(){return l("skuidBuilderRefreshJSItemList"),o},o.rebuildProps=function(){return t.Component.prototype.refresh.call(this),o},o.element.addClass("smb-model"),o.body.css("padding-bottom","10px");var r=new t.PropertyList(o.state),s=i.getJSItemProperties(o);a.each(s,function(){var n=new t.PropertyItem(this);n.element.addClass("sm-card sm-grid-division"),e.responsive.prepareDivision(n.element,{relativeSize:this.divisionSize?this.divisionSize:"1",minWidth:"400"}),r.addItem(n)}),r.render(),r.body.addClass("nx-list-contents sm-grid"),e.responsive.prepareGrid(r.body,{precision:"2",minWidth:"400"}),o.body.append(r.element),n.processResponsiveArea(o.body)},propertiesRenderer:function(){},defaultStateGenerator:function(){return i.defaultStateGenerators.jsitem()}},{id:"cssitem",name:"CSS Item",options:{allowSelection:!1,makeDraggable:!1},mobileRenderer:function(o){o.setTitle("CSS Item"),o.refresh=function(){return l("skuidBuilderRefreshCSSItemList"),o},o.rebuildProps=function(){return t.Component.prototype.refresh.call(this),o},o.element.addClass("smb-model"),o.body.css("padding-bottom","10px");var r=new t.PropertyList(o.state),s=i.getCSSItemProperties(o);a.each(s,function(){var n=new t.PropertyItem(this);n.element.addClass("sm-card sm-grid-division"),e.responsive.prepareDivision(n.element,{relativeSize:this.divisionSize?this.divisionSize:"1",minWidth:"400"}),r.addItem(n)}),r.render(),r.body.addClass("nx-list-contents sm-grid"),e.responsive.prepareGrid(r.body,{precision:"2",minWidth:"400"}),o.body.append(r.element),n.processResponsiveArea(o.body)},propertiesRenderer:function(){},defaultStateGenerator:function(){return i.defaultStateGenerators.cssitem()}},{id:"filter",name:"Filter",mobileRenderer:function(e){e.bodycontent.text("Filter")},propertiesRenderer:function(e,n){var i=new t.PropertyList(n.state);i.addItem(new t.PropertyItem({id:"test",label:"Test"})),e.addList(i),e.render()},defaultStateGenerator:function(){return r("<filter/>")}}])}(skuid)},360:function(e,t,n){"use strict";n(301),n(300),n(299),n(298),n(297),n(296),n(295),n(294),n(293),n(292),n(291),n(290),n(289),n(288),n(287),n(286),n(285),n(284),n(283),n(282),n(302),n(359),n(50)},50:function(e,t,n){"use strict";!function(e){var t=e.$,n=e.builder.core,i=e.utils,a=i.makeXMLDoc;function o(e){var t=e.state,n=l(t.attr("model"),t.attr("datasource")),i=!1;t.attr("displayas")||(t.attr("displayas","filename"),i=!0),!t.attr("storeas")&&n&&n.length&&(t.attr("storeas",n[0].value),i=!0),i&&e.save()}function r(e){return!!e.getUploadMethods}function l(i,a){var o=i&&n.getModelFromModelName(i),r=o?n.getDataSourceFromModel(o):e.dataSource.get(a||e.platform.getDefaultDataSourceName()),l=r&&r.getDataSourceType();return l&&l.getUploadMethods?t.map(l.getUploadMethods(),function(e,t){void 0===e.hasDescription&&(e.hasDescription=!0),void 0===e.hasParent&&(e.hasParent=!0),void 0===e.hasLabel&&(e.hasLabel=!0),void 0===e.hasName&&(e.hasName=!0);var n={label:e.label,value:t,forceStoreAsFileName:e.forceStoreAsFileName,needsFieldContext:e.needsFieldContext,needsRecordContext:e.needsRecordContext,canRunPostUploadSnippet:e.canRunPostUploadSnippet,needsModelInContext:e.needsModelInContext,hasDescription:e.hasDescription,hasName:e.hasName,hasLabel:e.hasLabel,hasParent:e.hasParent,builderProps:e.builderProps};return o?e.needsRecordContext||e.needsModelInContext?n:null:e.needsRecordContext?null:n}):[]}function s(e,t){var n=e.filter(function(e){return e.value===t});return n&&n.length?n[0]:null}var d=new n.Builder({id:"file",name:"File Upload",icon:"sk-bi-file",isJSCreateable:!0,description:function(){var t=e.version.number;return'The File component allows for viewing, uploading and removing files associated with an object.<br/><br/>More information: <ul><li><a href="https://docs.skuid.com/v'+t+'/en/skuid/components/file-upload/add-image.html" target="SkuidBuilderHelp">Using the File Component to Add an Image</a></li><li><a href="https://docs.skuid.com/v'+t+'/en/skuid/components/file-upload/attach-file.html" target="SkuidBuilderHelp">Attach Files to a Record</a></li></ul>For additional information, see the <a href="'+("https://docs.skuid.com/v"+t+"/en/skuid/components/file-upload/")+'">File Upload component tutorial</a>.'},handleStateEvent:function(e,t,i){n.handleModelRemove(e,t,{component:i}),n.handleModelIdChange(e,t)},componentRenderer:function(e){o(e),e.setTitle(e.builder.name);var n=t("<img>").prop("src",i.getDefaultImageUrl(e.state.attr("defaultimage")||"person")).css({width:"100%",maxWidth:"300px"});e.body.append(n),n.toggle("image"===e.state.attr("displayas")),e.body.css("overflow","hidden")},mobileRenderer:function(n){o(n);var a,r=n.body,l=n.state;n.setTitle(n.builder.name),"image"===l.attr("displayas")?a=t("<img>").prop("src",i.getDefaultImageUrl(l.attr("defaultimage")||"person")).css({width:"100%",maxWidth:"300px",margin:"8px 0px 0px"}):(a=t("<div>").addClass("sm-button").css("margin","8px 0px 4px"),new e.mobile.ui.Button({element:a,label:l.attr("label")||"Upload",icon:"fa-plus"})),r.empty().append(a)},propertiesRenderer:function(a,d){o(d);var u=d.state,c=u.attr("model"),p=u.attr("storeas"),h=l(c,u.attr("datasource")),f={id:"model",type:"model",label:"Parent Model",helptext:"The Model in whose record(s) this File will be stored, stored in the specified 'File storage location'.",required:!1,entryFilter:function(e){var t=l(e.attr("id"),e.attr("datasource"));return!(!t||!t.length)},onChange:function(e){var t=l(e,u.attr("datasource")),n=d.updateAutoCreatedEditorCondition;n&&n.call(d),u.removeAttr("idfield label defaultimage editable deleteable"),t&&t.length&&u.attr("storeas",t[0].value),u.attr("displayas","filename"),d.save().refresh().rebuildProps(a)}},m={id:"defaultimage",type:"picklist",label:"Default Image",defaultValue:"person",helptext:"A default image to display if an image has not been displayed yet.",picklistEntries:[{label:"Person",value:"person"},{label:"Org",value:"org"}],onChange:function(e){d.body.find("img").prop("src",i.getDefaultImageUrl(e))}},b={id:"label",type:"text",label:"Label",helptext:"The label for this File Component/field.",onChange:function(){d.refresh()}},v={id:"storeas",type:"picklist",label:"File storage location",defaultValue:"field",helptext:"The File Component allows you to store an uploaded file in the following ways: (1) In a field on this object that is a lookup to the Skuid Image object, e.g. Profile_Photo__c. This is useful when this particular File will need to be retrieved later, e.g. a Profile Photo or a Transcript.(2) As an Attachment to the record containing in this Model. This is useful for generic File Attachments that do not be referred to by their purpose.",picklistEntries:t.map(h,function(e){return e.hideInBuilder?null:e}),onChange:function(e){u.removeAttr("idfield label defaultimage editable deleteable");var t=s(l(u.attr("model"),u.attr("datasource")),e);t&&t.forceStoreAsFileName&&u.attr("displayas","filename"),d.save().refresh().rebuildProps(a)}},g={id:"displayas",type:"picklist",label:"Display As",defaultValue:"filename",helptext:"Once a File has been uploaded, should just the File's name be shown, or should a preview of the File / the image stored in the File be shown?",picklistEntries:[{label:"File Name",value:"filename"},{label:"File Preview/Image",value:"image"}],onChange:function(){d.refresh().rebuildProps(a)}},y=[{id:"saveto",type:"picklist",label:"Save To",defaultValue:"",picklistEntries:[{label:"Data Source",value:""},{label:"Field on Model",value:"field"}],onChange:function(){u.attr("model",""),d.rebuildProps(a)}}],C=s(h,p);u.attr("saveto")?y.push({id:"model",type:"model",label:"Model"},{id:"field",modelprop:"model",type:"field",label:"Field",displayTypeFilter:function(e){return["TEXT","STRING","TEXTAREA"].indexOf(e.displaytype)>-1}}):(C&&C.hasParent&&y.push(f),C&&C.hideInBuilder&&v.picklistEntries.push({label:C.label,value:C.label}),c||(y=y.concat(n.getDataSourceSelectionProps(d,a,{dataSourceTypeCriteria:r}))),v.picklistEntries.length<2&&(v.type="readonly"),y.push(v),C&&(C.needsFieldContext&&(e.mobile||y.push(g),y.push({id:"idfield",type:"field",addFieldToModel:!0,label:"Field Name",helptext:"The Skuid Image lookup field on this object that this File will be stored in.",modelprop:"model",displayTypeFilter:"REFERENCE",refFilter:"skuid__Image__c"})),C.hasLabel&&y.push(b),"image"===u.attr("displayas")&&y.push(m),C.needsFieldContext&&y.push({id:"editable",type:"boolean",label:"Allow Editing",defaultValue:!0,helptext:"If true, a yellow pencil icon will be shown when hovering over this File's preview, allowing users to upload a different File as a replacement."},{id:"deleteable",type:"boolean",label:"Allow Removal",defaultValue:!0,helptext:"If true, a red delete icon will be shown when hovering over this File's preview, allowing users to upload a different File as a replacement."}),C.hasName&&y.push({id:"filename",type:"text",label:"File Name",helptext:"If this is left blank, the filename will not change."}),C.hasDescription&&y.push({id:"description",type:"text",label:"File Description"}),C.canRunPostUploadSnippet&&y.push({id:"snippetname",type:"snippet",label:"Snippet to Run on Completion"}),C.builderProps&&("function"==typeof C.builderProps?y=y.concat(C.builderProps(d,u)):Array.prototype.push.apply(y,C.builderProps))));var w=[{name:"Basic",props:y,expanded:!0},{name:"On-Upload Actions",tree:[n.getActionsTree({customNodeId:"uploadsuccessactions",label:"On-Upload Success Actions",linkedComponent:d,actionsIndent:0,props:[{type:"helptext",html:"Success Actions will be run only when a File is successfully uploaded."}]}),n.getActionsTree({customNodeId:"uploadfailureactions",label:"On-Upload Failure Actions",linkedComponent:d,actionsIndent:0,props:[{type:"helptext",html:"Failure Actions will be run if a File fails to upload. The error message returned, if any, will be available for display using the merge {{$Error.Message}}"}]})]},n.getRenderingCategory({component:d,model:null,propViewer:a})];C&&C.needsRecordContext&&w.push(n.getContextCategory({propViewer:a,state:u,modelprop:"model"})),e.mobile&&w.push({name:"Remove",props:[{type:"remove"}]}),a.setTitle("File Properties"),a.applyPropsWithCategories(w,u)},defaultStateGenerator:function(){return a('<file editable="true" storeas="" displayas="" deleteable="true"/>')}});n.registerBuilder(d),e.builder.desktop&&n.registerBuilder(new n.Builder({id:"attachmentimage",name:"Attachment Image",hideFromComponentsList:!0,componentRenderer:d.componentRenderer,propertiesRenderer:d.propertiesRenderer}))}(skuid)}});