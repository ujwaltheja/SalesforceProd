!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=1775)}({1775:function(e,n,t){"use strict";var r=t(305);!function(e){var n=window.skuid.$,t=n.each,o=e.utils,i=o.makeXMLDoc,a=e.platform,u=e.constants.MIME_TYPES,c=e.pageSupport||(e.pageSupport={}),s=[u.ZIP],l=o.getLayoutFields(),f=a.getEntityFieldName("page","id"),p=a.getEntityFieldName("page","name"),d=a.getEntityFieldName("page","is_master_page"),m="skuid__Pages__r",g=[f,p,d].concat(l),y="> resources > javascript > jsitem",h="> resources > css > cssitem",v='[location="inline"], [location="inlinesnippet"], [location="inlinecomponent"]',_=' xmlns="http://soap.sforce.com/2006/04/metadata"',w='<?xml version="1.0" encoding="UTF-8"?><Package'+_+"><types>{{#.}}<members>{{name}}</members>{{/.}}<name>StaticResource</name></types><version>39.0</version></Package>",x='<?xml version="1.0" encoding="UTF-8"?><StaticResource'+_+"><cacheControl>{{cacheControl}}</cacheControl><contentType>{{contentType}}</contentType><description>{{description}}</description></StaticResource>";function P(e){return!!e&&s.indexOf(e)>=0}function k(e){return o.isFunction(e)?function(n,t){e({done:n,message:t})}:function(){}}function b(e,t){return function(){var r=n.Deferred(),o=Array.prototype.slice.call(arguments);return window.setTimeout(function(){var n=e.apply(t||window,o);r.resolve(n)}),r.promise()}}function j(e,t,r){return n.when.apply(n,e.reduce(function(e,n){var r=e[e.length-1];return r.length>=t&&e.push(r=[]),r.push(n),e},[[]]).map(r)).then(function(){return Array.prototype.slice.call(arguments)})}n.extend(c,{generateFiles:function(c,s){s||(s={});var _=s.progressCallback,F=k(_),E=s.relaxFieldChecks;if(!c)return n.Deferred().reject("Invalid Argument: Expecting an array of page objects").promise();n.isArray(c)||(c=[c]),F(!1,"Examining Pages... ");var I,T,S,A=c.filter(function(e){return e}).map(function(e){return e.row||e}),M=A.filter(function(e){return!0===e[d]}),O=M.filter(function(e){return e[f]&&!e[m]}).map(function(e){return e[f]}),C=A.filter(function(e){return E||g.every(function(n){return e.hasOwnProperty(n)})}),D=C.map(function(e){return e[f]}),N=Object.keys(A.filter(function(e){var n=C.indexOf(e)<0;return e[f]&&n}).map(function(e){return e[f]}).concat(M.filter(function(e){return e[m]}).reduce(function(e,t){var r=t[m].records;return n.isArray(r)?e.concat(r.filter(function(e){return e})):e},[]).map(function(e){return e[f]}).filter(function(e){return C.indexOf(e)<0})).reduce(function(e,n){return e[n]=1,e},{}));return 0===N.length&&0===O.length?I=n.when(C):(F(!1,"Querying for Additional Information..."),T=[],S=function(e,t){T[e]=t;var r,o=T.reduce(function(e,n){return e+n},0);r=o>=1048576?n.number(o/1048576,1)+" MB":o>=1024?n.number(o/1024,1)+" KB":n.number(o)+" bytes",F(!1,"Querying for Additional Information... ("+r+")")},I=j(O,200,function(e,t){return n.get({url:"/services/data/v39.0/query?q=SELECT Id, (SELECT Id FROM skuid__Pages__r) FROM skuid__Page__c WHERE Id IN ('"+e.join("','")+"')",headers:{Authorization:"Bearer "+o.userInfo.sessionId},xhr:function(){var e=n.ajaxSettings.xhr();return e.onprogress=function(e){var n=e.loaded;o.isNumber(n)&&S(t,n)},e}}).then(function(e){return e.records.reduce(function(e,n){return e.concat(n[m].records||[])},[]).map(function(e){return e[f]}).filter(function(e){return N.indexOf(e)<0&&D.indexOf(e)<0})})}).then(function(e){return e.reduce(function(e,n){return e.concat(n)},[])}).then(function(e){return j(N.concat(e),200,function(e,t){return n.get({url:"/services/data/v39.0/query?q=SELECT "+g.join(",")+",skuid__MasterPage__r."+g.join(",skuid__MasterPage__r.")+" FROM skuid__Page__c WHERE Id IN ('"+e.join("','")+"')",headers:{Authorization:"Bearer "+o.userInfo.sessionId},xhr:function(){var e=n.ajaxSettings.xhr();return e.onprogress=function(e){var n=e.loaded;o.isNumber(n)&&S(t,n)},e}}).then(function(e){return e.records})})}).then(function(e){return C=C.concat(e.reduce(function(e,n){return e.concat(n)},[]))})),I.then(function(c){F(!1,"Processing Additional Information...");var s={};return n.when.apply(n,c.map(b(function(e){var o,a,c,d,m,g,_=e[f],w=e[p],x=function(e){return function(n,t){return n+(e[t]?e[t]:"")}},P=e.skuid__MasterPage__r&&l.reduce(x(e.skuid__MasterPage__r),"")||"",k=l.reduce(x(e),""),b=[],j=[];F(!1,"Processing "+w);try{o=P.length>0&&n(y,i(P)),c=n(y,i(k)),a=P.length>0&&n(h,i(P)),d=n(h,i(k))}catch(e){return s}return g=(o&&o.filter(v).toArray()||[]).concat(c.filter(v).toArray()),t(g,function(e,t){var r=(t=n(t)).attr("location"),o=t.text().trim();"inline"==r?o&&b.push(o+";\n"):"inlinesnippet"==r?o&&b.push("skuid.snippet.register('"+t.attr("name")+"',function(args) {"+o+"\n});\n"):"inlinecomponent"==r&&o&&b.push("skuid.componentType.register('"+t.attr("name")+"',function(elem) {"+o+"\n});\n")}),m=(a&&a.filter(v).toArray()||[]).concat(d.filter(v).toArray()),t(m,function(e,t){var r=(t=n(t)).attr("location"),o=t.text().trim();"inline"==r&&o&&j.push(o+"\n")}),0===b.length&&0===j.length?s:(b.splice(0,0,"(function(skuid){\n"),b.push("}(window.skuid));"),{name:(0,r.getFileNameForPage)(e),description:"Skuid Support File for "+w+" ("+_+")",content:[{name:"inlineresources.js",content:b.join("")},{name:"inlineresources.css",content:j.join("")}],contentType:u.ZIP})}))).then(function(){var r=Array.prototype.slice.call(arguments).filter(function(e){return e!==s});return 0===r.length?[]:function(r,i){if(!r||0===r.length)return n.when([]).promise();var c=k(i);return o.loadJS(a.getResourceUrl({name:"lib/jSZip.js",namespace:"skuid",modstamp:e.version.date})).then(function(){var i=(new window.JSZip).folder("src"),a=i.folder("staticresources"),s=function(n,t){return e.Mustache.render(n,t)},l=s(w,r);i.file("package.xml",l),c(!1,"Building Deployment... ");var f=1;return n.when.apply(n,r.map(b(function(e){c(!1,"Building Deployment... ("+f+++"/"+r.length+")");var i,a,l=e.name,p=e.contentType,d=e.content;return e.description&&(e.description=o.encodeHTML(e.description)),a=s(x,n.extend({cacheControl:"private",contentType:"text/javascript"},e)),p==u.ZIP&&n.isArray(d)&&(i=new window.JSZip,t(d,function(e,n){i.file(n.name,n.content,{base64:P(n.contentType)})}),d=i.generate({type:"base64",compression:"DEFLATE"})),{name:l,metaXML:a,content:d,isBase64:P(p)}}))).then(function(){var e=Array.prototype.slice.call(arguments);return t(e,function(e,n){var t=n.name;a.file(t+".resource",n.content,{base64:n.isBase64}),a.file(t+".resource-meta.xml",n.metaXML)}),c(!1,"Building Deployment... Compressing"),i.generate({type:"base64",compression:"DEFLATE"})})})}(r,_).then(function(t){return function(t,r){var i=k(r),u=function(e){i(!0,e),c.reject(e)},c=n.Deferred();return o.loadJS(a.getResourceUrl({name:"lib/jSForce.js",namespace:"skuid",modstamp:e.version.date})).then(function(){var e,n=new window.jsforce.Connection({sessionId:o.userInfo.sessionId});return n.metadata.pollTimeout=1e3,n.metadata.pollTimeout=3e4,i(!1,"Sending Deployment..."),n.metadata.deploy(t,{rollbackOnError:!0},function(n,t){if(!e){if(n)return u(n);i(t.done,"Processing Deployment... "+t.state),e=t.id,r()}});function r(){n.metadata.checkDeployStatus(e,!0,function(e,n){if(e)return u(e);i(n.done,"Processing Deployment... "+(n.state||n.status)+("InProgress"===n.status?" (t: "+n.numberComponentsTotal+", d: "+n.numberComponentsDeployed+", e: "+n.numberComponentErrors+")":"")),n.done?c.resolve(n):window.setTimeout(r,500)})}}),c.promise()}(t,_)})})})},getFileNameForPage:r.getFileNameForPage})}(window.skuid)},305:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getFileNameForPage=function(e,n){var t=window.skuid.platform.getEntityFieldName,r=t("page","id"),o=t("page","name"),i=void 0;arguments.length>1?i=e:(i=e[r],n=e[o]);return("skuid_pgsp_"+i+"_"+n).replace(/[^a-zA-Z0-9_]/g,"_").replace(/_+/g,"_").slice(0,50).replace(/_$/,"")}}});