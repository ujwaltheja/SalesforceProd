!function(e){var t={};function a(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},a.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=355)}({353:function(e,t,a){"use strict";!function(e){var t=e.$,a=e.builder.core,r=e.utils,i=r.makeXMLDoc,l=e.$L,n=e.visualizations,o=n.core,s=n.map,d=s.defaultSettings;a.registerBuilder(new a.Builder({id:"skuidvis__geochart",name:"Geochart",icon:"sk-icon-world",isJSCreateable:!0,givesMultipleContextRows:!0,supportsMultipleContextRows:!0,actionTypes:{series:function(e){var t=o.getSeriesActions(e,{indent:3}),a=e.mapMetadata;return a&&a.drillDownMap&&t.push({value:"mapDrillIn",label:"Map Drill In",props:[{type:"helptext",html:'Also known as "Classic" Drilldown for Geocharts, this will load the next level down map for this Geochart'}]}),t}},description:function(){return'A thematic / choropleth map, in which regions such as country, state / province, county, etc. are shaded in proportion to an aggregate data value for each region.<br><br>For more information, see the <a href="'+("https://docs.skuid.com/v"+e.version.number+"/en/skuid/components/visualizations/geochart/")+'">Geochart component tutorial</a>.'},propertiesRenderer:function(r,l){r.setHeaderText("Geochart Properties");var n=l.state,d=n.attr("maptype");if(void 0===n.attr("mapgroup")){var c=s.types[d]&&s.types[d].group;a.updateState(n,{key:"mapgroup",value:c||"global"})}var p=[{name:"Basic",props:[{id:"maintitle",type:"string",location:"attribute",label:"Title",onChange:function(){l.refresh()}},{id:"subtitle",type:"string",location:"attribute",label:"Subtitle",onChange:function(){l.refresh()}},{id:"model",type:"model",label:"Model",required:!0},{id:"mapgroup",type:"picklist",label:"Map Group",defaultValue:"global",picklistEntries:[{value:"global",label:"Global"},{value:"af",label:"Africa"},{value:"as",label:"Asia"},{value:"eu",label:"Europe"},{value:"na",label:"North America"},{value:"oc",label:"Oceania"},{value:"sa",label:"South America"},{value:"canada",label:"Canadian Provinces"},{value:"usa",label:"USA States"}],onChange:function(){l.rebuildProps(r)}},{id:"maptype",type:"picklist",label:"Map Type",picklistEntries:t.map(s.types,function(e,a){if(-1!==t.inArray(n.attr("mapgroup"),e.groups))return{value:a,label:e.title}}).sort(function(e,t){return e.label>t.label?1:e.label<t.label?-1:0}),onChange:function(){l.refresh()}}],expanded:!0},{name:"Series",tree:function(e){e||(e={});var r=e.propViewer,l=e.component;return[{id:"serieslist",label:"Series List",deleteable:!1,icon:"sk-bi-renderconditions",isChild:!0,linkedComponent:l,props:[{type:"helptext",html:"Define one or more data series for this map"}],children:[{id:"series",indent:1,labelFunction:function(e){var t="",a=e.attr("modelId"),r=e.attr("valueField"),i=e.attr("splitField"),l=e.attr("aggFunction");return l&&(t+=o.AGG_FUNCTIONS[l].label+" "),r&&(t+=r),a&&(t+=" ("+a+")"),i&&(t+=" by "+i),t||"Series"},defaultStateFunction:function(){return i('<series joinBy="hc-key"/>')},childrenFunction:function(e){return o.getSeriesOnClickActionsTree({seriesComponent:e,component:l,seriesObj:this})},propsFunction:function(e){var a,i,n=e.state,d=s.types[l.state.attr("maptype")],c=n.attr("modelId")||l.state.attr("model"),p=o.getModelFieldsOptions(c),u=t.merge([{label:"-- None --",value:""}],p),h=t.merge([{label:"-- None --",value:""}],t.map(o.AGG_FUNCTIONS,function(e){return e})),f=function(t){var a={id:t.id,type:"picklist",label:t.label,picklistEntries:t.entries,onChange:function(){e.refresh()}};return t.helptext&&(a.helptext=t.helptext),a},b={id:"modelId",type:"model",label:"Model",noneOption:{label:"-- Default --",value:""},onChange:function(){e.refresh(),e.rebuildProps&&e.rebuildProps(),e.renderProperties&&e.renderProperties(r)}},g=(i={id:(a={id:"aggFunction",label:"Aggregate Function",entries:h}).id,type:"picklist",label:a.label,picklistEntries:a.entries,onChange:function(){e.refresh()}},a.helptext&&(i.helptext=a.helptext),i),m=f({id:"valueField",label:"Data Field",entries:p}),y=[];if(y.push(b,g,m),d.features&&d.features.length){var v={country:"The default maps in Geocharts require 2-digit ISO-3166 codes to connect your data to the maps. Country Field data that does not match this format will not be displayed.",state:"The default maps in Geocharts require 2-digit ISO-3166 codes to connect your data to the maps. State Field data that does not match this format will not be displayed."};t.each(d.features,function(){var e=f({id:this.id+"field",label:this.label+" Field"+(this.defaultValue?" ("+this.defaultValue+")":""),entries:!0===this.required?p:u});this.helptext?e.helptext=this.helptext:void 0!==v[this.id]&&(e.helptext=v[this.id]),y.push(e)})}else y.push({id:"mergeKey",type:"template",location:"attribute",displayAs:"input",label:"Merge Key"});return y}}]},{id:"buckets",label:"Buckets",deleteable:!1,icon:"sk-bi-conditions",isChild:!0,linkedComponent:l,props:[{type:"helptext",html:'Options for sorting series data into buckets (e.g. "Low" is values  < 10, "Medium" is values 10 to 20...)'}],children:[{id:"bucket",indent:1,summaryFunction:function(e){var a=t("<span>").text("Bucket"),r=e.attr("label"),i=e.attr("from"),l=e.attr("to"),n=e.attr("color");return r?a.html(r):l&&!i?a.html("< "+l):l&&i?a.html(i+" - "+l):!l&&i&&a.html("> "+i),n&&a.prepend(o.getColorPreview(n)),a},defaultStateFunction:function(){return i("<bucket/>")},propsFunction:function(e){var t=function(t){var a={id:t.id,label:t.label,type:"string",location:"attribute",onChange:function(){e.refresh(),l.refresh()}};return t.validator&&(a.validator=t.validator),a},r=[];return r.push(t({id:"label",label:"Label"}),t({id:"from",label:"From",validator:a.validators.numericOnly}),t({id:"to",label:"To",validator:a.validators.numericOnly}),t({id:"color",label:"Color"})),r}}]}]}({component:l,propViewer:r})},{name:"Styling",tree:function(e){var r=[{value:"",label:"-- Map Default --"},{value:"sk-data-value",label:"Data Value"},{value:"sk-off",label:"Off"}];return[{label:"Colors",deleteable:!1,linkedComponent:e,summaryFunction:function(a){var r=t("<div>").css({position:"relative"}),i=t("<div>").text("Map Default"),l=o.buildColorGenerator(e,{colorCount:7,variance:"0"}),n=a.children("colors");return n&&(i.empty(),t.each(n.children("value"),function(){var e=t(this).html();i.append(t("<div>").css({"background-color":e,height:"15px",width:"8px","margin-right":"2px",display:"inline-block"}))})),r.append(i,l),r},propsFunction:function(t){var a=[];return a.push({id:"backgroundcolor",type:"color",placeholder:"default",label:"Background Color",onChange:function(){e.refresh()}},{id:"hovercolor",type:"color",placeholder:"default",label:"Hover Color",helptext:"Optional, color to display when mousing over a map area",onChange:function(){e.refresh()}},{id:"nullcolor",type:"color",placeholder:"default",label:"Null Color",helptext:"Optional, color to display in map areas where this no data",onChange:function(){e.refresh()}},{id:"backbuttonbgcolor",type:"color",placeholder:"default",label:"Back Button Background",helptext:'Optional, specify the background color of the "Back" button when drilled down/in',defaultValue:""},{id:"backbuttontextcolor",type:"color",placeholder:"default",label:"Back Button Color",helptext:'Optional, specify the color of the text of the "Back" button when drilled down/in',defaultValue:""},{label:"Chart Colors",helptext:"Choose one or more colors to be used for this chart. When all colors are used, new colors are pulled from the start again.",id:"colors",location:"node",type:"multiitem",storeAs:{type:"node",name:"value"},onChange:function(){t.refresh(),e.refresh()}}),a}},o.getHeightTree({component:e,defaultSummary:"-- Geochart Default --",label:"Height"}),o.getLegendTree({component:e,defaultSummary:"-- Geochart Default --",defaultState:"<legend/>"}),{id:"regions",label:"Regions",deleteable:!1,linkedComponent:e,summaryFunction:function(e){var a=t("<span>").text("-- Geochart Default --"),r="",i=e.attr("rbcolor"),l=e.attr("rbwidth"),n=e.attr("rbstyle");return l&&(r=l),n&&(""!==r&&(r+=" | "),r+=n),""!==r&&a.html(r),i&&a.prepend(o.getColorPreview(i)),a},propsFunction:function(t){var r=function(){e.refresh(),t.refresh()};return[{type:"helptext",html:"Options for styling borders between regions on the Geochart"},{id:"rbstyle",type:"picklist",label:"Style",picklistEntries:[{value:"",label:"-- Geochart Default --"},{value:"Solid",label:"Solid"},{label:"ShortDash"},{label:"ShortDot"},{label:"ShortDashDot"},{label:"ShortDashDotDot"},{value:"Dot",label:"Dot"},{label:"Dash"},{label:"LongDash"},{label:"DashDot"},{label:"LongDashDot"},{label:"LongDashDotDot"}],onChange:function(e){r()}},{id:"rbwidth",label:"Width",type:"string",placeholder:"default",validator:a.validators.numericOnly,onChange:function(e){r()}},{id:"rbcolor",label:"Color",type:"color",placeholder:"default",onChange:function(e){r()}}]}},{id:"labels",label:"Labels",deleteable:!1,linkedComponent:e,summaryFunction:function(a){var i=s.types[e.state.attr("maptype")],l=t("<div>").text("Map Default"),n="",d=a.attr("dlformat"),c=a.attr("dlcolor"),p=a.attr("dlstrokecolor"),u=a.attr("dlstrokewidth");if(d){var h=r.concat(i.labelFormats||[]),f=t.grep(h,function(e){return e.value===d});n+=f.length&&f[0].label||d}if(""!==n&&l.text(n),c||u||p){var b=o.getColorPreview(c||"white").css({border:"3px solid rgba(0,0,0,0.5)"});p&&b.css({"border-color":p}),l.prepend(b)}return l},propsFunction:function(t){var i=[],l=s.types[e.state.attr("maptype")],n=function(){e.refresh(),t.refresh()},o={id:"dlformat",label:"Format",type:"picklist",defaultValue:"",picklistEntries:r,onChange:function(e){n()}},d={id:"dlcolor",label:"Text Color",type:"color",defaultValue:"",placeholder:"default",onChange:function(e){n()}},c={id:"dlbold",label:"Bold Labels",type:"boolean",onChange:function(e){n()}},p={id:"dlstrokecolor",label:"Stroke Color",placeholder:"default",helptext:'Color and alpha of the outline around data labels (e.g. "rgba(0,0,0,0.5)")',type:"color",onChange:function(e){n()}},u={id:"dlstrokewidth",label:"Stroke Width (in pixels)",placeholder:"default",validator:a.validators.numericOnly,helptext:'Width of the outline around data labels in pixels (e.g. "3")',type:"string",onChange:function(e){n()}};return l.labelFormats&&l.labelFormats.length&&(o.picklistEntries=r.concat([{label:"",value:"",disabled:!0},{label:"Additional Formats",value:"",disabled:!0}],l.labelFormats)),i.push(o),"sk-off"!=e.state.attr("dlformat")&&i.push(d,c,p,u),i}}]}(l)},o.getAdvancedProps({component:l}),a.getRenderingCategory({component:l,propViewer:r})];if(e.mobile){if(void 0===l.chartSet){var u=o.getMobileActionsList(l)||[];u.length>0&&p.push({name:"Actions",props:u})}p.push({name:"Remove",props:[{type:"remove"}]})}r.applyPropsWithCategories(p,n)},componentRenderer:function(a){a.setTitle(a.builder.name),a.givesMultipleContextRows=!0;var i=a.state,n=a.chartSet,c=t("<div>").addClass("sk-chart-wrapper"),p=t("<div>").addClass("sk-chart-container").appendTo(c),u=t.Deferred(),h=a.mapMetadata=s.types[i.attr("maptype")||Object.keys(s.types)[0]],f={backgroundColor:i.attr("backgroundcolor")||d.BACKGROUND_COLOR,nullColor:i.attr("nullcolor")||d.NULL_COLOR,hoverColor:i.attr("hovercolor"),colors:o.getColorsArray(i.children("colors").first()),legend:i.children("legend").first(),regions:{color:i.attr("rbcolor"),width:i.attr("rbwidth")||d.REGION_WIDTH,style:i.attr("rbstyle")},labels:{format:i.attr("dlformat"),color:i.attr("dlcolor")||d.LABEL_COLOR,bold:"true"===i.attr("dlbold"),strokeColor:i.attr("dlstrokecolor"),strokeWidth:i.attr("dlstrokewidth")||d.STROKE_WIDTH}},b=i.find("buckets:first > bucket"),g={title:{text:i.attr("maintitle")||"My Map"},subtitle:{text:i.attr("subtitle")||"Subtitle"},credits:{enabled:!1},colorAxis:{min:0},plotOptions:{map:{dataLabels:{enabled:!0,formatter:function(){return this.point.name}},animation:!1}}};if(c.css({height:i.attr("height")||"400px",position:"relative"}),p.css({height:"100%",width:"100%",position:"absolute"}),a.mapWrapper=c,a.container=p,a.mapObj=g,"off"===i.attr("export")&&(g.exporting={enabled:!1}),f.backgroundColor&&(g.chart||(g.chart={}),g.chart.backgroundColor=f.backgroundColor),f.nullColor&&(g.plotOptions.map.nullColor=f.nullColor),f.hoverColor&&(g.plotOptions.map.states={hover:{color:f.hoverColor}}),f.colors.length>1&&f.colors[0]&&f.colors[f.colors.length-1]){var m=f.colors;t.extend(g.colorAxis,{minColor:m[0],maxColor:m[m.length-1]})}if(s.methods.formatRegions(g,f.regions),(f.labels.format||f.labels.color||f.labels.strokeColor||f.labels.strokeWidth)&&s.methods.formatDataLabels(g,f.labels),b.length>0){var y=[];t.each(b,function(){var e=t(this),a={},r=e.attr("to"),i=e.attr("from"),l=e.attr("label"),n=e.attr("color");r&&(a.to=r),i&&(a.from=i),l&&(a.name=l),n&&(a.color=n),y.push(a)}),t.extend(g.colorAxis,{dataClasses:y})}if(f.legend.length){var v=o.parseNodetoObj(f.legend);s.methods.formatLegend(g,v)}r.getJSONBodyOfZIPResourceFile("GeochartMaps","skuid",h.mapfile).done(function(e){u.resolve(e)}).fail(function(e){u.reject(e)}),u.done(function(e){var r=[],i=-1;t.each(e.features,function(){if(-1===i)return i++,!0;r.push({"hc-key":this.properties["hc-key"],value:i++}),7===i&&(i=-1)}),g.series=[{data:r,mapData:e,joinBy:"hc-key"},{name:"Separators",type:"mapline",data:Highcharts.geojson(e,"mapline"),color:"silver",showInLegend:!1,enableMouseTracking:!1}],function(e){var t=e.container;t.highcharts()&&t.highcharts().destroy(),t.highcharts("Map",e.mapObj)}(a)}),e.mobile||(void 0===n?o.addDrilldownActionGroup(a):a.addActionItem({text:l("remove"),icon:"sk-icon-delete",action:function(){n.removeChart(a)},id:"removeButton"})),a.reflow=function(){var e=a.container,t=e.highcharts();t&&t.chartWidth!==e.width()&&e.is(":visible")&&t.reflow()}},afterAttach:function(t){t.body.append(t.mapWrapper),e.utils.addResizeHandler(t.reflow,100),r.delayEventCallback({eventType:"tabshow pageload dialogopen stepchange",delay:20,callback:t.reflow}),e.events.subscribe(["ui.reflow","skuid.chart.reflow"],function(e){e&&e.length&&e[0].component!==t||t.reflow()})},defaultStateGenerator:function(){var e,t=a.getLastSelectedModelComponent(),r=t?t.state:a.getFirstModel(),l=r?r.attr("id"):null;for(var n in s.types){e=n;break}return i("<"+this.id+' model="'+l+'" maintitle="{{Model.labelPlural}}" maptype="'+e+'" height="600px" />').append(i("<colors/>"),i("<legend/>"))}}))}(skuid)},354:function(e,t,a){"use strict";!function(e){var t=e.$,a=e.builder,r=a.core,i=a.mobile,l=e.utils,n=l.makeXMLDoc,o=e.$L,s=e.events.publish,d=!1,c=e.visualizations,p=c.core,u=c.chart,h={line:{options:[u.types.line,u.types.spline,u.types.area,u.types.areaspline,u.types.column,u.types.bar],previewExtras:{xAxis:{categories:["Category A","Category B","Category C"]},yAxis:{},series:[{name:"Series 1",data:[7,6.9,9.5]},{name:"Series 2",data:[-.2,.8,5.7]}]}},pie:{options:[u.types.pie,u.types.donut,u.types.funnel,u.types.pyramid],previewExtras:{series:[{name:"Series 1",data:[["Segment A",7],["Segment B",6.9],["Segment C",9.5]]}]}},scatter:{options:[u.types.scatter,u.types.bubble]}},f={line:h.line.previewExtras,spline:h.line.previewExtras,area:h.line.previewExtras,areaspline:h.line.previewExtras,column:h.line.previewExtras,bar:h.line.previewExtras,pie:h.pie.previewExtras,donut:{series:[{name:"Series 1",innerSize:"70%",data:[["Segment A",7],["Segment B",6.9],["Segment C",9.5]]}]},funnel:{plotOptions:{series:{neckWidth:"30%",neckHeight:"25%"}},series:[{name:"Series 1",data:[["Segment A",7],["Segment B",6.9],["Segment C",9.5]]}]},pyramid:h.pie.previewExtras,bubble:{series:[{name:"Series 1",data:[[97,36,79],[94,74,60],[68,76,58],[64,87,56],[68,27,73],[74,99,42],[7,93,87],[51,69,40],[38,23,33],[57,86,31]]},{name:"Series 2",data:[[25,10,87],[2,75,59],[11,54,8],[86,55,93],[5,3,58],[90,63,44],[91,33,17],[97,3,56],[15,67,48],[54,25,81]]}]},scatter:{series:[{name:"Series 1",data:[[97,36],[94,74],[68,76],[64,87],[68,27],[74,99],[7,93],[51,69],[38,23],[57,86]]},{name:"Series 2",data:[[25,10],[2,75],[11,54],[86,55],[5,3],[90,63],[91,33],[97,3],[15,67],[54,25]]}]}},b=function(e){var t={id:e.id,label:e.title||"Title",type:"template",location:"attribute",displayAs:"input"};return e.onChange&&(t.onChange=e.onChange),e.helptext&&(t.helptext=e.helptext),e.modelName&&(t.modelName=e.modelName),t},g=function(e,t,a){var i=r.validators.uniqueAttribute(e,t,{description:"Axis",attributeDescription:"ID",nodeList:a.state.find("axis")});return!0===i?r.validators.alphaNumericUnder(e,{description:"Axis IDs"}):i},m=function(e){e||(e={});var a=e.component;return{id:"serieslist",label:"Series List",deleteable:!1,icon:"sk-bi-renderconditions",isChild:!0,linkedComponent:a,props:[{type:"helptext",html:"Define one or more data series for this chart"}],children:[{id:"series",indent:0,linkedComponent:a,labelFunction:function(e){var t="",a=e.attr("modelId"),r=e.attr("aggfunction"),i=e.attr("valuefield"),l=e.attr("xvaluefield"),n=e.attr("yvaluefield"),o=e.attr("sizefield"),s=e.attr("splittype"),d=e.attr("splitfield"),c=e.attr("splittemplate");return"template"===s&&c?c:(r&&(t+=p.AGG_FUNCTIONS[r].label+" "),i&&(t+=i),l&&(t+=l),n&&(t+=", "+n),o&&(t+=", "+o),a&&(t+=" ("+a+")"),"field"===s&&d&&(t+=" by "+d),t||"Series")},defaultStateFunction:function(){return n("<series/>")},childrenFunction:function(e){return p.getSeriesOnClickActionsTree({seriesComponent:e,component:a,seriesObj:this})},propsFunction:function(e){return function(e){var a=e.seriesComponent,r=e.component,i=a.state,l=r.state,n=l.attr("type"),o=i.attr("modelId")||l.attr("model"),s=p.getModelFieldsOptions(o),d=u.types[n].metadata,c=[{label:"-- Chart default --",value:""}],f=t.merge([{label:"-- Chart default --",value:""}],s),g=t.map(p.AGG_FUNCTIONS,function(e){return e}),m=t.merge([{label:"-- None --",value:""}],g),y=l.children("dataaxes"),v=l.children("categoryaxes"),C=function(e){var t={id:e.id,type:"picklist",label:e.label,picklistEntries:e.entries,onChange:function(){a.refresh()}};return e.helptext&&(t.helptext=e.helptext),t},x=function(e){var t={id:e.id,type:"picklist",label:e.label,picklistEntries:e.entries,onChange:function(){a.refresh()}};return e.helptext&&(t.helptext=e.helptext),t},k={id:"modelId",type:"model",label:"Model",noneOption:{label:"-- Chart default --",value:""},onChange:function(){a.refresh().rebuildProps()}},w={id:"splittype",label:"Split Type",type:"picklist",defaultValue:"none",picklistEntries:[{label:"None",value:"none"},{label:"Field",value:"field"},{label:"Template",value:"template"}],onChange:function(){a.refresh().rebuildProps()}},S={id:"splitfield",type:"picklist",label:"Split Field",helptext:"Optionally split this series into multiple series by a model field",picklistEntries:s,onChange:function(){a.refresh()}},A=b({id:"splittemplate",title:"Split Template",helptext:"Optional template, allows for custom names for chart Series and for splitting data into multiple series",onChange:function(){a.refresh()},modelName:o}),D=C({id:"aggfunction",label:"Aggregate Function",entries:m}),F=x({id:"valuefield",label:"Data Field",entries:s}),O={id:"categoryField",type:"picklist",label:"Category Field",picklistEntries:f,onChange:function(){a.refresh().rebuildProps()}},I=C({id:"xaggfunction",label:"X Aggregate Function",entries:m}),T=x({id:"xvaluefield",label:"X Data Field",entries:s}),E=C({id:"yaggfunction",label:"Y Aggregate Function",entries:m}),M=x({id:"yvaluefield",label:"Y Data Field",entries:s}),B=C({id:"sizeaggfunction",label:"Size Aggregate Function",entries:m}),G=x({id:"sizefield",label:"Size Field",entries:s});t.each(h[u.types[n].category].options,function(){c.push(this)});var L,P,_=[],N={id:"type",type:"picklist",label:"Type",picklistEntries:c,onChange:function(){a.refresh()}},R={line:[D,F,w],pie:[D,F,w],scatter:[w]},V=function(e,a){var r=e.children("axis"),i=[];return t.each(r,function(){var e=t(this),r=e.attr("id"),l=e.attr("title")||r;a.type&&a.type!==e.attr("type")||i.push({value:r,label:l})}),i.length>1&&{id:a.id,type:"picklist",label:a.label,picklistEntries:i}};if(!0===d.hasMultiAxis)if(!0===d.hasXY)L=V(y,{id:"xAxisId",label:"X Data Axis",type:"xaxis"}),P=V(y,{id:"yAxisId",label:"Y Data Axis",type:"yaxis"});else{var W=V(y,{id:"dataAxisId",label:"Data Axis"});W&&_.push(W)}if(_.push(k),!0===d.hasCategories){var j=V(v,{id:"categoryAxisId",label:"Category Axis"});j&&_.push(j),i.attr("modelId")&&_.push(O)}_=_.concat(R[n]||R[u.types[n].category]);var U=i.attr("splittype");return"field"===U?_.push(S):"template"===U&&_.push(A),!0===d.hasXY&&(L&&_.push(L),_.push(I),_.push(T),P&&_.push(P),_.push(E),_.push(M)),!0===d.hasSize&&(_.push(B),_.push(G)),_.push(N),_}({component:a,seriesComponent:e})}}]}},y=function(e,a){var r=u.types[a.chart.type];e.highcharts()&&e.highcharts().destroy(),a.chart.type=r.hcType||a.chart.type,(a.legend&&!0===a.legend.showLabels||!1===a.legend.showLabels)&&(a.plotOptions||(a.plotOptions={}),a.plotOptions[a.chart.type]||(a.plotOptions[a.chart.type]={}),a.plotOptions[a.chart.type].dataLabels={enabled:a.legend.showLabels}),r.additionalProps&&r.additionalProps(a),t.extend(a.chart,{reflow:!1}),e.highcharts(a)};r.registerBuilder(new r.Builder({id:"skuidvis__chartset",name:"Chart Set",icon:"sk-bi-fields-agg",isJSCreateable:!0,hideFromComponentsList:!0,description:"A collection of related Charts",propertiesRenderer:function(t,a){var l=this,n=a.state,o=n.children("charts").first(),s=[];if(t.setHeaderText(l.name+" Properties"),e.mobile){var d=[],c=function(e,t){return new i.PropertyItem({type:"customaction",label:e,customAction:function(){var e,i=r.getBuilder(t).getDefaultState(void 0,{setUniqueId:!0});o.append(i),a.save(),e=a.addChart(i),l.selectChart(e)}})};d.push(c("Add Drilldown Chart","skuidvis__chart"),c("Add Drilldown Geochart","skuidvis__geochart")),d.length>0&&s.push({name:"Actions",props:d,expanded:!0}),s.push({name:"Remove",props:[{type:"remove"}]})}t.applyPropsWithCategories(s,n)},componentRenderer:function(a){var i=this,l=a.state,n=a.chartsNode=l.children("charts").first();if(a.setTitle(i.name),t.extend(a,{charts:[],chartsMap:{},chartsNav:t("<ul>").addClass("sk-charts-nav"),chartPreview:t("<div>").addClass("sk-chart-preview")}),i.buildChartSetNav(a),a.body.append(a.chartsNav,a.chartPreview),a.addChart=function(e){return i.addChart(a,e)},a.getChartByID=function(e){return i.getChartByID(a,e)},a.selectChartByIndex=function(e){return i.selectChartByIndex(a,e)},a.removeChart=function(e){return i.removeChart(a,e)},!e.mobile){var o=function(e,t,l){return{text:e,icon:t,action:function(){var e,t=r.getBuilder(l).getDefaultState(void 0,{setUniqueId:!0});n.append(t),a.save(),e=a.addChart(t),i.selectChart(e),e.reflow()}}};a.addActionGroup([o("Chart","sk-bi-fields-agg","skuidvis__chart"),o("Geochart","sk-icon-world","skuidvis__geochart")],"Add Drilldown","sk-icon-add")}},handleStateEvent:function(e,t,a){var r=!1,i=t.type,l=t.chartSet;if("chartset.chart.remove"===i&&a===l){var n=t.chartID,o=e.find('action[type="drilldown"][chartid="'+n+'"]');o.length&&(r=!0,o.remove())}!0===r&&a.save()},buildChartSetNav:function(e){var a=this,r=e.state.children("charts").first();r.length&&(r.children().each(function(){a.addChart(e,t(this))}),void 0===e.selectedChart&&a.selectChart(e.charts[0]))},addChart:function(a,l){var n=this,o=a.charts,s=a.chartsMap,d=a.chartsNav,c=t("<li>").text("Chart "+(o.length+1)),p=l.attr("uniqueid"),u=e.mobile?new i.Component(l).render():r.componentFactoryWithCache(l,r.getBuilder(l[0].nodeName),{makeDraggable:!1,isGlobalComponent:!1});return t.extend(u,{chartSet:a,button:c}),o.push(u),p&&(s[p]=u),c.on("click.skuid",function(e){e.stopPropagation(),n.selectChart(u)}),d.append(c),u},selectChart:function(t){var a=t.chartSet,r=a.selectedChart;if(void 0!==r){var i=r.button;i&&i.removeClass("selected")}var l=t.button;return l&&l.addClass("selected"),t.refresh(),(a.isSelected()||!a.isSelected()&&void 0!==a.selectedChart)&&t.select(),a.selectedChart=t,a.chartPreview.empty().append(t.element),e.events.publish("skuid.chart.reflow",[{component:t}]),t},selectChartByIndex:function(e,t){return this.selectChart(e.charts[t])},getChartByID:function(e,t){if(void 0!==t)return e.chartsMap[t]},removeChart:function(e,t){if(void 0!==t){var a=t.state.attr("uniqueid");t.remove(),t===e.selectedChart&&delete e.selectedChart,r.publishStateEvent({type:"chartset.chart.remove",chartSet:e,chartID:a}),e.save().refresh(),e.charts&&e.charts.map(function(e){e.reflow()})}},defaultStateGenerator:function(){return n("<skuidvis__chartset/>").append(n("<charts/>"))},afterAttach:function(t){e.events.subscribe(["component.drag.complete"],function(e){e._GUID===t._GUID&&t.charts.map(function(e){e.reflow()})})}})),r.registerBuilder(new r.Builder({id:"skuidvis__chart",name:"Chart",icon:"sk-bi-fields-agg",isJSCreateable:!0,givesMultipleContextRows:!0,supportsMultipleContextRows:!0,description:function(){return'Displays data series from one or more Models in various Chart formats.<br><br>For more information, see the <a href="'+("https://docs.skuid.com/v"+e.version.number+"/en/skuid/components/visualizations/chart/")+'">Chart component tutorial</a>.'},onDropEvent:"chart.addedToBuilder",actionTypes:{series:function(e){return p.getSeriesActions(e)}},handleStateEvent:function(e,a,i){var l=!1,n=a.type,o="model.idChange"===n,d=e.attr("model"),c=e.children("serieslist").children(),p=a.component,u=a.oldId,h=a.newId,f=!1;if(o&&(f=r.handleModelIdChange(e,a)||f,a.oldId===d&&(c&&t.each(c,function(e,r){r=t(r),a.oldId===r.attr("modelId")&&r.attr("modelId",a.newId)}),f=!0)),i===p){var b=e.children("serieslist").first();"chart.dataAxes.idChange"===n&&t.each(b.children("series"),function(){var e=t(this);e.attr("dataAxisId")===u&&(e.attr("dataAxisId",h),l=!0)}),"chart.categoryAxes.idChange"===n&&t.each(b.children("series"),function(){var e=t(this);e.attr("categoryAxisId")===u&&(e.attr("categoryAxisId",h),l=!0)})}f&&i&&s("skuidBuilderComponentNeedsRefresh",[i]),!0===l&&i.save()},propertiesRenderer:function(a,i){a.setHeaderText(o("chart")+" Properties");var s=[];t.each(h,function(e,a){s.push({label:"-- "+u.types[e].label+o("chart")+" Types --",value:"",disabled:!0}),t.each(a.options,function(){s.push(this)}),s.push({label:"",value:"",disabled:!0})});var d=i.state,c=u.types[d.attr("type")].metadata,f={id:"type",type:"picklist",label:"Default "+o("chart")+" Type",picklistEntries:s,onChange:function(e,r){var l=i.state,o=u.types[e].metadata;if(u.types[e].category!==u.types[r].category){var s=!1;if(l.children("allowedtypes").length&&(l.children("allowedtypes").remove(),s=!0),!0===o.hasCategories||!0===o.hasXY){0===l.children("dataaxes").length&&l.append(n("<dataaxes/>"));var d={x:[],y:[],categories:[]},c=l.children("dataaxes"),p=l.children("categoryaxes");t.each(c.children("axis"),function(){var e=t(this);"xaxis"===e.attr("type")?d.x.push(e):d.y.push(e)}),t.each(p.children("axis"),function(){var e=t(this);d.categories.push(e)}),!0===o.hasXY&&(o.hasCategories||0===d.categories.length||(0===d.x.length&&t.each(d.categories,function(){this.attr("type","xaxis"),c.append(this),d.x.push(this)}),d.categories=[],p.children().remove(),s=!0),t.each(d.y,function(){this.attr("type")||(this.attr("type","yaxis"),s=!0)}),0===d.x.length&&(c.append(n('<axis id="xAxis" type="xaxis"/>')),s=!0),0===d.y.length&&(c.append(n('<axis id="yAxis" type="yaxis"/>')),s=!0)),!0===o.hasCategories&&(0!==d.x.length&&(t.each(c.children("axis"),function(){var e=t(this);"xaxis"===e.attr("type")&&(e.remove(),s=!0)}),d.x=[]),0===d.categories.length&&(p.append(n('<axis id="categories"/>')),s=!0),0===d.y.length&&(c.append(n('<axis id="axis1"/>')),s=!0))}!0===s&&i.save()}i.refresh().rebuildProps(a)}},y={id:"allowedtypes",location:"node",type:"multipicklist",storeAs:{type:"node",name:"type"},label:"Additional Chart Types",helptext:"If additional types are specified here, the user will be able to dynamically change the default chart type at runtime.",picklistEntries:h[u.types[d.attr("type")].category].options,noneSelectedText:"Select Types..."},v=[{name:"Basic",props:t.merge([f,y],function(e){var t,a=[{id:"model",type:"model",label:"Model",required:!0},b({id:"maintitle",onChange:function(){e.refresh()}}),b({id:"subtitle",title:"Subtitle",onChange:function(){e.refresh()}})];return l.isMultiCurrencyOrganization&&(t={id:"useorgcurrency",label:"Use default currency of Org rather than User.",type:"boolean",defaultValue:"false"},a.push(t)),a}(i)),expanded:!0}];if(!0!==c.hasMultiAxis&&!0!==c.hasXY||v.push({name:"Axes",tree:function(a){a||(a={});var i=a.component,l=[],o=u.types[i.state.attr("type")].metadata,s=function(e){var t=e.attr("type"),a=e.attr("id"),r=e.attr("title"),i="true"===e.attr("flip"),l="";return r?(l+=r,a&&(l+=" ("+a+")")):a&&(l+=a),(t||i)&&(l+=" | ",t&&(l+=t+(i?", ":"")),i&&(l+="flipped")),l},d={id:"dataaxes",label:"Data Axes",deleteable:!1,icon:"sk-icon-popup",isChild:!0,linkedComponent:i,propsFunction:function(){return[{type:"helptext",html:'Declare one or more "Data Axes" for the chart. Think of a data axis like a "Y Axis" on a chart.'}]},children:[{id:"axis",indent:0,labelFunction:function(e){return s(e)},defaultStateFunction:function(){var e=i.state.children("dataaxes").children("axis").length+1||1;return n('<axis id="axis'+e+'"/>')},propsFunction:function(t){var a,l=[],n=(a=[],!0===u.types[i.state.attr("type")].metadata.hasXY&&a.push({label:"X Axis",value:"xaxis"},{label:"Y Axis",value:"yaxis"}),a),o=function(){t.refresh()},s={id:"type",type:"picklist",location:"attribute",label:"Type",required:!0,helptext:'"Data" Axes correspond to the "Y" Axis of the chart. "Category" Axes correspond to the "X" Axis of the chart.',defaultValue:n.length&&n[0].value,picklistEntries:n,onChange:function(){t.refresh()}};return l=[{id:"id",type:"string",location:"attribute",label:"ID",required:!0,validator:function(e){return g(e,t,i)},onChange:function(e,a){t.refresh(),r.publishStateEvent({type:"chart.dataAxes.idChange",component:i,oldId:a,newId:e})}},{id:"title",type:"string",location:"attribute",label:"Title",onChange:function(e){o()}}],n.length&&l.push(s),l.push({id:"flip",label:"Flipped",type:"boolean",helptext:'"Flip" this axis to the opposite side of the chart (e.g. if the chart default is on the left side, this axis will be displayed on the right side)',onChange:function(e){o()}},{id:"integersonly",label:"Integers Only",type:"boolean",helptext:"If checked, this axis will only display Integer values",onChange:function(e){o()}},{id:"minvalue",label:"Min Value",type:"string",validator:e.builder.core.validators.numericOnly,onChange:function(e){o()}},{id:"maxvalue",label:"Max Value",type:"string",validator:e.builder.core.validators.numericOnly,onChange:function(e){o()}}),l}}]},c={id:"categoryaxes",label:"Category Axes",deleteable:!1,icon:"sk-icon-hierarchy",isChild:!0,linkedComponent:i,propsFunction:function(){return[{type:"helptext",html:'Declare one or more "Category Axes" for the chart. Think of a category axis like an "X Axis" on a chart.'}]},children:[{id:"axis",indent:0,labelFunction:function(e){return s(e)},defaultStateFunction:function(){var e=i.state.children("categoryaxes").children("axis").length+1||1;return n('<axis id="axis'+e+'"/>')},propsFunction:function(e){var a=[],l=i.state.attr("model"),n=p.getModelFieldsOptions(l),o=t.map(p.DATE_GRANULARITIES,function(e){return e}),s={id:"id",type:"string",location:"attribute",label:"ID",required:!0,validator:function(t){return g(t,e,i)},onChange:function(t,a){e.refresh(),r.publishStateEvent({type:"chart.categoryAxes.idChange",component:i,oldId:a,newId:t})}},d={id:"title",type:"string",location:"attribute",label:"Title",onChange:function(){e.refresh()}},c={id:"categorytype",label:"Category Type",type:"picklist",defaultValue:"field",picklistEntries:[{label:"Field",value:"field"},{label:"Template",value:"template"}],onChange:function(){e.refresh().rebuildProps()}},u={id:"field",type:"picklist",label:"Category Field",defaultValue:n.length&&n[0].value,picklistEntries:n,onChange:function(){e.refresh().rebuildProps()}},h=b({id:"template",title:"Category Template",helptext:"Optional template, allows for custom category names and handling of blank values in category data",onChange:function(){e.refresh()}}),f={id:"dategranularity",type:"picklist",label:"Default Date Granularity",defaultValue:o.length&&o[0].value,picklistEntries:o},m={id:"allowedgranularities",location:"node",type:"multipicklist",storeAs:{type:"node",name:"type"},label:"Additional Granularities",helptext:"If additional date granularities are specified here, the user will be able to dynamically change the date granularity at runtime.",picklistEntries:o,noneSelectedText:"Select Granularities..."};switch(a=[s,d,c],e.state.attr("categorytype")){case"field":a.push(u);var y=e.state.attr("field")||n&&n[0]&&n[0].fieldId,v=y&&r.getFieldInfoFromCache(l,y);!v||"DATE"!==v.displaytype&&"DATETIME"!==v.displaytype||(void 0===e.state.attr("fillvals")&&(e.state.attr("fillvals","true"),e.save()),a.push({id:"fillvals",type:"picklist",label:"Fill in values",picklistEntries:[{value:"",label:"Skip Missing Dates"},{value:"true",label:"Fill in Gaps"},{value:"week",label:"Fill in Entire Week"},{value:"month",label:"Fill in Entire Month"},{value:"year",label:"Fill in Entire Year"}],helptext:"Automatically fill in gaps in Category values (e.g. if a month is skipped in the model data, create a category entry anyway)"},f,m));break;case"template":a.push(h)}return a.push({id:"flip",type:"boolean",label:"Flipped",helptext:'"Flip" this axis to the opposite side of the chart (e.g. if the chart default is on the left side, this axis will be displayed on the right side)'}),a}}]};return l.push(d),!0===o.hasCategories&&l.push(c),l}({component:i,propViewer:a})}),v.push({name:"Series",tree:m({component:i,propViewer:a})}),v.push({name:"Styling",tree:function(e){var a=u.types[e.state.attr("type")].metadata,r=function(t,a,r){r.refresh(),e.refresh()},i=[{label:"-- Chart Default --",value:""},{label:"On",value:"true"},{label:"Off",value:"false"}],l={label:"Stacking",deleteable:!1,linkedComponent:e,summaryFunction:function(e){var a=e.attr("stacking")||"";return t.map(i,function(e){if(e.value===a)return e.label})},propsFunction:function(e){return[{id:"stacking",type:"picklist",label:"Stack Series",helptext:"If checked, stackable chart types will be stacked.",picklistEntries:i,onChange:function(t){r(0,0,e)}}]}},n=[{label:"Colors",deleteable:!1,linkedComponent:e,summaryFunction:function(a){var r=t("<div>").css({position:"relative"}),i=t("<div>").text("Chart Default"),l=p.buildColorGenerator(e),n=a.children("colors");return n&&(i.empty(),t.each(n.children("value"),function(){var e=t(this).html();i.append(t("<div>").css({"background-color":e,height:"15px",width:"8px","margin-right":"2px",display:"inline-block"}))})),r.append(i,l),r},propsFunction:function(t){var a=[];return a.push({id:"backgroundcolor",type:"color",label:"Background Color",defaultValue:"",placeholder:"default",onChange:function(){e.refresh()}},{id:"backbuttonbgcolor",type:"color",label:"Back Button Background",helptext:'Optional, specify the background color of the "Back" button when drilled down',defaultValue:"",placeholder:"default"},{id:"backbuttontextcolor",type:"color",label:"Back Button Color",helptext:'Optional, specify the color of the text of the "Back" button when drilled down',defaultValue:"",placeholder:"default"},{id:"colors",location:"node",type:"multiitem",storeAs:{type:"node",name:"value"},label:"Chart Colors",helptext:"Choose one or more colors to be used for this chart. When all colors are used, new colors are pulled from the start again.",onChange:function(){t.refresh(),e.refresh()}}),a}},p.getHeightTree({component:e,defaultSummary:"-- Chart Default --",label:"Chart Height"})];!0===a.isStackable&&n.push(l),!0===a.hasLegend&&n.push(p.getLegendTree({component:e,defaultSummary:"-- Chart Default --",metadata:a}));var o=[{label:"-- Chart Default --",value:""},{label:"On",value:"true"},{label:"Off",value:"false"}],s={label:"Data Labels",deleteable:!1,linkedComponent:e,state:e.state.children("legend:first"),summaryFunction:function(e){var a=e.attr("showlabels")||"";return t.map(o,function(e){if(e.value===a)return e.label})},propsFunction:function(e){return[{id:"showlabels",type:"picklist",label:"Display Data Labels",location:"attribute",picklistEntries:o,onChange:function(t){r(0,0,e)}}]}};return n.push(s),n}(i)}),v.push(p.getAdvancedProps({component:i}),r.getRenderingCategory({component:i,propViewer:a}),r.getContextCategory({state:d,model:d.attr("model")})),e.mobile){if(void 0===i.chartSet){var C=p.getMobileActionsList(i)||[];C.length>0&&v.push({name:"Actions",props:C})}v.push({name:"Remove",props:[{type:"remove"}]})}a.applyPropsWithCategories(v,d)},buildChartObj:function(e){var a={chart:{type:e.attr("type")||"line"},title:{text:e.attr("maintitle")},subtitle:{text:e.attr("subtitle")},credits:{enabled:!1},plotOptions:{series:{animation:!1}}},r=e.children("colors"),i={backgroundColor:e.attr("backgroundcolor")},l=a.chart.type,n=u.types[l].hcType||l,o=u.types[l].metadata;t.extend(a,f[l]||{}),"off"===e.attr("export")?a.exporting={enabled:!1}:"offline"===e.attr("export")&&(a.exporting={mode:"offline"}),"true"==e.attr("stacking")&&(a.plotOptions||(a.plotOptions={}),a.plotOptions.series||(a.plotOptions.series={}),a.plotOptions.series.stacking="normal");var s=e.children("legend");if(s){var d=s.attr("layout");a.legend="off"===d?{enabled:!1}:{layout:s.attr("layout"),align:s.attr("halign"),verticalAlign:s.attr("valign")};var c=s.attr("showlabels");"true"===c?a.legend.showLabels=!0:"false"===c&&(a.legend.showLabels=!1),!0!==o.hasDataLabels||"horizontal"!==a.legend.layout&&"vertical"!==a.legend.layout||(a.plotOptions||(a.plotOptions={}),a.plotOptions[n]||(a.plotOptions[n]={}),t.extend(!0,a.plotOptions[n],{showInLegend:!0}))}if(r){var p=r.children("value");p.length&&(a.colors=[],t.each(p,function(){a.colors.push(t(this).text())}))}return a.chart||(a.chart={}),a.chart.backgroundColor=i.backgroundColor,a},componentRenderer:function(a){a.setTitle(a.builder.name),a.givesMultipleContextRows=!0;var r=a.state,i=a.chartSet,l=a.chartWrapper=t("<div>").addClass("sk-chart-wrapper"),n=r.attr("height");a.container=t("<div>").addClass("sk-chart-container").appendTo(l),a.chartObj=this.buildChartObj(r),n&&l.css({height:n}),e.mobile||(void 0===i?p.addDrilldownActionGroup(a):a.addActionItem({text:o("remove"),icon:"sk-icon-delete",action:function(){i.removeChart(a)},id:"removeButton"})),a.reflow=function(){var e=a.container,t=e.highcharts();t&&t.chartWidth!==e.width()&&e.is(":visible")&&t.reflow()}},afterAttach:function(t){t.body.append(t.chartWrapper),d&&y(t.container,t.chartObj),e.utils.addResizeHandler(t.reflow,100),l.delayEventCallback({eventType:"tabshow pageload dialogopen stepchange",delay:20,callback:t.reflow}),e.events.subscribeOnce(["skuid.pageBuilder.complete",this.onDropEvent],function(){y(t.container,t.chartObj),d=!0}),!d&&e.events.subscribe("component.drag.complete",function(e){e._GUID===t._GUID&&t.reflow()}),e.events.subscribe(["ui.reflow","skuid.chart.reflow"],function(e){e&&e.length&&e[0].component!==t||t.reflow()})},defaultStateGenerator:function(e){var t=r.getLastSelectedModelComponent(),a=t?t.state:r.getFirstModel(),i=a?a.attr("id"):null,l=n("<"+this.id+' model="'+i+'" maintitle="{{Model.labelPlural}}" type="line" />');return l.append(n('<dataaxes><axis id="axis1"/></dataaxes>'),n('<categoryaxes><axis id="categories" categorytype="field"/></categoryaxes>'),n("<serieslist/>"),n("<colors/>"),n('<legend layout="horizontal" halign="center" valign="bottom"/>')),e||(e={}),!0===e.includeContextCondition&&l.append(n("<conditions/>").append(n('<condition type="contextrows" field="Id" mergefield="Id" operator="in" autocreated="true"/>'))),l}}))}(skuid)},355:function(e,t,a){"use strict";a(354),a(353)}});