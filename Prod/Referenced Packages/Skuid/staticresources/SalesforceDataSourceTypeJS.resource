!function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},a.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=316)}({316:function(e,t,a){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t,a=e.constants,n=a.DISPLAY_TYPES,o=a.LIGHTNING,i=n.REFERENCE,s=a.SALESFORCE,c=a.VISUALFORCE,l=n.MULTIPICKLIST,d=n.TEXT,u=n.BOOLEAN,f=n.PICKLIST,p="x-salesforce-save-api-version",m=2,h="Could not upload file",g="_failedToGetRecordTypeMetadata",b="_recordTypeIdsAlreadyFetching",v=e.$,y=e.utils,S=y.inPlatform,C=y.toArray,I=e.dataSource.utils,N=y.mergeAsTextInContext,T=y.isString,R=e.sfdc,A=y.makeXMLDoc,F=y.getInvokable,E=y.encodeHTML,_=y.resolve,w=y.startsWith,M=R.api.version,j={},P={Case:"CaseNumber",ContentDocument:"Title",ContentVersion:"Title",CustomPermission:"MasterLabel",Event:"Subject",FeedItem:"Title",Idea:"Title",PartnerNetworkConnection:"ConnectionName",Solution:"SolutionName",Task:"Subject",WorkOrder:"WorkOrderNumber"},O={CampaignMember:1,AccountContactRole:1,OpportunityContactRole:1,ContractContactRole:1,CaseContactRole:1,CaseComment:1,CaseSolution:1,OpportunityLineItem:1},x=1,k={};function L(e){if(!e)return!0;if(S([c,o])){if("string"==typeof e)return e===s;if("object"===(void 0===e?"undefined":r(e)))return e.name===s}return!1}function D(e){return L(e.getDataSource())}function U(){return!(!window.sforce||!sforce.one)&&sforce.one}function V(e,t){return y.getWindowLocation().href.indexOf("/lightning/")>-1?"/lightning/r/"+t+"/"+e+"/view":"#/sObject/"+e+"/view"}function B(e){e.element.off("click.skuidLinkHandler")}function q(e,t){e.element.on("click.skuidLinkHandler","a",function(e){e.metaKey||(e.preventDefault(),t())})}function H(e,t){q(e,function(){window.$A.get("e.force:navigateToSObject").setParams({recordId:t}).fire()})}function Y(e,t){q(e,function(){sforce.one.navigateToSObject(t)})}function W(){return S(o)&&!!window.$A}function G(e,t){var a,r,n,o=e.metadata.controllingField,i=e.model,s=o&&i.getField(o),c=e.metadata.picklistEntries,l=[];return o&&s?(r=i.getFieldValue(e.row,o,!0),t&&t.length&&(a={},v.each(t,function(){a[this.value]=1})),"BOOLEAN"===s.displaytype?n=r?1:0:v.each(s.picklistEntries,function(e,t){t.value===r&&(n=e)}),(n||0===n)&&c&&v.each(c,function(e,t){var r,o;r=n,o=t.validFor,0!=(new sforce.Base64Binary("").decode(o).charCodeAt(r>>3)&128>>r%8)&&(!a||t.value in a)&&l.push(t)}),l):t||c}function J(e){var t=e.model,a=t.objectName,r=e.item,n=e.metadata,o=n.picklistEntries||[],i=r&&r.ValidRecordTypeIds?r.ValidRecordTypeIds:[],s=t.getFieldValue(e.row,"RecordTypeId",!0);return n.overrideMetadata&&o.length&&n.customPicklistEntriesProvided||n.uiOnly?I.deferrable(o):(s&&-1===v.inArray(s,i)&&i.push(s),i.length?Ee(a,e.id,i,t).then(function(t){return t||(t=e.picklistEntries||e.metadata.picklistEntries),G(e,t)}):I.deferrable(G(e)))}function z(){return!!(window.sforce&&window.sforce.console&&window.sforce.console.isInConsole())&&window.sforce.console}function K(e){for(;T(e);)try{e=JSON.parse(e)}catch(e){break}return e}function $(e){var t=e.split(".")[0];return y.endsWith(t,"__r")||y.endsWith(t,"__pr")?t.substring(0,t.length-1)+"c":t+"Id"}function X(e){return y.endsWith(e,"__c")||y.endsWith(e,"__pc")?e.substring(0,e.length-1)+"r":e.substring(0,e.length-2)}function Q(e){if(e&&e.fields&&e.fields.length){var t=e.getDataSource&&e.getDataSource(),a=t&&t.getCachedEntityMetadata(e.objectName);v.each(e.fields,function(t,r){!function e(t,a,r,o){if(a){var s,c,l,d,u,f,p=a.split("."),m=o.getDataSource&&o.getDataSource();if("childRelationship"===t.type)(d=t.referenceTo&&t.referenceTo.length&&t.referenceTo[0])&&(u=m&&m.getCachedEntityMetadata(d.o),(f=t.subFields)&&v.each(f,function(t,a){e(a,a.id,u,o)}));else if(1===p.length){if(s=r&&r.getField&&r.getField(a)){c=o.getOverrideableFieldMetadata(t);var h=t.id,g=t.name;v.extend(!0,t,s),h&&(t.id=h),g&&(t.name=g),c&&v.each(c,function(e,a){t[e]=a})}if(t&&t.function){var b,y,S=t.function;S&&(b=["CALENDAR_MONTH","CALENDAR_QUARTER","CALENDAR_YEAR","DAY_IN_MONTH","DAY_IN_WEEK","DAY_IN_YEAR","FISCAL_MONTH","FISCAL_QUARTER","FISCAL_YEAR","HOUR_IN_DAY","WEEK_IN_MONTH","WEEK_IN_YEAR"],y=["DAY_ONLY"],0===(S=S.toUpperCase()).lastIndexOf("COUNT",0)?t.displaytype=n.INTEGER:t.displaytype!==n.DATE&&t.displaytype!==n.DATETIME||-1===b.indexOf(S)?t.displaytype==n.DATETIME&&-1!==y.indexOf(S)&&(t.displaytype=n.DATE):t.displaytype=n.STRING,t.required=t.createable=t.editable=!1)}var C,I,N,T;t&&t.displaytype===i&&(t.relationshipName||(t.relationshipName=t.rel),!t.ref&&t.referenceTo&&(C=t.referenceTo)&&C.length&&(I=[],N=[],T={c:"createable",o:"objectName",l:"label",k:"keyPrefix",p:"labelPlural",s:"searchable"},v.each(C,function(e,t){t.o&&(I.push(t.o),N.push(t.k),v.each(T,function(e,a){t[a]=t[e],delete t[e]}),t.accessible=!0)}),I.length&&(t.ref=I.join(",")),N.length&&(t.refprefix=N.join(","))))}else a=$(a=p.shift()),(s=r&&a&&r.getField&&r.getField(a))&&((l=s.referenceTo)&&1===l.length?r=m&&m.getCachedEntityMetadata(l[0].objectName||l[0].o):l&&l.length>1&&(r=m&&m.getCachedEntityMetadata("Name")),r&&e(t,p.join("."),r,o)),t.required=t.createable=t.editable=!1}}(r,r.id,a,e)})}return e}function Z(e){if(!e)return"";var t=e.statusCode,a=e.body,r=t&&e.status?t+" "+e.status+": ":"";return(a=K(a))instanceof Array&&1===a.length?r+=a[0].message:a&&a.message?r+=a.message:e.error&&(r+=e.error),r}function ee(t){var r=y.combineUrls(t.serviceUrl,"/services/apexrest/skuid/api/v1/");return t._sfdcRemote=[{name:"load",pathName:"models"},{name:"save",pathName:"models"},{name:"getModelMetadata",pathName:"models"},{name:"getEntityList",pathName:"models"},{name:"doSearch",pathName:"models"},{name:"checkMetadataApiAccess",pathName:"models"},{name:"approvalsProcessWorkItem",pathName:"approvals"},{name:"approvalsUnlockRecord",pathName:"approvals"}].reduce(function(n,o){return n[o.name]=function(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"models";return function(i){var c,l,d,u=v.Deferred(),f=i&&!T(i)?JSON.stringify(i):i||null,p=0;return t.name===s?(d=[],f&&d.push(f),d.push(function(a,r){var o;if(r.status){if(T(a))try{a=JSON.parse(a)}catch(e){}u.resolve(a)}else o=r.message,e.platform.isPlatformSessionError(o,t)?e.platform.attemptLogin(p).then(function(){p++,e.remote()[n].apply(window,d)}).catch(function(){u.reject(o)}):u.reject(o)},{escape:!1}),e.remote()[n].apply(window,d)):(l={method:c=f?"POST":"GET",url:r+o,headers:{"x-skuid-rest-service-method":n,"X-SKUID-REST-SERVICE-METHOD":n}},"POST"===c&&(l.body=f,l.contentType="application/json"),t.makeRequest(t.createHTTPRequest(l)).then(function(e){var t=e.body,r=e.statusCode;e.error?u.reject(e.error):t&&(t=K(t),v.inArray(r,[200,201,204])<0?u.reject(Z(e)):t&&t.error&&1===y.size(t)?"Invalid Skuid Model API request method: null"===t.error&&S(a.NATIVE)?u.reject("The version of Skuid installed in the target Salesforce org is not compatible with Skuid Platform. Please install the latest version of Skuid into this Salesforce org."):u.reject(t.error):u.resolve(t))},function(e){u.reject(Z(e))})),u.promise()}}(o.name,o.pathName),n},{})}function te(e){var t=e._sfdcRemote;return t||(t=new ee(e)),t}function ae(){return e.utils.userInfo}function re(e){var t=e.path,a=e.basePath||"";return e.dataSource&&e.dataSource.name===s&&(a=""),e.accessToken=e.accessToken||ae().sessionId,e.url=y.getSafeRelativeUrl(a+"/services/data"+t),function(e){var t,a=e.fields,r=e.file,n=e.payloadField,o=e.url,i="formboundary"+Math.random().toString(36).substr(2,10),c=e.filename||r.name,l=e.dataSource;t=new Blob(["--boundary_"+i+'\nContent-Disposition: form-data; name="entity_content";\nContent-Type: application/json\n\n'+JSON.stringify(a)+"\n\n--boundary_"+i+"\nContent-Type: "+r.type+'\nContent-Disposition: form-data; name="'+n+'"; filename="'+c+'"\n\n',r,"\n--boundary_"+i+"--"],{type:'multipart/form-data; boundary="boundary_'+i+'"'});var d=l.createHTTPRequest({url:o,headers:{},method:"POST"});return d.headers.Accept="application/json",l.name===s&&(d.headers.Authorization="Bearer "+ae().sessionId),v.extend(d,{body:t,cache:!1,contentType:!!l.useProxy&&'multipart/form-data; boundary="boundary_'+i+'"',processData:!1}),y._ie&&(d.contentType='multipart/form-data; boundary="boundary_'+i+'"'),l.makeRequest(d)}(e)}function ne(e,t,a,r){var n,o=[],i={errors:o},s=!0;function c(t,a){var r=e[t];if(r&&r.length===a)for(n=0;n<a;n++)r[n].success||(r[n].errors&&r[n].errors.length&&Array.prototype.push.apply(o,r[n].errors),s=!1);else s=!1}return t&&c("insertResults",t),a&&c("updateResults",a),r&&c("deleteResults",r),i.success=!o.length&&s,i}function oe(e){var t,a,r,n,o,i=v.Deferred(),c=e.paramString||"",l=e.dataSource,d=e.fileField,u=e.context;return u&&(u.id?r=u.id:u.row&&(d?(n=u.model.getField(d))&&"REFERENCE"===n.displaytype?(a=d.substr(0,d.length-1),r=y.getObjectProperty(u.row,a+"r.skuid__AttachmentId__c")):r=y.getObjectProperty(u.row,d):u.model&&("skuid__Image__c"===(t=u.model.objectName)?r=u.row.skuid__AttachmentId__c:"Attachment"===t&&(r=u.row.Id)))),r?l.name===s?i.resolve(y.getUrlFromAttachmentId(r+c)):(o=l.serviceUrl+"/services/data/v"+M+"/sobjects/Attachment/"+r+"/body",l.authenticate().then(function(){return l.makeRequest(l.createHTTPRequest({url:o,accept:"application/octet-stream"}))}).then(function(e){i.resolve("data:;base64,"+e.body)},function(e){i.reject(e)})):i.reject("No Attachment Id"),i.promise()}function ie(t,a){if(y.isString(t))return a({message:h+": "+t});a({message:e.ajax.getErrorMessage(t,h)})}function se(t,a,r,n,i,c){var l,d,u=r.uploadMethod.dataSource,f={row:a.row,model:a.model},p={createFields:!1},m=a.options.xmlDef,h=a.row,g=m&&m.attr("owneridfield")||"",b=h&&g&&h[g]?h[g]:"",C=r.description?N(r.description,f,p):"",I=r.filename?N(r.filename,f,p):t.name,T=r.feedtext?N(r.feedtext,f,p):"";function R(e){ie(e,i)}function A(e){var a={Origin:e,PathOnClient:I,Description:C};return"contentdocumentwithrecord"===r.storeAs&&(a.FirstPublishLocationID=h.Id),re({path:"/v"+M+"/sobjects/ContentVersion",basePath:u&&u.serviceUrl,fields:a,payloadField:"VersionData",file:t,filename:I,dataSource:u})}if(n({fileName:I}),S(o))return i({message:"Cannot upload large files in Lightning"}),!1;if("record"===r.storeAs){var F={ParentId:a.model.getRowId(a.row),Name:I,ContentType:t.type,Description:C};b&&(F.OwnerId=b),re({path:"/v"+M+"/sobjects/Attachment",basePath:u&&u.serviceUrl,fields:F,payloadField:"Body",file:t,filename:I,dataSource:u}).then(function(e){var t=(e&&y.parseAsJSONIfString(e.response||e.body)).id;i({newFileId:t,newFileName:I})},R,function(e){c(e)})}else if("field"===r.storeAs){var E,_,w="/v"+M+"/sobjects/Attachment",j=a.fieldValue,P=!1;(function(){var e=v.Deferred();if(j)e.resolve(j);else{var t=[],r={id:"updateObject",updates:{},type:a.model.objectName},n=a.model.getRowId(a.row);r.updates[n]={},r.updates[n][a.fieldName]="1",t.push({id:"imageImageInsert",inserts:{1:{}},type:"skuid__Image__c"},r),te(u).save(JSON.stringify({operations:t,rollbackOnAnyError:!0})).then(function(t){var a,r="";t.globalErrors&&t.globalErrors.length?r+=t.globalErrors.join(", "):t.insertResults&&1===t.insertResults.length&&t.updateResults&&1===t.updateResults.length?t.insertResults[0].success&&t.updateResults[0].success?a=t.insertResults[0].id:(v.each(t.insertResults[0].errors,function(){r+=this.message}),v.each(t.updateResults[0].errors,function(){r+=this.message})):r+="Error Uploading File",a?e.resolve(a):e.reject(r)},function(t){e.reject(t&&t.error)})}return e.promise()})().then(function(e){var r=a.fileId;_=e,r&&e&&(P=!0,w+="/"+r+"?_HttpMethod=PATCH");var n={Name:I,ContentType:t.type,Description:C};return!r&&e&&(n.ParentId=e),re({path:w,basePath:u&&u.serviceUrl,fields:n,payloadField:"Body",file:t,filename:I,dataSource:u})}).then(function(e){var t=a.fileId,r=e&&(e.response||e.body);if(t?E=t:r&&(r=y.parseAsJSONIfString(r),E=r.id),P){var n=[],o={id:"updateObject",updates:{},type:"skuid__Image__c"};return o.updates[_]={Name:I},n.push(o),te(u).save(JSON.stringify({operations:n,rollbackOnAnyError:!0}))}return v.when()}).then(function(){i({newFileId:E,newFileName:I,newFieldValue:_})},R,function(e){c(e)})}else"chatterfeed"===r.storeAs?(l=e.page?e.page.community:null,d=l?l.id:null,re({path:"/v35.0"+(d?"/connect/communities/"+d:"")+"/chatter/feed-elements",basePath:u&&u.serviceUrl,fields:{body:{messageSegments:[{type:"Text",text:T}]},capabilities:{content:{description:C,title:I}},feedElementType:"FeedItem",subjectId:a.model.getRowId(a.row)},payloadField:"feedElementFileUpload",file:t,filename:I,dataSource:u})).then(function(){if(i(),window.chatter&&u.name===s){var e=chatter.getFeed(),t=e.getConfig();e.refresh({feedType:t.feedType,isFullRefresh:!0,params:t})}},R,function(e){c(e)}):"chatterfiles"===r.storeAs?A("H").then(function(){i()},R,function(e){c(e)}):"contentdocument"!==r.storeAs&&"contentdocumentwithrecord"!==r.storeAs||A("C").then(function(){i()},R,function(e){c(e)})}function ce(t,a,r,n,o){var i=r.filename||t.name,c=r.uploadMethod.dataSource,l=c&&c.serviceUrl?c.serviceUrl:"",d=function(e){ie(e,o)};n({fileName:i}),y.readFileAsBase64(t).then(function(t){var a,r,n,u=i.split("."),f="";u.length>1&&(f=u.pop().toUpperCase()),a=(i=u.join("")+f).match(/[a-z]|[A-Z]|[0-9]/g),i=a?a.join(""):"unnamedResource",/[0-9]/.test(i.charAt(0))&&(i="SR"+i),(r=c.createHTTPRequest({url:l+"/services/data/v"+M+"/sobjects/StaticResource",headers:{"Content-Type":"application/json"},method:"POST"})).headers.Accept="application/json",c.name===s&&(r.headers.Authorization="Bearer "+ae().sessionId),n={Name:i,ContentType:"application/"+f,Body:t,CacheControl:"Public"},v.extend(r,{body:JSON.stringify(n),contentType:"application/json"}),c.makeRequest(r).then(function(e){var t=e.body,a=t.id||t.Id;void 0!==a&&(n.Id=a),o({record:v.extend(n,e)})},function(t){var a="SELECT Id FROM StaticResource WHERE Name='"+i+"'";c.name===s?e.sfdc.api.query(a).then(function(a){if(a.records&&a.records[0]&&window.confirm('Static Resource "'+i+'" already exists, do you want to overwrite it?'))return n.Id=a.records[0].Id,new e.sfdc.api.SObject("StaticResource",n).update();return v.Deferred().reject(t).promise()}).then(function(){o({record:n})},function(e){d(e)}):d(t)})})}function le(e){return e&&e in P?P[e]:e in O||e&&y.endsWith(e,"__x")?"Id":"Name"}function de(){return"Id"}function ue(t,a){var r,o={Case:["UseActiveAssignmentRule","SendAutoResponseEmails","SendUserNotificationEmails","AllowExternalEmails"],CaseComment:["AllowExternalEmails"],Event:["SendUserNotificationEmails","AllowExternalEmails"],Lead:["UseActiveAssignmentRule","SendAutoResponseEmails","SendUserNotificationEmails","AssignmentRuleId"],Task:["SendUserNotificationEmails"],User:["SendUserNotificationEmails"]};if(t&&t.operations)return a||(a=m),t.operations.forEach(function(t){var a=o[t.type],r=e.$M(t.id);["inserts","updates","changes"].forEach(function(e){t[e]&&v.each(t[e],function(t,o){if(v.each(o,function(a,i){if((y.endsWith(a,"__r")||y.endsWith(a,"__pr"))&&delete o[a],r){var s,c,l,d=r?r.getField(a):null,u=v.isArray(i),f=v.isPlainObject(i);if("changes"===e?(s=!!(l=r.getRecordById(t))&&l.isNew(),c=!!l&&(!l.isNew()&&!l.isMoribund())):(s="inserts"===e,c="updates"===e),d){if(s&&!d.createable||c&&!d.editable)return delete o[a],!0;if(f&&d.displaytype===n.OBJECT||u&&d.displaytype===n.ARRAY)return o[a]=JSON.stringify(i),!0}(u||f)&&delete o[a]}}),r&&a){var i=r.changes[t];v.each(a,function(e,t){i.hasOwnProperty(t)&&(o[t]=i[t])})}})})}),a<2?{operations:(r=t).operations.map(function(e){var t={updates:e.returning.map(function(e){return{id:e}}),changes:{},id:e.id,type:e.type};return e.inserts&&v.each(e.inserts,function(e,a){t.changes[e]=a}),e.updates&&v.each(e.updates,function(e,a){t.changes[e]=a}),e.deletes&&v.each(e.deletes,function(e){t.changes[e]={__deleted:!0}}),t}),rollbackOnAnyError:r.rollbackOnAnyError}:t}function fe(e,t,a){var r=t+a,n=e[b]=e[b]||{},o=n[r];return o||(n[r]=function(e,t,a){if("Task"===t||"Event"===t)return y.reject();return pe("/ui-api/object-info/"+t+"/picklist-values/"+a,e,"GET",function(){}).then(function(e){return t=e.picklistFieldValues,a={},v.each(t,function(e,t){var r=y.grab(t,"defaultValue","value");a[e]=v.map(t.values,function(e){return{value:e.value,label:e.label,defaultValue:r&&r===e.value}})}),a;var t,a})}(e,t,a).then(function(e){if(!y.size(e))throw new Error("Failed to fetch - on platform");return delete n[r],e}).catch(function(){var o=r+"sobject";return n[o]?n[o]:n[o]=function(e,t,a){return pe("/sobjects/"+t+"/describe/layouts/"+a,e,"GET",function(){}).then(function(e){return a={},(t=e).detailLayoutSections&&t.detailLayoutSections.forEach(function(e){e.layoutRows&&e.layoutRows.forEach(function(e){e.layoutItems&&e.layoutItems.forEach(function(e){e.layoutComponents&&e.layoutComponents.forEach(function(e){var t=y.grab(e,"details","type");t&&(t.indexOf("picklist")>-1||"combobox"===t)&&(a[e.details.name]=e.details.picklistValues)})})})}),a;var t,a})}(e,t,a).then(function(e){return delete n[r],delete n[o],e}).catch(function(){delete n[r],delete n[o],e[g]=!0})}))}function pe(t,a,r,n){var o={type:r=r||"GET",url:t,cache:"GET"===r,dataSource:a,error:n};return e.sfdc.api.makeRequest(o)}v.each([n.BUTTONGROUP,n.COMBOBOX,n.MULTIBUTTONGROUP,n.MULTIPICKLIST,n.PICKLIST],function(e,t){k[t]=!0});var me=function(t,a){a&&a.addProblem?a.addProblem(t):e.component.getByType("skuidpage")[0].addProblem(t)},he=function(e,t){var a=(t=t||{}).needSObject,r=t.isStandard,n=t.sobject,o=t.actionName;return r&&!o&&(o=e),o=o||"",r?"/actions/standard/"+o:a?"/actions/custom/"+e+"/"+n+"/"+o:"/actions/custom/"+e+"/"+o},ge=function(t,a,r,o,i){i=i||{};var s=r&&r.component,c=r&&r.propViewer,l=i.needSObject,d=i.isStandard;return{builderProps:function(){var r=[],n=F(a,"attr"),i=l&&(n("sobject")||"global"),u=I.makeLabelFromId(o),f=n("sfdcactionname"),p=he(o,{needSObject:l,isStandard:d,sobject:i}),m=(f||d)&&he(o,{needSObject:l,isStandard:d,sobject:i,actionName:f}),h=function(e){return function(){y.removeAllAttrsExcept(a,["actionname","datasource","type"].concat(e)),s.save().rebuildProps(c)}};if(l&&r.push({id:"sobject",label:"SObject",type:"combobox",defaultValue:"Global",source:function(){return pe("/actions/custom/"+o,t).then(function(e){return v.map(e,function(e,t){return{label:t,value:t}})})},onChange:h(["sobject"])}),d||r.push({id:"sfdcactionname",label:u+" action",type:"combobox",source:function(){return pe(p,t).then(function(e){return v.map(e.actions,function(e){return{label:e.label,value:e.name}})})},onChange:h(["sfdcactionname","sobject"])}),m){var g=e.sfdc.api.getCachedResult({type:"GET",url:m,dataSource:t});!g&&m?pe(m,t).then(function(){s.rebuildProps(c)}):function(e,t,a,r){var n,o=r.children("inputs");if(o.length&&(n=o.children()),n&&n.length){var i=!1;v.each(n,function(e,a){0===t.filter(function(e){return e.name===v(a).attr("name")}).length&&(a.remove(),i=!0)}),i&&a.save()}v.each(t,function(t,i){var s=i.name,c=n?n.filter('[name="'+s+'"]'):[],l=c.length?c.attr("value"):null,d=(i.type||"TEXT").toLowerCase();"sobject"===d&&i.sobjectType&&(d="TEXT");var u={isStateless:!0,value:l,label:i.label,required:i.required,type:d.toLowerCase(),helptext:i.description,onChange:function(e){var t=!!o&&o.children('[name="'+s+'"]');e||!1===e||0===e?(t&&t.length||(t=A("<input/>").attr({name:s,displaytype:d}),(!o||o&&!o.length)&&(o=A("<inputs/>").appendTo(r)),t.appendTo(o)),t.attr("value",e)):t.remove(),a.save()}};"picklist"!==d&&"combobox"!==d||(u.picklistEntries=i.picklistValues),e.push(u)})}(r,g.inputs,s,a)}return r},runtimeExecution:function(t,a,r){r=r||{};var o=function(e){var t;return e&&e.length?(t=e[0].outputValues)&&t.output&&t.output.attributes?t.output:t:null},i=function(e,t,a){return"Error running "+e+" action"+(t?" "+t:"")+(a?(a.statusCode?": "+a.statusCode:"")+(a.message?': "'+a.message+'"':""):"")};return function(s,c,l){var d,u=s.attr("sfdcactionname")||a,f=s.attr("sobject")||"global",p=v.Deferred(),m={},h=!0,g=v.extend({},r,{sobject:f,actionName:u});if(s.children("inputs").children().each(function(){var e=F(v(this),"attr"),t=e("name"),a=e("value"),r=e("displaytype"),o=y.getContextToUse(c,l);if(!t)return p.reject({$CurrentAction:{error:'Invalid parameter name for Salesforce Action "'+u+'"'}}),h=!1,!1;a=y.mergeAsDataInContext(a,o),r.toUpperCase()===n.BOOLEAN&&(a="true"===a),m[t]=a}),!h)return p.promise();c&&c.button&&c.button.startProcessing();var b={inputs:[m]},S=he(a,g);return e.sfdc.api.makeRequest({type:"POST",url:S,dataSource:t,data:b,crossDomain:!0,success:function(e){d=o(e),p.resolve({$PreviousAction:{result:d}})},error:function(r){var n,s=y.parseAsJSONIfString(r.responseJSON);if(s&&s.length){var l=s[0];if(l.errors&&l.errors.length){var f=l.errors[0];"apex"===a&&"INVALID_INPUT"===f.statusCode?(n=i(a,u,f)+". Attempting to run action one more time without the invalid input parameter.",me(n,c),pe(S,t,"GET").then(function(r){var s={};(r=y.parseAsJSONIfString(r)).inputs&&r.inputs.length&&v.each(r.inputs,function(e,t){for(var a in m)a===t.name&&(s[a]=m[a])});var l={inputs:[s]};e.sfdc.api.makeRequest({type:"POST",url:S,dataSource:t,data:l,crossDomain:!0,success:function(e){d=o(e),p.resolve({$PreviousAction:{result:d}})},error:function(e){var t,r=y.parseAsJSONIfString(e.responseJSON)[0];r.errors&&r.errors.length&&(t=r.errors[0]),n=i(a,u,t),me(n,c);var o=t.message||"Error running custom Apex action "+u;p.reject({$CurrentAction:{error:o}})}})},function(){p.reject({$CurrentAction:{error:"Error getting updated inputs for custom Apex action"}})})):(n=i(a,u&&u!==a?u:null,f),me(n,c),p.reject({$CurrentAction:{error:f.message}}))}else me(n="Error running "+a+" action",c),p.reject({$CurrentAction:{error:"Unknown error with custom Apex action"}})}}}).always(function(){c&&c.button&&c.button.stopProcessing()}),p.promise()}}(t,o,i),label:i.label||I.makeLabelFromId(o),name:o}},be=function(e){return function(t,a,r,n){var o=t.attr("workitemid"),i=t.attr("comments"),s=t.attr("nextapproverid"),c=y.getContextToUse(a,r),l={actionType:e,workItemId:y.mergeAsDataInContext(o,c),comments:y.mergeAsDataInContext(i,c)};return"Removed"!==e&&s&&(l.nextApproverId=y.mergeAsDataInContext(s,c)),n.authenticate().then(function(){return te(n).approvalsProcessWorkItem(JSON.stringify(l))}).catch(function(e){return me(e,a),y.reject({$CurrentAction:{error:e}})})}},ve=function(e,t,a,r){var n=y.getContextToUse(t,a),o=y.mergeAsDataInContext(e.attr("recordid"),n);if(!o){return me("You must provide a valid record Id.",t),y.reject({$CurrentAction:{error:"You must provide a valid record Id."}})}return r.authenticate().then(function(){return te(r).approvalsUnlockRecord(o)}).catch(function(e){return me(e,t),y.reject({$CurrentAction:{error:e}})})},ye=function(e,t){return y.parseAsJSONIfString(e.getCacheProperty(t,"sessionStorage"))||{}},Se=function(e){var t={};return v.each(e,function(e,a){t[a]=e}),t},Ce={getMapOfPicklistValuesToEntries:function(e){if(!e)return{};var t=e.metadata&&e.metadata.picklistEntries||e.picklistEntries,a={};return v.each(t,function(e,t){a[t.value]=t}),a},getCurrentlyCachedFieldsMap:function(e,t){var a=e.getCachedEntityMetadata(t);return a?a.getFieldsMap():{}},getRecordTypeMetadata:function(e,t,a){var r=this,n=e._decompressedRecordTypeMetadata;if(n||(n=e._decompressedRecordTypeMetadata={}),n[a])return n[a];var o=ye(e,"compressedRecordTypeMetadata."+a);if(y.size(o)&&3===o.length){var i=o[0];if(!Re({modstamp:o[1],__uid:o[2]},e)){var s=Se(ye(e,"picklistToIndexMapMetadata.picklist")),c=Se(ye(e,"picklistToIndexMapMetadata.value")),l=r.getCurrentlyCachedFieldsMap(e,t),d=y.isUndefined,u=n[a]={};return v.each(i,function(e,t){var a=s[t[0]],n=r.getMapOfPicklistValuesToEntries(l[a]),o=t[2];y.size(n)&&!d(a)&&l[a]&&(u[a]=v.map(t[1],function(e){var t=c[e];if(!d(t)&&(!n||n[t]&&n[t].active))return{value:t,label:n[t]&&n[t].label||t,defaultValue:e===o}}))}),u}}},storeRecordTypeMetadata:function(e,t,a){var r=a;Fe(r);var n=ye(e,"picklistToIndexMapMetadata"),o=n.value||{},i=n.picklist||{},s=Object.keys(o).length,c=Object.keys(i).length,l=[],d=y.isUndefined,u=[l,r.modstamp,r.__uid];v.each(r.metadata,function(e,t){var a=[],r=[],n=i[e];l.push(r),d(n)&&(n=i[e]=c,c++),r.push(n,a),v.each(t,function(e,t){var n=y.decodeHTML(t.value),i=o[n];d(i)&&(i=o[n]=s,s++),a.push(i),t.defaultValue&&r.push(i)})}),this.safeUpdateCache(e,"picklistToIndexMapMetadata","picklist",i),this.safeUpdateCache(e,"picklistToIndexMapMetadata","value",o),this.safeUpdateCache(e,"compressedRecordTypeMetadata",r.id,u)},persistCache:function(e){e.persistBatchCache("sessionStorage")},safeUpdateCache:function(e,t,a,r){var n=e.getCacheProperty(t,"sessionStorage")||{};n[a]=r,e.batchCacheProperty(t,n,"sessionStorage")},clear:function(e){delete e._decompressedRecordTypeMetadata,e.clearPropertiesCache()}};var Ie=function(e,t,a){return y.isApiEnabled()&&!a[g]&&t&&t.length?v.when.all(v.map(t,function(t){var r=Ce.getRecordTypeMetadata(a,e,t);return r?{metadata:r,id:t}:fe(a,e,t).then(function(r){var n={metadata:r,id:t};return Ce.storeRecordTypeMetadata(a,e,n),{metadata:Ce.getRecordTypeMetadata(a,e,t),id:t}})})).then(function(e){Ce.persistCache(a);var t={};return v.each(e,function(e,a){t[a.id]=a.metadata}),t}).catch(function(){}):y.resolve()};function Ne(e){var t=y.runningTests()?null:j[e];return t||((t=y.sessionStorage(e))?(t=JSON.parse(t),j[e]=t,t):null)}function Te(e,t){j[e]=t,t&&!t.__isFailure&&y.sessionStorage(e,JSON.stringify(t))}function Re(t,a){var r=t.__uid,n=r===Ae()||r===function(e){if(e){var t=e.authentication,a=!!t&&t.responseBody;return a||(a=t.responseBody=e.getStoredAuthData()),a?a.access_token:void 0}}(a),o=!t.modstamp||e.page.modstamp&&t.modstamp<e.page.modstamp,i=a&&a._metadataCacheVersion&&a._metadataCacheVersion>t.modstamp;return!n||o||i}function Ae(){return t||(t=function(e){var t,a,r=0;if(0===e.length)return r;for(t=0,a=e.length;t<a;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return r}(ae().sessionId)),t}function Fe(t,a){if(!t)return!1;var r=(new Date).getTime();r<e.page.modstamp&&(r=e.page.modstamp),t.modstamp=r,t.__uid=Ae()||y.grab(a,"authentication","responseBody","access_token")}function Ee(t,a,r,n){var o=n&&n.dataSource||e.dataSource.get(s);return Ie(t,r,o).then(function(e){if(e){var t={},n=[];return v.each(r,function(r,o){var i=e[o]&&e[o][a];i&&v.each(i,function(e,a){t[a.value]||(n.push(a),t[a.value]=!0)})}),n}})}function _e(e,t,a,r){var n,o=Ce.getRecordTypeMetadata(r,a,t);if(o)return(n=o[e.id])?C(n):e.metadata?e.metadata.picklistEntries:e.picklistEntries}function we(e){var t=Me(e);return t||je(e),(t=Me(e))&&t.recordTypeId}function Me(e){return e._defaultRecordType||je(e),e._defaultRecordType}function je(e,t){var a,r,n=[];if(t||(t=v.map(e.conditions,function(e){if(!e.inactive)return e})),Pe(e)&&v.each(e.recordTypeInfos,function(){if(this.isDefaultRecordTypeMapping&&!this.isMaster)return a=this.recordTypeId,!1}),e.createable&&t&&v.each(t,function(e,t){!t.inactive&&t.field&&"RecordTypeId"===t.field&&t.value&&"null"!=t.value&&t.value.length>=15&&(a=t.value,n.unshift(e))}),a){var o=a.substring(0,15);v.each(e.recordTypeInfos,function(){if(this.recordTypeId.substring(0,15)===o)return r=this,a=this.recordTypeId,!1})}return e._defaultRecordType=r,n.length&&v.each(n,function(){t.splice(this,1)}),r}function Pe(e){return e.recordTypeInfos&&e.recordTypeInfos.length>1}function Oe(e){var t=e.metadata||e,a=t&&t.picklistEntries;return!!(t.overrideMetadata&&a&&a.length&&t.customPicklistEntriesProvided)}function xe(e,t){var a=e.metadata||e;return Pe(t)&&!!k[a.displaytype]&&!Oe(e)&&!a.uiOnly}function ke(t,a,r,n,o){o||(o={});var i=e.ui.getFieldRenderer(t),s=r.model,c=r.row,l=r.metadata,u=s.getDataSource(),f=r.row&&(c.RecordTypeId||c.RecordType&&c.RecordType.Id),p=!!o.picklistEntries,m=Pe(s)&&f,h=Oe(r);if(l.uiOnly||p||u[g]||h||!m||function(e,t,a){var r=Ce.getRecordTypeMetadata(e,t,a);return!(!r||!y.size(r))}(s.dataSource,s.objectName,f))return i[a](r,n,o);e.ui.fieldRenderers[d].read(r,e.$L("loading")),J(r).then(function(t){r.render({picklistEntries:t}),e.events.publish("salesforce.async.field.rendered",[r])}).catch(function(){r.render()})}function Le(e){return{read:function(t,a,r){return ke(e,"read",t,a,r)},readonly:function(t,a,r){return ke(e,"readonly",t,a,r)},edit:function(t,a,r){return ke(e,"edit",t,a,r)}}}function De(e){var t=v.Deferred(),a='<?xml version="1.0" encoding="utf-8"?><env:Envelope xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><env:Header><urn:SessionHeader xmlns:urn="http://soap.sforce.com/2006/04/metadata"><urn:sessionId>'+sforce.connection.sessionId+"</urn:sessionId></urn:SessionHeader></env:Header><env:Body>"+e.body+"</env:Body></env:Envelope>";return e.dataSource.name!==s?I.deferrable():(v.ajax({type:"POST",url:"/services/Soap/m/40.0",beforeSend:function(e){e.setRequestHeader("SOAPAction",'""'),e.setRequestHeader("Content-Type","text/xml")},data:a}).done(function(e,a,r){var n="",o=y.makeXMLDoc(r.responseText),i=o.find("errors"),s=o.find("result"),c={};i.length&&v.each(i,function(){n+=v(this).children("message").text()+"\n"}),n?t.reject(n):(v.each(s.children(),function(e,t){t=v(t),c[t.prop("tagName")]=t.text()}),t.resolve(c))}).fail(function(e,a,r){t.reject(r.status)}),t.promise())}new e.dataSource.DataSourceType({name:s,prefillMetadataForObject:function(e){Q(e.data)},getNameField:le,getIdField:de,getIdFieldForChildRelationship:function(){return"Id"},getKeyPrefix:function(e,t){return t.keyPrefix},getValueKeyPrefix:function(e){return e.substring(0,3)},getRowId:function(e,t){return t.getFieldValue(e,"Id",!0)},getRowName:function(e,t){return t.getFieldValue(e,le(t.objectName),!0)},getValidPicklistEntries:J,getValidPicklistEntriesSync:function(e){var t=e.row,a=e.model.getDataSource(),r=e.model.objectName,n=t&&(t.RecordTypeId||t.RecordType&&t.RecordType.Id);return G(e,Oe(e)?e.metadata.picklistEntries:_e(e,n,r,a)||e.metadata.picklistEntries)},save:function(e,t){var a=t.dataSource,r=a.getCacheProperty(p);return r||(r=m,a.setPersistentCacheProperty(p,r)),a.authenticate().then(function(){return te(a).save(ue(e,r)).then(function(e){return e},function(t){if(t&&t.indexOf("Invalid Skuid Save request - could not deserialize JSON into valid Save Request")>-1){var n=r>=2?1:2;return te(a).save(ue(e,n)).then(function(e){return a.setPersistentCacheProperty(p,n),e})}return t})})},makeMetadataApiRequest:De,checkMetadataApiAccess:function(e){return te(e).checkMetadataApiAccess()},addRemoteSiteSetting:function(e){var t=e.dataSource,a=e.url,r=e.name||a.substring(a.indexOf("://")+3).replace(/[\W]+/g,""),n='<createMetadata><metadata xsi:type="RemoteSiteSetting"><fullName>'+(r.length>40?r.substring(0,40):r)+"</fullName><description>"+e.description+"</description><disableProtocolSecurity>false</disableProtocolSecurity><isActive>true</isActive><url>"+a+"</url></metadata></createMetadata>";return t.name!==s?I.deferrable():De({dataSource:t,body:n})},fieldRenderers:function(){return{PICKLIST:Le(f),MULTIPICKLIST:Le(l)}},onSelectEntity:function(e,t,a,r){var n=e,o=r.getCachedEntityMetadata(n).getField("RecordTypeId"),i=a.state.children("fields").empty();o&&i.append(A('<field id="RecordTypeId"/>'))},load:function(t,a){var r,n=a.dataSource;return n.authenticate().then(function(){var e,a=["conditionLogic","doQuery","forView","groupByMethod","havingLogic","id","objectName","orderByClause","offsetPageNumber","offsetPageSize","offsetSize","queryAllRows","recordsLimit","type"],r=v.map(t,function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&v.inArray(r,a)>-1&&(t[r]=e[r]);return v.each(["fields","groupByFields"],function(a,r){var n,o=e[r];o&&o.length&&(n=t[r]=[],v.each(o,function(e,t){var a;t.uiOnly?a=t:"childRelationship"===t.type?(a={id:t.id,type:t.type},v.each(["recordsLimit","orderByClause","subConditionLogic"],function(e,r){t.hasOwnProperty(r)&&null!==t[r]&&void 0!==t[r]&&(a[r]=t[r])}),t.subConditions&&(a.subConditions=[],t.subConditions.length&&v.each(t.subConditions,function(e,t){var r={};for(var n in t)t.hasOwnProperty(n)&&null!==t[n]&&void 0!==t[n]&&(r[n]=t[n]);a.subConditions.push(r)})),t.subFields&&(a.subFields=[],t.subFields.length&&v.each(t.subFields,function(e,r){var n={id:r.id};void 0!==t.query&&null!==t.query&&(n.query=n.query),a.subFields.push(n)}))):(a={id:t.id},v.each(["name","function","query","convertToUserTimezone"],function(e,r){t.hasOwnProperty(r)&&null!==t[r]&&(a[r]=t[r])})),n.push(a)}))}),v.each(["conditions","havings"],function(a,r){var n,o=e[r];o&&o.length&&(n=t[r]=[],v.each(o,function(e,t){var a=v.extend({},t);for(var r in a)null===a[r]&&delete a[r];n.push(a)}))}),t}),o=function(e,t,a){var r,n;if(!a._metadataCacheVersion||0===a._metadataCacheVersion){for(r=0;r<t.length;r++)if(!t[r].hasMetadataLoaded())return!1;return!0}for(r=0;r<e.length;r++){var o=e[r],i=t[r],s={};if(!i.hasMetadataLoaded()){if(!(a.entityMetadataCache[o.objectName]&&a.entityMetadataCache[o.objectName]._m&&a.entityMetadataCache[o.objectName]._m.fields))return!1;var c=a.entityMetadataCache[o.objectName]._m.fields;for(v.each(c,function(e,t){t.rel&&t.referenceTo&&(s[t.rel]={fieldFrom:t.id,entityAssociated:t.referenceTo[0].o?t.referenceTo[0].o:t.referenceTo[0].objectname}),s[t.id]=c[e]}),n=0;n<o.fields.length;n++){var l=o.fields[n];if(-1!==l.id.indexOf(".")){var d=$(l.id),u=a.entityMetadataCache[o.objectName],f=u&&d&&u.getField&&u.getField(d);if(f){var p=f.referenceTo;if(p&&1===p.length?u=a&&a.getCachedEntityMetadata(p[0].objectName||p[0].o):p&&p.length>1&&(u=a&&a.getCachedEntityMetadata("Name")),!u)return!1}}else if(!s[l.id])return!1}i.setMetadataHasLoaded()}}return!0}(r,t,n);return e=o?{operationModels:r,options:{excludeMetadata:o}}:r,te(n).load(e)}).then(function(e){var t;if(v.isArray(e))return e;if(e&&e.models)return(t=e.metadata)&&y.size(t)&&v.each(t,function(e,t){n.cacheEntityMetadata(e,t)}),e.models;throw"Invalid Response Format"}).then(function(t){return r=t,function(t,a){var r,n={};return v.each(t,function(t,a){if(!a.data||!a.data.length){var r=e.$M(a.id);if(r&&r.createRowIfNoneFound||a.createRowIfNoneFound){var o=we(a);o&&(n[a.objectName]||(n[a.objectName]={}),n[a.objectName][o]=!0)}}}),r=v.map(n,function(e,t){var r=v.map(e,function(e,t){return t});return Ie(t,r,a)}),v.when.all(r)}(t,n)}).then(function(){return r})},getUserInfo:function(t){var a,r=t.authentication,n=r&&r.responseBody;return t.name===s&&y.inPlatform([c,o])?_(ae()):(n&&(a=n.id),n&&a?(a=(a=a.replace("https://","")).substring(a.indexOf("/")),e.ajax.proxy(t.createHTTPRequest({url:y.combineUrls(t.serviceUrl,a),method:"GET",contentType:"application/json"})).then(function(e){var t=y.parseAsJSONIfString(e.body);return{email:t.email,firstName:t.first_name,lastName:t.last_name,name:t.display_name,userId:t.user_id,userName:t.username}})):_())},getUserInfoProperties:function(){return[{label:"First Name",value:"firstname"},{label:"Last Name",value:"lastname"},{label:"Email",value:"email"},{label:"Full Name",value:"name"},{label:"User Id",value:"userid",defaultValue:!0},{label:"User Name",value:"username"}]},getActions:function(e){return pe(he("",{isStandard:!0}),e).then(function(e){return function(t,a,r){var n,o,i=(e&&e.actions||[]).filter(function(e){return"submit"!=e.name||(n=ge(t,a,r,e.name,{isStandard:!0,label:e.label}),!1)}).map(function(e){return ge(t,a,r,e.name,{isStandard:!0,label:e.label})});return[{label:"Standard",value:"-",disabled:!0}].concat(i).concat([{label:"",value:"-",disabled:!0},{label:"Custom",value:"-",disabled:!0},ge(t,a,r,"apex"),ge(t,a,r,"flow"),ge(t,a,r,"emailAlert",{needSObject:!0}),ge(t,a,r,"quickAction",{needSObject:!0}),{label:"",value:"-",disabled:!0},{label:"Approvals",value:"-",disabled:!0},n]).concat([{name:"approvals-approve",label:"Approve",builderProps:(o=[{label:"Work Item Id",id:"workitemid",type:"template",location:"attribute",displayAs:"input",helptext:"The Id of the Salesforce ProcessInstanceWorkItem on which the action is being performed."},{label:"Comments",id:"comments",type:"template",location:"attribute",displayAs:"input",helptext:"(Optional) Adds comments to the approval history for this action."}]).concat([{label:"Next Approver Id",id:"nextapproverid",type:"template",location:"attribute",displayAs:"input",helptext:"(Optional) The user Id of the next approver. This property only applies if the next approval step allows users to manually choose a next approver."}]),runtimeExecution:be("Approve")},{name:"approvals-reject",label:"Reject",builderProps:o,runtimeExecution:be("Reject")},{name:"approvals-recall",label:"Recall",builderProps:o,runtimeExecution:be("Removed")},{name:"approvals-unlock",label:"Unlock Record",builderProps:[{label:"Record Id",id:"recordid",type:"template",location:"attribute",displayAs:"input",helptext:"Id of the record to unlock."}],runtimeExecution:ve}])}})},getEntityList:function(e){var t=y.sObjectList,a=e.dataSource;return a.name===s&&t?v.Deferred().resolve(t).promise():a.authenticate().then(function(){return te(a).getEntityList()})},handleDefaultReferenceFieldValue:function(t,a,n,o,i){var c=o.rel,l=a.value,d=y.getNameField(o.ref),u=a.nameFieldValue||!1;if(u||"RecordType"!==o.ref||v.each(n.recordTypeInfos,function(){if(this.recordTypeId===l)return u=this.name,!1}),!u){if(a.model){var f=e.$M(a.model),p=f.getDataSourceType().name===s;f&&f.data.length&&v.each(f.data,function(e,t){if(l===f.getRowId(t)||p&&l===t.Id15){var a=f.getRecordForRow(t);return u=a?a.get():t,!1}})}if(!u){var m=y.getFieldReference(a.field,o);v.each(i,function(e,t){t===a||t.field!==m||t.inactive||!t.value||a.operator&&"="!==a.operator||(u=t.value)})}}var h,g={};u&&("object"===(void 0===u?"undefined":r(u))?h=u:(h={})[d]=u,g[c]=h);g[a.field]=l,n.updateRow(t,g)},coerceCreateRow:function(e,t,a){var r,n,o=t,i=e.row(),s={};i.Id=e.id(),je(t,a),r=we(t),n=Me(t);var c=y.grab(t,"fieldsMap","RecordTypeId");c&&c.overrideMetadata&&!y.isUndefined(c.defaultValue)||r&&(s.RecordTypeId=r,n&&(s.RecordType={Name:n.name}),o.updateRow(i,s,{preventSetActive:!0}))},coerceUpdateRows:function(e,t,a){a.preventTrackChanges||"Opportunity"===e.objectName&&v.each(t,function(t,a){var r=e.changes[t],n=r&&r.StageName,o=a.StageName,i=e.getField("StageName"),s=i&&i.fieldMappings;if(o&&s){var c=e.getField("Probability"),l=e.getField("ForecastCategoryName"),d=e.getField("ForecastCategory");if(n){var u=!1,f=!1,p=!1;v.each(s,function(e,t){t.MasterLabel===n&&("Probability"in r&&r.Probability!==t.DefaultProbability&&(u=!0),"ForecastCategoryName"in r&&r.ForecastCategoryName!==t.ForecastCategoryName&&(f=!0),"ForecastCategory"in r&&r.ForecastCategory!==t.ForecastCategoryName&&(p=!0))}),u&&f&&p||v.each(s,function(e,t){t.MasterLabel===o&&(c&&!u&&(a.Probability=t.DefaultProbability),l&&!f&&(a.ForecastCategoryName=t.ForecastCategoryName),d&&!p&&(a.ForecastCategory=t.ForecastCategoryName))})}else r?v.each(s,function(e,t){t.MasterLabel===o&&(c&&!r.Probability&&(a.Probability=t.DefaultProbability),l&&!r.ForecastCategoryName&&(a.ForecastCategoryName=t.ForecastCategoryName),d&&!r.ForecastCategory&&(a.ForecastCategory=t.ForecastCategoryName))}):v.each(s,function(e,t){t.MasterLabel===o&&(c&&(a.Probability=t.DefaultProbability),l&&(a.ForecastCategoryName=t.ForecastCategoryName),d&&(a.ForecastCategory=t.ForecastCategoryName))})}})},coerceMassUpdate:function(e){"Opportunity"===e.objectName&&(e.getField("StageName")&&v.each(["ForecastCategory","ForecastCategoryName","Probability"],function(t,a){var r=e.getField(a);r&&(r.needsEditor=!0)}))},coerceDefaultValue:function(e,t){var a,r,n,o=e.displaytype,i=we(t);return xe(e,t)&&(n=_e(e,i,t.objectName,t.getDataSource()))&&n.length&&(v.each(n,function(e,t){if(t.defaultValue&&"false"!==t.defaultValue)return a=t.value,!1}),a&&0!==a&&"null"!=a&&(o===u&&(a=!0===a||"true"===a),r=a)),r},determineIfCreateRowNeedsMetadata:function(e){for(var t=e.fields,a=0;a<t.length;a++)if(xe(t[a],e))return!0},loadDefaultValueMetadata:function(e,t){if(xe(e,t)){var a=we(t);return this.getMetadataForRecordTypes(t.objectName,[a],t.dataSource)}return v.when()},getReferenceFieldNameFromRelationshipField:$,getReferenceFieldRelationshipName:X,isRelationshipField:function(e){return y.contains(e,".")},getReferenceFieldRelatedData:function(t,a,r,n,o){var i,s=t.id,c=X(s);if(void 0===o[c]){if(v.each(n.data,function(){if(this[s]&&(this[s]===a||this[s].length&&this[s].length>=15&&this[s].substr(0,15)===a)&&n.getFieldValue(this,c))return i=n.getFieldValue(this,c,!0),!1}),!i){var l=t.referenceTo,d=[],u=[];l&&l.length&&v.each(l,function(){d.push(this.keyPrefix),u.push(this.objectName)}),d.length>1&&a.length>=15&&(d=[a.substring(0,3)]),v.each(d,function(t,r){v.each(e.model.getModelsByKeyPrefix(r)||[],function(){var e=this;if(e.data&&e.data.forEach(function(t){if(e.getRowId(t)===a||t.Id15&&t.Id15===a){var r=e.getRecordForRow(t);return i=r?r.get():t,!1}}),i)return!1})})}if(!i){var f=n.dataSource&&n.dataSource.name;v.each(e.model.getModelsByDataSource(f),function(){var e=this,t=[];if(e!==n)return v.each(this.fields,function(){var e=this,a=e.referenceTo;a&&a.length&&v.each(u,function(r,n){v.each(a,function(){n===this.objectName&&t.push(e)})})}),t.length&&v.each(e.getRows(),function(){var r=this;if(v.each(t,function(){if(e.getFieldValue(r,this.id,!0)===a)return i=e.getFieldValue(r,this.rel,!0),!1}),i)return!1}),!i&&void 0})}return i}},search:function(e){var t=e.dataSource;return delete e.dataSource,te(t).doSearch(e).then(function(a){return a.results&&a.results.forEach(function(t,a){t.objectMapKey=e.returning[a].objectMapKey,t.modelName=e.returning[a].modelName}),e.dataSource=t,a.request=e,a})},buildEntityMetadataRequest:function(e){var t=e.targetEntity;return!t&&e.model&&e.model.attr&&(t=e.model.attr("sobject")),{objectName:t}},clientSideCacheIsEnabled:function(e){return!(!e._metadataCacheVersion||0==e._metadataCacheVersion||null==e._metadataCacheVersion)},dataSourceProvidesLanguageDetails:function(){return ae().language},getEntityMetadataLoadingMessageFromBreadcrumb:function(e){return"Loading metadata for object "+e.endsobject+"..."},getEntityMetadataCacheKey:function(e){return e.objectName},getEntityMetadata:function(e){var t=v.Deferred(),a=e.entities,r=e.dataSource,n=e.ignoreMetadataOverrides?"true":"false";return a?r.authenticate().then(function(){var e=[];v.each(a,function(t,a){var o=v.Deferred(),i=T(a)?a:a.objectName,s={sObjectName:i,loadChildRelationships:"true",loadPicklistValues:"false",ignoreMetadataOverrides:n};if(e.push(o.promise()),!i)return o.reject("Error: no Salesforce Object Name was specified for Model."),!0;a&&a.fields&&a.fields.length&&(s.fieldsToLoad=a.fields.join(","),v.isPlainObject(a.fields[0])&&(s.fieldsToLoad=a.fields.map(function(e){return e.id}).join(","))),te(r).getModelMetadata(s).then(function(e){e?e instanceof Array&&e.length?o.resolve(v.map(e,function(e){return Q(e),e})):(Q(e),o.resolve(e)):o.resolve(e)},function(e){o.reject("There was an error retrieving metadata for object: "+i+": "+e)})}),v.when.all(e).then(function(e){t.resolve(e)},function(e){t.reject(e&&e.length?e.join(","):"")})},function(e){t.reject("Unable to authenticate to Salesforce. Metadata could not be retrieved. "+e)}):t.reject("No SObject provided."),t.promise()},getGroupingMethodsPicklistEntries:function(){return[{value:"simple",label:"Simple"},{value:"rollup",label:"Rollup"}]},getImageSources:function(t){var r={attachment:{label:"Attachment",needsRecordContext:!0,needsFieldContext:!0,relatedObjectName:"skuid__Image__c",automaticFieldMappings:{Attachment:!0,skuid__Image__c:!0},getSrc:oe}};return t&&t.name===s&&(r.staticresource={label:"Static Resource",builderProps:function(t,r,n){var o=n.additionalOnRefresh,i=n.additionalOnRebuildAndRefresh,s=n.prefix||"",c=[],l=s+"resource",d=s+"resourceContentType",u=s+"path",f={},p=!0;return f[l]="{{#NamespacePrefix}}{{{NamespacePrefix}}}__{{/NamespacePrefix}}{{{Name}}}",f[d]="{{{ContentType}}}",r.attr(d)&&(p=r.attr(d)===a.MIME_TYPES.ZIP),c.push(e.platform.builder.getStaticResourceProperty({id:l,valueTemplates:f,onChange:function(){r.attr(u)&&(r.removeAttr(u),t.save()),t.refresh().rebuildProps(),i&&i()}})),r.attr(l)&&p&&c.push(e.platform.builder.getNestedPathProperty({id:u,state:r,nameProperty:l,namespaceProperty:l,onChange:function(){t.refresh(),o&&o()}})),c},getSrc:function(e){var t,a,r=v.Deferred(),n=e.prefix||"",o=e.xmlDef&&e.xmlDef.attr(n+"resource"),i=e.xmlDef&&e.xmlDef.attr(n+"path"),s=e.context,c=e.mergeSettings;return i&&(i=y.mergeAsTextInContext(i,s,c)),o&&(o=y.mergeAsTextInContext(o,s,c))&&2===(a=o.split("__")).length&&(t=a[0],o=a[1]),o?r.resolve(y.getStaticResourceUrl(o,t,i)):r.reject("No Resource Provided"),r.promise()}}),r},getMetadataCacheVersion:function(){return x},getReferenceHandler:function(){return{getBaseReferenceProps:function(t){return[{id:"targetobjects",type:"sobject",label:"SObject Type",dataSourceName:e.dataSource.getDataSourceFromXML(t.state).name}]},getOverrideBatchProperties:function(){return[{type:"helptext",html:"Specify fields that will be added as related data. Any fields that are used in search or display templates will need to be added here."}]},getOverrideBatchNoItemsFunction:function(){return function(){return v("<div>").text("(Loading key field only.)")}},getOverrideBatchFieldChildrenFunction:function(e){return function(){return[{id:"batchfield",indent:1,linkedComponent:e,addtooltip:"Add New Batch Load Field",labelFunction:function(e){return e.attr("field")||"[No Field Selected]"},defaultStateFunction:function(){return A("<batchfield/>")},propsFunction:function(t){return[{id:"field",type:"field",label:"Field",sobject:e.state.attr("targetobjects"),dataSourceName:e.state.attr("datasource"),onChange:function(){t.refresh().rebuildProps()}}]}}]}},getMetadataHandler:function(t,a,r,n,o){var s,c=t.children("batchfields").first().children("batchfield"),l=t.attr("keyfield")||"Id",d=t.attr("targetobjects"),u=t.attr("ogdisplaytype"),f=t.attr("rel")||n+"__r";if(a.keyField=l,a.originalDisplayType=u,d&&(s=d.split(","),a.isNamePointing=s.length>1,(o||u&&u!==i)&&(a.relationshipName=a.rel=f),a.referenceTo=v.map(s,function(e){return{accessible:!0,objectName:e}}),a.ref=d),!o&&u&&u!==i){var p=e.dataSource.getDataSourceFromXML(t),m=new e.model.Model({dataSource:p});m.id="_ReferenceLabelModel_"+(new Date).getTime()+f,c&&c.length?m.fields=v.map(c,function(e){return{id:v(e).attr("field")}}):m.fields=[{id:l}],m.doQuery=!0,m.doClone=!1,m.objectName=d,m.initialize();var h=new e.model.Condition;h.name="__reference_batch",h.operator="in",m.addCondition(h),r.batchLabelModels||(r.batchLabelModels={}),r.batchLabelModels[n]=m}},getReferenceValue:function(e,t){return e[t.keyField||"Id"]},getRowFromReferenceValue:function(e,t,a){var r=e.getRows([{field:a.keyField||"Id",value:t}]);return r&&r.length?r[0]:{}},processReferenceLookupModel:function(e,t,a){e.objectName=a,"OwnerId"===t.id&&"Group"===a&&e.addCondition({field:"Type",value:"Queue",inactive:!1}),"recordtype"==a.toLowerCase()&&(e.rTypeFor=t.model.objectName,e.addCondition({field:"SObjectType",value:e.rTypeFor,inactive:!1,type:"fieldvalue"}))}}},getUploadMethods:function(){var t,a=65e4,r={id:"autorefreshmodels",type:"boolean",label:"Auto-refresh related Models on successful upload",defaultValue:!0,helptext:"If true, then upon successful file upload, Skuid will automatically attempt to find related Models that are displaying File data, and Skuid will cancel changes in these Models and then re-query them."};function n(e,t,r,n,o,i){e.size<a?function(e,t,a,r,n){var o=a.uploadMethod.dataSource;y.readFileAsBase64(e).then(function(i){var s,c,l,d,u,f=[],p={},m={},h={},g=t.model,b=t.row,y=t.options.xmlDef,S=y&&y.attr("owneridfield")||"",C=b&&g?g.getRowId(b):null,I=b&&S&&b[S]?b[S]:"";p.id="imageAttachmentUpload",p.type="Attachment",m.id="imageImageInsert",m.type="skuid__Image__c",h.id="updateObject",h.type=g.objectName,c=a.description?N(a.description,{row:b,model:g},{createFields:!1}):"",d=a.filename?N(a.filename,{row:b,model:g},{createFields:!1}):e.name,l=t.fieldValue,s=t.fileId,"field"===a.storeAs?s&&l?(m.id="imageImageUpdate",m.updates={},m.updates[l]={Name:d},p.deletes={},p.deletes[s]={Id:s},p.inserts={1:{ParentId:l,Body:i,Name:d,ContentType:e.type,Description:c}},f.push(p,m),u="AttachmentUpdate"):l?(m.id="imageImageUpdate",m.updates={},m.updates[l]={Name:d},p.inserts={1:{ParentId:l,Body:i,Name:d,ContentType:e.type,Description:c}},f.push(p,m),u="CreateAttachmentToImage"):(m.inserts={1:{}},p.inserts={2:{ParentId:"1",Body:i,Name:d,ContentType:e.type,Description:c}},h.updates={},h.updates[C]={},h.updates[C][t.fieldName]="1",f.push(m,p,h),u="CreateFileAndAttachment"):"record"===a.storeAs&&(p.inserts={1:{ParentId:C,Body:i,Name:d,ContentType:e.type,Description:c}},I&&(p.inserts[1].OwnerId=I),f.push(p),u="CreateAttachment"),r({fileName:d}),te(o).save(JSON.stringify({operations:f,rollbackOnAnyError:!0})).then(function(e){var a,r,o,i,s,c=e.insertResults,l=t.fieldValue;"AttachmentUpdate"===u?(s=ne(e,1,1,1)).success?(a=c[0].id,r=l):(i="Failure Updating Attachment",o=s.errors):"CreateAttachmentToImage"===u?(s=ne(e,1,1,0)).success?(a=c[0].id,r=l):(i="Failure Creating Attachment",o=s.errors):"CreateAttachment"===u?(s=ne(e,1,0,0)).success?a=c[0].id:(i="Failure Creating Attachment",o=s.errors):"CreateFileAndAttachment"===u&&((s=ne(e,2,1,0)).success?(a=c[1].id,r=c[0].id):(i="Failure Creating File and Attachment",o=s.errors)),i&&o&&o.length&&(i+=": "+v.map(o,function(e){return e.message}).join(", ")),n({newFileId:a,newFieldValue:r,newFileName:d,message:i})},function(e){n({message:e&&e.error})})},function(e){n(e)})}(e,t,r,n,o):se(e,t,r,n,o,i)}function o(e,t,a,r){var n=e.model.objectName,o=e.row.Id,i=this.dataSource,s=e.model.getFieldValue(e.row,t),c={id:"objdelete",updates:{},type:n},l={id:"imagedelete",deletes:{},type:"skuid__Image__c"},d=o;c.updates[d]={},c.updates[d][t]="",l.deletes[s]={},a(),te(i).save(JSON.stringify({operations:[c,l]})).then(function(){r()},function(e){r({message:e})})}function i(t,a,r,n,o){var i=t.row.Id,c=a.attr("id");return this.dataSource.name===s?(e.page.runningOnForceSite?e.page.currentSiteUrl:"/")+"apex/UploadImage?id="+i+(r?"&objfield="+r:"")+"&elid="+c+(n?"&desc="+n:"")+(o?"&filename="+o:""):""}function c(){return this.dataSource.name===s}return t={record:{label:"In Attachment to Record",relatedObjectName:"Attachment",needsRecordContext:!0,forceStoreAsFileName:!0,upload:n,getSrc:oe,deleteFile:o,supportsIframeUpload:c,getIframeSrc:i,builderProps:[{id:"owneridfield",helpText:"If left blank, owner of record will be creator of attachment",type:"field",addFieldToModel:!0,label:"Custom Owner Id Field",modelprop:"model"}]},chatterfeed:{label:"In Chatter Feed Item",relatedObjectName:"ContentVersion",needsRecordContext:!0,upload:se,builderProps:[{id:"feedtext",type:"text",label:"Feed Text"}]},field:{label:"In Field on Record",needsRecordContext:!0,needsFieldContext:!0,upload:n,getSrc:oe,deleteFile:o,supportsIframeUpload:c,getIframeSrc:i,getFileIdField:function(e){return e.substr(0,e.length-1)+"r"+".skuid__AttachmentId__c"},getFileNameField:function(e){return e.substr(0,e.length-1)+"r"+".Name"}},chatterfiles:{label:"In Chatter Files",relatedObjectName:"ContentVersion",upload:se},contentdocument:{label:"In Content Document",relatedObjectName:"ContentVersion",upload:se},contentdocumentwithrecord:{label:"In Content Document (with Record Context)",relatedObjectName:"ContentVersion",needsRecordContext:!0,upload:se},staticresource:{label:"In Static Resource",canRunPostUploadSnippet:!0,upload:ce,hideInBuilder:!0}},v.each(t,function(e,t){if(t.relatedObjectName){var a=t.builderProps;a||(a=t.builderProps=[]),a.push(r)}}),t},getDefaultFieldsForReferenceField:function(e,t,a){var r,n=t.referenceTo[0].objectName,o=[];return r=t.referenceTo.length<2?y.getFieldReference(e,t,a):y.getFieldRelationshipName(e,t)+".Name",o.push(r),"skuid__Image__c"===n&&o.push(y.getFieldRelationshipName(e,t)+".skuid__AttachmentId__c"),o},getNameFieldURLForReferenceField:function(t,a,r){var n,o,i=t.options.fieldXML,s=i&&i.attr("redirecttype")||"datasourcedefault",c=e.dataSource.DataSourceType.prototype.getNameFieldURLForReferenceField;return"datasourcedefault"!==s?c(t,a,r):D(t.model)&&a&&a.length?(o='<a href="',n=a.substring(0,3),B(t),W()?(o+=V(a,t.metadata.referenceTo.find(function(e){return e.keyPrefix===n}).objectName),H(t,a)):U()?(o+=y.getSafeRelativeUrl("/"+a),Y(t,a)):z()?(o+=y.getSafeRelativeUrl("/"+a),function(t,a){q(t,function(){e.ui.openConsoleTabForField(t._GUID,t.model.id,a)})}(t,a)):o+=y.getSafeRelativeUrl("/"+a),o+='" tabindex="-1">'+r+"</a>"):void 0},getNameFieldURLForTextField:function(t,a,r){var n,o,i,s=t.metadata,c=t.model,l=r,d=t.row,u=c.getRowId(d),f=s&&"URL"===s.displaytype,p=W(),m=U(),h=z(),g=a;return B(t),!t.options.noLink&&!c.isSingleRow()&&D(c)&&y.userInfo.isAuthenticated&&(s&&s.nameField||["FirstName","LastName","Company"].includes(t.id))&&!c.isNewRow(d)&&-1===t.id.indexOf(".")?(g=l,l='<a href="',p?(l+=V(u,c.objectName),H(t,u)):m?(l+=y.getSafeRelativeUrl("/"+u),Y(t,u)):h?(l+=y.getSafeRelativeUrl("/"+u),q(t,function(){e.ui.openConsoleTabForNameField(u,c.id)})):l+=y.getSafeRelativeUrl("/"+u),l+'">'+E(g)+"</a>"):f?(n=l&&w(l,"/"),i=E(g),o=E(l),n&&q(t,function(){p?window.$A.get("e.force:navigateToURL").setParams({url:g}).fire():m?sforce.one.navigateToURL(g):h&&e.ui.openConsoleTabForUrl(g,i)}),'<a href="'+i+'"'+(n?"":' target="blank"')+">"+o+"</a>"):void 0},coerceStartingPageSize:function(e){e.recordsLimit>2e3?e.offsetPageSize=2e3:e.offsetPageSize=e.recordsLimit||100},getModelProperties:function(t,a,r){var n=this,o=e.builder.core,i=t.state,c=function(){return(i.attr("datasource")||i.attr("service")||s)===s},l=o.getUnsavedChangesWarningProperty({component:t}),d=o.getCoreModelBasicProperties({component:t,propViewer:a}),u=[];return d.push({id:"sobject",type:"sobject",dataSourceTypeName:this.name,dataSourceName:i.attr("datasource")||i.attr("service"),label:"Salesforce Object Name",onChange:function(a,o){n.onSelectEntity(a,o,t,r),t.refresh(),e.mobile&&e.mobile.processResponsiveElements()}},o.getModelTypeProperty({component:t}),o.getModelQueryOnPageLoadProperty({component:t,propViewer:a})),c()&&"aggregate"!==i.attr("type")&&u.push({id:"doclone",type:"picklist",label:"Clone data returned by Model query",helptext:"Should all data returned by querying this Model be 'cloned', meaning that data in the Model will be marked as 'New' so that when the Model is saved, new records will be created, rather than updates made to existing records?",picklistEntries:[{label:"Yes, always",value:"yes"},{label:"Yes, if 'clone' and 'id' parameters are present in URL",value:""},{label:"No",value:"no"}],defaultValue:""}),u.push({id:"queryallrows",type:"boolean",label:"Query Deleted / Archived records",helptext:'For developers: adds the SOQL "ALL ROWS" clause to your query. If true, then deleted records and/or archived Tasks will be included in your Model\'s query --- by default, they are not.'},{id:"forview",type:"boolean",label:'Update Salesforce "Recently Viewed" info',helptext:"For developers: adds the SOQL \"FOR VIEW\" clause to your query. Use this if you want this Model to feed into Salesforce's tracking of Recently Viewed Items. When this Model's query is run, the LastViewedDate for all records in this Model will be updated, and new records will be added to the RecentlyViewed object. "}),c()?(e.offline.isEnabled()||u.push({id:"processonclient",type:"boolean",defaultValue:o.pageModel.getFieldValue(o.pageRow,"skuid__MasterPage__c")&&"true"===o.getMasterPageXML().attr("cachepage"),label:"Process Model client-side",onChange:function(){t.refresh().rebuildProps()},helptext:"If this page, or its master page, has Page Caching enabled, this is HIGHLY RECOMMENDED, unless you expect this Model's data to rarely change. Causes Skuid to construct this Model client-side in JavaScript rather than server-side, which prevents your Model metadata and data from being cached, which could result in stale / inaccurate metadata/data being presented to your users."}),"true"===i.attr("processonclient")&&d.push(o.getAsyncLoadProperty({component:t})),u.push({defaultValue:!1,id:"nativeuiautosync",type:"boolean",label:"Auto-sync with other Lightning Components",helptext:"If enabled, then when this Skuid Page is used in Lightning Experience or Salesforce1, Skuid will automatically update this Model's data when other Lightning Components are refreshed, and Skuid will automatically notify other components whenever this Model is saved."})):d.push(o.getAsyncLoadProperty({component:t})),d.push(o.getModelLimitProperty(),o.getModelOrderByProperty(),o.getCreateDefaultRowProperty()),l&&u.push(l),Array.prototype.push.apply(u,o.getModelLabelProperties()),[{name:"Basic",props:d},{name:"Advanced",props:u}]},getAggregateFieldProperties:function(t,a){var r=t.state,n=e.builder.core;return[{id:"function",type:"picklist",label:"Function",helptext:"The Aggregation function to use",defaultValue:"SUM",required:!0,picklistEntries:[{label:"COUNT",value:"COUNT"},{label:"COUNT DISTINCT",value:"COUNT_DISTINCT"},{label:"SUM",value:"SUM"},{label:"AVG",value:"AVG"},{label:"MAX",value:"MAX"},{label:"MIN",value:"MIN"}],onChange:function(e){e&&r.attr("name",n.getDefaultAliasName(r.attr("id"),e)),t.save().refresh().rebuildProps(a)}}]},getAggregateGroupingProperties:function(t,a,r){var o=t.state,i=e.builder.core,s=[];if(r){var c=r.displaytype;if(c&&(c===n.DATE||c===n.DATETIME)){var l=c===n.DATETIME,d=[];l||d.push({label:"--None--",value:"",abbrev:""}),d.push({label:"CALENDAR_MONTH",value:"CALENDAR_MONTH",abbrev:"cm"},{label:"CALENDAR_QUARTER",value:"CALENDAR_QUARTER",abbrev:"cq"},{label:"CALENDAR_YEAR",value:"CALENDAR_YEAR",abbrev:"cy"},{label:"DAY_IN_MONTH",value:"DAY_IN_MONTH",abbrev:"dm"},{label:"DAY_IN_WEEK",value:"DAY_IN_WEEK",abbrev:"dw"},{label:"DAY_IN_YEAR",value:"DAY_IN_YEAR",abbrev:"dy"}),l&&d.push({label:"DAY_ONLY",value:"DAY_ONLY",abbrev:"do"}),d.push({label:"FISCAL_MONTH",value:"FISCAL_MONTH",abbrev:"fm"},{label:"FISCAL_QUARTER",value:"FISCAL_QUARTER",abbrev:"fq"},{label:"FISCAL_YEAR",value:"FISCAL_YEAR",abbrev:"fy"},{label:"HOUR_IN_DAY",value:"HOUR_IN_DAY",abbrev:"hd"},{label:"WEEK_IN_MONTH",value:"WEEK_IN_MONTH",abbrev:"wm"},{label:"WEEK_IN_YEAR",value:"WEEK_IN_YEAR",abbrev:"wy"}),s.push({id:"function",type:"picklist",label:"Function",helptext:"The Date Function to use",defaultValue:l?"CALENDAR_YEAR":"",picklistEntries:d,onChange:function(e){var r=void 0;v.each(d,function(t,a){if(a.value==e)return r=a.abbrev,!1}),null!==r&&o.attr("name",i.getDefaultAliasName(o.attr("id"),r)),t.save().refresh().rebuildProps(a)}}),l&&s.push({id:"convertToUserTimezone",type:"boolean",label:"Convert to User Timezone",helptext:"Converts date/time values to the running user's time zone before grouping results. The default behavior is to group results based on UTC values.",defaultValue:!1})}}return s},processModelXMLExtensions:function(e,t){e.extensions={salesforce:{forView:"true"===t.attr("forview"),nativeUiAutoSync:"true"===t.attr("nativeuiautosync"),objectName:t.attr("sobject"),type:t.attr("type"),queryAllRows:"true"===t.attr("queryallrows")}}},isDataSourceNativeSalesforce:L,getMetadataForRecordTypes:Ie,getPicklistEntriesValidForRecordTypes:Ee,getAPIDescribeSObject:function(t){if(y.isApiEnabled()){var a="skuid_describeSObject_"+t,r=Ne(a),n=!1;if(r?(Re(r)&&(n=!0),(!r.modstamp||r.modstamp<e.page.modstamp)&&(n=!0)):n=!0,n)try{Fe(r=sforce.connection.describeSObject(t)),Te(a,r)}catch(e){r=null}return r}return!1},getAPIDescribeLayout:function(t){if(y.isApiEnabled()){var a="skuid_describeLayout_"+t,r=Ne(a),n=!1;if(r?(Re(r)&&(n=!0),(!r.modstamp||r.modstamp<e.page.modstamp)&&(n=!0)):n=!0,n)try{Fe(r=sforce.connection.describeLayout(t)),Te(a,r)}catch(e){r=null}return r}return!1},initialize:Q,initializeDataSource:function(t){t.name===s&&S(o)&&!t.serviceUrl&&(t.serviceUrl="https://"+e.settings.site("host"))},properties:{composer:{supports:{childRelationships:!0},canFieldsBeSelected:function(e){return!!e.breadcrumb.endsobject||"Select an SObject for this Model"}},canAutoGenerateConditionsFromFields:!0,validConditionTypes:["fieldvalue","multiple","modelmerge","blank","param","userinfo","datasourceuserinfo","join"],canConditionsBeGrouped:!0,hasGlobalSearchEntities:!0,batchableEntityRequests:!0,serverSideModelMerge:!0,offline:{createConditionsForConflicts:function(t){return[new e.model.Condition({encloseValueInParens:!0,encloseValueInQuotes:!0,field:"Id",inactive:!1,operator:"in",state:"filterableon",type:"multiple",values:v.map(t.updates,function(e,t){return t})})]}}},_recordTypeCacheStorage:Ce,_setMetadataCacheVersion:function(e){x=e}})}(skuid)}});