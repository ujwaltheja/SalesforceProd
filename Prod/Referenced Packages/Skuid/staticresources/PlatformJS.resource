"use strict";window.skuid||(window.skuid={}),function(a,b){function c(){return a.utils}function d(){return!!window.$A}function e(){return a.components&&a.components.config?a.components.config.navigation.apps:c().sfApps}function f(){!d()&&a.offline.isEnabled()?window.location.href="/?startURL="+encodeURI(window.location.href):window.location.reload()}function g(a){var c=b.Deferred(),d=!1,e=window.Visualforce,g=function(){d||(d=!0,window.confirm('You need to log in again, your session has expired.\n\nPress "OK" to go to the login page now.\n\nPress "Cancel" to remain on this page. Refresh your browser to go to the login page.')&&f())},h=function(){var a=b.Deferred(),c=setTimeout(a.reject,5e3),d=b('<iframe src="/apex/" width="0" height="0"/>').css("display","none").appendTo(document.body).load(function(){clearTimeout(c),d.remove(),a.resolve()});return a.promise()},i=function(a){var c=b.Deferred(),d=setTimeout(c.reject,5e3);return a.refresh(function(){clearTimeout(d),c.resolve()}),c.promise()};return a?(g(),c.reject()):function(){return h().then(function(){return b.when.all(b.map(e.remoting.Manager.providers,function(a){return i(a)}))})}().then(function(){c.resolve()},function(){g(),c.reject()}),c.promise()}function h(){return a.components&&a.components.config?a.components.config.navigation.tabs:c().sfTabs}function i(a){return b.map(a.tabs,function(b){var c=h()[b],d=a.url&&a.url.slice(-20);return d&&(d=-1===d.indexOf("tsid=")?"":(-1===c.url.indexOf("?")?"?":"&")+d),{label:c.label,link:c.url+d}})}function j(){var a,c=[],d=e(),f=h();return d&&f?(b.each(d,function(){if(this.isSelected)return a=this,!1}),a&&(c=i(a)),c):c}function k(a){var c=e();if(!c)return[];a||(a={});var d,f,g=[],h={},j=[],k=a.selectedAppFirst,l=a.withTabs;return b.each(c,function(a,b){if(k&&b.isSelected)f=b;else{var c=b.sortOrder;c>-1&&!h[c]?h[c]=b:j.push(b)}}),d=Object.keys(h),d.sort(function(a,b){return a-b}),f&&g.push(f),b.each(d,function(a,b){g.push(h[b])}),j.length&&g.concat(j),b.map(g,function(a){var b=l?i(a):null;return{label:a.label,link:a.url,items:b}})}function l(){return k({selectedAppFirst:!0})}function m(){return k({withTabs:!0})}function n(){return[{label:"My Profile",link:"/_ui/core/userprofile/UserProfilePage"},{label:"My Settings",link:"/ui/setup/Setup?setupid=PersonalSetup"},{label:"My Apps",link:null,items:l},{label:"Salesforce Setup",link:"/setup/forcecomHomepage.apexp?setupid=ForceCom"},{label:"Developer Console",link:"/_ui/common/apex/debug/ApexCSIPage",window:"blank"},{label:"Logout",link:"/secur/logout.jsp"}]}function o(a){return"/apex/skuid__PageBuilder?id="+a}function p(a,b){return"/apex/skuid__PageBuilder?pagename="+a+(b?"&pagemodule="+b:"")}function q(){return $}function r(c,e){var f="";return f=d()?"/skuid/ui.app?"+(a.mobile?"type=Mobile&":"")+"page=":"/apex/skuid__ui?page=",f+=c[Y.page.name],e&&(f+="&"+e.substring(b.inArray(e.charAt(0),["&","?"])>-1?1:0)),f}function s(){return window.location.pathname}function t(a){return"/apex/skuid__PageXMLEdit?id="+a[Y.page.id]}function u(){return["skuid__Layout__c","skuid__Layout2__c","skuid__Layout3__c","skuid__Layout4__c","skuid__Layout5__c"]}function v(){return 65e4}function w(){return d()?W:X}function x(){return!1}function y(){return window.location.origin+(d()?"/skuid/oauthproxy.app":"/apex/skuid__oauthproxy")}function z(a){var b=window.location.origin,e=a.customCallbackUrl;return d()?b+"/skuid/oauthcallback.app":!e||c().determineIfInSkuidNamespace()?b+"/apex/skuid__oauthcallback":c().combineUrls(b,e)}function A(){return[{value:"sftabs",label:"Salesforce Tabs for Current App",items:j},{value:"sfapps",label:"Salesforce Apps",items:l},{value:"sfappswithtabs",label:"Salesforce Apps with Tabs",items:m},{value:"sfusermenu",label:"Salesforce User Menu",items:n}]}function B(a){return Y[a]}function C(a,b){return Y[a][b]}function D(b){var e,f,g,h,i,j,k,l,m,n,o=a.page.sitePrefix||"",p=window.location.host,q={"css/themeBuilder":"ThemeBuilderCSS"};if(o&&!o.startsWith("/")&&(o="/"+o),c().isObject(b)){if(b.type&&"external"===b.type)return b.url||b.path;e=b.name||b.resource,h=b.namespace||b.ns,j=b.nestedPath||b.path,k=b.modstamp}else e=b;return e&&(f=e.split("/"),i=f.length,e=f.pop(),i>=4&&(f.shift(),f.shift(),g=f.map(c().capitalizeFirst).join("_")+"_"),e in q?e=q[e]:"dataSourceTypes"===f[0]&&c().endsWith(e,".js")?e=c().capitalizeFirst(e).replace(".js","DataSourceTypeJS"):e.match(/(\.js|\.css)$/i)&&(e=c().capitalizeFirst(e),e=e.replace(/\.js$/i,"JS").replace(/\.css$/i,"CSS"))),g||(g=""),d()?(l=window.$A.get("$Resource."+(h?h+"__":"")+g+e),j?c().combineUrls(l,j):l):(a.offline.networkDown()&&p.indexOf(".visual.force.com")>-1&&(n=c().getLocalVisualforceDomain(p),h&&(n=n.replace("--c","--"+h).replace("//c.","//"+h+".")),m=window.location.protocol+"//"+n),[m||"",o,"/resource/",k&&k+"/",h&&h+"__",g&&g+"_",e,j&&"/"+j].filter(function(a){return!!a}).join(""))}function E(a){return D(a)}function F(a,b){var d=a.split("/"),e=d.length,f=c().capitalizeFirst(d.pop())+("dataSourceTypes"===d[0]?"DataSourceType":"")+"TestsJS";return e>=3&&(d.shift(),f=d.map(c().capitalizeFirst).join("_")+"_"+f),D({name:f,namespace:"skuid",modstamp:b&&b[f]})}function G(){if(d())return c().resolve();var b=new a.model.Model(['<model datasource="salesforce" sobject="StaticResource" query="true" processonclient="true">',"<fields>",'<field id="SystemModstamp"/>','<field id="Name"/>',"</fields>","<conditions>",'<condition type="fieldvalue" field="Name" operator="ends with" value="TestsJS"/>','<condition type="fieldvalue" field="NamespacePrefix" operator="=" value="skuid"/>',"</conditions>","</model>"].join("")).initialize();return b.load().then(function(){var c={};return b.getRows().forEach(function(b){c[b.Name]=a.time.parseSFDateTime(b.SystemModstamp).getTime()}),c})}function H(a){return Z[a]}function I(a,b){Z[a]=b}function J(a){var b=a.split("__");return"$Label."+(2===b.length?b[0]+"."+b[1]:"c."+b[0])}function K(a){function c(){var b={},h=!1,i=[];if(a.forEach(function(a){var c=J(a),d=window.$A.get("{!"+c+"}");d?d===c+" does not exist."?(b[a]="",i.push(a)):b[a]=d:h||(h=!0)}),h)e>=f?d.reject("Could not find all requested labels."):(e++,setTimeout(c,g));else{if(i.length){var j=window.$A.get("e.force:showToast");j.setParams({title:"Skuid: Unable to retrieve labels",type:"error",message:"The following requested labels could not be retrieved: "+i.join(", ")}),j.fire()}d.resolve(b)}}var d=b.Deferred(),e=0,f=10,g=500;return a&&a.length&&(window.$A.get("{!"+a.map(J).join("}{!")+"}"),c()),d.promise()}function L(b){return a.remote.promisify.apply(null,[a.remote(),b].concat(Array.prototype.slice.call(arguments,1)))}function M(){return"/resource/skuid__IconsSVG/"}function N(){return"salesforce"}function O(){return"salesforce"}function P(a,b){var c=!1;return b.name===N()&&(a&&-1!==a.indexOf("Logged in?")?c=!0:a&&-1!==a.indexOf("Page not allowed for the profile")?c=!0:a&&-1!==a.indexOf("Remoting request invalid")&&(c=!0)),c}function Q(b){if("object"==typeof b){if(b instanceof a.model.Model)return"skuid.model.Model("+b.id+")";if(b instanceof a.component.Component)return"skuid.component.Component("+b.getId()+")";try{JSON.stringify(b)}catch(c){return"object could not be serialized to JSON"}}return b}function R(d,e){var f={};return a.$.each(e,function(a,g){var h,i,j=d?d.getParam(a):null;j&&(i=j.getDisplayType(),g=e[a],-1!=b.inArray(i,["DOUBLE","CURRENCY","PERCENT"])?h=parseFloat(g):"INTEGER"===i&&(h=parseInt(g,10))),f[a]=Q(c().isUndefined(h)?g:h)}),f}function S(c,e,f){if(d()){var g,h=window.$A.get("e."+c),i=f&&f.channel,j=window.$A.get("e.skuid:event"),k=a.events.get(c);e&&(g=R(k,b.extend({},e.length?e[0]:e))),h&&(g&&h.setParams(g),h.fire()),j.setParams({name:c,source:"skuid"}),g&&j.setParam("data",JSON.stringify(g)),i&&j.setParam("channel",i),j.fire()}}function T(){return!0}function U(){return!1}function V(b){return a.features&&a.features.hasOwnProperty(b)}var W="lightning",X="visualforce",Y={auth_provider:{auth_method:"skuid__Auth_Method__c",authorize_endpoint_url:"skuid__Authorize_Endpoint_URL__c",client_id:"skuid__Client_Id__c",client_secret:"skuid__Client_Secret__c",custom_callback_url:"skuid__Custom_Callback_URL__c",id:"Id",name:"Name",oauth_grant_type:"skuid__OAuth_Grant_Type__c",oauth_provider_type:"skuid__Type__c",request_headers:"skuid__Request_Headers__c",token_endpoint_url:"skuid__Token_Endpoint_URL__c",token_request_body_parameters:"skuid__Token_Request_Body_Parameters__c",default_scopes:"skuid__Default_Scopes__c"},auth_provider_credential:{id:"Id",auth_provider_id:"skuid__Auth_Provider__c",auth_provider_name:"Auth_Provider_Name__ui",user_id:"skuid__User__c",access_token:"skuid__Access_Token__c",access_token_issued:"skuid__Access_Token_Issued__c",access_token_expiration:"skuid__Access_Token_Expiration__c",refresh_token:"skuid__Refresh_Token__c"},data_source:{authentication:"skuid__Authentication__c",auth_request_body:"skuid__Auth_Request_Body__c",auth_request_body_content_type:"skuid__Auth_Request_Body_Content_Type__c",auth_request_headers:"skuid__Auth_Request_Headers__c",auth_request_verb:"skuid__Auth_Request_Verb__c",auth_url:"skuid__Authentication_URL__c",credential_source:"skuid__Credential_Source__c",id:"Id",is_active:"skuid__Active__c",name:"Name",password:"skuid__Password__c",request_body_parameters:"skuid__Request_Body_Parameters__c",request_headers:"skuid__Request_Headers__c",request_url_parameters:"skuid__Request_URL_Parameters__c",url:"skuid__URL__c",username:"skuid__Username__c",use_proxy:"skuid__Use_Apex_Proxy__c",type:"skuid__Adapter_Name__c"},data_source_credential:{id:"Id",password:"skuid__Password__c",user_id:"skuid__Applies_To__c",username:"skuid__Username__c"},page:{composer_settings:"skuid__Composer_Settings__c",id:"Id",is_master_page:"skuid__IsMaster__c",master_page:"skuid__MasterPage__r",master_page_id:"skuid__MasterPage__c",max_auto_saves:"skuid__Max_Auto_Saves__c",module:"skuid__Module__c",name:"Name",updated_at:"LastModifiedDate"},static_resource:{id:"Id",name:"Name",namespace:"NamespacePrefix",content_type:"ContentType"},theme:{id:"Id",name:"Name",resource_name:"skuid__Resource_Name__c",resource_namespace:"skuid__Resource_Namespace__c",type:"skuid__Type__c",version_date:"skuid__Skuid_Version_Date__c",active:"skuid__Active__c"}},Z={};sforce.one&&navigator&&(navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i))&&(a.$.ui.dialog.prototype._focusTabbable=function(){}),window.Visualforce&&window.Visualforce.remoting&&(window.Visualforce.remoting.timeout=9e4);var $={RICHTEXT:{edit:function(c){function d(){var a=this._richtextInstanceAPI,b=a.get("v.value");if(b===undefined)throw"Unable to get value from Rich Text component.";h&&h(b)}if(a.utils.inPlatform(X))return a.ui.renderers.RICHTEXT.edit(c);c||(c={});var e=b("<div>").append(b('<div class="nx-spinner">')),f=c.value,g=c.field||c.editor||c.component,h=c.onChange,i=c.onCreated,j=c.afterInit,k=e;return b.when(g).then(function(){for(;!g&&k.length;)k=k.parent(),g=k.data("object")||k.data("component")||k.data("editor");return g}).then(function(b){b&&b._richtextInstanceAPI&&(b._richtextInstanceAPI.destroy(),delete b._richtextInstanceAPI);var c=b&&b.getParentPage()||e.closest(".nx-page").data("component")||a.component.getByType("skuidpage")[0];if(c)return c.teleportLightningComponent("lightning:inputRichText",{value:f,onblur:{run:d.bind(b)}},e).then(function(a){b._richtextInstanceAPI=a})}).then(function(){e.find("> .nx-spinner").remove(),i&&i(),j&&j()}),e},destroy:function(a){var b=a.field||a.editor||a.component,c=b&&b._richtextInstanceAPI;c&&(c.destroy(),delete b._richtextInstanceAPI)}}},_={checkNetwork:function(){return L("checkNetwork")["catch"](function(a){if(!d()&&a&&a.indexOf&&-1!==a.indexOf("Remoting request invalid for your session.  Refresh page and re-submit request"))return g(0);if(!(c().isString(a)&&a.indexOf("Logged in?")>-1))throw a})},componentPack:function(a){return c().isUndefined(a)&&(a=null),L("componentPackService",a)},events:function(){var b=a.events,d=b.Event,e=b.EventParameter,f=[{name:"force:closeQuickAction",label:"Lightning: Close Quick Action"},{name:"force:showToast",label:"Lightning: Show Toast Message",parameters:[{name:"title",label:"Title",displayType:"TEXT"},{name:"message",label:"Message",displayType:"TEXT",metadata:{required:!0}},{name:"duration",label:"Duration (milliseconds)",displayType:"INTEGER",metadata:{defaultValue:"5000"}},{name:"type",label:"Type",displayType:"PICKLIST",metadata:{defaultValue:"other",required:!0,picklistEntries:[{label:"Error",value:"error"},{label:"Warning",value:"warning"},{label:"Success",value:"success"},{label:"Info",value:"info"},{label:"Other",value:"other"}]}},{name:"mode",label:"Remains visible until",displayType:"PICKLIST",metadata:{defaultValue:"dismissible",required:!0,picklistEntries:[{label:"User closes OR duration elapses",value:"dismissible"},{label:"Duration elapses - no close button.",value:"pester"},{label:"Until user closes - duration is ignored.",value:"sticky"}]}},{name:"key",label:"Icon",displayType:"TEXT"}]}];return c().resolve(f.map(function(b){return new d(b.name,b.label,(b.parameters||[]).map(function(a){return new e(a.name,a.label,a.displayType,a.metadata)}),{scope:a.constants.EVENT_SCOPES.GLOBAL,subscribable:!1})}))},labels:function(a){return d()?K(a):L("labelsService",JSON.stringify(a))},meta:function(a){return L("metaService",JSON.stringify(a))},page:function(a,b){return c().isUndefined(b)&&(b=null),L("pageService",a,b).then(function(a){return{metadata:{pageName:a.pageName,pageId:a.pageId,pageLastModifiedDate:a.pageLastModifiedDate,masterPageName:a.masterPageName},xml:a.pageLayout}})},serviceModstamps:function(){return L("loaderServiceModstamps")},settings:function(){return L("settingsService")},theme:function(a){return L("themeService",a)}};a.platform={attemptLogin:g,get:H,getBasePreviewUrl:r,getBaseXmlEditorUrl:t,getIconsUrl:M,getDefaultDataSourceName:N,getDefaultDataSourceTypeName:O,getPageNavigateUrl:s,getEntityFieldName:C,getEntityFieldNames:B,getLayoutFields:u,getMaxProxyRequestPayload:v,getName:w,isNative:x,getNavigationItemSourceTypes:A,getOAuthRedirectUri:z,getOAuthProxyUri:y,getPageComposeUrlById:o,getPageComposeUrlByName:p,getRenderers:q,getResourceUrl:D,getSiteResourceUrl:E,handlePageLoaderNotFound:U,isPlatformSessionError:P,loadModstampsForTestResourceFiles:G,publishEvent:S,requiresSerializedProxyRequests:T,requiresClientSideModelLoading:d,resolveTestPath:F,services:_,set:I,hasFeature:V},a.platform.builder={getProtectedModules:function(){return a.builder.core.protectedModules},getPageModule:function(a,b){return a.getFieldValue(b,"skuid__Module__c",!0)||""},getModuleEntries:function(b){return a.$.map(b.getField("skuid__Module__c").picklistEntries,function(a){return{value:a.value,label:a.label,disabled:!1===a.active,defaultValue:a.defaultValue}})},getAvailableComponentPacks:function(){return a.builder.core.availablePacks},getPageSelectProperty:function(a){return{id:a.id,type:"autocomplete",sobject:"skuid__Page__c",dataSource:a.dataSource,fieldsToReturn:["Name","skuid__Module__c"],fieldsToSearch:["Name","skuid__Module__c"],displayTemplate:"{{Name}}{{#skuid__Module__c}} ({{skuid__Module__c}}){{/skuid__Module__c}}",valueTemplates:{pagename:"{{Name}}",module:"{{skuid__Module__c}}"},order:"Name",label:a.label,helptext:a.helptext,required:!0,onChange:a.onChange||function(){}}},getStaticResourceProperty:function(a){return{id:a.id,type:"autocomplete",sobject:"StaticResource",fieldsToReturn:["Name","NamespacePrefix","ContentType"],fieldsToSearch:["Name","NamespacePrefix"],displayTemplate:"{{Name}}{{#ContentType}} ({{ContentType}}){{/ContentType}}",valueTemplates:a.valueTemplates,order:"Name",label:"Resource Name",helptext:a.helptext,required:a.required||!1,onChange:a.onChange||function(){}}},getNestedPathProperty:function(a){return{id:a.id||"filepath",type:"filepath",label:"File Path (within ZIP Static Resources)",helptext:"The desired file's relative location within Static Resources that are .zip files. Do not use unless your Static Resource is a ZIP file.",divisionSize:"2",getResourceName:function(){var b=a.state.attr(a.nameProperty).split("__");return b[b.length-1]},getResourceNamespace:function(){var b=a.state.attr(a.namespaceProperty).split("__");return 2===b.length?b[0]:null},onChange:a.onChange||function(){}}}},a.platform.themeBuilder={getThemeData:function(c,d){var e=b.Deferred();return a.ThemeComposerController.bootstrap(JSON.stringify({resourceName:c.Name,resourceNamespace:c.NamespacePrefix}),function(a){d&&d(a),e.resolve(a)},{escape:!1}),e.promise()},getThemeResourceUrl:function(b){return a.platform.getResourceUrl(b)},getResource:function(a,b){return c().getBodyOfZIPResourceFile(a.Name,a.NamespacePrefix,b)},saveTheme:function(b,c,d){var e={Id:b.resourceId||d.Id,Body:c};return new a.sfdc.api.SObject("StaticResource",e).update()}},a.sfdc.search=function(){function b(){return c.search.apply(c,d)}var c=a.dataSource.get("salesforce"),d=arguments;return c?b():a.loader.service.loadDataSourceAndDependencies("salesforce").then(function(a){return c=a,b()})}}(skuid,skuid.$),function(a,b,c){function d(b){var c=a.page.language,d=[c];return c&&c.length>2&&d.push(c.substring(0,2)),{fields:[{id:"Name"},{id:"MasterLabel"},{id:"PageOrSobjectType"},{id:"NamespacePrefix"},{id:"OpenType"},{id:"LinkType"},{id:"Url"},{id:"Localization",type:"childRelationship",fields:[{id:"Value"}],conditions:[{field:"Language",type:"multiple",operator:"in",values:d}],recordsLimit:1,orderByClause:"NamespacePrefix NULLS FIRST"}],conditions:[{field:"DisplayType",operator:"IN",type:"multiple",values:["L","B"]},{field:"PageOrSobjectType",value:b},{field:"LinkType",operator:"IN",type:"multiple",values:["page","url"]}],objectName:"Weblink",order:"Name"}}function e(a){a&&(a instanceof Array?a.length&&c.each(a,function(){k.push(this)}):k.push(this))}function f(a){return a in l}function g(b){var h,i,j=b.weblinkName,n=b.objectName,o=b.namespacePrefix,p=b.callback,q=c.Deferred();if(j&&n&&c.each(k,function(a,b){if(b.Name===j&&b.PageOrSobjectType===n){if(o===b.NamespacePrefix)return i=b,!1;b.NamespacePrefix&&(h=b)}}),!i&&h&&(i=h),i||!0===b.didQuery||f(n))q.resolve(),p&&p(i);else{var r=m[n],s=!1;r||(r=m[n]=[],s=!0),r.push(b),s&&a.remote().load(JSON.stringify(d(n)),function(a,b){l[n]=1;var d=JSON.parse(a),f=d.models[0];b.status?(f.data&&f.data.length&&e(f.data),c.each(r,function(a,b){b.didQuery=!0,g(b)})):(q.resolve(),r.length&&c.each(r,function(a,b){b.callback&&b.callback(null)})),delete m[n]},{escape:!1})}return q}function h(a){var b=a.Localization;return b&&b.records?b.records[0].Value:a.MasterLabel}function i(a){var b=[];return k.length&&c.each(k,function(){this.PageOrSobjectType===a&&b.push(this)}),b}function j(){k=[],l={},m={}}var k,l,m,n=b.weblink={};j(),n.get=g,n.getLabel=h,n.getAllForObject=i,n.add=e,n.haveQueriedForObject=f,n.resetCaches=j,n._buildQueryForObject=d}(skuid,skuid.sfdc,skuid.$);